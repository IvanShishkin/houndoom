# Extended malware signatures
# Note: Patterns with backreferences (\1, \2) are skipped (Go RE2 limitation)

signatures:
  - id: "PHP-STR-0001"
    name: "PHP-STR-0001"
    description: "Malware detection signature PHP-STR-0001"
    severity: critical
    category: php_backdoor
    pattern: 'w4l3XzY3 Mailer'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0002"
    name: "PHP-STR-0002"
    description: "Malware detection signature PHP-STR-0002"
    severity: critical
    category: php_backdoor
    pattern: 'Coded_by_V'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0003"
    name: "PHP-STR-0003"
    description: "Malware detection signature PHP-STR-0003"
    severity: critical
    category: php_backdoor
    pattern: 'move_uploaded_file($_FILES[<qq>F1l3'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0004"
    name: "PHP-STR-0004"
    description: "Malware detection signature PHP-STR-0004"
    severity: critical
    category: php_backdoor
    pattern: 'By<s1>KymLjnk'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0005"
    name: "PHP-STR-0005"
    description: "Malware detection signature PHP-STR-0005"
    severity: critical
    category: php_backdoor
    pattern: 'By<s1>Sh4Link'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0006"
    name: "PHP-STR-0006"
    description: "Malware detection signature PHP-STR-0006"
    severity: critical
    category: php_backdoor
    pattern: 'By<s1>AnonCoders'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0007"
    name: "PHP-STR-0007"
    description: "Malware detection signature PHP-STR-0007"
    severity: critical
    category: php_backdoor
    pattern: '$userAgents = array("Google", "Slurp", "MSNBot'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0008"
    name: "PHP-STR-0008"
    description: "Malware detection signature PHP-STR-0008"
    severity: critical
    category: php_backdoor
    pattern: '[3ran]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0009"
    name: "PHP-STR-0009"
    description: "Malware detection signature PHP-STR-0009"
    severity: critical
    category: php_backdoor
    pattern: 'Dawn_angel'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0010"
    name: "PHP-STR-0010"
    description: "Malware detection signature PHP-STR-0010"
    severity: critical
    category: php_backdoor
    pattern: 'R3DTUXES'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0011"
    name: "PHP-STR-0011"
    description: "Malware detection signature PHP-STR-0011"
    severity: critical
    category: php_backdoor
    pattern: 'visitorTracker_isMob'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0012"
    name: "PHP-STR-0012"
    description: "Malware detection signature PHP-STR-0012"
    severity: critical
    category: php_backdoor
    pattern: 'com_content/articled.php'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0013"
    name: "PHP-STR-0013"
    description: "Malware detection signature PHP-STR-0013"
    severity: critical
    category: php_backdoor
    pattern: '<title>EmsProxy v'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0014"
    name: "PHP-STR-0014"
    description: "Malware detection signature PHP-STR-0014"
    severity: critical
    category: php_backdoor
    pattern: 'android-igra-'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0015"
    name: "PHP-STR-0015"
    description: "Malware detection signature PHP-STR-0015"
    severity: critical
    category: php_backdoor
    pattern: '===:::mad:::==='
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0016"
    name: "PHP-STR-0016"
    description: "Malware detection signature PHP-STR-0016"
    severity: critical
    category: php_backdoor
    pattern: 'H4xOr'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0017"
    name: "PHP-STR-0017"
    description: "Malware detection signature PHP-STR-0017"
    severity: critical
    category: php_backdoor
    pattern: 'R4pH4x0r'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0018"
    name: "PHP-STR-0018"
    description: "Malware detection signature PHP-STR-0018"
    severity: critical
    category: php_backdoor
    pattern: 'NG689Skw'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0019"
    name: "PHP-STR-0019"
    description: "Malware detection signature PHP-STR-0019"
    severity: critical
    category: php_backdoor
    pattern: 'fopo.com.ar'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0020"
    name: "PHP-STR-0020"
    description: "Malware detection signature PHP-STR-0020"
    severity: critical
    category: php_backdoor
    pattern: '64.68.80.'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0021"
    name: "PHP-STR-0021"
    description: "Malware detection signature PHP-STR-0021"
    severity: critical
    category: php_backdoor
    pattern: 'HarchaLi'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0022"
    name: "PHP-STR-0022"
    description: "Malware detection signature PHP-STR-0022"
    severity: critical
    category: php_backdoor
    pattern: 'xxR99musviei0x0'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0023"
    name: "PHP-STR-0023"
    description: "Malware detection signature PHP-STR-0023"
    severity: critical
    category: php_backdoor
    pattern: 'P.h.p.S.p.y'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0024"
    name: "PHP-STR-0024"
    description: "Malware detection signature PHP-STR-0024"
    severity: critical
    category: php_backdoor
    pattern: '_shell_atildi_'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0025"
    name: "PHP-STR-0025"
    description: "Malware detection signature PHP-STR-0025"
    severity: critical
    category: php_backdoor
    pattern: '~ Shell I'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0026"
    name: "PHP-STR-0026"
    description: "Malware detection signature PHP-STR-0026"
    severity: critical
    category: php_backdoor
    pattern: '0xdd82'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0027"
    name: "PHP-STR-0027"
    description: "Malware detection signature PHP-STR-0027"
    severity: critical
    category: php_backdoor
    pattern: 'Antichat shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0028"
    name: "PHP-STR-0028"
    description: "Malware detection signature PHP-STR-0028"
    severity: critical
    category: php_backdoor
    pattern: 'ALEMiN KRALi'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0029"
    name: "PHP-STR-0029"
    description: "Malware detection signature PHP-STR-0029"
    severity: critical
    category: php_backdoor
    pattern: 'ASPX Shell by LT'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0030"
    name: "PHP-STR-0030"
    description: "Malware detection signature PHP-STR-0030"
    severity: critical
    category: php_backdoor
    pattern: 'aZRaiLPhP'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0031"
    name: "PHP-STR-0031"
    description: "Malware detection signature PHP-STR-0031"
    severity: critical
    category: php_backdoor
    pattern: 'Coded By Charlichaplin'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0032"
    name: "PHP-STR-0032"
    description: "Malware detection signature PHP-STR-0032"
    severity: critical
    category: php_backdoor
    pattern: 'Bl0od3r'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0033"
    name: "PHP-STR-0033"
    description: "Malware detection signature PHP-STR-0033"
    severity: critical
    category: php_backdoor
    pattern: 'BY iSKORPiTX'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0034"
    name: "PHP-STR-0034"
    description: "Malware detection signature PHP-STR-0034"
    severity: critical
    category: php_backdoor
    pattern: 'devilzShell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0035"
    name: "PHP-STR-0035"
    description: "Malware detection signature PHP-STR-0035"
    severity: critical
    category: php_backdoor
    pattern: 'Written by Captain Crunch Team'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0036"
    name: "PHP-STR-0036"
    description: "Malware detection signature PHP-STR-0036"
    severity: critical
    category: php_backdoor
    pattern: 'c2007.php'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0037"
    name: "PHP-STR-0037"
    description: "Malware detection signature PHP-STR-0037"
    severity: critical
    category: php_backdoor
    pattern: 'C99 Modified By Psych0'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0038"
    name: "PHP-STR-0038"
    description: "Malware detection signature PHP-STR-0038"
    severity: critical
    category: php_backdoor
    pattern: '$c99sh_updatefurl'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0039"
    name: "PHP-STR-0039"
    description: "Malware detection signature PHP-STR-0039"
    severity: critical
    category: php_backdoor
    pattern: 'C99 Shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0040"
    name: "PHP-STR-0040"
    description: "Malware detection signature PHP-STR-0040"
    severity: critical
    category: php_backdoor
    pattern: 'cookiename = "wieeeee"'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0041"
    name: "PHP-STR-0041"
    description: "Malware detection signature PHP-STR-0041"
    severity: critical
    category: php_backdoor
    pattern: 'Coded by : Super-Crystal and Mohajer22'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0042"
    name: "PHP-STR-0042"
    description: "Malware detection signature PHP-STR-0042"
    severity: critical
    category: php_backdoor
    pattern: 'CrystalShell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0043"
    name: "PHP-STR-0043"
    description: "Malware detection signature PHP-STR-0043"
    severity: critical
    category: php_backdoor
    pattern: 'TEAM SCRIPTING - RODNOC'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0044"
    name: "PHP-STR-0044"
    description: "Malware detection signature PHP-STR-0044"
    severity: critical
    category: php_backdoor
    pattern: 'Cyber Shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0045"
    name: "PHP-STR-0045"
    description: "Malware detection signature PHP-STR-0045"
    severity: critical
    category: php_backdoor
    pattern: 'd0mains'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0046"
    name: "PHP-STR-0046"
    description: "Malware detection signature PHP-STR-0046"
    severity: critical
    category: php_backdoor
    pattern: 'DarkDevilz.iN'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0047"
    name: "PHP-STR-0047"
    description: "Malware detection signature PHP-STR-0047"
    severity: critical
    category: php_backdoor
    pattern: 'Shell written by Bl0od3r'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0048"
    name: "PHP-STR-0048"
    description: "Malware detection signature PHP-STR-0048"
    severity: critical
    category: php_backdoor
    pattern: 'Dive Shell - Emperor Hacking Team'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0049"
    name: "PHP-STR-0049"
    description: "Malware detection signature PHP-STR-0049"
    severity: critical
    category: php_backdoor
    pattern: 'Devr-i Mefsedet'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0050"
    name: "PHP-STR-0050"
    description: "Malware detection signature PHP-STR-0050"
    severity: critical
    category: php_backdoor
    pattern: 'Comandos Exclusivos do DTool Pro'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0051"
    name: "PHP-STR-0051"
    description: "Malware detection signature PHP-STR-0051"
    severity: critical
    category: php_backdoor
    pattern: 'Emperor Hacking TEAM'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0052"
    name: "PHP-STR-0052"
    description: "Malware detection signature PHP-STR-0052"
    severity: critical
    category: php_backdoor
    pattern: 'Fixed by Art Of Hack'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0053"
    name: "PHP-STR-0053"
    description: "Malware detection signature PHP-STR-0053"
    severity: critical
    category: php_backdoor
    pattern: 'FaTaLisTiCz_Fx Fx29Sh'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0054"
    name: "PHP-STR-0054"
    description: "Malware detection signature PHP-STR-0054"
    severity: critical
    category: php_backdoor
    pattern: 'Lutfen Dosyayi Adlandiriniz'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0055"
    name: "PHP-STR-0055"
    description: "Malware detection signature PHP-STR-0055"
    severity: critical
    category: php_backdoor
    pattern: 'this is a priv3 server'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0056"
    name: "PHP-STR-0056"
    description: "Malware detection signature PHP-STR-0056"
    severity: critical
    category: php_backdoor
    pattern: 'GFS Web-Shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0057"
    name: "PHP-STR-0057"
    description: "Malware detection signature PHP-STR-0057"
    severity: critical
    category: php_backdoor
    pattern: 'GHC Manager'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0058"
    name: "PHP-STR-0058"
    description: "Malware detection signature PHP-STR-0058"
    severity: critical
    category: php_backdoor
    pattern: 'Goog1e_analist'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0059"
    name: "PHP-STR-0059"
    description: "Malware detection signature PHP-STR-0059"
    severity: critical
    category: php_backdoor
    pattern: 'Grinay Go0o$E'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0060"
    name: "PHP-STR-0060"
    description: "Malware detection signature PHP-STR-0060"
    severity: critical
    category: php_backdoor
    pattern: 'h4ntu shell [powered by tsoi]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0061"
    name: "PHP-STR-0061"
    description: "Malware detection signature PHP-STR-0061"
    severity: critical
    category: php_backdoor
    pattern: 'Hacked By Devr-i Mefsedet'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0062"
    name: "PHP-STR-0062"
    description: "Malware detection signature PHP-STR-0062"
    severity: critical
    category: php_backdoor
    pattern: 'HACKED BY REALWAR'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0063"
    name: "PHP-STR-0063"
    description: "Malware detection signature PHP-STR-0063"
    severity: critical
    category: php_backdoor
    pattern: 'Hackerler Vurur Lamerler Surunur'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0064"
    name: "PHP-STR-0064"
    description: "Malware detection signature PHP-STR-0064"
    severity: critical
    category: php_backdoor
    pattern: 'iMHaBiRLiGi'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0065"
    name: "PHP-STR-0065"
    description: "Malware detection signature PHP-STR-0065"
    severity: critical
    category: php_backdoor
    pattern: 'KA_uShell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0066"
    name: "PHP-STR-0066"
    description: "Malware detection signature PHP-STR-0066"
    severity: critical
    category: php_backdoor
    pattern: 'Liz0ziM'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0067"
    name: "PHP-STR-0067"
    description: "Malware detection signature PHP-STR-0067"
    severity: critical
    category: php_backdoor
    pattern: 'Locus7Shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0068"
    name: "PHP-STR-0068"
    description: "Malware detection signature PHP-STR-0068"
    severity: critical
    category: php_backdoor
    pattern: 'Moroccan Spamers Ma-EditioN By GhOsT'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0069"
    name: "PHP-STR-0069"
    description: "Malware detection signature PHP-STR-0069"
    severity: critical
    category: php_backdoor
    pattern: 'Matamu Mat'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0070"
    name: "PHP-STR-0070"
    description: "Malware detection signature PHP-STR-0070"
    severity: critical
    category: php_backdoor
    pattern: 'Open the file attachment if any, and base64_encode'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0071"
    name: "PHP-STR-0071"
    description: "Malware detection signature PHP-STR-0071"
    severity: critical
    category: php_backdoor
    pattern: 'm0rtix'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0072"
    name: "PHP-STR-0072"
    description: "Malware detection signature PHP-STR-0072"
    severity: critical
    category: php_backdoor
    pattern: 'm0hze'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0073"
    name: "PHP-STR-0073"
    description: "Malware detection signature PHP-STR-0073"
    severity: critical
    category: php_backdoor
    pattern: 'Matamu Mat'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0074"
    name: "PHP-STR-0074"
    description: "Malware detection signature PHP-STR-0074"
    severity: critical
    category: php_backdoor
    pattern: 'Moroccan Spamers'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0075"
    name: "PHP-STR-0075"
    description: "Malware detection signature PHP-STR-0075"
    severity: critical
    category: php_backdoor
    pattern: '$MyShellVersion'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0076"
    name: "PHP-STR-0076"
    description: "Malware detection signature PHP-STR-0076"
    severity: critical
    category: php_backdoor
    pattern: 'MySQL RST'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0077"
    name: "PHP-STR-0077"
    description: "Malware detection signature PHP-STR-0077"
    severity: critical
    category: php_backdoor
    pattern: 'MySQL Web Interface'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0078"
    name: "PHP-STR-0078"
    description: "Malware detection signature PHP-STR-0078"
    severity: critical
    category: php_backdoor
    pattern: 'MySQL Web Interface Version'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0079"
    name: "PHP-STR-0079"
    description: "Malware detection signature PHP-STR-0079"
    severity: critical
    category: php_backdoor
    pattern: 'MySQL Webshell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0080"
    name: "PHP-STR-0080"
    description: "Malware detection signature PHP-STR-0080"
    severity: critical
    category: php_backdoor
    pattern: 'N3tshell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0081"
    name: "PHP-STR-0081"
    description: "Malware detection signature PHP-STR-0081"
    severity: critical
    category: php_backdoor
    pattern: 'Hacked by Silver'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0082"
    name: "PHP-STR-0082"
    description: "Malware detection signature PHP-STR-0082"
    severity: critical
    category: php_backdoor
    pattern: 'HaCkeD By Fallag'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0083"
    name: "PHP-STR-0083"
    description: "Malware detection signature PHP-STR-0083"
    severity: critical
    category: php_backdoor
    pattern: 'erivfvhz'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0084"
    name: "PHP-STR-0084"
    description: "Malware detection signature PHP-STR-0084"
    severity: critical
    category: php_backdoor
    pattern: 'NeoHack'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0085"
    name: "PHP-STR-0085"
    description: "Malware detection signature PHP-STR-0085"
    severity: critical
    category: php_backdoor
    pattern: 'By KymLjnk'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0086"
    name: "PHP-STR-0086"
    description: "Malware detection signature PHP-STR-0086"
    severity: critical
    category: php_backdoor
    pattern: 'Big R3zult'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0087"
    name: "PHP-STR-0087"
    description: "Malware detection signature PHP-STR-0087"
    severity: critical
    category: php_backdoor
    pattern: 'NetworkFileManagerPHP'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0088"
    name: "PHP-STR-0088"
    description: "Malware detection signature PHP-STR-0088"
    severity: critical
    category: php_backdoor
    pattern: 'NIX REMOTE WEB-SHELL'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0089"
    name: "PHP-STR-0089"
    description: "Malware detection signature PHP-STR-0089"
    severity: critical
    category: php_backdoor
    pattern: 'O BiR KRAL TAKLiT EDilEMEZ'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0090"
    name: "PHP-STR-0090"
    description: "Malware detection signature PHP-STR-0090"
    severity: critical
    category: php_backdoor
    pattern: 'PHANTASMA- NeW CmD'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0091"
    name: "PHP-STR-0091"
    description: "Malware detection signature PHP-STR-0091"
    severity: critical
    category: php_backdoor
    pattern: 'PIRATES CREW WAS HERE'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0092"
    name: "PHP-STR-0092"
    description: "Malware detection signature PHP-STR-0092"
    severity: critical
    category: php_backdoor
    pattern: 'a simple php backdoor'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0093"
    name: "PHP-STR-0093"
    description: "Malware detection signature PHP-STR-0093"
    severity: critical
    category: php_backdoor
    pattern: 'LOTFREE PHP Backdoor'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0094"
    name: "PHP-STR-0094"
    description: "Malware detection signature PHP-STR-0094"
    severity: critical
    category: php_backdoor
    pattern: 'News Remote PHP Shell Injection'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0095"
    name: "PHP-STR-0095"
    description: "Malware detection signature PHP-STR-0095"
    severity: critical
    category: php_backdoor
    pattern: 'PHPJackal'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0096"
    name: "PHP-STR-0096"
    description: "Malware detection signature PHP-STR-0096"
    severity: critical
    category: php_backdoor
    pattern: 'PHP HVA Shell Script'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0097"
    name: "PHP-STR-0097"
    description: "Malware detection signature PHP-STR-0097"
    severity: critical
    category: php_backdoor
    pattern: 'phpRemoteView'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0098"
    name: "PHP-STR-0098"
    description: "Malware detection signature PHP-STR-0098"
    severity: critical
    category: php_backdoor
    pattern: 'PHP Shell is aninteractive PHP-page'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0099"
    name: "PHP-STR-0099"
    description: "Malware detection signature PHP-STR-0099"
    severity: critical
    category: php_backdoor
    pattern: 'PHVayv'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0100"
    name: "PHP-STR-0100"
    description: "Malware detection signature PHP-STR-0100"
    severity: critical
    category: php_backdoor
    pattern: 'PPS 1.0 perl-cgi web shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0101"
    name: "PHP-STR-0101"
    description: "Malware detection signature PHP-STR-0101"
    severity: critical
    category: php_backdoor
    pattern: 'Press OK to enter site'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0102"
    name: "PHP-STR-0102"
    description: "Malware detection signature PHP-STR-0102"
    severity: critical
    category: php_backdoor
    pattern: 'private Shell by m4rco'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0103"
    name: "PHP-STR-0103"
    description: "Malware detection signature PHP-STR-0103"
    severity: critical
    category: php_backdoor
    pattern: 'r0nin'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0104"
    name: "PHP-STR-0104"
    description: "Malware detection signature PHP-STR-0104"
    severity: critical
    category: php_backdoor
    pattern: 'R57Sql'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0105"
    name: "PHP-STR-0105"
    description: "Malware detection signature PHP-STR-0105"
    severity: critical
    category: php_backdoor
    pattern: 'r57shell\.php'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0106"
    name: "PHP-STR-0106"
    description: "Malware detection signature PHP-STR-0106"
    severity: critical
    category: php_backdoor
    pattern: 'rgod`s webshell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0107"
    name: "PHP-STR-0107"
    description: "Malware detection signature PHP-STR-0107"
    severity: critical
    category: php_backdoor
    pattern: 'realauth=SvBD85dINu3'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0108"
    name: "PHP-STR-0108"
    description: "Malware detection signature PHP-STR-0108"
    severity: critical
    category: php_backdoor
    pattern: 'Ru24PostWebShell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0109"
    name: "PHP-STR-0109"
    description: "Malware detection signature PHP-STR-0109"
    severity: critical
    category: php_backdoor
    pattern: 'KAdot Universal Shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0110"
    name: "PHP-STR-0110"
    description: "Malware detection signature PHP-STR-0110"
    severity: critical
    category: php_backdoor
    pattern: 'Cr@zy_King'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0111"
    name: "PHP-STR-0111"
    description: "Malware detection signature PHP-STR-0111"
    severity: critical
    category: php_backdoor
    pattern: 'Safe_Mode Bypass PHP'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0112"
    name: "PHP-STR-0112"
    description: "Malware detection signature PHP-STR-0112"
    severity: critical
    category: php_backdoor
    pattern: 'SarasaOn Services'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0113"
    name: "PHP-STR-0113"
    description: "Malware detection signature PHP-STR-0113"
    severity: critical
    category: php_backdoor
    pattern: 'Simple PHP backdoor by DK'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0114"
    name: "PHP-STR-0114"
    description: "Malware detection signature PHP-STR-0114"
    severity: critical
    category: php_backdoor
    pattern: 'G-Security Webshell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0115"
    name: "PHP-STR-0115"
    description: "Malware detection signature PHP-STR-0115"
    severity: critical
    category: php_backdoor
    pattern: 'Simorgh Security Magazine'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0116"
    name: "PHP-STR-0116"
    description: "Malware detection signature PHP-STR-0116"
    severity: critical
    category: php_backdoor
    pattern: 'Shell by Mawar_Hitam'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0117"
    name: "PHP-STR-0117"
    description: "Malware detection signature PHP-STR-0117"
    severity: critical
    category: php_backdoor
    pattern: 'SSI web-shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0118"
    name: "PHP-STR-0118"
    description: "Malware detection signature PHP-STR-0118"
    severity: critical
    category: php_backdoor
    pattern: 'Storm7Shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0119"
    name: "PHP-STR-0119"
    description: "Malware detection signature PHP-STR-0119"
    severity: critical
    category: php_backdoor
    pattern: 'The_BeKiR'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0120"
    name: "PHP-STR-0120"
    description: "Malware detection signature PHP-STR-0120"
    severity: critical
    category: php_backdoor
    pattern: 'W3D Shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0121"
    name: "PHP-STR-0121"
    description: "Malware detection signature PHP-STR-0121"
    severity: critical
    category: php_backdoor
    pattern: 'w4ck1ng shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0122"
    name: "PHP-STR-0122"
    description: "Malware detection signature PHP-STR-0122"
    severity: critical
    category: php_backdoor
    pattern: 'developed by Digital Outcast'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0123"
    name: "PHP-STR-0123"
    description: "Malware detection signature PHP-STR-0123"
    severity: critical
    category: php_backdoor
    pattern: 'Watch Your system Shany was here'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0124"
    name: "PHP-STR-0124"
    description: "Malware detection signature PHP-STR-0124"
    severity: critical
    category: php_backdoor
    pattern: 'Web Shell by'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0125"
    name: "PHP-STR-0125"
    description: "Malware detection signature PHP-STR-0125"
    severity: critical
    category: php_backdoor
    pattern: 'WSO2 Webshell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0126"
    name: "PHP-STR-0126"
    description: "Malware detection signature PHP-STR-0126"
    severity: critical
    category: php_backdoor
    pattern: 'NetworkFileManagerPHP for channel'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0127"
    name: "PHP-STR-0127"
    description: "Malware detection signature PHP-STR-0127"
    severity: critical
    category: php_backdoor
    pattern: 'Small PHP Web Shell by ZaCo'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0128"
    name: "PHP-STR-0128"
    description: "Malware detection signature PHP-STR-0128"
    severity: critical
    category: php_backdoor
    pattern: 'Mrlool.exe'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0129"
    name: "PHP-STR-0129"
    description: "Malware detection signature PHP-STR-0129"
    severity: critical
    category: php_backdoor
    pattern: 'SEoDOR'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0130"
    name: "PHP-STR-0130"
    description: "Malware detection signature PHP-STR-0130"
    severity: critical
    category: php_backdoor
    pattern: 'Mr.HiTman'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0131"
    name: "PHP-STR-0131"
    description: "Malware detection signature PHP-STR-0131"
    severity: critical
    category: php_backdoor
    pattern: 'd3b~X'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0132"
    name: "PHP-STR-0132"
    description: "Malware detection signature PHP-STR-0132"
    severity: critical
    category: php_backdoor
    pattern: 'ConnectBackShell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0133"
    name: "PHP-STR-0133"
    description: "Malware detection signature PHP-STR-0133"
    severity: critical
    category: php_backdoor
    pattern: 'BY MMNBOBZ'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0134"
    name: "PHP-STR-0134"
    description: "Malware detection signature PHP-STR-0134"
    severity: critical
    category: php_backdoor
    pattern: 'OLB:PRODUCT:ONLINE_BANKING'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0135"
    name: "PHP-STR-0135"
    description: "Malware detection signature PHP-STR-0135"
    severity: critical
    category: php_backdoor
    pattern: 'C0derz.com'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0136"
    name: "PHP-STR-0136"
    description: "Malware detection signature PHP-STR-0136"
    severity: critical
    category: php_backdoor
    pattern: 'MrHazem'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0137"
    name: "PHP-STR-0137"
    description: "Malware detection signature PHP-STR-0137"
    severity: critical
    category: php_backdoor
    pattern: 'v0ld3m0rt'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0138"
    name: "PHP-STR-0138"
    description: "Malware detection signature PHP-STR-0138"
    severity: critical
    category: php_backdoor
    pattern: 'K!LL3r'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0139"
    name: "PHP-STR-0139"
    description: "Malware detection signature PHP-STR-0139"
    severity: critical
    category: php_backdoor
    pattern: 'Dr.abolalh'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0140"
    name: "PHP-STR-0140"
    description: "Malware detection signature PHP-STR-0140"
    severity: critical
    category: php_backdoor
    pattern: '$rand_writable_folder_fullpath'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0141"
    name: "PHP-STR-0141"
    description: "Malware detection signature PHP-STR-0141"
    severity: critical
    category: php_backdoor
    pattern: '<textarea name=\"phpev\" rows=\"5\" cols=\"150\">".@$_POST[''phpev'']."</textarea><br>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0142"
    name: "PHP-STR-0142"
    description: "Malware detection signature PHP-STR-0142"
    severity: critical
    category: php_backdoor
    pattern: 'c99ftpbrutecheck'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0143"
    name: "PHP-STR-0143"
    description: "Malware detection signature PHP-STR-0143"
    severity: critical
    category: php_backdoor
    pattern: 'By Psych0'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0144"
    name: "PHP-STR-0144"
    description: "Malware detection signature PHP-STR-0144"
    severity: critical
    category: php_backdoor
    pattern: '$c99sh_updatefurl'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0145"
    name: "PHP-STR-0145"
    description: "Malware detection signature PHP-STR-0145"
    severity: critical
    category: php_backdoor
    pattern: 'temp_r57_table'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0146"
    name: "PHP-STR-0146"
    description: "Malware detection signature PHP-STR-0146"
    severity: critical
    category: php_backdoor
    pattern: 'admin@spygrup.org'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0147"
    name: "PHP-STR-0147"
    description: "Malware detection signature PHP-STR-0147"
    severity: critical
    category: php_backdoor
    pattern: 'casus15'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0148"
    name: "PHP-STR-0148"
    description: "Malware detection signature PHP-STR-0148"
    severity: critical
    category: php_backdoor
    pattern: 'WSCRIPT.SHELL'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0149"
    name: "PHP-STR-0149"
    description: "Malware detection signature PHP-STR-0149"
    severity: critical
    category: php_backdoor
    pattern: 'Executed command: <b><font color=#dcdcdc>[$cmd]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0150"
    name: "PHP-STR-0150"
    description: "Malware detection signature PHP-STR-0150"
    severity: critical
    category: php_backdoor
    pattern: 'ctshell.php'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0151"
    name: "PHP-STR-0151"
    description: "Malware detection signature PHP-STR-0151"
    severity: critical
    category: php_backdoor
    pattern: 'DX_Header_drawn'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0152"
    name: "PHP-STR-0152"
    description: "Malware detection signature PHP-STR-0152"
    severity: critical
    category: php_backdoor
    pattern: 'crlf.''unlink($name);''.$crlf.''rename("~".$name, $name);''.$crlf.''unlink("grp_repair.php"'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0153"
    name: "PHP-STR-0153"
    description: "Malware detection signature PHP-STR-0153"
    severity: critical
    category: php_backdoor
    pattern: '/0tVSG/Suv0Ur/haUYAdn3jMQwbbocGffAeC29BN9tmBiJdV1lk+jYDU92C94jdtDif+xOYjG6CLhx31Uo9x9/eAWgsBK60kK2mLwqzqd'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0154"
    name: "PHP-STR-0154"
    description: "Malware detection signature PHP-STR-0154"
    severity: critical
    category: php_backdoor
    pattern: 'mpty($_POST[''ur''])) $mode |= 0400; if (!empty($_POST[''uw''])) $mode |= 0200; if (!empty($_POST[''ux''])) $mode |= 0100'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0155"
    name: "PHP-STR-0155"
    description: "Malware detection signature PHP-STR-0155"
    severity: critical
    category: php_backdoor
    pattern: 'klasvayv.asp?yenidosya=<%=aktifklas%>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0156"
    name: "PHP-STR-0156"
    description: "Malware detection signature PHP-STR-0156"
    severity: critical
    category: php_backdoor
    pattern: 'nt)(disk_total_space(getcwd())/(1024*1024)) . "Mb " . "Free space " . (int)(disk_free_space(getcwd())/(1024*1024)) . "Mb <'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0157"
    name: "PHP-STR-0157"
    description: "Malware detection signature PHP-STR-0157"
    severity: critical
    category: php_backdoor
    pattern: 'a href="<?echo "$fistik.php?dizin=$dizin/../"?>" style="text-decoration: non'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0158"
    name: "PHP-STR-0158"
    description: "Malware detection signature PHP-STR-0158"
    severity: critical
    category: php_backdoor
    pattern: 'RootShell!'');self.location.href=''http:'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0159"
    name: "PHP-STR-0159"
    description: "Malware detection signature PHP-STR-0159"
    severity: critical
    category: php_backdoor
    pattern: '<%=Request.ServerVariables("script_name")%>?FolderPath=<%=Server.URLPathEncode(Folder.Driv'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0160"
    name: "PHP-STR-0160"
    description: "Malware detection signature PHP-STR-0160"
    severity: critical
    category: php_backdoor
    pattern: 'print((is_readable($f) && is_writeable($f))?"<tr><td>".w(1).b("R".w(1).font(''red'',''RW'',3)).w(1):(((is_readable($f))?"<tr><td>".w(1).b("R").w(4):"").((is_writabl'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0161"
    name: "PHP-STR-0161"
    description: "Malware detection signature PHP-STR-0161"
    severity: critical
    category: php_backdoor
    pattern: '(''"'',''&quot;'',$fn)).''";document.list.submit();\''>''.htmlspecialchars(strlen($fn)>format?substr($fn,0,format-3).''...'':$fn).''</a>''.str_repeat('' '',format-strlen($fn)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0162"
    name: "PHP-STR-0162"
    description: "Malware detection signature PHP-STR-0162"
    severity: critical
    category: php_backdoor
    pattern: 'zehirhacker'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0163"
    name: "PHP-STR-0163"
    description: "Malware detection signature PHP-STR-0163"
    severity: critical
    category: php_backdoor
    pattern: 'J@!Vr@*&RHRw~JLw.G|xlhnLJ~?1.bwObxbP|!V'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0164"
    name: "PHP-STR-0164"
    description: "Malware detection signature PHP-STR-0164"
    severity: critical
    category: php_backdoor
    pattern: 'WSOsetcookie(md5($_SERVER[''HTTP_HOST''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0165"
    name: "PHP-STR-0165"
    description: "Malware detection signature PHP-STR-0165"
    severity: critical
    category: php_backdoor
    pattern: '</td><td id=fa>[ <a title=\"Home: ''".htmlspecialchars(str_replace("\", $sep, getcwd()))."''.\" id=fa href=\"javascript:ViewDir(''".rawurlencode'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0166"
    name: "PHP-STR-0166"
    description: "Malware detection signature PHP-STR-0166"
    severity: critical
    category: php_backdoor
    pattern: 'Content-Type: $_'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0167"
    name: "PHP-STR-0167"
    description: "Malware detection signature PHP-STR-0167"
    severity: critical
    category: php_backdoor
    pattern: '<nobr><b>$cdir$cfile</b> (".$file["size_str"].")</nobr></td></tr><form name=curr_file>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0168"
    name: "PHP-STR-0168"
    description: "Malware detection signature PHP-STR-0168"
    severity: critical
    category: php_backdoor
    pattern: 'wsoEx(''tar cfzv '' . escapeshellarg($_POST[''p2''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0169"
    name: "PHP-STR-0169"
    description: "Malware detection signature PHP-STR-0169"
    severity: critical
    category: php_backdoor
    pattern: '5jb20iKW9yIHN0cmlzdHIoJHJlZmVyZXIsImFwb3J0Iikgb3Igc3RyaXN0cigkcmVmZXJlciwibmlnbWEiKSBvciBzdHJpc3RyKCRyZWZlcmVyLCJ3ZWJhbHRhIikgb3Igc3RyaXN0cigk'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0170"
    name: "PHP-STR-0170"
    description: "Malware detection signature PHP-STR-0170"
    severity: critical
    category: php_backdoor
    pattern: 'LS0gRHVtcDNkIGJ5IFBpcnVsaW4uUEhQIFdlYnNoM2xsIHYxLjAgYzBkZWQgYnkgcjBkcjEgOkw='
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0171"
    name: "PHP-STR-0171"
    description: "Malware detection signature PHP-STR-0171"
    severity: critical
    category: php_backdoor
    pattern: 'if (ereg(''^[[:blank:]]*cd[[:blank:]]+([^;]+)$'', $command, $regs))'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0172"
    name: "PHP-STR-0172"
    description: "Malware detection signature PHP-STR-0172"
    severity: critical
    category: php_backdoor
    pattern: 'round(0+9830.4+9830.4+9830.4+9830.4+9830.4))=='
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0173"
    name: "PHP-STR-0173"
    description: "Malware detection signature PHP-STR-0173"
    severity: critical
    category: php_backdoor
    pattern: 'PHPSHELL.PHP'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0174"
    name: "PHP-STR-0174"
    description: "Malware detection signature PHP-STR-0174"
    severity: critical
    category: php_backdoor
    pattern: 'Shell by Mawar_Hitam'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0175"
    name: "PHP-STR-0175"
    description: "Malware detection signature PHP-STR-0175"
    severity: critical
    category: php_backdoor
    pattern: 'private Shell by m4rco'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0176"
    name: "PHP-STR-0176"
    description: "Malware detection signature PHP-STR-0176"
    severity: critical
    category: php_backdoor
    pattern: 'w4ck1ng shell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0177"
    name: "PHP-STR-0177"
    description: "Malware detection signature PHP-STR-0177"
    severity: critical
    category: php_backdoor
    pattern: 'FaTaLisTiCz_Fx Fx29Sh'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0178"
    name: "PHP-STR-0178"
    description: "Malware detection signature PHP-STR-0178"
    severity: critical
    category: php_backdoor
    pattern: 'Worker_GetReplyCode($opData[''recvBuffer''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0179"
    name: "PHP-STR-0179"
    description: "Malware detection signature PHP-STR-0179"
    severity: critical
    category: php_backdoor
    pattern: '$filepath=@realpath($_POST[''filepath'']);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0180"
    name: "PHP-STR-0180"
    description: "Malware detection signature PHP-STR-0180"
    severity: critical
    category: php_backdoor
    pattern: '$redirectURL=''http://''.$rSite.$_SERVER[''REQUEST_URI''];if(isset($_SERVER[''HTTP_REFERER''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0181"
    name: "PHP-STR-0181"
    description: "Malware detection signature PHP-STR-0181"
    severity: critical
    category: php_backdoor
    pattern: 'rename("wso.php",'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0182"
    name: "PHP-STR-0182"
    description: "Malware detection signature PHP-STR-0182"
    severity: critical
    category: php_backdoor
    pattern: '$MessageSubject = base64_decode($_POST["msgsubject"]);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0183"
    name: "PHP-STR-0183"
    description: "Malware detection signature PHP-STR-0183"
    severity: critical
    category: php_backdoor
    pattern: 'copy($_FILES[x][tmp_name],$_FILES[x][name]))'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0184"
    name: "PHP-STR-0184"
    description: "Malware detection signature PHP-STR-0184"
    severity: critical
    category: php_backdoor
    pattern: 'SELECT 1 FROM mysql.user WHERE concat(`user`, ''@'', `host`)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0185"
    name: "PHP-STR-0185"
    description: "Malware detection signature PHP-STR-0185"
    severity: critical
    category: php_backdoor
    pattern: '!@$_COOKIE[$sessdt_k]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0186"
    name: "PHP-STR-0186"
    description: "Malware detection signature PHP-STR-0186"
    severity: critical
    category: php_backdoor
    pattern: '$a=(substr(urlencode(print_r(array(),1)),5,1).c)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0187"
    name: "PHP-STR-0187"
    description: "Malware detection signature PHP-STR-0187"
    severity: critical
    category: php_backdoor
    pattern: 'xh -s "/usr/local/apache/sbin/httpd -DSSL" ./httpd -m $1'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0188"
    name: "PHP-STR-0188"
    description: "Malware detection signature PHP-STR-0188"
    severity: critical
    category: php_backdoor
    pattern: 'pwd > Generasi.dir'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0189"
    name: "PHP-STR-0189"
    description: "Malware detection signature PHP-STR-0189"
    severity: critical
    category: php_backdoor
    pattern: 'BRUTEFORCING'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0190"
    name: "PHP-STR-0190"
    description: "Malware detection signature PHP-STR-0190"
    severity: critical
    category: php_backdoor
    pattern: 'Cautam fisierele de configurare'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0191"
    name: "PHP-STR-0191"
    description: "Malware detection signature PHP-STR-0191"
    severity: critical
    category: php_backdoor
    pattern: '$ka=''<?//BRE'';$kaka=$ka.''ACK//?>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0192"
    name: "PHP-STR-0192"
    description: "Malware detection signature PHP-STR-0192"
    severity: critical
    category: php_backdoor
    pattern: '$subj=urldecode($_GET[''su'']);$body=urldecode($_GET[''bo'']);$sds=urldecode($_GET[''sd''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0193"
    name: "PHP-STR-0193"
    description: "Malware detection signature PHP-STR-0193"
    severity: critical
    category: php_backdoor
    pattern: '$____=@gzinflate($____)){if(isset($_POS'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0194"
    name: "PHP-STR-0194"
    description: "Malware detection signature PHP-STR-0194"
    severity: critical
    category: php_backdoor
    pattern: 'passthru(getenv("HTTP_ACCEPT_LANGUAGE'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0195"
    name: "PHP-STR-0195"
    description: "Malware detection signature PHP-STR-0195"
    severity: critical
    category: php_backdoor
    pattern: 'Asmodeus'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0196"
    name: "PHP-STR-0196"
    description: "Malware detection signature PHP-STR-0196"
    severity: critical
    category: php_backdoor
    pattern: 'for(;$paddr=accept(CLIENT, SERVER);close CLIENT) {'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0197"
    name: "PHP-STR-0197"
    description: "Malware detection signature PHP-STR-0197"
    severity: critical
    category: php_backdoor
    pattern: '$izinler2=substr(base_convert(@fileperms($fname),10,8),-4);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0198"
    name: "PHP-STR-0198"
    description: "Malware detection signature PHP-STR-0198"
    severity: critical
    category: php_backdoor
    pattern: '$backdoor->ccopy($cfichier,$cdestination);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0199"
    name: "PHP-STR-0199"
    description: "Malware detection signature PHP-STR-0199"
    severity: critical
    category: php_backdoor
    pattern: '{${passthru($cmd)}}<br>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0200"
    name: "PHP-STR-0200"
    description: "Malware detection signature PHP-STR-0200"
    severity: critical
    category: php_backdoor
    pattern: '$a[hits]''); \r\n#endquery\r\n'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0201"
    name: "PHP-STR-0201"
    description: "Malware detection signature PHP-STR-0201"
    severity: critical
    category: php_backdoor
    pattern: 'ncftpput -u $ftp_user_name'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0202"
    name: "PHP-STR-0202"
    description: "Malware detection signature PHP-STR-0202"
    severity: critical
    category: php_backdoor
    pattern: 'execl("/bin/sh","sh","-i",(char*)0);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0203"
    name: "PHP-STR-0203"
    description: "Malware detection signature PHP-STR-0203"
    severity: critical
    category: php_backdoor
    pattern: '<HTML><HEAD><TITLE>cgi-shell.py'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0204"
    name: "PHP-STR-0204"
    description: "Malware detection signature PHP-STR-0204"
    severity: critical
    category: php_backdoor
    pattern: 'system("unset HISTFILE; unset SAVEHIST'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0205"
    name: "PHP-STR-0205"
    description: "Malware detection signature PHP-STR-0205"
    severity: critical
    category: php_backdoor
    pattern: 'SHADOW Z118'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0206"
    name: "PHP-STR-0206"
    description: "Malware detection signature PHP-STR-0206"
    severity: critical
    category: php_backdoor
    pattern: '$login=@posix_getuid();'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0207"
    name: "PHP-STR-0207"
    description: "Malware detection signature PHP-STR-0207"
    severity: critical
    category: php_backdoor
    pattern: '(ereg(''^[[:blank:]]*cd[[:blank:]]*$'', $_REQUEST[''command'']))'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0208"
    name: "PHP-STR-0208"
    description: "Malware detection signature PHP-STR-0208"
    severity: critical
    category: php_backdoor
    pattern: '!$_REQUEST["c99sh_surl"])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0210"
    name: "PHP-STR-0210"
    description: "Malware detection signature PHP-STR-0210"
    severity: critical
    category: php_backdoor
    pattern: 'shell_exec($_POST[''cmd''] . " 2>&1");'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0211"
    name: "PHP-STR-0211"
    description: "Malware detection signature PHP-STR-0211"
    severity: critical
    category: php_backdoor
    pattern: 'if(!$whoami)$whoami=exec("whoami");'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0212"
    name: "PHP-STR-0212"
    description: "Malware detection signature PHP-STR-0212"
    severity: critical
    category: php_backdoor
    pattern: 'PySystemState.initialize(System.getProperties(), null, argv);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0213"
    name: "PHP-STR-0213"
    description: "Malware detection signature PHP-STR-0213"
    severity: critical
    category: php_backdoor
    pattern: '<%=env.queryHashtable("user.name")%>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0214"
    name: "PHP-STR-0214"
    description: "Malware detection signature PHP-STR-0214"
    severity: critical
    category: php_backdoor
    pattern: 'if (empty($_POST[''wser''])) {$wser = "whois.ripe.net";} else $wser = $_POST[''wser''];'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0215"
    name: "PHP-STR-0215"
    description: "Malware detection signature PHP-STR-0215"
    severity: critical
    category: php_backdoor
    pattern: 'if (move_uploaded_file($_FILES[''fila''][''tmp_name''], $curdir."/".$_FILES[''fila''][''name''])) {'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0216"
    name: "PHP-STR-0216"
    description: "Malware detection signature PHP-STR-0216"
    severity: critical
    category: php_backdoor
    pattern: 'shell_exec(''uname -a'');'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0217"
    name: "PHP-STR-0217"
    description: "Malware detection signature PHP-STR-0217"
    severity: critical
    category: php_backdoor
    pattern: 'if (!defined$param{cmd}){$param{cmd}="ls -la"};'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0218"
    name: "PHP-STR-0218"
    description: "Malware detection signature PHP-STR-0218"
    severity: critical
    category: php_backdoor
    pattern: 'if(get_magic_quotes_gpc())$shellOut=stripslashes($shellOut);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0219"
    name: "PHP-STR-0219"
    description: "Malware detection signature PHP-STR-0219"
    severity: critical
    category: php_backdoor
    pattern: '<a href=''$PHP_SELF?action=viewSchema&dbname=$dbname&tablename=$tablename''>Schema</a>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0220"
    name: "PHP-STR-0220"
    description: "Malware detection signature PHP-STR-0220"
    severity: critical
    category: php_backdoor
    pattern: 'passthru( $bindir."mysqldump --user=$USERNAME --password=$PASSWORD'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0221"
    name: "PHP-STR-0221"
    description: "Malware detection signature PHP-STR-0221"
    severity: critical
    category: php_backdoor
    pattern: 'mysql_query("CREATE TABLE `xploit` (`xploit` LONGBLOB NOT NULL)");'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0222"
    name: "PHP-STR-0222"
    description: "Malware detection signature PHP-STR-0222"
    severity: critical
    category: php_backdoor
    pattern: '$ra44  = rand(1,99999);$sj98 = "sh-$ra44";$ml = "$sd98";$a5 = $_SERVER[''HTTP_REFERER''];'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0223"
    name: "PHP-STR-0223"
    description: "Malware detection signature PHP-STR-0223"
    severity: critical
    category: php_backdoor
    pattern: '$_FILES[''probe''][''size''], $_FILES[''probe''][''type'']);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0224"
    name: "PHP-STR-0224"
    description: "Malware detection signature PHP-STR-0224"
    severity: critical
    category: php_backdoor
    pattern: 'system("$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp");'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0225"
    name: "PHP-STR-0225"
    description: "Malware detection signature PHP-STR-0225"
    severity: critical
    category: php_backdoor
    pattern: '} elsif ($servarg =~ /^\:(.+?)\!(.+?)\@(.+?) PRIVMSG (.+?) \:(.+)/) {'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0226"
    name: "PHP-STR-0226"
    description: "Malware detection signature PHP-STR-0226"
    severity: critical
    category: php_backdoor
    pattern: 'send(SOCK5, $msg, 0, sockaddr_in($porta, $iaddr)) and $pacotes{o}++;;'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0227"
    name: "PHP-STR-0227"
    description: "Malware detection signature PHP-STR-0227"
    severity: critical
    category: php_backdoor
    pattern: '$fe("$cmd  2>&1");'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0228"
    name: "PHP-STR-0228"
    description: "Malware detection signature PHP-STR-0228"
    severity: critical
    category: php_backdoor
    pattern: 'while ($row = mysql_fetch_array($result,MYSQL_ASSOC)) print_r($row);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0229"
    name: "PHP-STR-0229"
    description: "Malware detection signature PHP-STR-0229"
    severity: critical
    category: php_backdoor
    pattern: 'elseif(@is_writable($FN) && @is_file($FN)) $tmpOutMF'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0230"
    name: "PHP-STR-0230"
    description: "Malware detection signature PHP-STR-0230"
    severity: critical
    category: php_backdoor
    pattern: 'connect(SOCKET, sockaddr_in($ARGV[1], inet_aton($ARGV[0]))) or die print'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0231"
    name: "PHP-STR-0231"
    description: "Malware detection signature PHP-STR-0231"
    severity: critical
    category: php_backdoor
    pattern: 'if(move_uploaded_file($_FILES["fic"]["tmp_name"],good_link("./".$_FILES["fic"]["name"])))'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0232"
    name: "PHP-STR-0232"
    description: "Malware detection signature PHP-STR-0232"
    severity: critical
    category: php_backdoor
    pattern: 'UNION SELECT ''0'' , ''<? system(\$_GET[cpc]);exit; ?>'' ,0 ,0 ,0 ,0 INTO OUTFILE ''$outfile'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0233"
    name: "PHP-STR-0233"
    description: "Malware detection signature PHP-STR-0233"
    severity: critical
    category: php_backdoor
    pattern: 'if (!@is_link($file) && ($r = realpath($file)) != FALSE) $file = $r;'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0234"
    name: "PHP-STR-0234"
    description: "Malware detection signature PHP-STR-0234"
    severity: critical
    category: php_backdoor
    pattern: 'echo "FILE UPLOADED TO $dez";'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0235"
    name: "PHP-STR-0235"
    description: "Malware detection signature PHP-STR-0235"
    severity: critical
    category: php_backdoor
    pattern: '$function($_POST[''cmd''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0236"
    name: "PHP-STR-0236"
    description: "Malware detection signature PHP-STR-0236"
    severity: critical
    category: php_backdoor
    pattern: '$filename = $backupstring."$filename";'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0237"
    name: "PHP-STR-0237"
    description: "Malware detection signature PHP-STR-0237"
    severity: critical
    category: php_backdoor
    pattern: 'if(''''==($df=@ini_get(''disable_functions''))){echo'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0238"
    name: "PHP-STR-0238"
    description: "Malware detection signature PHP-STR-0238"
    severity: critical
    category: php_backdoor
    pattern: '<% For Each Vars In Request.ServerVariables %>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0239"
    name: "PHP-STR-0239"
    description: "Malware detection signature PHP-STR-0239"
    severity: critical
    category: php_backdoor
    pattern: 'if ($funcarg =~ /^portscan (.*)/)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0240"
    name: "PHP-STR-0240"
    description: "Malware detection signature PHP-STR-0240"
    severity: critical
    category: php_backdoor
    pattern: '$uploadfile = $rpath."/" . $_FILES[''userfile''][''name''];'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0241"
    name: "PHP-STR-0241"
    description: "Malware detection signature PHP-STR-0241"
    severity: critical
    category: php_backdoor
    pattern: '$cmd = ($_REQUEST[''cmd'']);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0242"
    name: "PHP-STR-0242"
    description: "Malware detection signature PHP-STR-0242"
    severity: critical
    category: php_backdoor
    pattern: 'if($cmd != "") print Shell_Exec($cmd);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0243"
    name: "PHP-STR-0243"
    description: "Malware detection signature PHP-STR-0243"
    severity: critical
    category: php_backdoor
    pattern: 'if (is_file("/tmp/$ekinci")){'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0244"
    name: "PHP-STR-0244"
    description: "Malware detection signature PHP-STR-0244"
    severity: critical
    category: php_backdoor
    pattern: '__all__ = ["SMTPServer","DebuggingServer","PureProxy","MailmanProxy"]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0245"
    name: "PHP-STR-0245"
    description: "Malware detection signature PHP-STR-0245"
    severity: critical
    category: php_backdoor
    pattern: 'global $mysqlHandle, $dbname, $tablename, $old_name, $name,'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0246"
    name: "PHP-STR-0246"
    description: "Malware detection signature PHP-STR-0246"
    severity: critical
    category: php_backdoor
    pattern: '2>&1 1>&2" : " 1>&1 2>&1");'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0247"
    name: "PHP-STR-0247"
    description: "Malware detection signature PHP-STR-0247"
    severity: critical
    category: php_backdoor
    pattern: 'map { read_shell($_) } ($sel_shell->can_read(0.01));'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0248"
    name: "PHP-STR-0248"
    description: "Malware detection signature PHP-STR-0248"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite ($fp, "$yazi");'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0249"
    name: "PHP-STR-0249"
    description: "Malware detection signature PHP-STR-0249"
    severity: critical
    category: php_backdoor
    pattern: 'Send this file: <INPUT NAME="userfile" TYPE="file">'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0250"
    name: "PHP-STR-0250"
    description: "Malware detection signature PHP-STR-0250"
    severity: critical
    category: php_backdoor
    pattern: '$db_d = @mysql_select_db($database,$con1);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0251"
    name: "PHP-STR-0251"
    description: "Malware detection signature PHP-STR-0251"
    severity: critical
    category: php_backdoor
    pattern: 'for ($value) { s/&/&amp;/g; s/</&lt;/g; s/>/&gt;/g; s/"/&quot;/g; }'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0252"
    name: "PHP-STR-0252"
    description: "Malware detection signature PHP-STR-0252"
    severity: critical
    category: php_backdoor
    pattern: 'copy($_FILES[''upkk''][''tmp_name''],"kk/".basename($_FILES[''upkk''][''name'']));'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0253"
    name: "PHP-STR-0253"
    description: "Malware detection signature PHP-STR-0253"
    severity: critical
    category: php_backdoor
    pattern: 'function google_bot() {$sUserAgent = strtolower($_SERVER[''HTTP_USER_AGENT'']);if(!(strp'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0254"
    name: "PHP-STR-0254"
    description: "Malware detection signature PHP-STR-0254"
    severity: critical
    category: php_backdoor
    pattern: 'create_function("&$"."function","$"."function = chr(ord($"."function)-3);")'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0255"
    name: "PHP-STR-0255"
    description: "Malware detection signature PHP-STR-0255"
    severity: critical
    category: php_backdoor
    pattern: 'long int:t(0,3)=r(0,3);-2147483648;2147483647;'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0256"
    name: "PHP-STR-0256"
    description: "Malware detection signature PHP-STR-0256"
    severity: critical
    category: php_backdoor
    pattern: '?url=''.$_SERVER[''HTTP_HOST'']).unlink(ROOT_DIR.'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0257"
    name: "PHP-STR-0257"
    description: "Malware detection signature PHP-STR-0257"
    severity: critical
    category: php_backdoor
    pattern: 'cat ${blklog[2]} | grep "root:x:0:0"'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0258"
    name: "PHP-STR-0258"
    description: "Malware detection signature PHP-STR-0258"
    severity: critical
    category: php_backdoor
    pattern: '@path1=(''admin/'',''administrator/'',''moderator/'',''webadmin/'',''adminarea/'',''bb-admin/'',''adminLogin/'''
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0259"
    name: "PHP-STR-0259"
    description: "Malware detection signature PHP-STR-0259"
    severity: critical
    category: php_backdoor
    pattern: '"admin1.php", "admin1.html", "admin2.php", "admin2.html", "yonetim.php", "yonetim.html"'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0260"
    name: "PHP-STR-0260"
    description: "Malware detection signature PHP-STR-0260"
    severity: critical
    category: php_backdoor
    pattern: 'POST {$path}{$connector}?Command=FileUpload&Type=File&CurrentFolder='
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0261"
    name: "PHP-STR-0261"
    description: "Malware detection signature PHP-STR-0261"
    severity: critical
    category: php_backdoor
    pattern: '@assert($_REQUEST[''PHPSESSID'']'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0262"
    name: "PHP-STR-0262"
    description: "Malware detection signature PHP-STR-0262"
    severity: critical
    category: php_backdoor
    pattern: '$prod="sy"."s"."tem";$id=$prod($_REQUEST[''product'']);${''id''};'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0263"
    name: "PHP-STR-0263"
    description: "Malware detection signature PHP-STR-0263"
    severity: critical
    category: php_backdoor
    pattern: 'php ".$wso_path'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0264"
    name: "PHP-STR-0264"
    description: "Malware detection signature PHP-STR-0264"
    severity: critical
    category: php_backdoor
    pattern: '$Fchmod,$Fdata,$Options,$Action,$hddall,$hddfree,$hddproc,$uname,$idd):shared'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0265"
    name: "PHP-STR-0265"
    description: "Malware detection signature PHP-STR-0265"
    severity: critical
    category: php_backdoor
    pattern: 'server.</p>\r\n</body></html>";exit;}if(preg_match('
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0266"
    name: "PHP-STR-0266"
    description: "Malware detection signature PHP-STR-0266"
    severity: critical
    category: php_backdoor
    pattern: '$file = $_FILES["filename"]["name"]; echo "<a href=\"$file\">$file</a>";} else {echo("empty");}'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0267"
    name: "PHP-STR-0267"
    description: "Malware detection signature PHP-STR-0267"
    severity: critical
    category: php_backdoor
    pattern: 'FS_chk_func_libc=( $(readelf -s $FS_libc | grep _chk@@ | awk'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0268"
    name: "PHP-STR-0268"
    description: "Malware detection signature PHP-STR-0268"
    severity: critical
    category: php_backdoor
    pattern: 'find / -name .ssh > $dir/sshkeys/sshkeys'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0269"
    name: "PHP-STR-0269"
    description: "Malware detection signature PHP-STR-0269"
    severity: critical
    category: php_backdoor
    pattern: 're.findall(dirt+''(.*)'',prognm)[0]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0270"
    name: "PHP-STR-0270"
    description: "Malware detection signature PHP-STR-0270"
    severity: critical
    category: php_backdoor
    pattern: 'outstr += string.Format("<a href=''?fdir={0}''>{1}/</a>&nbsp;"'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0271"
    name: "PHP-STR-0271"
    description: "Malware detection signature PHP-STR-0271"
    severity: critical
    category: php_backdoor
    pattern: '<%=Request.Servervariables("SCRIPT_NAME")%>?txtpath=<%=Request.QueryString("txtpath'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0272"
    name: "PHP-STR-0272"
    description: "Malware detection signature PHP-STR-0272"
    severity: critical
    category: php_backdoor
    pattern: 'Response.Write(Server.HtmlEncode(this.ExecuteCommand(txtCommand.Text)))'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0273"
    name: "PHP-STR-0273"
    description: "Malware detection signature PHP-STR-0273"
    severity: critical
    category: php_backdoor
    pattern: 'new FileStream(Path.Combine(fileInfo.DirectoryName, Path.GetFileName(httpPostedFile.FileName)), FileMode.Create'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0274"
    name: "PHP-STR-0274"
    description: "Malware detection signature PHP-STR-0274"
    severity: critical
    category: php_backdoor
    pattern: 'Response.Write("<br>( ) <a href=?type=1&file=" & server.URLencode(item.path) & "\>" & item'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0275"
    name: "PHP-STR-0275"
    description: "Malware detection signature PHP-STR-0275"
    severity: critical
    category: php_backdoor
    pattern: 'sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.Decimal).Value = decimal'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0276"
    name: "PHP-STR-0276"
    description: "Malware detection signature PHP-STR-0276"
    severity: critical
    category: php_backdoor
    pattern: '<%= "\" & oScriptNet.ComputerName & "\" & oScriptNet.UserName %>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0277"
    name: "PHP-STR-0277"
    description: "Malware detection signature PHP-STR-0277"
    severity: critical
    category: php_backdoor
    pattern: 'curl_setopt($ch, CURLOPT_URL, "http://$host:2082")'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0278"
    name: "PHP-STR-0278"
    description: "Malware detection signature PHP-STR-0278"
    severity: critical
    category: php_backdoor
    pattern: 'HJ3HjutckoRfpXf9A1zQO2AwDRrRey9uGvTeez79qAao1a0rgudkZkR8Ra'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0279"
    name: "PHP-STR-0279"
    description: "Malware detection signature PHP-STR-0279"
    severity: critical
    category: php_backdoor
    pattern: '$ini[''users''] = array(''root'' =>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0280"
    name: "PHP-STR-0280"
    description: "Malware detection signature PHP-STR-0280"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite($fp,"\xEF\xBB\xBF".$body'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0281"
    name: "PHP-STR-0281"
    description: "Malware detection signature PHP-STR-0281"
    severity: critical
    category: php_backdoor
    pattern: 'proc_open(''IHSteam'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0282"
    name: "PHP-STR-0282"
    description: "Malware detection signature PHP-STR-0282"
    severity: critical
    category: php_backdoor
    pattern: '$baslik=$_POST[''baslik'']'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0283"
    name: "PHP-STR-0283"
    description: "Malware detection signature PHP-STR-0283"
    severity: critical
    category: php_backdoor
    pattern: 'fread($fp, filesize($fichero))'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0284"
    name: "PHP-STR-0284"
    description: "Malware detection signature PHP-STR-0284"
    severity: critical
    category: php_backdoor
    pattern: 'I/gcZ/vX0A10DDRDg7Ezk/d+3+8qvqqS1K0+AXY'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0285"
    name: "PHP-STR-0285"
    description: "Malware detection signature PHP-STR-0285"
    severity: critical
    category: php_backdoor
    pattern: '{$_POST[''root'']}'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0286"
    name: "PHP-STR-0286"
    description: "Malware detection signature PHP-STR-0286"
    severity: critical
    category: php_backdoor
    pattern: '}elseif($_GET[''page'']==''ddos'''
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0287"
    name: "PHP-STR-0287"
    description: "Malware detection signature PHP-STR-0287"
    severity: critical
    category: php_backdoor
    pattern: 'The Dark Raver'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0288"
    name: "PHP-STR-0288"
    description: "Malware detection signature PHP-STR-0288"
    severity: critical
    category: php_backdoor
    pattern: '$value =~ s/%(..)/pack(''c'',hex($1))/eg;'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0289"
    name: "PHP-STR-0289"
    description: "Malware detection signature PHP-STR-0289"
    severity: critical
    category: php_backdoor
    pattern: 'www.t0s.org'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0290"
    name: "PHP-STR-0290"
    description: "Malware detection signature PHP-STR-0290"
    severity: critical
    category: php_backdoor
    pattern: 'unless(open(PFD,$g_upload_db))'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0291"
    name: "PHP-STR-0291"
    description: "Malware detection signature PHP-STR-0291"
    severity: critical
    category: php_backdoor
    pattern: 'az88pix00q98'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0292"
    name: "PHP-STR-0292"
    description: "Malware detection signature PHP-STR-0292"
    severity: critical
    category: php_backdoor
    pattern: 'sh go $1.$x'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0293"
    name: "PHP-STR-0293"
    description: "Malware detection signature PHP-STR-0293"
    severity: critical
    category: php_backdoor
    pattern: 'system("php -f xpl $host")'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0294"
    name: "PHP-STR-0294"
    description: "Malware detection signature PHP-STR-0294"
    severity: critical
    category: php_backdoor
    pattern: 'exploitcookie'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0295"
    name: "PHP-STR-0295"
    description: "Malware detection signature PHP-STR-0295"
    severity: critical
    category: php_backdoor
    pattern: '80 -b $1 -i eth0 -s 8'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0296"
    name: "PHP-STR-0296"
    description: "Malware detection signature PHP-STR-0296"
    severity: critical
    category: php_backdoor
    pattern: 'HTTP flood complete after'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0297"
    name: "PHP-STR-0297"
    description: "Malware detection signature PHP-STR-0297"
    severity: critical
    category: php_backdoor
    pattern: 'NIGGERS.NIGGERS'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0298"
    name: "PHP-STR-0298"
    description: "Malware detection signature PHP-STR-0298"
    severity: critical
    category: php_backdoor
    pattern: 'if(isset($_GET[''host''])&&isset($_GET[''time''])){'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0299"
    name: "PHP-STR-0299"
    description: "Malware detection signature PHP-STR-0299"
    severity: critical
    category: php_backdoor
    pattern: 'subprocess.Popen(cmd, shell = True, stdout=subprocess.PIPE, stderr=subprocess.STDOU'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0300"
    name: "PHP-STR-0300"
    description: "Malware detection signature PHP-STR-0300"
    severity: critical
    category: php_backdoor
    pattern: 'def daemon(stdin=''/dev/null'', stdout=''/dev/null'', stderr=''/dev/null'')'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0301"
    name: "PHP-STR-0301"
    description: "Malware detection signature PHP-STR-0301"
    severity: critical
    category: php_backdoor
    pattern: 'print("[!] Host: " + hostname + " might be down!\n[!] Response Code'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0302"
    name: "PHP-STR-0302"
    description: "Malware detection signature PHP-STR-0302"
    severity: critical
    category: php_backdoor
    pattern: 'connection.send("shell "+str(os.getcwd())+'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0303"
    name: "PHP-STR-0303"
    description: "Malware detection signature PHP-STR-0303"
    severity: critical
    category: php_backdoor
    pattern: 'os.system(''echo alias ls=".ls.bash" >> ~/.bashrc'')'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0304"
    name: "PHP-STR-0304"
    description: "Malware detection signature PHP-STR-0304"
    severity: critical
    category: php_backdoor
    pattern: 'rule_req = raw_input("SourceFire'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0305"
    name: "PHP-STR-0305"
    description: "Malware detection signature PHP-STR-0305"
    severity: critical
    category: php_backdoor
    pattern: 'argparse.ArgumentParser(description=help, prog="sctunnel"'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0306"
    name: "PHP-STR-0306"
    description: "Malware detection signature PHP-STR-0306"
    severity: critical
    category: php_backdoor
    pattern: 'subprocess.Popen(''%sgdb -p %d -batch %s'' % (gdb_prefix, p'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0307"
    name: "PHP-STR-0307"
    description: "Malware detection signature PHP-STR-0307"
    severity: critical
    category: php_backdoor
    pattern: '$framework.plugins.load("#{rpctype.downcase}rpc", opts).run'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0308"
    name: "PHP-STR-0308"
    description: "Malware detection signature PHP-STR-0308"
    severity: critical
    category: php_backdoor
    pattern: 'if self.hash_type == ''pwdump'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0309"
    name: "PHP-STR-0309"
    description: "Malware detection signature PHP-STR-0309"
    severity: critical
    category: php_backdoor
    pattern: 'itsoknoproblembro'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0310"
    name: "PHP-STR-0310"
    description: "Malware detection signature PHP-STR-0310"
    severity: critical
    category: php_backdoor
    pattern: 'add_filter(''the_content'', ''_bloginfo'', 10001)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0311"
    name: "PHP-STR-0311"
    description: "Malware detection signature PHP-STR-0311"
    severity: critical
    category: php_backdoor
    pattern: '<stdlib.h'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0312"
    name: "PHP-STR-0312"
    description: "Malware detection signature PHP-STR-0312"
    severity: critical
    category: php_backdoor
    pattern: 'echo y ; sleep 1 ; } | { while read ; do echo z$REPLY; done'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0313"
    name: "PHP-STR-0313"
    description: "Malware detection signature PHP-STR-0313"
    severity: critical
    category: php_backdoor
    pattern: 'VOBRA GANGO'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0314"
    name: "PHP-STR-0314"
    description: "Malware detection signature PHP-STR-0314"
    severity: critical
    category: php_backdoor
    pattern: 'int32((($z >> 5 & 0x07ffffff) ^ $y << 2) + (($y >> 3 & 0x1fffffff) ^ $z << 4'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0315"
    name: "PHP-STR-0315"
    description: "Malware detection signature PHP-STR-0315"
    severity: critical
    category: php_backdoor
    pattern: '@copy($_FILES[fileMass][tmp_name],$_POST[path].$_FILES[fileMass][name'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0316"
    name: "PHP-STR-0316"
    description: "Malware detection signature PHP-STR-0316"
    severity: critical
    category: php_backdoor
    pattern: 'find_dirs($grandparent_dir, $level, 1, $dirs);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0317"
    name: "PHP-STR-0317"
    description: "Malware detection signature PHP-STR-0317"
    severity: critical
    category: php_backdoor
    pattern: '@setcookie("hit", 1, time()+'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0318"
    name: "PHP-STR-0318"
    description: "Malware detection signature PHP-STR-0318"
    severity: critical
    category: php_backdoor
    pattern: 'e/*./'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0319"
    name: "PHP-STR-0319"
    description: "Malware detection signature PHP-STR-0319"
    severity: critical
    category: php_backdoor
    pattern: 'JHZpc2l0Y291bnQgPSAkSFRUUF9DT09LSUVfV'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0320"
    name: "PHP-STR-0320"
    description: "Malware detection signature PHP-STR-0320"
    severity: critical
    category: php_backdoor
    pattern: '0d0a0d0a676c6f62616c20246d795f736d7'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0321"
    name: "PHP-STR-0321"
    description: "Malware detection signature PHP-STR-0321"
    severity: critical
    category: php_backdoor
    pattern: 'fopen(''/etc/passwd'''
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0322"
    name: "PHP-STR-0322"
    description: "Malware detection signature PHP-STR-0322"
    severity: critical
    category: php_backdoor
    pattern: '$tsu2[rand(0,count($tsu2) - 1)].$tsu1[rand(0,count($tsu1) - 1)].$tsu2[rand(0'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0323"
    name: "PHP-STR-0323"
    description: "Malware detection signature PHP-STR-0323"
    severity: critical
    category: php_backdoor
    pattern: '/usr/local/apache/bin/httpd -DSSL'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0324"
    name: "PHP-STR-0324"
    description: "Malware detection signature PHP-STR-0324"
    severity: critical
    category: php_backdoor
    pattern: 'set protect-telnet 0'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0325"
    name: "PHP-STR-0325"
    description: "Malware detection signature PHP-STR-0325"
    severity: critical
    category: php_backdoor
    pattern: 'ayu pr1 pr2 pr3 pr4 pr5 pr6'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0326"
    name: "PHP-STR-0326"
    description: "Malware detection signature PHP-STR-0326"
    severity: critical
    category: php_backdoor
    pattern: 'bind filt - "\001ACTION *\001"'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0327"
    name: "PHP-STR-0327"
    description: "Malware detection signature PHP-STR-0327"
    severity: critical
    category: php_backdoor
    pattern: 'regsub -all -- , [string tolower $owner] "" owners'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0328"
    name: "PHP-STR-0328"
    description: "Malware detection signature PHP-STR-0328"
    severity: critical
    category: php_backdoor
    pattern: 'kill -CHLD \$botpid >/dev/null 2>&1'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0329"
    name: "PHP-STR-0329"
    description: "Malware detection signature PHP-STR-0329"
    severity: critical
    category: php_backdoor
    pattern: 'bind dcc -'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0330"
    name: "PHP-STR-0330"
    description: "Malware detection signature PHP-STR-0330"
    severity: critical
    category: php_backdoor
    pattern: 'r4aTc.dPntE/fztSF1bH3RH0'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0331"
    name: "PHP-STR-0331"
    description: "Malware detection signature PHP-STR-0331"
    severity: critical
    category: php_backdoor
    pattern: 'privmsg $chan'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0332"
    name: "PHP-STR-0332"
    description: "Malware detection signature PHP-STR-0332"
    severity: critical
    category: php_backdoor
    pattern: 'bind join - * gop_join'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0333"
    name: "PHP-STR-0333"
    description: "Malware detection signature PHP-STR-0333"
    severity: critical
    category: php_backdoor
    pattern: 'set google(data) [http::data $google(page)]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0334"
    name: "PHP-STR-0334"
    description: "Malware detection signature PHP-STR-0334"
    severity: critical
    category: php_backdoor
    pattern: 'proc http::Connect {token}'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0335"
    name: "PHP-STR-0335"
    description: "Malware detection signature PHP-STR-0335"
    severity: critical
    category: php_backdoor
    pattern: 'privmsg $nick'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0336"
    name: "PHP-STR-0336"
    description: "Malware detection signature PHP-STR-0336"
    severity: critical
    category: php_backdoor
    pattern: 'putbot $bot'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0337"
    name: "PHP-STR-0337"
    description: "Malware detection signature PHP-STR-0337"
    severity: critical
    category: php_backdoor
    pattern: 'unbind RAW -'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0338"
    name: "PHP-STR-0338"
    description: "Malware detection signature PHP-STR-0338"
    severity: critical
    category: php_backdoor
    pattern: '--DCCDIR [lindex $User($i) 2]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0339"
    name: "PHP-STR-0339"
    description: "Malware detection signature PHP-STR-0339"
    severity: critical
    category: php_backdoor
    pattern: 'Cybester90'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0340"
    name: "PHP-STR-0340"
    description: "Malware detection signature PHP-STR-0340"
    severity: critical
    category: php_backdoor
    pattern: 'file_get_contents(trim($f[$_GET[''id'']]));'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0341"
    name: "PHP-STR-0341"
    description: "Malware detection signature PHP-STR-0341"
    severity: critical
    category: php_backdoor
    pattern: 'unlink($writable_dirs'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0342"
    name: "PHP-STR-0342"
    description: "Malware detection signature PHP-STR-0342"
    severity: critical
    category: php_backdoor
    pattern: 'base64_decode($code_script)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0343"
    name: "PHP-STR-0343"
    description: "Malware detection signature PHP-STR-0343"
    severity: critical
    category: php_backdoor
    pattern: 'luciffer@luciffer.org'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0344"
    name: "PHP-STR-0344"
    description: "Malware detection signature PHP-STR-0344"
    severity: critical
    category: php_backdoor
    pattern: '$this->F->GetController($_SERVER[''REQUEST_URI''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0345"
    name: "PHP-STR-0345"
    description: "Malware detection signature PHP-STR-0345"
    severity: critical
    category: php_backdoor
    pattern: '$time_started.$secure_session_user.session_id()'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0346"
    name: "PHP-STR-0346"
    description: "Malware detection signature PHP-STR-0346"
    severity: critical
    category: php_backdoor
    pattern: '$param x $n.substr ($param, length($param) - length($code)%length($param))'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0347"
    name: "PHP-STR-0347"
    description: "Malware detection signature PHP-STR-0347"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite($f,get_download($_GET[''url''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0348"
    name: "PHP-STR-0348"
    description: "Malware detection signature PHP-STR-0348"
    severity: critical
    category: php_backdoor
    pattern: 'http://''.$_SERVER[''HTTP_HOST''].urldecode($_SERVER[''REQUEST_URI''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0349"
    name: "PHP-STR-0349"
    description: "Malware detection signature PHP-STR-0349"
    severity: critical
    category: php_backdoor
    pattern: 'wp_posts WHERE post_type = ''post'' AND post_status = ''publish'' ORDER BY `ID` DESC'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0350"
    name: "PHP-STR-0350"
    description: "Malware detection signature PHP-STR-0350"
    severity: critical
    category: php_backdoor
    pattern: '$url = $urls[rand(0, count($urls)-1)]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0351"
    name: "PHP-STR-0351"
    description: "Malware detection signature PHP-STR-0351"
    severity: critical
    category: php_backdoor
    pattern: 'preg_match(''/(?<=RewriteRule).*(?=\[L\,R\=302\]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0352"
    name: "PHP-STR-0352"
    description: "Malware detection signature PHP-STR-0352"
    severity: critical
    category: php_backdoor
    pattern: 'preg_match(''!MIDP|WAP|Windows.CE|PPC|Series60'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0353"
    name: "PHP-STR-0353"
    description: "Malware detection signature PHP-STR-0353"
    severity: critical
    category: php_backdoor
    pattern: 'R0lGODlhEwAQALMAAAAAAP///5ycAM7OY///nP//zv/OnPf39////wAAAAAA'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0354"
    name: "PHP-STR-0354"
    description: "Malware detection signature PHP-STR-0354"
    severity: critical
    category: php_backdoor
    pattern: 'str_rot13($basea[($dimension*$dimension-1) - ($i*$dimension+$j)])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0355"
    name: "PHP-STR-0355"
    description: "Malware detection signature PHP-STR-0355"
    severity: critical
    category: php_backdoor
    pattern: 'if(empty($_GET[''zip'']) and empty($_GET[''download'']) & empty($_GET[''img''])){'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0356"
    name: "PHP-STR-0356"
    description: "Malware detection signature PHP-STR-0356"
    severity: critical
    category: php_backdoor
    pattern: 'Made by Delorean'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0357"
    name: "PHP-STR-0357"
    description: "Malware detection signature PHP-STR-0357"
    severity: critical
    category: php_backdoor
    pattern: 'overflow-y:scroll;\">".$links.$html_mf[''body'']'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0358"
    name: "PHP-STR-0358"
    description: "Malware detection signature PHP-STR-0358"
    severity: critical
    category: php_backdoor
    pattern: 'function urlGetContents($url, $timeout = 5)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0359"
    name: "PHP-STR-0359"
    description: "Malware detection signature PHP-STR-0359"
    severity: critical
    category: php_backdoor
    pattern: 'd3lete'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0360"
    name: "PHP-STR-0360"
    description: "Malware detection signature PHP-STR-0360"
    severity: critical
    category: php_backdoor
    pattern: 'letaksekarang()'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0361"
    name: "PHP-STR-0361"
    description: "Malware detection signature PHP-STR-0361"
    severity: critical
    category: php_backdoor
    pattern: 'YENI3ERI'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0362"
    name: "PHP-STR-0362"
    description: "Malware detection signature PHP-STR-0362"
    severity: critical
    category: php_backdoor
    pattern: '$OOO000000=urldecode('
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0363"
    name: "PHP-STR-0363"
    description: "Malware detection signature PHP-STR-0363"
    severity: critical
    category: php_backdoor
    pattern: '-I/usr/local/bandmin'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0364"
    name: "PHP-STR-0364"
    description: "Malware detection signature PHP-STR-0364"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite($fpsetv, getenv("HTTP_COOKIE")'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0365"
    name: "PHP-STR-0365"
    description: "Malware detection signature PHP-STR-0365"
    severity: critical
    category: php_backdoor
    pattern: 'isset($_POST[''execgate''])'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0366"
    name: "PHP-STR-0366"
    description: "Malware detection signature PHP-STR-0366"
    severity: critical
    category: php_backdoor
    pattern: 'Webcommander at'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0367"
    name: "PHP-STR-0367"
    description: "Malware detection signature PHP-STR-0367"
    severity: critical
    category: php_backdoor
    pattern: '== "bindshell"'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0368"
    name: "PHP-STR-0368"
    description: "Malware detection signature PHP-STR-0368"
    severity: critical
    category: php_backdoor
    pattern: 'Pashkela'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0369"
    name: "PHP-STR-0369"
    description: "Malware detection signature PHP-STR-0369"
    severity: critical
    category: php_backdoor
    pattern: 'createFilesForInputOutput'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0370"
    name: "PHP-STR-0370"
    description: "Malware detection signature PHP-STR-0370"
    severity: critical
    category: php_backdoor
    pattern: 'M4ll3r'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0371"
    name: "PHP-STR-0371"
    description: "Malware detection signature PHP-STR-0371"
    severity: critical
    category: php_backdoor
    pattern: '__VIEWSTATEENCRYPTED'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0372"
    name: "PHP-STR-0372"
    description: "Malware detection signature PHP-STR-0372"
    severity: critical
    category: php_backdoor
    pattern: 'OoN_Boy'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0373"
    name: "PHP-STR-0373"
    description: "Malware detection signature PHP-STR-0373"
    severity: critical
    category: php_backdoor
    pattern: 'ReaL_PuNiShEr'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0374"
    name: "PHP-STR-0374"
    description: "Malware detection signature PHP-STR-0374"
    severity: critical
    category: php_backdoor
    pattern: 'darkminz'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0375"
    name: "PHP-STR-0375"
    description: "Malware detection signature PHP-STR-0375"
    severity: critical
    category: php_backdoor
    pattern: 'Zed0x'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0376"
    name: "PHP-STR-0376"
    description: "Malware detection signature PHP-STR-0376"
    severity: critical
    category: php_backdoor
    pattern: 'abacho|abizdirectory|about|acoon|alexana'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0377"
    name: "PHP-STR-0377"
    description: "Malware detection signature PHP-STR-0377"
    severity: critical
    category: php_backdoor
    pattern: 'ppc|midp|windows ce|mtk|j2me|symbian'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0378"
    name: "PHP-STR-0378"
    description: "Malware detection signature PHP-STR-0378"
    severity: critical
    category: php_backdoor
    pattern: '@chr(($h[$e[$o]]<<4)+($h[$e[++$o]]));}}eval($d)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0379"
    name: "PHP-STR-0379"
    description: "Malware detection signature PHP-STR-0379"
    severity: critical
    category: php_backdoor
    pattern: '$sh3llColor'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0380"
    name: "PHP-STR-0380"
    description: "Malware detection signature PHP-STR-0380"
    severity: critical
    category: php_backdoor
    pattern: 'Punker2Bot'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0381"
    name: "PHP-STR-0381"
    description: "Malware detection signature PHP-STR-0381"
    severity: critical
    category: php_backdoor
    pattern: '<?php echo "#!!#";'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0382"
    name: "PHP-STR-0382"
    description: "Malware detection signature PHP-STR-0382"
    severity: critical
    category: php_backdoor
    pattern: '$im=substr($im,0,$i).substr($im,$i2+1,$i4-($i2+1)).substr($im,$i4+12,strlen'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0383"
    name: "PHP-STR-0383"
    description: "Malware detection signature PHP-STR-0383"
    severity: critical
    category: php_backdoor
    pattern: '($indata,$b64=1){if($b64==1){$cd=base64_decode($indata)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0384"
    name: "PHP-STR-0384"
    description: "Malware detection signature PHP-STR-0384"
    severity: critical
    category: php_backdoor
    pattern: '($_POST["dir"]));'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0385"
    name: "PHP-STR-0385"
    description: "Malware detection signature PHP-STR-0385"
    severity: critical
    category: php_backdoor
    pattern: 'Hacked By EnDLeSs'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0386"
    name: "PHP-STR-0386"
    description: "Malware detection signature PHP-STR-0386"
    severity: critical
    category: php_backdoor
    pattern: 'andex|oogl'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0387"
    name: "PHP-STR-0387"
    description: "Malware detection signature PHP-STR-0387"
    severity: critical
    category: php_backdoor
    pattern: 'ndroi|htc_'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0388"
    name: "PHP-STR-0388"
    description: "Malware detection signature PHP-STR-0388"
    severity: critical
    category: php_backdoor
    pattern: '<dot>IrIsT'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0389"
    name: "PHP-STR-0389"
    description: "Malware detection signature PHP-STR-0389"
    severity: critical
    category: php_backdoor
    pattern: '7P1td+NWliaI/hWkZ4VX9'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0390"
    name: "PHP-STR-0390"
    description: "Malware detection signature PHP-STR-0390"
    severity: critical
    category: php_backdoor
    pattern: 'NinjaVirus Here'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0391"
    name: "PHP-STR-0391"
    description: "Malware detection signature PHP-STR-0391"
    severity: critical
    category: php_backdoor
    pattern: '$im=substr($tx,$p+2,$p2-($p+2));'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0392"
    name: "PHP-STR-0392"
    description: "Malware detection signature PHP-STR-0392"
    severity: critical
    category: php_backdoor
    pattern: '3xp1r3'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0393"
    name: "PHP-STR-0393"
    description: "Malware detection signature PHP-STR-0393"
    severity: critical
    category: php_backdoor
    pattern: '$md5=md5("$random");'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0394"
    name: "PHP-STR-0394"
    description: "Malware detection signature PHP-STR-0394"
    severity: critical
    category: php_backdoor
    pattern: 'oTat8D3DsE8''&~hU06CCH5;$gYSq'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0395"
    name: "PHP-STR-0395"
    description: "Malware detection signature PHP-STR-0395"
    severity: critical
    category: php_backdoor
    pattern: 'GIF89A;<?php'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0396"
    name: "PHP-STR-0396"
    description: "Malware detection signature PHP-STR-0396"
    severity: critical
    category: php_backdoor
    pattern: 'Created By EMMA'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0397"
    name: "PHP-STR-0397"
    description: "Malware detection signature PHP-STR-0397"
    severity: critical
    category: php_backdoor
    pattern: 'Password:<s>".$_POST[<q>passwd<q>]'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0398"
    name: "PHP-STR-0398"
    description: "Malware detection signature PHP-STR-0398"
    severity: critical
    category: php_backdoor
    pattern: 'Net@ddress Mail'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0399"
    name: "PHP-STR-0399"
    description: "Malware detection signature PHP-STR-0399"
    severity: critical
    category: php_backdoor
    pattern: '$isevalfunctionavailable'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0400"
    name: "PHP-STR-0400"
    description: "Malware detection signature PHP-STR-0400"
    severity: critical
    category: php_backdoor
    pattern: 'Baby_Drakon'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0401"
    name: "PHP-STR-0401"
    description: "Malware detection signature PHP-STR-0401"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite(fopen(dirname(__FILE__)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0402"
    name: "PHP-STR-0402"
    description: "Malware detection signature PHP-STR-0402"
    severity: critical
    category: php_backdoor
    pattern: ']]));}}eval($'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0403"
    name: "PHP-STR-0403"
    description: "Malware detection signature PHP-STR-0403"
    severity: critical
    category: php_backdoor
    pattern: 'ereg_replace(<q>&email&<q>,'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0404"
    name: "PHP-STR-0404"
    description: "Malware detection signature PHP-STR-0404"
    severity: critical
    category: php_backdoor
    pattern: '); $i++)$ret.=chr($'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0405"
    name: "PHP-STR-0405"
    description: "Malware detection signature PHP-STR-0405"
    severity: critical
    category: php_backdoor
    pattern: '$param2mask.")\=[\<qq>\"](.*?)(?=[\<qq>\"] )[\<qq>\"]/sie'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0406"
    name: "PHP-STR-0406"
    description: "Malware detection signature PHP-STR-0406"
    severity: critical
    category: php_backdoor
    pattern: '//rasta//'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0407"
    name: "PHP-STR-0407"
    description: "Malware detection signature PHP-STR-0407"
    severity: critical
    category: php_backdoor
    pattern: '<!--COOKIE UPDATE-->'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0408"
    name: "PHP-STR-0408"
    description: "Malware detection signature PHP-STR-0408"
    severity: critical
    category: php_backdoor
    pattern: 'profexor.hell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0409"
    name: "PHP-STR-0409"
    description: "Malware detection signature PHP-STR-0409"
    severity: critical
    category: php_backdoor
    pattern: 'MagelangCyber'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0410"
    name: "PHP-STR-0410"
    description: "Malware detection signature PHP-STR-0410"
    severity: critical
    category: php_backdoor
    pattern: 'ZOBUGTEL'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0411"
    name: "PHP-STR-0411"
    description: "Malware detection signature PHP-STR-0411"
    severity: critical
    category: php_backdoor
    pattern: 'FakeSender by'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0412"
    name: "PHP-STR-0412"
    description: "Malware detection signature PHP-STR-0412"
    severity: critical
    category: php_backdoor
    pattern: 'data:text/html;base64'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0413"
    name: "PHP-STR-0413"
    description: "Malware detection signature PHP-STR-0413"
    severity: critical
    category: php_backdoor
    pattern: 'S_]@_^U^'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0414"
    name: "PHP-STR-0414"
    description: "Malware detection signature PHP-STR-0414"
    severity: critical
    category: php_backdoor
    pattern: '@$_POST[(chr('
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0415"
    name: "PHP-STR-0415"
    description: "Malware detection signature PHP-STR-0415"
    severity: critical
    category: php_backdoor
    pattern: 'ZeroDayExile'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0416"
    name: "PHP-STR-0416"
    description: "Malware detection signature PHP-STR-0416"
    severity: critical
    category: php_backdoor
    pattern: 'SultanHaikal'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0417"
    name: "PHP-STR-0417"
    description: "Malware detection signature PHP-STR-0417"
    severity: critical
    category: php_backdoor
    pattern: 'Coupdegrace'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0418"
    name: "PHP-STR-0418"
    description: "Malware detection signature PHP-STR-0418"
    severity: critical
    category: php_backdoor
    pattern: 'artickle@'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0419"
    name: "PHP-STR-0419"
    description: "Malware detection signature PHP-STR-0419"
    severity: critical
    category: php_backdoor
    pattern: 'gnitroper_rorre'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0420"
    name: "PHP-STR-0420"
    description: "Malware detection signature PHP-STR-0420"
    severity: critical
    category: php_backdoor
    pattern: 'cutter[at]real.xakep.ru'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0421"
    name: "PHP-STR-0421"
    description: "Malware detection signature PHP-STR-0421"
    severity: critical
    category: php_backdoor
    pattern: 'if($wp__wp=@gzinflate($wp__wp'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0422"
    name: "PHP-STR-0422"
    description: "Malware detection signature PHP-STR-0422"
    severity: critical
    category: php_backdoor
    pattern: 'r00nix'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0423"
    name: "PHP-STR-0423"
    description: "Malware detection signature PHP-STR-0423"
    severity: critical
    category: php_backdoor
    pattern: '$full_path_to_doorway'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0424"
    name: "PHP-STR-0424"
    description: "Malware detection signature PHP-STR-0424"
    severity: critical
    category: php_backdoor
    pattern: '<b>Done ==> $userfile_name</b>'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0425"
    name: "PHP-STR-0425"
    description: "Malware detection signature PHP-STR-0425"
    severity: critical
    category: php_backdoor
    pattern: '>Dark Shell<'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0426"
    name: "PHP-STR-0426"
    description: "Malware detection signature PHP-STR-0426"
    severity: critical
    category: php_backdoor
    pattern: '/../*/index.php'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0427"
    name: "PHP-STR-0427"
    description: "Malware detection signature PHP-STR-0427"
    severity: critical
    category: php_backdoor
    pattern: 'if(is_uploaded_file/*;*/($_FILES'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0428"
    name: "PHP-STR-0428"
    description: "Malware detection signature PHP-STR-0428"
    severity: critical
    category: php_backdoor
    pattern: 'exec($command, $output)'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0429"
    name: "PHP-STR-0429"
    description: "Malware detection signature PHP-STR-0429"
    severity: critical
    category: php_backdoor
    pattern: '@include_once(''/tmp/'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0430"
    name: "PHP-STR-0430"
    description: "Malware detection signature PHP-STR-0430"
    severity: critical
    category: php_backdoor
    pattern: 'trim(''http://''.$sc.<qq>?Command=GetFoldersAndFiles&Type=File&CurrentFolder=%2F%00'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0431"
    name: "PHP-STR-0431"
    description: "Malware detection signature PHP-STR-0431"
    severity: critical
    category: php_backdoor
    pattern: '$script_find = str_replace("loader", "find", $script_loader'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0432"
    name: "PHP-STR-0432"
    description: "Malware detection signature PHP-STR-0432"
    severity: critical
    category: php_backdoor
    pattern: '<title>./Hacked By'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0433"
    name: "PHP-STR-0433"
    description: "Malware detection signature PHP-STR-0433"
    severity: critical
    category: php_backdoor
    pattern: 'By Ta3es'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0434"
    name: "PHP-STR-0434"
    description: "Malware detection signature PHP-STR-0434"
    severity: critical
    category: php_backdoor
    pattern: '$new_moustache'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0435"
    name: "PHP-STR-0435"
    description: "Malware detection signature PHP-STR-0435"
    severity: critical
    category: php_backdoor
    pattern: '/WapClick.php'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0436"
    name: "PHP-STR-0436"
    description: "Malware detection signature PHP-STR-0436"
    severity: critical
    category: php_backdoor
    pattern: 'profexor.hell'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0437"
    name: "PHP-STR-0437"
    description: "Malware detection signature PHP-STR-0437"
    severity: critical
    category: php_backdoor
    pattern: 'eval($moon);'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0438"
    name: "PHP-STR-0438"
    description: "Malware detection signature PHP-STR-0438"
    severity: critical
    category: php_backdoor
    pattern: 'str_rot13(gzinflate(base64_decode($code'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0439"
    name: "PHP-STR-0439"
    description: "Malware detection signature PHP-STR-0439"
    severity: critical
    category: php_backdoor
    pattern: ';}}exit;'');${"\x'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0440"
    name: "PHP-STR-0440"
    description: "Malware detection signature PHP-STR-0440"
    severity: critical
    category: php_backdoor
    pattern: '\x2ephp";/*'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-STR-0441"
    name: "PHP-STR-0441"
    description: "Malware detection signature PHP-STR-0441"
    severity: critical
    category: php_backdoor
    pattern: 'config root man'
    is_regex: false
    extensions: [php, php3, php4, php5, php7, phtml, pht]
    level: 0
  - id: "PHP-REX-0002"
    name: "PHP-REX-0002"
    description: "Malware detection signature PHP-REX-0002"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(base64_decode\("ew0KaWYgKCFkZ.{100,1000}Qp9DQp9"\)\);\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0008"
    name: "PHP-REX-0008"
    description: "Malware detection signature PHP-REX-0008"
    severity: critical
    category: php_backdoor
    pattern: '<script\s+language=javascript>\s*eval\(\s*String\.fromCharCode\((\d+\s*,\s*){3}[^)]+\)\s*\)\s*;</script>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0009"
    name: "PHP-REX-0009"
    description: "Malware detection signature PHP-REX-0009"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*eval\(\s*String\.fromCharCode\((\d+\s*,\s*){3}[^)]+\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0013"
    name: "PHP-REX-0013"
    description: "Malware detection signature PHP-REX-0013"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\s*\(\s*@?preg_match\s*\(\s*[''"]/?(?:checkout|admin|\|){1,3}/?[''"]\s*,\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]{1,20}[''"]\s*\]\s*\)\s*\)\s*\{\s*@?file_put_contents\s*\(\s*.{1,200}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0017"
    name: "PHP-REX-0017"
    description: "Malware detection signature PHP-REX-0017"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\(isset\(\$_GET\[[''"]\w{1,10}[''"]\].{60,70}\$disable_functions\s*=\s*@ini_get\([''"]disable_functions[''"]\);\s*.{320,350}echo[''"]<b>\s*gagal[\s\w]{0,15}[''"];\s*\}\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0018"
    name: "PHP-REX-0018"
    description: "Malware detection signature PHP-REX-0018"
    severity: critical
    category: php_backdoor
    pattern: '@file_put_contents\([''"]\w{1,40}\.php[''"]\s*,\s*file_get_contents\s*\(\s*[''"]https?://pastebin\.com/raw[^\)]{1,40}\)\)\;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0019"
    name: "PHP-REX-0019"
    description: "Malware detection signature PHP-REX-0019"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(?:\s*\$\w{1,9}\s*=\s*(?:\s*chr\(\d+\)\.?){1,20}\;|\s*\$\w{1,9}\s*=\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)(?:\s*\[\s*[''"][^''"]{1,9}[''"]\s*\])?\s*;\s*){1,20}(?:\s*\$\w{1,9}\s*[\(,\.\)]\s*){1,9}\s*\)\s*;\s*include\s*\(\s*\$\w{1,9}\s*\)\s*;\s*\$\w{1,9}\s*\(\s*\$\w{1,9}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0020"
    name: "PHP-REX-0020"
    description: "Malware detection signature PHP-REX-0020"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(isset\(\$_GET\[[''"]\w{1,10}[''"]\].{60,70}\$disable_functions\s*=\s*@ini_get\([''"]disable_functions[''"]\);\s*.{320,350}echo[''"]<b>\s*gagal[\s\w]{0,15}[''"];\s*\}\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0024"
    name: "PHP-REX-0024"
    description: "Malware detection signature PHP-REX-0024"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?extract\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\)\s*\&\&\s*@?(assert|eval)\s*\(\s*stripslashes\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\&\&\s*@?exit\s*;\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0025"
    name: "PHP-REX-0025"
    description: "Malware detection signature PHP-REX-0025"
    severity: critical
    category: php_backdoor
    pattern: '\*/@\$\w\&\&@\$\w\s*\(\s*\$\w\s*\(\s*\$\w\s*,\s*\$\w\s*\)\s*\)\s*;/\*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0026"
    name: "PHP-REX-0026"
    description: "Malware detection signature PHP-REX-0026"
    severity: critical
    category: php_backdoor
    pattern: '\*/extract\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\)\s*;/\*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0028"
    name: "PHP-REX-0028"
    description: "Malware detection signature PHP-REX-0028"
    severity: critical
    category: php_backdoor
    pattern: 'call_user_func\s*\(\s*create_function\s*\(\s*\w{1,40}\s*\,\s*str_rot13\s*\(\s*strrev\s*\(\s*[''"][^'']{1,400}''\)\)\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0029"
    name: "PHP-REX-0029"
    description: "Malware detection signature PHP-REX-0029"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*[''"][^''"]*[''"]\s*;\s*\$\w{1,40}\s*=\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*;\s*foreach\s*\(\s*\$\w{1,40}\s*as\s*\$\w{1,40}\s*=\s*>\s*\$\w{1,40}\s*\)\s*\{\s*if.{1,200}\s*echo\s*@\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0031"
    name: "PHP-REX-0031"
    description: "Malware detection signature PHP-REX-0031"
    severity: critical
    category: php_backdoor
    pattern: 'extract\(\$_(?:COOKIE|GET|POST|SERVER|REQUEST)\);\s*if\s*\(\$\w\)\s*\{\s*@\$\w\(\$\w\s*,\s*\$\w\)\s*;\s*@?\$\w\(\$\w\(\$\w\s*,\s*\$\w\)\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0032"
    name: "PHP-REX-0032"
    description: "Malware detection signature PHP-REX-0032"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s+echo\s*[''"]\s*Priv8\s+Home\s+Root\s+Uploader.{500,1000}echo\s*[''"]gagal\s+upload[''"];\s*}\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0033"
    name: "PHP-REX-0033"
    description: "Malware detection signature PHP-REX-0033"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\s*\(\s*[''"][^,]{1,120}\,\s*base64_decode\s*\(\s*[''"]PD9waHANCmVjaG8gIlRoaXMgc2hpdCB3b3JrcyEiOw0KaWYgKGlzc2V0KCRfRklMRVNbImZpbGVuYW1lIl0pK[^,]{500,510}\;(\s/\*[''"]\)\;)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0034"
    name: "PHP-REX-0034"
    description: "Malware detection signature PHP-REX-0034"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*\$\w{1,40}="[^"]+";\s*\$\w{1,40}=''[^'']+'';\s*(\$\w{1,40}=(\$\w{1,40}\[\d+\]\.?)+;\s*){4,10}\s*\$\w{1,40}=\$\w{1,40}\([''"]{2},\$\w{1,40}\("[^"]+",\$\w{1,40}\(\$\w{1,40}\(\$\w{1,40}\)\)\)\);\s*\$\w{1,40}\(\$\w{1,40},\$\w{1,40}\(\$\w{1,40}\),\$\w{1,40}(,\d)?\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0037"
    name: "PHP-REX-0037"
    description: "Malware detection signature PHP-REX-0037"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!function_exists\s*\(\s*[''"]wp_func_jquery[''"]\s*\)\s*\)\s*(?:\{\s*if\s*\(!current_user_can\(\s*[''"]read[''"]\s*\)\))?\s*\{\s*function\s*wp_func_jquery\s*\(\s*\)\s*{\s*\$host\s*=\s*[''"]https?://[''"]\s*;.{100,500}?add_action\([''"]wp_footer[''"]\s*,\s*[''"]wp_func_jquery[''"]\);\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0038"
    name: "PHP-REX-0038"
    description: "Malware detection signature PHP-REX-0038"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\s*ini_set\(\s*(chr\(\d+\)\s*\.?)+,\s*\d+\);\s*echo\s+@?file_get_contents\(\s*(chr\(\d+\)\s*\.?)+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0042"
    name: "PHP-REX-0042"
    description: "Malware detection signature PHP-REX-0042"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*"[^"]*"\s*;\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*,\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*(passthru|system|shell_exec|popen)\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0043"
    name: "PHP-REX-0043"
    description: "Malware detection signature PHP-REX-0043"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*basename\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*if\s*\(\s*copy\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*,\s*\$\w{1,40}\s*\)\s*\)\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0044"
    name: "PHP-REX-0044"
    description: "Malware detection signature PHP-REX-0044"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$\w{1,40}=''[^;]+;if\(isset\(\$\{\$\w{1,40}\[[^}]+}\[\$\w{1,40}[^)]+\)\)\{eval\(\$\{[^)]+\);\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0045"
    name: "PHP-REX-0045"
    description: "Malware detection signature PHP-REX-0045"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*@?eval.+''\)\);\s*/\*,\*/\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0046"
    name: "PHP-REX-0046"
    description: "Malware detection signature PHP-REX-0046"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*;\s*if\s*\(\s*isset\s*\(\s*\$\w{1,40}\s*\)\s*&&\s*!empty\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*@eval\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0050"
    name: "PHP-REX-0050"
    description: "Malware detection signature PHP-REX-0050"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?(eval|assert)\s*\(\s*\$_(?:REQUEST|GET|POST|COOKIE|SERVER)\s*\[''p''\]\s*\)\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0051"
    name: "PHP-REX-0051"
    description: "Malware detection signature PHP-REX-0051"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*preg_replace\("\\x2F\\x2E\\x2A\\x2F\\x65"\s*,\s*"[^"]+"\s*,\s*""\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0053"
    name: "PHP-REX-0053"
    description: "Malware detection signature PHP-REX-0053"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=.{1,100}str_replace\(''[^'']+''\s*,\s*''''\s*,\s*base64_decode\(\s*''[^'']+''\s*\)\s*;\s*call_user_func\([^;]+;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0054"
    name: "PHP-REX-0054"
    description: "Malware detection signature PHP-REX-0054"
    severity: critical
    category: php_backdoor
    pattern: '@include\s+"(/|\\057|\\x2f).{20,300}(\.|\\056|\\x2e)(i|\\x69|\\071|\\151)(c|\\143|\\x63)(o|\\157|\\x6f)"\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0055"
    name: "PHP-REX-0055"
    description: "Malware detection signature PHP-REX-0055"
    severity: critical
    category: php_backdoor
    pattern: '\$auth_pass\s*=\s*"[^"]*"\s*;\s*\$color\s*=\s*"[^"]*"\s*;\s*\$default_use_ajax\s*=\s*true\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*eval\s*\(\s*"[^"]*"\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0056"
    name: "PHP-REX-0056"
    description: "Malware detection signature PHP-REX-0056"
    severity: critical
    category: php_backdoor
    pattern: '\$links\s*=\s*new\s+Get_links\(\);\s*\$links\s*=\s*\$links->get_remote\(\);\s*echo\s*\$links;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0057"
    name: "PHP-REX-0057"
    description: "Malware detection signature PHP-REX-0057"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*array\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*array_filter\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*exit\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0058"
    name: "PHP-REX-0058"
    description: "Malware detection signature PHP-REX-0058"
    severity: critical
    category: php_backdoor
    pattern: '<meta\s+http-equiv="refresh"\s+content="\d+;\s+url=[^"]+">\s*<body\s+onLoad="tiktak\(\);">'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0060"
    name: "PHP-REX-0060"
    description: "Malware detection signature PHP-REX-0060"
    severity: critical
    category: php_backdoor
    pattern: 'if\(md5\(\$bannermass\)==\$get_url_var\)\s*\{\s*\$set_cookie\(stripslashes\(\$check_category\)\);\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0062"
    name: "PHP-REX-0062"
    description: "Malware detection signature PHP-REX-0062"
    severity: critical
    category: php_backdoor
    pattern: '\$USER->Authorize\(1\s*,\s*true\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0063"
    name: "PHP-REX-0063"
    description: "Malware detection signature PHP-REX-0063"
    severity: critical
    category: php_backdoor
    pattern: '\$links\s*=\s*\$client_lnk->build_links\(\);\s*if\s*\(!\$iKnowYou\)\s*\{\s*\$bodyText\s*=\s*preg_replace\(".\(\.\*\)\(<\(\\s\*\?\)\\/\(\\s\*\?\)body\(\[\^>\]\*\?\)>\).s"\s*,\s*"\$1\\r\\n<div>"\s*\.\s*\$links\s*\.\s*"</div>\$2"\s*,\s*\$bodyText\);\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0064"
    name: "PHP-REX-0064"
    description: "Malware detection signature PHP-REX-0064"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$GLOBALS\[''_\d+_''\]=Array\(.{1,600}@eval\(\$_\d+\);exit\(\);\}\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0065"
    name: "PHP-REX-0065"
    description: "Malware detection signature PHP-REX-0065"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(\$\w{1,40}\s*=\s*"[^"]+";\s*|\$\w{1,40}\s*=\s*str_replace\("\w+"\s*,\s*""\s*,\s*"\w+"\);\s*|\$\w{1,40}\s*=\s*\$\w{1,40}\s*\("\w+"\s*,\s*""\s*,\s*"\w+"\s*\);\s*){6,}\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\([''"]{2}\s*,\s*\$\w{1,40}\(\$\w{1,40}\("\w+"\s*,\s*""\s*,[^)]+\)\)\)\s*;.{1,30}\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0069"
    name: "PHP-REX-0069"
    description: "Malware detection signature PHP-REX-0069"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\$_POST\[''\w+''\]\)\)\s*eval\(\$_POST\[''\w+''\]\);\s*else\s*echo\s*"<form.{1,70}</button></form>";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0072"
    name: "PHP-REX-0072"
    description: "Malware detection signature PHP-REX-0072"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\$_GET\[''view''\]\)\)\s*\{.{1,100}eval/\*\*/\s*\(\s*''[^'']*''\s*\.\s*join\s*\(\s*"[^"]*"\s*,\s*file\s*\(\s*"[^"]*"\s*\)\s*\)\s*\.\s*''[^'']*''\s*\)\s*;\s*die\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0074"
    name: "PHP-REX-0074"
    description: "Malware detection signature PHP-REX-0074"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*eval\s*\(\s*base64_decode\s*\(\s*"aWYoaXNzZXQoJF9SRVFVRVNUWy[^"]{400,1000}"\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0075"
    name: "PHP-REX-0075"
    description: "Malware detection signature PHP-REX-0075"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*@?eval\s*\(\s*stripslashes\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*;\s*\}\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0077"
    name: "PHP-REX-0077"
    description: "Malware detection signature PHP-REX-0077"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*@\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*,\s*"[^"]*"\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0079"
    name: "PHP-REX-0079"
    description: "Malware detection signature PHP-REX-0079"
    severity: critical
    category: php_backdoor
    pattern: 'extract\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\)\s*;\s*@\$\w{1,40}\s*\(\s*@\$\w{1,40}\s*\(\s*(\$\w{1,40})\s*,\s*\$\w{1,40}\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0081"
    name: "PHP-REX-0081"
    description: "Malware detection signature PHP-REX-0081"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(GET|POST|COOKIE)\s*\[\s*''[^'']*''\s*\]\s*!=''[^'']*''\s*\)\s*\{\s*eval\s*\(\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*\}\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*eval\s*\(\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0082"
    name: "PHP-REX-0082"
    description: "Malware detection signature PHP-REX-0082"
    severity: critical
    category: php_backdoor
    pattern: 'if\(preg_match_all\(''/\\\$tmpcontent\s*=\s*@file_get_contents\\\("http:\\/\\/\(\.\*\)\\/code20\\.php.{1,300}newdomain''\],\s*\$file\);\s*@file_put_contents\(__FILE__,\s*\$file\);\s*print\s*"true";\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0083"
    name: "PHP-REX-0083"
    description: "Malware detection signature PHP-REX-0083"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*theme_temp_setup\(\s*\$phpCode\s*\)\s*\{\s*\$tmpfname\s*=\s*tempnam\(sys_get_temp_dir\(\)\s*,\s*"theme_temp_setup"\);\s*\$handle\s*=\s*fopen\(\s*\$tmpfname\s*,\s*"w\+"\);\s*fwrite\(\s*\$handle\s*,\s*"<\?php\\n".{1,100}return\s*get_defined_vars\(\);\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0085"
    name: "PHP-REX-0085"
    description: "Malware detection signature PHP-REX-0085"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\)\s*;\s*@eval\s*\(\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;\s*unset\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0086"
    name: "PHP-REX-0086"
    description: "Malware detection signature PHP-REX-0086"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?preg_replace\(''/[^/]{1,40}/e''\s*,\s*''[^,]+,\s*''[^'']+''\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0087"
    name: "PHP-REX-0087"
    description: "Malware detection signature PHP-REX-0087"
    severity: critical
    category: php_backdoor
    pattern: 'print_r\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0088"
    name: "PHP-REX-0088"
    description: "Malware detection signature PHP-REX-0088"
    severity: critical
    category: php_backdoor
    pattern: 'print_r\s*\(\s*call_user_func_array\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*array\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0089"
    name: "PHP-REX-0089"
    description: "Malware detection signature PHP-REX-0089"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+passthru\(getenv\("HTTP_\w{1,50}"\)\);.{1,200}\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0092"
    name: "PHP-REX-0092"
    description: "Malware detection signature PHP-REX-0092"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(//header\(''Content-Type:text/html; charset=utf-8''\);)?(\s*\$[O0_]+=(''[^'']*''|\d+);){3,}\s*\$[O0_]+=array\(.{300,500}\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0093"
    name: "PHP-REX-0093"
    description: "Malware detection signature PHP-REX-0093"
    severity: critical
    category: php_backdoor
    pattern: '@copy\s*\(\s*\$_FILES\[file\]\[tmp_name\]\s*,\s*\$_FILES\[file\]\[name\]\);\s*exit;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0094"
    name: "PHP-REX-0094"
    description: "Malware detection signature PHP-REX-0094"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(isset\s*\(\$_GET\[''check''\]\)\)\s*\{\s*echo\s*"checked.{300,600}echo\s*''<a href=''\.\$file\.''>''\.\$file\.''</a>'';\s*\}\s*else\s*\{\s*echo\("FILE"\);\s*\}\s*\?>\s*</body>\s*</html>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0095"
    name: "PHP-REX-0095"
    description: "Malware detection signature PHP-REX-0095"
    severity: critical
    category: php_backdoor
    pattern: '\A<\?php\s*eval\(base64_decode\(''ZWNobyBmaWxlX2dldF9jb250ZW50cygiaHR0c.{1,100}''\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0096"
    name: "PHP-REX-0096"
    description: "Malware detection signature PHP-REX-0096"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*md5\s*\(\s*''[^'']*''\s*\)\s*;\s*system\s*\(\s*''[^'']*''\s*\)\s*;\s*unlink\s*\(\s*\$_SERVER\s*\[\s*''SCRIPT_FILENAME''\s*\]\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0098"
    name: "PHP-REX-0098"
    description: "Malware detection signature PHP-REX-0098"
    severity: critical
    category: php_backdoor
    pattern: '(include|include_once|require|require_once)\s*\(\s*\$_SERVER\[\s*''DOCUMENT_ROOT''\s*\]\s*\.\s*''[\w/_0%]{0,200}\.(jpg|gif|jpeg|bmp)''\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0099"
    name: "PHP-REX-0099"
    description: "Malware detection signature PHP-REX-0099"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\(\$\w{1,40}\s*=\s*\$_POST\[[^]]+\]\)\s*&&\s*@?preg_replace\(''/ad/e'',[^;]{1,200};\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0104"
    name: "PHP-REX-0104"
    description: "Malware detection signature PHP-REX-0104"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$f\s*=\s*[create_function.''" ]{15,};if.{10,200}print_r\(\s*\$out\s*\);\s*die\(\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0107"
    name: "PHP-REX-0107"
    description: "Malware detection signature PHP-REX-0107"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^"'']*[''"]\s*\]\s*\)\s*\{\s*\$\w{1,40}="[^;]+"\s*;\s*preg_replace\s*\(\s*"/[^/]+/e"\s*,\s*\$_\s*\(\s*"[^"]{1,500}"\s*\)\s*,\s*0\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0112"
    name: "PHP-REX-0112"
    description: "Malware detection signature PHP-REX-0112"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_GET\[''bataboom.{100,300}Submit"/></form><\?php\s*\}\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0114"
    name: "PHP-REX-0114"
    description: "Malware detection signature PHP-REX-0114"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(!empty\(\$_REQUEST\[''ch2''\]\)\s*&&\s*\$_REQUEST\[''ch2''\]\s*==.{400,650};fclose\(\$fp\);include\([^)]+\);\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0115"
    name: "PHP-REX-0115"
    description: "Malware detection signature PHP-REX-0115"
    severity: critical
    category: php_backdoor
    pattern: '@preg_replace\(\s*\$exif\[[^\]]+\]\s*\.\s*\$exif\[[^\]]+\]\s*,\s*\$exif\[[^\]]+\]\s*\.\s*\$exif\[[^\]]+\]\s*\.\s*\$exif\[[^\]]+\]\s*\.\s*\$exif\[[^\]]+\]\s*,\s*''''\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0116"
    name: "PHP-REX-0116"
    description: "Malware detection signature PHP-REX-0116"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\$_GET\s*\[''ch''\]\)\s*\{\s*echo "OK";\s*exit;\s*\}.{100,400}echo\s*"An error occured";\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0117"
    name: "PHP-REX-0117"
    description: "Malware detection signature PHP-REX-0117"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*@\$\w{1,40}\(''''\s*,\s*strrev\('';\)\)\]\w{1,40}\[REVRES_\$\(edoced_46esab\(lave''\s*\)\s*\);\s*@\$\w{1,40}\(\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0118"
    name: "PHP-REX-0118"
    description: "Malware detection signature PHP-REX-0118"
    severity: critical
    category: php_backdoor
    pattern: 'include\(''/[0-9a-zA-Z_\-/]{1,150}/bitrix/images/iblock/ib\.gif''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0119"
    name: "PHP-REX-0119"
    description: "Malware detection signature PHP-REX-0119"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*"PHP\s+Uploader.{200,500}echo "Failed to Upload\.";\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0120"
    name: "PHP-REX-0120"
    description: "Malware detection signature PHP-REX-0120"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*extract\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\)\s*&&\s*@\$\w{1,40}\s*\(\s*stripslashes\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*&&\s*exit\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0121"
    name: "PHP-REX-0121"
    description: "Malware detection signature PHP-REX-0121"
    severity: critical
    category: php_backdoor
    pattern: 'include\s*"\\x2.{1,300}?(\.|\\x2e)(p|\\x70)(h|\\x68)(p|\\x70)"\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0122"
    name: "PHP-REX-0122"
    description: "Malware detection signature PHP-REX-0122"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(0\);\s*if\(isset\(\$_GET\[\w{1,40}\]\)\)\s*\{\s*echo.{100,1000}-->"\.\$_FILES\["\w+"\]\["\w+"\];\}else\{echo"<b>";\}\}\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0123"
    name: "PHP-REX-0123"
    description: "Malware detection signature PHP-REX-0123"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*ini_set\("log_errors", false\);ini_set\("display_errors", false\);error_reporting\(0\);if\s*\(isset\(\$_REQUEST.{1,1000};file_put_contents\(\$tmp, "<\?php "\.gzuncompress\(base64_decode\(\$_POST\["\w+"\]\)\)\);include \$tmp;\};\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0127"
    name: "PHP-REX-0127"
    description: "Malware detection signature PHP-REX-0127"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*(?:system|exec|shell_exec|popen|passthru)\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\.\s*''\s*2>&1\s*''\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0128"
    name: "PHP-REX-0128"
    description: "Malware detection signature PHP-REX-0128"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*strtoupper\s*\([^)]{1,100}\)\s*;\s*if\s*\(\s*isset\s*\(\s*\$\s*\{\s*\$\w{1,40}\s*\}\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*(?:assert|eval)\s*\(\s*\$\s*\{\s*\$\w{1,40}\s*\}\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0130"
    name: "PHP-REX-0130"
    description: "Malware detection signature PHP-REX-0130"
    severity: critical
    category: php_backdoor
    pattern: 'if\(is_uploaded_file\(\$_FILES\["filename"\]\["tmp_name"\]\)\)\s*\{\s*move_uploaded_file\(.{100,400}\$filename\s*=\s*\$_SERVER\[SCRIPT_FILENAME\];\s*\$time\s*=\s*time\(\)\s*-\s*\d+;\s*touch\(\$filename\s*,\s*\$time\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0134"
    name: "PHP-REX-0134"
    description: "Malware detection signature PHP-REX-0134"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?eval\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^"'']*["'']\s*\]\s*\)\s*;?\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0136"
    name: "PHP-REX-0136"
    description: "Malware detection signature PHP-REX-0136"
    severity: critical
    category: php_backdoor
    pattern: '<\?=\s*\(\s*\$\w{1,40}=@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*\.\s*stripslashes\s*\(\s*@\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*\)\s*;\s*exit\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0138"
    name: "PHP-REX-0138"
    description: "Malware detection signature PHP-REX-0138"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s*encode\(\s*\$string\s*\)\s*\{.{500,800}=\s*function\(\s*\)\s*\{\s*''\.\$b\[''code''\]\.''\}''\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0139"
    name: "PHP-REX-0139"
    description: "Malware detection signature PHP-REX-0139"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*md5\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*==\s*''[^'']*''\s*\)\s*\{\s*preg_replace\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0140"
    name: "PHP-REX-0140"
    description: "Malware detection signature PHP-REX-0140"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*){1,4}\$\w{1,40}\s*=\s*\$\w{1,40}\s*\.\s*\$\w{1,40}\s*\.\s*''[^'']*''\s*;\s*if\s*\(\s*@md5\s*\(\s*\$_REQUEST\s*\[\s*''[^'']*''\s*\]\s*\)\s*==\s*''[^'']*''\s*\)\s*@\$\w{1,40}\s*\(\s*\$_FILES\[\s*''\w+''\s*\]\s*\[\s*''\w+''\s*\]\s*,\s*\$_POST\s*\[\s*''\w+''\s*\]\s*\.\s*\$\w{1,40}\s*\[\s*''\w+''\s*\]\s*\[\s*''\w+''\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0141"
    name: "PHP-REX-0141"
    description: "Malware detection signature PHP-REX-0141"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=[^;]{1,100};\s*\$\w{1,40}\s*=\s*"[^"]{1,500}"\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0142"
    name: "PHP-REX-0142"
    description: "Malware detection signature PHP-REX-0142"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\[\s*''[^'']{1,10}''\s*\]\s*\)\s*\)\s*\{\s*(system|shell_exec|exec|passthru|popen)\s*\(\s*\[\s*''[^'']{1,10}''\s*\]\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0143"
    name: "PHP-REX-0143"
    description: "Malware detection signature PHP-REX-0143"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*"<pre>"\s*;\s*(?:system|exec|eval|assert|shell_exec|passthru)\(\$_(?:GET|POST|COOKIE|REQUEST)\[[^]]{1,20}\]\)\s*;\s*echo\s*"</pre>"\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0145"
    name: "PHP-REX-0145"
    description: "Malware detection signature PHP-REX-0145"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*die\s*\(\s*(?:eval|assert|passthru|exec|system|shell_exec)\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0146"
    name: "PHP-REX-0146"
    description: "Malware detection signature PHP-REX-0146"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,10}\s*=\s*''[^'']{1,10}''\s*\.\s*substr\(\s*\$\w{1,10}\s*,\s*\d+\s*,\s*\d+\);\s*\$\w{1,10}\s*=\s*preg_replace\(\s*\$\w{1,10}\s*,\s*strtr\(\s*\$\w{1,10}\s*,\s*\$\w{1,10}\s*,\s*\$\w{1,10}\)\s*,\s*''[^'']{1,20}''\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0147"
    name: "PHP-REX-0147"
    description: "Malware detection signature PHP-REX-0147"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|REQUEST);.{100,300}var_dump\(\$\w{1,40}\(\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\);\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0148"
    name: "PHP-REX-0148"
    description: "Malware detection signature PHP-REX-0148"
    severity: critical
    category: php_backdoor
    pattern: '\$arr\s*=\s*\$_(GET|POST|COOKIE|REQUEST|SERVER);\s*foreach\s*\(\s*\$arr\s*as\s*\$\w{1,40}\s*=>\s*\$\w{1,40}\s*\)\s*\{\s*if\s*\(\s*\$\w{1,40}\s*==\s*"\w{1,40}"\s*\)\s*\{\s*\$\w{1,40}\s*=\s*end\(\$\w{1,40}\);.{1,100}echo\s*\$\w{1,40};\s*}\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0153"
    name: "PHP-REX-0153"
    description: "Malware detection signature PHP-REX-0153"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*if\(\$\w{1,40}\s*!=\s*""\)\s*print\s*Shell_Exec\(\$\w{1,40}\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0157"
    name: "PHP-REX-0157"
    description: "Malware detection signature PHP-REX-0157"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@copy\(\$_FILES\[''\w{1,40}''\]\[''tmp_name''\]\s*,\s*\$_POST\[''\w{1,40}''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0158"
    name: "PHP-REX-0158"
    description: "Malware detection signature PHP-REX-0158"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(0\);\s*if\(isset\(\$_GET\[''ms-load''\]\)\s*&&.{100,1000}\}\s*\}\s*endif;\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0159"
    name: "PHP-REX-0159"
    description: "Malware detection signature PHP-REX-0159"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=".{100,1000}\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*"",[^;]+;\s*\$\w{1,40}\s*\(\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0161"
    name: "PHP-REX-0161"
    description: "Malware detection signature PHP-REX-0161"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\$_REQUEST\["key"\]\s*!=\s*""\s*\)\s*{\s*if\s*\(\s*\$_REQUEST\["key"\]\s*==\s*"[^{]+{\$\w{1,40}\s*=\s*copy\(\$_SERVER\["DOCUMENT_ROOT"\]\s*\.\s*".{1,100}/restore\.php"\s*,\s*\$_SERVER\["DOCUMENT_ROOT"\]\s*\."[^"]{1,100}"\)\s*;\s*if\(\$\w{1,40}\)\s*{\s*die\(\s*"ok"\s*\)\s*;\s*}\s*else\s*{\s*die\s*\(\s*"fail"\s*\)\s*;\s*\}\s*\}\s*\};'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0162"
    name: "PHP-REX-0162"
    description: "Malware detection signature PHP-REX-0162"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(//\w{1,40})?\s*\$\{"[^"]+"\}\["[^"]+"\]="[^"]+";\$\{".+;echo\$\{\$\w{1,30}};exit\(\);\}\}\}\}\s*(//\w{1,40})?\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0163"
    name: "PHP-REX-0163"
    description: "Malware detection signature PHP-REX-0163"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\(\s*\$_GET\[\s*"ms-load"\s*\]\s*\)\s*&&.{100,1000}print "Error:n";\s*\}\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0167"
    name: "PHP-REX-0167"
    description: "Malware detection signature PHP-REX-0167"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^]]+\s*\]\s*\)\s*\{\s*\$\w{1,40}=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^]]+\s*\]\s*;\s*echo\s*\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^]]+\s*\]\s*\)\s*;\s*exit\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0168"
    name: "PHP-REX-0168"
    description: "Malware detection signature PHP-REX-0168"
    severity: critical
    category: php_backdoor
    pattern: '\$USER->Update\(1\s*,\s*array\(\s*"PASSWORD"\s*=>\s*["''][^''"]+[''"]\s*\)\s*\);\s*require\(\$_SERVER\[''DOCUMENT_ROOT''\]\."/bitrix/footer\.php"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0174"
    name: "PHP-REX-0174"
    description: "Malware detection signature PHP-REX-0174"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(base64_decode\("aWYgKCFkZWZpbmVkKCdBTFJFQURZX1JVTl[^"]+"\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0179"
    name: "PHP-REX-0179"
    description: "Malware detection signature PHP-REX-0179"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(?:system|passthru|shell_exec)\(\s*"\$\w{1,40}"\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0181"
    name: "PHP-REX-0181"
    description: "Malware detection signature PHP-REX-0181"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*header\s*\(\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*=\s*''[^;]{5,100};\s*@\$\w{1,40}\s*\(\s*stripslashes\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0184"
    name: "PHP-REX-0184"
    description: "Malware detection signature PHP-REX-0184"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*preg_replace\s*\(\s*"\|\.\*\|ie"\s*,\s*"[^"]*"\s*,\s*"[^"]+"\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0185"
    name: "PHP-REX-0185"
    description: "Malware detection signature PHP-REX-0185"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*\$GLOBALS\[''_\d+_''\]=Array.{400,1000}?\(\d+\)\)\s*eval\s*\(\s*base64_decode\s*\(\s*\$_POST\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0187"
    name: "PHP-REX-0187"
    description: "Malware detection signature PHP-REX-0187"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(JRequest::getVar\(''get_product'',0,''POST''\)\|\|JRequest::getVar\(''get_product'',0,''COOKIE''\)\){.{300,1000}?exit\(\);}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0188"
    name: "PHP-REX-0188"
    description: "Malware detection signature PHP-REX-0188"
    severity: critical
    category: php_backdoor
    pattern: '\A<\?php\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*@?eval\s*\(\s*base64_decode\s*\(\s*''[^'']*''\s*\)\s*\)\s*\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0189"
    name: "PHP-REX-0189"
    description: "Malware detection signature PHP-REX-0189"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*eval\(base64_decode\(''.{76}''\.\s*''.{76}''\.'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0192"
    name: "PHP-REX-0192"
    description: "Malware detection signature PHP-REX-0192"
    severity: critical
    category: php_backdoor
    pattern: '\*/\s*preg_replace\s*\(\s*"\\[^"]{10,30}"\s*,\s*"\\[^"]{10,110}"\s*,\s*"\\[^"]+"\s*\)\s*;\s*/\*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0194"
    name: "PHP-REX-0194"
    description: "Malware detection signature PHP-REX-0194"
    severity: critical
    category: php_backdoor
    pattern: '{\s*move_uploaded_file\s*\(\s*\$_FILES\["filename"\]\["tmp_name"\]\s*,\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*echo\s*"true"\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0195"
    name: "PHP-REX-0195"
    description: "Malware detection signature PHP-REX-0195"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*eval\s*\(\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0196"
    name: "PHP-REX-0196"
    description: "Malware detection signature PHP-REX-0196"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\s*\(\s*\w+\s*\)\s*;.{100,1000}if\s*\(\s*md5\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*==''[^'']*''\s*\)\s*eval\s*\(\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0198"
    name: "PHP-REX-0198"
    description: "Malware detection signature PHP-REX-0198"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$\w{1,40}\s*\[\s*\w{1,40}\s*\]\s*\)\s*\)\s*\{\s*if\s*\(\s*is_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*\w+\s*\]\s*\[\s*tmp_name\s*\]\s*\)\s*\)\s*\{\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*\w+\s*\]\s*\[\s*tmp_name\s*\]\s*,\s*\$\w{1,40}\s*\[\s*\w+\s*\]\s*\[\s*name\s*\]\s*\)\s*;\s*\}\s*\}\s*\?>\s*<form.{50,200}</form>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0199"
    name: "PHP-REX-0199"
    description: "Malware detection signature PHP-REX-0199"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=''[^'']*''\s*\^\s*''[^'']*''\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*\^\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0201"
    name: "PHP-REX-0201"
    description: "Malware detection signature PHP-REX-0201"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*preg_replace\s*\(\s*''/\w+/e''\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0202"
    name: "PHP-REX-0202"
    description: "Malware detection signature PHP-REX-0202"
    severity: critical
    category: php_backdoor
    pattern: '{\s*\$USER->Authorize\(\$_REQUEST\[''ID''\]\);\s*LocalRedirect\("/bitrix/admin/"\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0205"
    name: "PHP-REX-0205"
    description: "Malware detection signature PHP-REX-0205"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=''[^'']*''\^''[^'']*''\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\^''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0206"
    name: "PHP-REX-0206"
    description: "Malware detection signature PHP-REX-0206"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*preg_replace\s*\(\s*''.\w{1,30}.e''\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0208"
    name: "PHP-REX-0208"
    description: "Malware detection signature PHP-REX-0208"
    severity: critical
    category: php_backdoor
    pattern: '\$USER->Authorize\(\$_(?:REQUEST|GET)\[''\w+''\]\);\s*LocalRedirect\("/bitrix/admin/"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0209"
    name: "PHP-REX-0209"
    description: "Malware detection signature PHP-REX-0209"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\s*\(\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*\$\w{1,40}\s*,\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\)\s*;\s*eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0210"
    name: "PHP-REX-0210"
    description: "Malware detection signature PHP-REX-0210"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*@isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*tryyr\s*\]\s*\)\s*\)\s*\{\s*(?:\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*){2,}\s*\$\w{1,40}\s*=\$\w{1,40}[^;]+;\s*echo\s*''[^'']*''\s*\.\s*@?\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0212"
    name: "PHP-REX-0212"
    description: "Malware detection signature PHP-REX-0212"
    severity: critical
    category: php_backdoor
    pattern: '@\s*include(_once)?\s*\(\s*\$_SERVER\[\s*"DOCUMENT_ROOT"\s*\]\s*\.\s*"/bitrix/.{1,200}?\.gif"\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0214"
    name: "PHP-REX-0214"
    description: "Malware detection signature PHP-REX-0214"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*"[^;]+;\s*\$\w{1,40}\s*=\s*@\$\w{1,40}\(''\$\w{1,40}''\s*,\s*".+?''\s*\)\s*;\s*@?\$\w{1,40}\("[^"]+"\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0215"
    name: "PHP-REX-0215"
    description: "Malware detection signature PHP-REX-0215"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*file_put_contents\s*\(\s*\$\w{1,40}\s*,\s*''[^'']*''\s*\.\s*\$\w{1,40}\s*\)\s*;\s*include\s*\(\s*\$\w{1,40}\s*\)\s*;\s*unlink\s*\(\s*\$\w{1,40}\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0217"
    name: "PHP-REX-0217"
    description: "Malware detection signature PHP-REX-0217"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*if\s*\(\s*\$\w{1,40}\s*==''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*curl_init\s*\(\s*\)\s*;.+?curl_close\s*\(\s*\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*print\s*"[^"]*"\s*;\s*print\s*\$\w{1,40}\s*;\s*\}\s*else\s*\{\s*print\s*"[^"]*"\s*;\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0219"
    name: "PHP-REX-0219"
    description: "Malware detection signature PHP-REX-0219"
    severity: critical
    category: php_backdoor
    pattern: '\*/\s*(include|require|include_once|require_once)\s*/\*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0220"
    name: "PHP-REX-0220"
    description: "Malware detection signature PHP-REX-0220"
    severity: critical
    category: php_backdoor
    pattern: '(<\s*\?\s*eval\s*\(\s*gzuncompress\s*\(\s*base64_decode\s*\(\s*[''"][^''"]*[''"]\s*\)\s*\)\s*\)\s*;\s*\?>\s*){3,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0221"
    name: "PHP-REX-0221"
    description: "Malware detection signature PHP-REX-0221"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s*\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*for\s*\(\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*<\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\+\+\s*\)\s*\{\s*\$\w{1,40}\s*\.\s*=\s*isset\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\]\s*\)\s*\?\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\]\s*:\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*;\s*\}\s*\$\w{1,40}\s*="[^"]*"\s*;\s*return\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\$\w{1,40}\s*=.+eval\s*\(\s*\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\)\s*;\s*(\?>)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0222"
    name: "PHP-REX-0222"
    description: "Malware detection signature PHP-REX-0222"
    severity: critical
    category: php_backdoor
    pattern: '<\s*\?\s*require\s*\(\s*\$_SERVER\s*\[\s*"[^"]*"\s*\]\s*\.\s*"[^"]*"\s*\)\s*;\s*global\s*\$\w{1,40}\s*;\s*\$\w{1,40}-\s*>\s*Authorize\s*\(\s*[^)]+\)\s*;\s*LocalRedirect\s*\(\s*"[^"]*"\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0223"
    name: "PHP-REX-0223"
    description: "Malware detection signature PHP-REX-0223"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*([''"][^"'']*[''"]\s*\.\s*)+[''"][^"'']+[''"];.+?function\s*\w+\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\{\s*return\s*\$\w{1,40}\s*\^\s*str_repeat\s*\(\s*\$\w{1,40}\s*,\s*ceil\s*\(\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*/\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0224"
    name: "PHP-REX-0224"
    description: "Malware detection signature PHP-REX-0224"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*eval\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\}\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0225"
    name: "PHP-REX-0225"
    description: "Malware detection signature PHP-REX-0225"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*[''"][^;]+;\s*\$\w{1,40}\s*=(\$\w{1,40}\s*\[\s*\d+\s*\]\s*\.\s*){2,}\$\w{1,40}\s*\[\s*\d+\s*\]\s*;\s*\$\w{1,40}\s*=(\$\w{1,40}\s*\[\s*\d+\s*\]\s*\.\s*){2,}\$\w{1,40}\s*\[\s*\d+\s*\]\s*;\s*if\s*\(\s*isset\s*\(\s*\$\s*\{\s*(\$\w{1,40}\s*\[\s*\d+\s*\]\s*\.?\s*){2,}\s*}\s*\[\s*\$\w{1,40}\s*\(\s*(\$\w{1,40}\s*\[\s*\d+\s*\]\s*\.?\s*){2,}\s*\)\s*\]\s*\)\s*\)\s*{\s*eval\s*\(\s*\$\s*\{\s*(\$\w{1,40}\s*\[\s*\d+\s*\]\s*\.?\s*){2,}}\[\$\w{1,40}\s*\((\$\w+\[\d+\]\s*\.?){2,}\)]\);}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0226"
    name: "PHP-REX-0226"
    description: "Malware detection signature PHP-REX-0226"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*class\s*\w+\s*\{\s*public\s*function\s*__construct\s*\(\s*\)\s*\{\s*\$\w{1,40}\s*=\s*@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]*[''"]\s*\]\s*;\s*if\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]*[''"]\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\$\w{1,40}\s*\(\s*["''][^''"]*["'']\s*,\s*\$\w{1,40}\s*,\s*438\s*\)\s*;\s*\}\s*else\s*\{\s*header\s*\(\s*["''][^''"]*["'']\s*\)\s*;\s*\}\s*\}\s*\}\s*\$\w{1,40}\s*=\s*new\s*\w+\s*;\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0227"
    name: "PHP-REX-0227"
    description: "Malware detection signature PHP-REX-0227"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*md5\s*\(\s*\$\w{1,40}\s*\.\s*"[^"]*"\s*\)\s*;\s*eval\s*\(\s*gzuncompress\s*\(\s*str_rot13\s*\(\s*base64_decode\s*\(\s*''[^'']*''\s*\)\s*\)\s*\)\s*\)\s*;\s*exit\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0228"
    name: "PHP-REX-0228"
    description: "Malware detection signature PHP-REX-0228"
    severity: critical
    category: php_backdoor
    pattern: 'define\s*\(\s*''[^'']*''\s*,\s*class_exists\s*\(\s*[''"]COM[''"]\s*\)\s*\?\s*1\s*:\s*0\s*\)\s*;\s*define\s*\(\s*''PHPINFO_IS''\s*,\s*\(\s*!eregi\s*\(\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\)\s*\)\s*\?\s*1\s*:\s*0\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0229"
    name: "PHP-REX-0229"
    description: "Malware detection signature PHP-REX-0229"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*new\s*Get_links\s*\(\s*\)\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}-\s*>\s*return_links\s*\(\s*\$\w{1,40}\s*\)\s*;\s*echo\s*\$\w{1,40}\s*;\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0230"
    name: "PHP-REX-0230"
    description: "Malware detection signature PHP-REX-0230"
    severity: critical
    category: php_backdoor
    pattern: 'class\s+Get_links\s*{\s*var\s*\$host\s*=.+?(return\s*''<!--link error-->'';\s*}\s*}|\$data = file_get_contents\(\$file\);\s*return \$data;\s*}\s*}\s*})'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0231"
    name: "PHP-REX-0231"
    description: "Malware detection signature PHP-REX-0231"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*eval\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0232"
    name: "PHP-REX-0232"
    description: "Malware detection signature PHP-REX-0232"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\s*\(\s*trim\s*\(\s*base64_decode\s*\(\s*["''][^''"]*[''"]\s*\)\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0233"
    name: "PHP-REX-0233"
    description: "Malware detection signature PHP-REX-0233"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*="[^"]*"\s*;\s*sprintf\s*\(\s*base64_decode\s*\(\s*gzuncompress\s*\(\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0234"
    name: "PHP-REX-0234"
    description: "Malware detection signature PHP-REX-0234"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@error_reporting\s*\(\s*\d+\s*\)\s*;\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^"'']*[''"]\s*\]\s*;\s*if\s*\(\s*isset\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*eval\s*\(\s*base64_decode\s*\(\s*[''"][^''"]*[''"]\s*\)\s*\)\s*;\s*\}\s*else\s*\{\s*echo\s*base64_decode\s*\(\s*\w+\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0235"
    name: "PHP-REX-0235"
    description: "Malware detection signature PHP-REX-0235"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*echo\s*file_get_contents\s*\(\s*"[^"]*"\s*\)\s*;\s*exit\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0236"
    name: "PHP-REX-0236"
    description: "Malware detection signature PHP-REX-0236"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*[''"][^''"]+[''"];\s*preg_replace\s*\([''"][^''"]+[''"]\s*,\s*["][^"]+["]\s*,\s*["][^"]+["]\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0237"
    name: "PHP-REX-0237"
    description: "Malware detection signature PHP-REX-0237"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*die\(\$\w{1,40}\(\$\w{1,40}\(\$\w{1,40}\([^}]+\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0238"
    name: "PHP-REX-0238"
    description: "Malware detection signature PHP-REX-0238"
    severity: critical
    category: php_backdoor
    pattern: '(/\*[^\*]+\*/)?if(/\*[^\*]+\*/)?\s*\((/\*[^\*]+\*/)?\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*(/\*[^\*]+\*/)?\s*\)\s*(/\*[^\*]+\*/)?\s*\)(/\*[^\*]+\*/)?\s*\{\s*(/\*[^\*]+\*/)?\s*(eval|assert)\s*(/\*[^\*]+\*/)?\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)(/\*[^\*]+\*/)?;\s*(/\*[^\*]+\*/)?exit\s*;(/\*[^\*]+\*/)?\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0239"
    name: "PHP-REX-0239"
    description: "Malware detection signature PHP-REX-0239"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\${\s*[^}]+\s*}\s*\[[^\]]+\]\s*\)\s*\)\s*{\s*\$\w{1,40}\s*=\s*["''evalbs64srtprglc\s\.]+;\s*\$\w{1,40}\s*\(\s*\${[^}]+}\s*\[[^\]]+\]\s*\);\s*exit;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0240"
    name: "PHP-REX-0240"
    description: "Malware detection signature PHP-REX-0240"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\((/\*[^*]+\*/)?isset\((/\*[^*]+\*/)?\${(/\*[^*]+\*/)?"_.{1,250}?exit;[^}]+}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0241"
    name: "PHP-REX-0241"
    description: "Malware detection signature PHP-REX-0241"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*md5\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^"'']*["'']\s*\]\s*\)\s*==["''][^"'']*["'']\s*\)\s*\{\s*\$\w{1,40}\s*=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*system\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*;\s*\$\w{1,40}\s*=\s*dirname\s*\(\s*__FILE__\s*\)\s*;\s*echo\s*<\s*<\s*<\s*HTML\s*<\s*form\s*enctype\s*="[^"]*"\s*method\s*="[^"]*"\s*>\s*.+?\s*\}\s*else\s*\{\s*print\s*"[^"]*"\s*;\s*\}\s*\}\s*\}\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0242"
    name: "PHP-REX-0242"
    description: "Malware detection signature PHP-REX-0242"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=__FILE__\s*;\s*\$\w{1,40}\s*=__LINE__\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*eval\s*\(\s*\(\s*base64_decode\s*\(\s*''[^'']*''\s*\)\s*\)\s*\)\s*;\s*return\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0243"
    name: "PHP-REX-0243"
    description: "Malware detection signature PHP-REX-0243"
    severity: critical
    category: php_backdoor
    pattern: '\*/\s*["''](\\x2f|/)[\\\-\*\sa-zA-Z0-9_/\.]+?(\.|\\x2e)(p|\\x70)(h|\\x68)(p|\\x70)["''];\s*/\*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0244"
    name: "PHP-REX-0244"
    description: "Malware detection signature PHP-REX-0244"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\(\s*\$\w{1,40}=@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*\.\s*@\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^"'']*["'']\s*\]\s*\)\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0245"
    name: "PHP-REX-0245"
    description: "Malware detection signature PHP-REX-0245"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*header\s*\(\s*"[^"]*"\s*\)\s*;\s*header\s*\(\s*"Pragma: hack"\s*\)\s*;\s*header\s*\(\s*"[^"]*"\s*\.\s*\$\w{1,40}\s*\)\s*;\s*header\s*\(\s*"[^"]*"\s*\.\s*\(\s*string\s*\)\s*\(\s*filesize\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*;\s*header\s*\(\s*''[^'']*''\s*\.\s*\$\w{1,40}\s*\.\s*''[^'']*''\s*\)\s*;\s*header\s*\(\s*"[^"]*"\s*\)\s*;\s*readfile\s*\(\s*\$\w{1,40}\s*\)\s*;\s*exit\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0246"
    name: "PHP-REX-0246"
    description: "Malware detection signature PHP-REX-0246"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*/\*[^*]+\*/\s*\$\w+\s*=[''"][^''"]+[''"];\s*\$\w+\s*=\s*str_rot13\s*\(\s*gzinflate\s*\(\s*str_rot13\s*\(\s*base64_decode\s*\(\s*\$\w+\s*\)\s*\)\s*\)\s*\)\s*;\s*eval\s*\(\s*\$\w+\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0247"
    name: "PHP-REX-0247"
    description: "Malware detection signature PHP-REX-0247"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*&&\s*array_map\s*\(\s*"[^"]*"\s*,\s*\(\s*array\s*\)\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0248"
    name: "PHP-REX-0248"
    description: "Malware detection signature PHP-REX-0248"
    severity: critical
    category: php_backdoor
    pattern: 'isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]*[''"]\s*\]\s*\)\s*&&\s*\(\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''][^"'']*[''"]\s*\]\s*\)\s*&&\s*@preg_replace\s*\(\s*[''"][^''"]*e[''"]\s*,\s*[^,]+\s*,\s*[''][^"'']*['']\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0249"
    name: "PHP-REX-0249"
    description: "Malware detection signature PHP-REX-0249"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^''"]*[''"]\s*\]\s*;\s*echo\s*\$\w{1,40}\s*=\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\?\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*:["''][^"'']*[''"]\s*;\s*\$\w{1,40}\s*=\s*[''"][^''"]*[''"]\s*;\s*foreach\s*\(\s*array\s*\(\s*\$\w{1,40}\s*\)\s*as\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*\.\s*=\$\w{1,40}\s*;\s*\}\s*ob_start\s*\(\s*\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*echo\s*\$\w{1,40}\s*;\s*\}\s*ob_end_flush\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0250"
    name: "PHP-REX-0250"
    description: "Malware detection signature PHP-REX-0250"
    severity: critical
    category: php_backdoor
    pattern: 'print\s*[''"][^'']*["'']\s*;\s*if\s*\(\s*isset\s*\(\s*\$\w{1,40}\s*\[\s*["''][^"'']*[''"]\s*\]\s*\[\s*["''][^"'']*[''"]\s*\]\s*\)\s*\)\s*\{\s*foreach\s*\(\s*\$\w{1,40}\s*\[\s*["''][^"'']*[''"]\s*\]\s*\[\s*["''][^"'']*[''"]\s*\]\s*as\s*\$\w{1,40}\s*=\s*>\s*\$\w{1,40}\s*\)\s*\{\s*if\s*\(\s*\$\w{1,40}\s*==\s*UPLOAD_ERR_OK\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*["''][^"'']*[''"]\s*\]\s*\[\s*\$\w{1,40}\s*\]\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\[\s*["''][^"'']*[''"]\s*\]\s*\[\s*["''][^"'']*[''"]\s*\]\s*\[\s*\$\w{1,40}\s*\]\s*;\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*,\s*["''][^"'']*[''"]\s*\)\s*;\s*\}\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0251"
    name: "PHP-REX-0251"
    description: "Malware detection signature PHP-REX-0251"
    severity: critical
    category: php_backdoor
    pattern: '<\s*\?\s*if\s*\(\s*\$_FILES\[''F1l3''\]\s*\)\s*\{\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*echo\s*''[^'']*''\s*;\s*\}\s*else\s*\{\s*echo\s*''[^'']*''\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0252"
    name: "PHP-REX-0252"
    description: "Malware detection signature PHP-REX-0252"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*["'']<\?php\s*\(["'']\s*;.+?\$\w{1,40}\s*=\s*@fopen\s*\(\s*["''][^''"]*["'']\s*,\s*["''][^''"]*["'']\s*\)\s*;\s*@fwrite\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0253"
    name: "PHP-REX-0253"
    description: "Malware detection signature PHP-REX-0253"
    severity: critical
    category: php_backdoor
    pattern: '\$cookey\s*=\s*"[^"]*"\s*;\s*preg_replace\s*\(\s*["''][^"'']*["'']\s*,\s*["''][^''"]*["'']\s*,\s*["''][^''"]*["'']\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0254"
    name: "PHP-REX-0254"
    description: "Malware detection signature PHP-REX-0254"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*@?\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^"'']*["'']\s*\]\s*==\s*["''][^"'']*["'']\s*\)\s*\{\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*@array_map\s*\(\s*\([^)]+\)\s*,\s*\(\s*array\s*\)\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*HTTP_X\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0255"
    name: "PHP-REX-0255"
    description: "Malware detection signature PHP-REX-0255"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(//header\s*\(\s*''[^'']*''\s*\)\s*;)?\s*\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}=''[^'']*''\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*urldecode\s*\(\s*.+?;\${"(\\x[0-9a-fA-F]{2,3})+"}\s*\["(\\x[0-9a-fA-F]{2,3})+"\]\(\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0256"
    name: "PHP-REX-0256"
    description: "Malware detection signature PHP-REX-0256"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=[^;]+;\s*\$\w{1,40}\s*=\s*create_function\s*\(\s*''[^'']*''\s*,\s*\w+\s*\(\s*base64_decode\s*\(\s*[^)]+\)\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*str_replace\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\]\s*\)\s*\.\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*;\s*function\s*\w+\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\{\s*return\s*\$\w{1,40}\s*\^\s*str_repeat\s*\(\s*\$\w{1,40}\s*,\s*ceil\s*\(\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*/\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0257"
    name: "PHP-REX-0257"
    description: "Malware detection signature PHP-REX-0257"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*header\s*\(\s*''[^'']*''\s*\)\s*;\s*exit\s*;\s*\}\s*\?>\s*<\s*\?\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*=\s*Array\s*\(\s*base64_decode\s*\(\s*''[^'']*''\s*\.\s*''[^'']*''\s*\)\s*,\s*base64_decode\s*\(\s*[^{]+{\s*\$\w{1,40}\s*=\s*Array\([^>]+>\s*<\?php\s*\$\w{1,40}\s*=_\d+\s*\(\s*\d+\s*\)\s*;\s*.+?\s*,\s*\$\w{1,40}\s*,\s*_\d+\s*\(\s*\d+\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0258"
    name: "PHP-REX-0258"
    description: "Malware detection signature PHP-REX-0258"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\s*\{\s*\$\w{1,40}\s*\}\s*=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[[^;]+;\s*\w+\$\s*\{\s*\$\w{1,40}\s*\}\s*\.\s*"[^"]*"\s*;\s*Smarty3::redirect\s*\(\s*[^)]+\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0259"
    name: "PHP-REX-0259"
    description: "Malware detection signature PHP-REX-0259"
    severity: critical
    category: php_backdoor
    pattern: '^\s*<\?php\s*header\s*\(\s*''Location:\s*https?://[^/]+/\?a=\w+&c=\w+''\s*\)\s*;\s*\?>\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0260"
    name: "PHP-REX-0260"
    description: "Malware detection signature PHP-REX-0260"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*==\s*"[^"]*"\s*\)\s*\{\s*\$\w{1,40}\s*=\s*file_get_contents\s*\(\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*=\s*fopen\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*fwrite\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*fopen\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*fwrite\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0261"
    name: "PHP-REX-0261"
    description: "Malware detection signature PHP-REX-0261"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*/\*\s*\w+\s*\*/\s*header\s*\(\s*"Location:\s*http[^"]*"\s*\)\s*;\s*/\*\s*\w+\s*\*/\s*exit\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0262"
    name: "PHP-REX-0262"
    description: "Malware detection signature PHP-REX-0262"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*if\s*\(\s*@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==''[^'']*''\s*\)\s*\{\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*file_exists.+?file_exists\s*\(\s*\$\w{1,40}\s*\)\s*\?\s*@filemtime\s*\(\s*\$\w{1,40}\s*\)\s*:\$\w{1,40}\s*;\s*@file_put_contents\s*\(\s*\$\w{1,40}\s*,\s*''[^'']*''\s*\.\s*base64_encode\s*\(\s*\$\w{1,40}\s*\)\s*,\s*FILE_APPEND\s*\)\s*;\s*@touch\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0263"
    name: "PHP-REX-0263"
    description: "Malware detection signature PHP-REX-0263"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}-\s*>\s*sendCcNumber\s*\(\s*\)\s*;\s*return\s*\$\w{1,40}\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0264"
    name: "PHP-REX-0264"
    description: "Malware detection signature PHP-REX-0264"
    severity: critical
    category: php_backdoor
    pattern: 'class\s*Ma\w+\s*extends\s*Mage_\w+\s*\{\s*public\s*function\s*indexAction\s*\(\s*\)\s*\{\s*@?eval\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0265"
    name: "PHP-REX-0265"
    description: "Malware detection signature PHP-REX-0265"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]+["'']\s*\]\s*\)\s*\)\s*\{\s*echo\s*.+?\s*\}\s*else\s*\{\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*["''][^''"]+["'']\s*\]\s*\[\s*["''][^''"]+["'']\s*\]\s*,\s*["''][^"'']*["'']\s*\.\s*\$\w{1,40}\s*\[\s*["''][^"'']+["'']\s*\]\s*\[\s*["''][^''"]+["'']\s*\]\s*\)\s*;\s*echo[^$]+\$_FILES\s*\[\s*["''][^"'']+["'']\s*\]\s*\[\s*["''][^"'']+["'']\s*\]\s*;\s*echo\s*["''][^''"]+["'']\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0266"
    name: "PHP-REX-0266"
    description: "Malware detection signature PHP-REX-0266"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*"[^"]*"\s*;\s*(passthru|exec|shell_exec|popen|system|eval)\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0267"
    name: "PHP-REX-0267"
    description: "Malware detection signature PHP-REX-0267"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,40}\s*="[^"]*"\s*;\s*)+\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\)\s*;\s*if\s*\(\s*!empty\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*foreach\s*\(.+?\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*CURLOPT_URL\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*CURLOPT_POST\s*,\s*1\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*CURLOPT_POSTFIELDS\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0268"
    name: "PHP-REX-0268"
    description: "Malware detection signature PHP-REX-0268"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*/\*\*\s*\*\s*Plugin\s*Name:\s*Login\s*Wall.+?\s*;\s*exit\s*\(\s*\)\s*;\s*\}\s*exit\s*\(\s*\)\s*;\s*\}\s*add_action\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*,\s*0\s*\)\s*;\s*add_action\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0269"
    name: "PHP-REX-0269"
    description: "Malware detection signature PHP-REX-0269"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\s*\(\s*E_ALL\s*\)\s*;\s*ini_set\s*\(\s*''[^'']*''\s*,\s*1\s*\)\s*;\s*function\s*str_between.+magento\s*not\s*found''[^'']*''Content-type:\s*application/json''\s*\)\s*;\s*echo\s*json_encode\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0270"
    name: "PHP-REX-0270"
    description: "Malware detection signature PHP-REX-0270"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*die\s*\(\s*pi\s*\(\s*\)\s*\)\s*;\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*="[^"]*"\s*;.+eval\s*\(\s*\$\s*\{\s*\$\w{1,40}\s*\}\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*\}\s*exit\s*\(\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0271"
    name: "PHP-REX-0271"
    description: "Malware detection signature PHP-REX-0271"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=["''][^''"]+["'']\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*header\s*\(\s*"[^"]*"\s*\)\s*;\s*@date_default_timezone_set\s*\(\s*"[^"]*"\s*\)\s*;\s*@ini_set\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*error_reporting\s*\(\s*E_ALL\s*\)\s*;\s*ini_set\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\?\s*l1HXxk0\s*\(\s*\)\s*:l11x\s*\(\s*\)\s*;\s*l15Oe\s*\(\s*\)\s*;\s*\$\w{1,40}\s*=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*;\s*\$\w{1,40}\s*=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*;.+?break\s*;\s*\}\s*\$\w{1,40}\s*=\$\w{1,40}\s*<\s*0\s*\?\s*abs\s*\(\s*\$\w{1,40}\s*\)\s*:\$\w{1,40}\s*;\s*\$\w{1,40}%=\$\w{1,40}\s*;\s*return\s*\$\w{1,40}\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0272"
    name: "PHP-REX-0272"
    description: "Malware detection signature PHP-REX-0272"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s+getBot\(\s*\$\w{1,40}\s*\).+if\s*\(\s*@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*==\s*"[^"]*"\s*\)\s*\{\s*if\s*\(\s*@?(copy|move_uploaded_file)\s*\(\s*\$_FILES\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*,\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*echo\s*"[^"]*"\s*;\s*\}\s*else\s*\{\s*echo\s*"[^"]*"\s*;\s*\}\s*\}\s*\}\s*else\s*\{\s*exit\s*\(\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0273"
    name: "PHP-REX-0273"
    description: "Malware detection signature PHP-REX-0273"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*str_rot13\s*\(\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*\.\s*=''[^'']*''\s*\.\s*\$\w{1,40}\s*;\s*@\$\w{1,40}\s*\(\s*\$\w+\s*\(.+?\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0274"
    name: "PHP-REX-0274"
    description: "Malware detection signature PHP-REX-0274"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^"'']+["'']\s*\]\s*==\s*"[^"]*"\s*\)\s*\{\s*\$\w{1,40}\s*=\s*file_get_contents\s*\(\s*["''][^"'']*["'']\s*\)\s*;\s*\$\w{1,40}\s*=\s*fopen\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*fwrite\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*fopen\s*\(\s*[''"][^"'']+[''"]\s*,\s*"[^"]*"\s*\)\s*;\s*fwrite\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*echo\s*["''][^''"]+["'']\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0275"
    name: "PHP-REX-0275"
    description: "Malware detection signature PHP-REX-0275"
    severity: critical
    category: php_backdoor
    pattern: '<\s*\?\s*if\s*\(\s*!isset\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*@import_request_variables\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*\}\s*if\s*\(\s*md5\s*\(\s*\$\w{1,40}\s*\)\s*!=''[^'']*''\s*\)\s*\{\s*echo\s*"[^"]*"\s*;\s*\}\s*else\s*\{\s*if\s*\(\s*get_magic_quotes_gpc\s*\(\s*\)\s*\)\s*\$\w{1,40}\s*=\s*stripslashes\s*\(\s*\$\w{1,40}\s*\)\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*;\s*return\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0276"
    name: "PHP-REX-0276"
    description: "Malware detection signature PHP-REX-0276"
    severity: critical
    category: php_backdoor
    pattern: 'require_once\s*\(\s*findsysfolder\s*\(\s*__FILE__\s*\)\s*\.\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\w+\s*\(\s*\w+\s*\(\s*__FILE__\s*\)\s*\)\s*;\$\w+=''[^'']+'';\$\w{1,40}\s*=''[^'']*''\s*;\s*eval\s*\(\s*\w+\s*\(\s*[''"][^''"]*[''"]\s*,\s*\$\w{1,40}\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0277"
    name: "PHP-REX-0277"
    description: "Malware detection signature PHP-REX-0277"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!function_exists\s*\(\s*''[^'']*''\s*\)\s*\)\s*\{\s*function\s*findsysfolder\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*dirname\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\.\s*''[^'']*''\s*;\s*clearstatcache\s*\(\s*\)\s*;\s*if\s*\(\s*!is_dir\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*return\s*findsysfolder\s*\(\s*\$\w{1,40}\s*\)\s*;\s*else\s*return\s*\$\w{1,40}\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0278"
    name: "PHP-REX-0278"
    description: "Malware detection signature PHP-REX-0278"
    severity: critical
    category: php_backdoor
    pattern: '<\?(php)?\s*\$\w+\s*=(\s*chr\(\s*\d+\s*\)\s*\.?\s*)+\s*;\s*(\s*\$\w+\s*=(\$\w+\(\s*\d+\s*\)\s*\.?\s*){10,};\s*){2,}\$\w+=\$\w+\s*\(\s*["'']+\s*,\s*\$\w+\s*\)\s*;\s*@\$\w+\(\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0279"
    name: "PHP-REX-0279"
    description: "Malware detection signature PHP-REX-0279"
    severity: critical
    category: php_backdoor
    pattern: '<\s*\?\s*\$\w{1,40}\s*="[^"]*"\s*;\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*pass\s*\]\s*==\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*getcwd\s*\(\s*\)\s*;\s*Echo.+?<input\s+type="submit" name="\w+"\s+value="go!"\s+/></form>\s*<\?php\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0280"
    name: "PHP-REX-0280"
    description: "Malware detection signature PHP-REX-0280"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*error_reporting\s*\(\s*E_ALL\s*\)\s*;\s*@ini_set\s*\(\s*''[^'']*''\s*,\s*TRUE\s*\)\s*;\s*@ini_set\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*;\s*@set_time_limit\s*\(\s*\d+\s*\)\s*;.+?http_build_query\s*\(\s*array\s*\(\s*''[^'']*''\s*=\s*>\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*\)\s*;\s*\$\w{1,40}\s*=\s*stream_context_create\s*\(\s*\$\w{1,40}\s*\)\s*;\s*return\s*file_get_contents\s*\(\s*\$\w{1,40}\s*,\s*false\s*,\s*\$\w{1,40}\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0281"
    name: "PHP-REX-0281"
    description: "Malware detection signature PHP-REX-0281"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*&&\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*echo\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*[*+/-^]\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0282"
    name: "PHP-REX-0282"
    description: "Malware detection signature PHP-REX-0282"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*md5\s*\(\s*@?\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*==[''"][^''"]*[''"]\s*\)\s*\(\s*\$\w{1,40}=@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*\.\s*@\$\w{1,40}\s*\(\s*stripslashes\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0283"
    name: "PHP-REX-0283"
    description: "Malware detection signature PHP-REX-0283"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[[^]]+\]\s*=\s*\$_SERVER;\s*function\s*\w+\(\$\w+\)\s*{\s*\$\w+\s*=\s*["''][''"]\s*;\s*global.+?\(\s*\$url\s*,\s*FALSE\s*,\s*\${\s*\w+\(\s*[^)]+\)\s*}\s*\);\s*return\s*\${\s*\w+\(\s*[^)]+\)\s*}\s*;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0284"
    name: "PHP-REX-0284"
    description: "Malware detection signature PHP-REX-0284"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*php\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"login"\s*\]\s*=="[^"]*"\s*\)\s*\{\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;.+?<\s*form\s*enctype\s*="[^"]*"\s*method\s*="[^"]*"\s*>\s*<\s*input\s*name\s*="[^"]*"\s*type\s*="[^"]*"/\s*>\s*<\s*input\s*type\s*="[^"]*"\s*value\s*="[^"]*"/\s*>\s*<\s*/form\s*>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0285"
    name: "PHP-REX-0285"
    description: "Malware detection signature PHP-REX-0285"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*\$GLOBALS\[''_\d+_''\]=Array\(base64_decode\(.+\$password=_\d+\(0\);\$GLOBALS\[''_\d+_''\]\[\d+\]\(_\d+\(\d+\),_\d+\(\d+\),_\d+\(\d+\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0286"
    name: "PHP-REX-0286"
    description: "Malware detection signature PHP-REX-0286"
    severity: critical
    category: php_backdoor
    pattern: '\#!/usr/bin/env.+?\]\s*\[\s*\d+\s*\]\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*_\d+\s*\(\s*9\s*\)\s*\]\s*\)\s*;\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*\d+\s*\]\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\}\s*echo\s*\$\w{1,40}\s*;\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0287"
    name: "PHP-REX-0287"
    description: "Malware detection signature PHP-REX-0287"
    severity: critical
    category: php_backdoor
    pattern: 'define\s*\(\s*''[^'']*''/''[^'']*''\s*,\s*DIRECTORY_SEPARATOR\s*\)\s*;\s*\$\w{1,40}\s*=\s*realpath\s*\(\s*dirname\s*\(\s*__FILE__\s*\)\s*\.\s*[^)]+\)\s*;\s*if\s*\(\s*!file_exists\s*\(\s*\$\w{1,40}\s*\.\s*[^)]+\)\s*&&\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*[^)]+\)\s*;\s*\}\s*define\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0288"
    name: "PHP-REX-0288"
    description: "Malware detection signature PHP-REX-0288"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*("[^"]*"\s*\.)?\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*array\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*@array_filter\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*exit\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0289"
    name: "PHP-REX-0289"
    description: "Malware detection signature PHP-REX-0289"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*php\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\(\s*htmlspecialchars\s*\(\s*file_get_contents\s*\(\s*''[^'']*''\s*\)\s*\)\s*\)\s*;\s*echo\s*\$\w{1,40}\s*;\s*\}\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\(\s*htmlspecialchars\s*\(\s*file_get_contents\s*\(\s*''[^'']*''\s*\)\s*\)\s*\)\s*;\s*echo\s*\$\w{1,40}\s*;\s*\}(\s*//file\s*end)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0290"
    name: "PHP-REX-0290"
    description: "Malware detection signature PHP-REX-0290"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s/\*\s*--\s*enphp.+unset\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\)\s*;\s*\}\s*echo\s*\$\w{1,40}\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0291"
    name: "PHP-REX-0291"
    description: "Malware detection signature PHP-REX-0291"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w+=[^;]+;)+@\$\w+\(@\$\w+\(@\$\w+\(\$_(GET|POST|COOKIE|REQUEST|SERVER)\[[^]]+\]\)\)\);die\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0292"
    name: "PHP-REX-0292"
    description: "Malware detection signature PHP-REX-0292"
    severity: critical
    category: php_backdoor
    pattern: '(\$arr_word\[\d+\]\[\]\s*=\s*"\d+";){10,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0293"
    name: "PHP-REX-0293"
    description: "Malware detection signature PHP-REX-0293"
    severity: critical
    category: php_backdoor
    pattern: '//insta\w+\s*(require|include|require_once|include_once)\(["''][^''"]+[''"]\);\s*//insta\w+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0294"
    name: "PHP-REX-0294"
    description: "Malware detection signature PHP-REX-0294"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*php\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*;\s*function\s*\w+\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*global\s+\$\w.+@\$\s*\{\s*\w+\s*\(\s*"[^"]*"\s*\)\s*\}\s*\(\s*\$\w{1,40}\s*,\s*FALSE\s*,\s*\$\s*\{\s*\w+\s*\(\s*"[^"]*"\s*\)\s*\}\s*\)\s*;\s*return\s*\$\s*\{\s*\w+\s*\(\s*"[^"]*"\s*\)\s*\}\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0295"
    name: "PHP-REX-0295"
    description: "Malware detection signature PHP-REX-0295"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$str\s*=\s*''PGRpdi[^'']+'';\s*echo\s+base64_decode\(\$str\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0296"
    name: "PHP-REX-0296"
    description: "Malware detection signature PHP-REX-0296"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^"'']*["'']\s*\]\s*==["''][^''"]*["'']\s*\)\s*\{\s*echo\s*\w+\s*;\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*if\s*\(\s*\$\w{1,40}!="[^"]*"\s*\)\s*\{\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*@?eval\s*\(\s*["''][^"'']*["'']\s*\)\s*;\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0297"
    name: "PHP-REX-0297"
    description: "Malware detection signature PHP-REX-0297"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*="[^"]*"\s*;.+?\s*;\s*eval\s*\(\s*\$\s*\{\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*\}\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0298"
    name: "PHP-REX-0298"
    description: "Malware detection signature PHP-REX-0298"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*\$\w{1,40}\s*==''upload''\s*\)\s*\{\s*if\s*\(\s*is_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*,\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*echo\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*;\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0299"
    name: "PHP-REX-0299"
    description: "Malware detection signature PHP-REX-0299"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0300"
    name: "PHP-REX-0300"
    description: "Malware detection signature PHP-REX-0300"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\s*\(\s*base64_decode\s*\(\s*\w+[^)]{1000,}\)\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0301"
    name: "PHP-REX-0301"
    description: "Malware detection signature PHP-REX-0301"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*[''"][^"'']*[''"]\s*;\s*\$\w{1,40}\s*=\s*[''"][^"'']*["'']\s*;\s*\$\w{1,40}\s*=\s*array\s*\((\s*\d+\s*,\s*){2,}\s*\d+\s*\)\s*;\s*foreach\s*\(\s*\$\w{1,40}\s*as\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*\.\s*=\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*;\s*\}\s*\$\w{1,40}\s*=\s*strrev\s*\([^)]+\)\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\)\s*;\s*return\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0302"
    name: "PHP-REX-0302"
    description: "Malware detection signature PHP-REX-0302"
    severity: critical
    category: php_backdoor
    pattern: 'include\s*\(\s*dirname\s*\(\s*__FILE__\s*\)\s*\.\s*''/includes/_bb_press_plugin.class.php''\s*\)\s*;\s*register_activation_hook\s*\(\s*__FILE__\s*,\s*array\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*\)\s*;\s*//\s*M\s*register_deactivation_hook\s*\(\s*__FILE__\s*,\s*array\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*\)\s*;\s*add_filter\s*\(\s*''[^'']*''\s*,\s*array\s*\(\s*\$\w{1,40}\s*,\s*''[^'']*''\s*\)\s*,\s*10\s*,\s*3\s*\)\s*;\s*add_action\s*\(\s*''[^'']*''\s*,\s*array\s*\(\s*\$\w{1,40}\s*,\s*''[^'']*''\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0303"
    name: "PHP-REX-0303"
    description: "Malware detection signature PHP-REX-0303"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*eval\s*\(base64_decode\s*\(\s*(str_replace\s*\(\s*[''"][^''"]+[''"]\s*,\s*[''"][^''"]+[''"]\s*\s*,)+\s*[''"][^''"]+[''"]\s*(\)\s*)+;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0304"
    name: "PHP-REX-0304"
    description: "Malware detection signature PHP-REX-0304"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]*"\s*;\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*==\s*\$\w{1,40}\s*\)\s*\{\s*@set_time_limit\s*\(\s*\d+\s*\)\s*;\s*\$\w{1,40}\s*="[^"]*"\s*\.\s*"[^"]*".+?<\s*form\s*method\s*="[^"]*"\s*enctype\s*="multipart/form-data"\s*>\s*<\s*input\s*name\s*="[^"]*"\s*type\s*="[^"]*"\s*>\s*<\s*input\s*type\s*="[^"]*"\s*value\s*="[^"]*"\s*>\s*<\s*/form\s*>\s*<\?php\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0305"
    name: "PHP-REX-0305"
    description: "Malware detection signature PHP-REX-0305"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*require_once\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\.\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}-\s*>\s*Authorize\s*\(\s*1\s*\)\s*;\s*require_once\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\.\s*"[^"]*"\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0306"
    name: "PHP-REX-0306"
    description: "Malware detection signature PHP-REX-0306"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*extract\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*,\s*\d+\s*\)\s*;\s*strripos\s*\(\s*@sha1\s*\(\s*\$\w{1,40}\s*\)\s*,\s*"[^"]*"\s*\)\s*==\s*\d+\s*&&\s*@\$\w{1,40}\s*\(\s*stripslashes\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0307"
    name: "PHP-REX-0307"
    description: "Malware detection signature PHP-REX-0307"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=\s*(\$\w{1,40}\s*\[\s*\d+\s*\]\s*\.?\s*){3,};\s*\$\w+\((\$\w{1,40}\s*\[\s*\d+\s*\]\s*\.?\s*){3,}\s*,\s*\$\w+\s*,\s*[''"]+\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0309"
    name: "PHP-REX-0309"
    description: "Malware detection signature PHP-REX-0309"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*for\s*\(\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*<\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*-\d+\s*;\s*\$\w{1,40}\+=\s*\d+\s*\)\s*\{\s*\$\w{1,40}\s*\.\s*=\s*chr\s*\(\s*hexdec\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\.\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\+\d+\s*\]\s*\)\s*\)\s*;\s*\}\s*preg_replace\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*,\s*''[^'']*''\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0310"
    name: "PHP-REX-0310"
    description: "Malware detection signature PHP-REX-0310"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s*clear_folder\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*if\s*\(\s*is_dir\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*if\s*\(\s*\$\w{1,40}\s*=\s*opendir\s*\(\s*\$\w{1,40}\s*\)\s*\).+\s*\(\s*is_dir\s*\(\s*''[^'']*''\s*\)\s*\)\s*rmdir\s*\(\s*"[^"]*"\s*\)\s*;\s*if\s*\(\s*is_dir\s*\(\s*''[^'']*''\s*\)\s*\)\s*echo\s*"[^"]*"\s*;\s*else\s*echo\s*"[^"]*"\s*;\s*exit\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0311"
    name: "PHP-REX-0311"
    description: "Malware detection signature PHP-REX-0311"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\(\s*htmlspecialchars\s*\(\s*file_get_contents\s*\(\s*''[^'']*''\s*\)\s*\)\s*\)\s*;\s*echo\s*\$\w{1,40}\s*;\s*\}\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\(\s*htmlspecialchars\s*\(\s*file_get_contents\s*\(\s*''[^'']*''\s*\)\s*\)\s*\)\s*;\s*echo\s*\$\w{1,40}\s*;\s*\}(\s*//file\s*end)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0312"
    name: "PHP-REX-0312"
    description: "Malware detection signature PHP-REX-0312"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+css\(\$i\)\s*{\s*\$\w+\s*=\s*"[^"]+";\s*\$xml_content=file_get_contents\(\$\w+\.\$\w+\);\s*\$\w+\s*=\s*array\((\s*"[^"]+"\s*,?)+\);\s*reset\(\$\w+\);.+?echo\s*\$xml_content;(\s*exit\(\);)?\s*}\s*}\s*}\s*(css\(\s*''[^'']+''\s*\);)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0313"
    name: "PHP-REX-0313"
    description: "Malware detection signature PHP-REX-0313"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+=''[^'']+'';\s*\$\w+=(\$\w+\{\d+\}\.?){3,};(\s*\$\w+\s*=(\$\w+\{\d+\}\.?)+;)+\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0314"
    name: "PHP-REX-0314"
    description: "Malware detection signature PHP-REX-0314"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*array\s*\((\s*[''"].[''"]\s*,?){1,}\s*\)\s*;\s*\$\w{1,40}\s*=\s*create_function\s*\(((\s*[''"].[''"]\s*\.?)\s*,\s*?){1,}\s*,\s*(\$\w{1,40}\[\d+\]\.?)+\)\s*;\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0315"
    name: "PHP-REX-0315"
    description: "Malware detection signature PHP-REX-0315"
    severity: critical
    category: php_backdoor
    pattern: '@?file_get_contents\("[^"]+"\s*\.\s*\$_SERVER\[''HTTP_REFERER''\]\s*\.\s*"&\w+=http://"\s*\.\s*\$_SERVER\[''SERVER_NAME''\]\s*\.\s*"/[^"]+"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0316"
    name: "PHP-REX-0316"
    description: "Malware detection signature PHP-REX-0316"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*@?\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*=="[^"]*"\s*\)\s*\{\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*@?array_map\s*\(\s*\([^)]+\)\s*,\s*\(\s*array\s*\)\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*HTTP_X\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0317"
    name: "PHP-REX-0317"
    description: "Malware detection signature PHP-REX-0317"
    severity: critical
    category: php_backdoor
    pattern: '(GIF\d+a\+\s*)?<\?\s*php\s*eval\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0318"
    name: "PHP-REX-0318"
    description: "Malware detection signature PHP-REX-0318"
    severity: critical
    category: php_backdoor
    pattern: 'copy\(''http://.+?''\s*,\s*''\w+\.php''\);exit;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0319"
    name: "PHP-REX-0319"
    description: "Malware detection signature PHP-REX-0319"
    severity: critical
    category: php_backdoor
    pattern: '\$wp_nonce=isset\(\$_POST\[\$_SERVER{\$_SERVER{.+?unset\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\)\s*;\s*\}\s*echo\s+\$wp_auth_check;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0320"
    name: "PHP-REX-0320"
    description: "Malware detection signature PHP-REX-0320"
    severity: critical
    category: php_backdoor
    pattern: '/\s*\*\w+\s*\*/\s*@include\s*"[^"]*"\s*;\s*/\s*\*\w+\s*\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0322"
    name: "PHP-REX-0322"
    description: "Malware detection signature PHP-REX-0322"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*(\$\w{1,40}\s*\.?){2,}\s*\)\s*\)\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\)\s*;\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0323"
    name: "PHP-REX-0323"
    description: "Malware detection signature PHP-REX-0323"
    severity: critical
    category: php_backdoor
    pattern: '<div\s+id="\w+">\s*(<a\s+href=''[^'']+''\s+title=''[^'']+''>[^<]+</a>\s*){20,}<script>\s*eval.+?</script>\s*</div>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0324"
    name: "PHP-REX-0324"
    description: "Malware detection signature PHP-REX-0324"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*php\s*\(\s*\$\w{1,40}=@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\d+\s*\]\s*\)\s*\.\s*@\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\d+\s*\]\s*\)\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0325"
    name: "PHP-REX-0325"
    description: "Malware detection signature PHP-REX-0325"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*if\s*\(\s*\$\w{1,40}!=''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*@eval\s*\(\s*"[^"]*"\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0326"
    name: "PHP-REX-0326"
    description: "Malware detection signature PHP-REX-0326"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*php\s*eval\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\d+\s*\]\s*\)\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0327"
    name: "PHP-REX-0327"
    description: "Malware detection signature PHP-REX-0327"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*if\s*\(\s*function_exists\s*\(\s*''[^'']*''\s*\)\s*\)\s*\{\s*set_time_limit\s*\(\s*\d+\s*\).+?echo\s*\$\w{1,40}\s*;\s*@file_get_contents\s*\(\s*''[^'']*''\s*\.\s*\$\w{1,40}\s*\.\s*''[^'']*''\s*\.\s*\$\w{1,40}\s*\)\s*;\s*\}\s*exit\s*\(\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0328"
    name: "PHP-REX-0328"
    description: "Malware detection signature PHP-REX-0328"
    severity: critical
    category: php_backdoor
    pattern: '<\s*\?\s*eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*''[^'']{1000,}''\s*\)\s*\)\s*\)\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0330"
    name: "PHP-REX-0330"
    description: "Malware detection signature PHP-REX-0330"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*=="[^"]*"\s*\)\s*\{\s*echo\s*success\s*;\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*if\s*\(\s*\$\w{1,40}!="[^"]*"\s*\)\s*\{\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*@?eval\s*\(\s*"[^"]*"\s*\)\s*;\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0331"
    name: "PHP-REX-0331"
    description: "Malware detection signature PHP-REX-0331"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*&&\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*&&\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==\s*''[^'']*''\s*\)\s*\)\s*\{\s*switch\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\{\s*case.+?print\s*stripslashes\s*\(\s*\$\w{1,40}\s*->\s*content\s*\)\s*;\s*get_search_form\s*\(\s*\)\s*;\s*get_sidebar\s*\(\s*\)\s*;\s*get_footer\s*\(\s*\)\s*;\s*\}\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0332"
    name: "PHP-REX-0332"
    description: "Malware detection signature PHP-REX-0332"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*="[^"]*"\s*;\s*\$\s*\{\s*.+?\s*;\s*eval\s*\(\s*\$\s*\{\s*\$\w{1,40}\s*\}\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*\}\s*exit\s*\(\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0333"
    name: "PHP-REX-0333"
    description: "Malware detection signature PHP-REX-0333"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=\s*array\s*\(\s*.+?preg_split\s*\(\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*,\s*-1\s*,\s*PREG_SPLIT_NO_EMPTY\s*\)\s*;\s*foreach\s*\(\s*\$\w{1,40}\s*as\$\w{1,40}\s*=>\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*=\s*chr\s*\(\s*ord\s*\(\s*\$\w{1,40}\s*\)\s*-3\s*\)\s*;\s*\}\s*\$\w{1,40}\s*=\s*implode\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\$\w{1,40}\s*=\$\w{1,40}\s*\[\s*\d+\s*\]\s*\.\s*\$\w{1,40}\s*\.\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*;\s*\}\s*return\s*\$\w{1,40}\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0334"
    name: "PHP-REX-0334"
    description: "Malware detection signature PHP-REX-0334"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*4\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*for\s*\(\s*\$\w{1,40}\s*=\s*0\s*;\s*\$\w{1,40}<\$\w{1,40}\s*;\s*\$\w{1,40}\+\+\s*\)\s*\$\w{1,40}\s*\.\s*=\s*chr\s*\(\s*ord\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*\^\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*fopen\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*fputs\s*\(\s*\$\w{1,40}\s*,\s*"[^"]*"\s*\)\s*;\s*include\s*\(\s*"[^"]*"\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*fopen\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0335"
    name: "PHP-REX-0335"
    description: "Malware detection signature PHP-REX-0335"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*\d+\+\d+\s*;\s*\$\w{1,40}\s*=\s*base64_decode\s*\([^;]+;\s*\$\w{1,40}\s*=\s*base64_decode\s*\([^;]+;\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*base64_decode\s*\([^;]+;\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*base64_decode\s*\([^\]]+\]\s*==\s*base64_decode\s*\([^}]+\{\s*@\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\[\s*base64_decode\s*\(.+?\)\s*\]\s*\)\s*;\s*\}\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0336"
    name: "PHP-REX-0336"
    description: "Malware detection signature PHP-REX-0336"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*array\s*\((\s*\d+\s*,\s*){3,}\d+\s*\)\s*;\s*foreach\s*\(\s*\$\w{1,40}\s*as\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*\.\s*=\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*;\s*\}\s*\$\w{1,40}\s*=\s*strrev\s*\([^)]+\)\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\)\s*;\s*exit\s*\(\s*\)\s*;\s*\}\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0337"
    name: "PHP-REX-0337"
    description: "Malware detection signature PHP-REX-0337"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]*"\s*;\s*eval\s*\(\s*base64_decode\s*\(\s*gzuncompress\s*\(\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0338"
    name: "PHP-REX-0338"
    description: "Malware detection signature PHP-REX-0338"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,20}\s*=\s*[''"][^''"]+["'']\s*;\s*\$\w{1,20}\s*=(?:\$\w{1,20}\[\s*\d{1,5}\s*\]\s*\.?\s*){3,}.+?include[^?]+\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0339"
    name: "PHP-REX-0339"
    description: "Malware detection signature PHP-REX-0339"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,20}\s*=\s*[''"][^''"]+["'']\s*;\s*if\s*\(\s*isset\s*\(\s*\${\s*(\$\w{1,20}\[\s*\d+\s*\]\s*\.?\s*){3,}\s*\}\s*\[\s*(\$\w{1,20}\[\s*\d+\s*\]\s*\.?\s*){3,}\s*\]\s*\)\s*\)\s*{\s*eval\(\s*\${\s*(\$\w{1,20}\[\s*\d+\s*\]\s*\.?\s*){3,}\s*\}\[\s*(\$\w{1,20}\[\s*\d+\s*\]\s*\.?\s*){3,}\s*\]\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0340"
    name: "PHP-REX-0340"
    description: "Malware detection signature PHP-REX-0340"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}="\w{1,20}";if\(!empty\(\$_(REQUEST|GET|POST|COOKIE)\[\$\w+\]\)\){\$[^@]+@\$\w+\(stripslashes\(\$_(REQUEST|GET|POST|COOKIE)\[\$\w+\]\)\);}else\s*@unlink\(__FILE__\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0341"
    name: "PHP-REX-0341"
    description: "Malware detection signature PHP-REX-0341"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,20}=\$_POST\[\w{1,20}\];echo\s*eval\(\$\w{1,20}\);echo "404 Not Found";\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0342"
    name: "PHP-REX-0342"
    description: "Malware detection signature PHP-REX-0342"
    severity: critical
    category: php_backdoor
    pattern: '(/\*[^*]+\*/)?if(/\*[^*]+\*/)?(/\*[^*]+\*/)?\((/\*[^*]+\*/)?isset\((/\*[^*]+\*/)?\$_(REQUEST|GET|POST|SERVER|COOKIE)\[[''"]\w{1,20}[''"]\](/\*[^*]+\*/)?\)(/\*[^*]+\*/)?\)(/\*[^*]+\*/)?{(/\*[^*]+\*/)?\$_(REQUEST|GET|POST|SERVER|COOKIE)(/\*[^*]+\*/)?\[[''"]\w{1,20}[''"]\]\((/\*[^*]+\*/)?\$_(REQUEST|GET|POST|SERVER|COOKIE)\["\w{1,20}"\](/\*[^*]+\*/)?\)(/\*[^*]+\*/)?;(/\*[^*]+\*/)?(/\*[^*]+\*/)?exit(/\*[^*]+\*/)?;(/\*[^*]+\*/)?}(/\*[^*]+\*/)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0343"
    name: "PHP-REX-0343"
    description: "Malware detection signature PHP-REX-0343"
    severity: critical
    category: php_backdoor
    pattern: '(/\*[^*]+\*/)?if(/\*[^*]+\*/)?(/\*[^*]+\*/)?\((/\*[^*]+\*/)?isset\((/\*[^*]+\*/)?\$_(REQUEST|GET|POST|SERVER|COOKIE)\[''\w{1,20}''\](/\*[^*]+\*/)?\)(/\*[^*]+\*/)?\)(/\*[^*]+\*/)?{(/\*[^*]+\*/)?\$\w{1,20}(/\*[^*]+\*/)?=(/\*[^*]+\*/)?["''][assert''".\s]+["''];(/\*[^*]+\*/)?\$\w{1,20}(/\*[^*]+\*/)?=(/\*[^*]+\*/)?\$\w{1,20}(/\*[^*]+\*/)?\((/\*[^*]+\*/)?\$_(REQUEST|GET|POST|SERVER|COOKIE)\[''\w{1,20}''\](/\*[^*]+\*/)?\)(/\*[^*]+\*/)?;(/\*[^*]+\*/)?exit;(/\*[^*]+\*/)?}(/\*[^*]+\*/)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0344"
    name: "PHP-REX-0344"
    description: "Malware detection signature PHP-REX-0344"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,}\s*=\s*[\s_.GET"'']+;\s*if\s*\((!empty|isset)\(\s*\$\{\s*\$\w+\s*\}\[\s*[''"]\w+[''"]\s*\]\s*\)\s*\)\s*preg_replace\(\s*[^,]+\s*,\s*[\s"e.''Val]+\(\s*\$''\s*\.\s*\$\w+\s*\.\s*''\[\s*[''"]\w+[''"]\s*\]\)[''"]\s*,\s*[''"][''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0345"
    name: "PHP-REX-0345"
    description: "Malware detection signature PHP-REX-0345"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(!empty\(\$_FILES\[''\w+''\]\[''\w+''\]\) && \(md5\(\$_POST\[''\w+''\]\) == ''\w{32}''\)\)\s*{\s*\$sc = \(empty\(\$_POST\[''\w+'']\)\).+<br/>Security Code: <br/><input name="\w+" value=""/>\s*<br/>Name:\s*<br/><input name="name" value=""/>\s*<br/>\s*<input type="submit" value="Sent" />\s*</form>\s*</body>\s*</html>'';'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0346"
    name: "PHP-REX-0346"
    description: "Malware detection signature PHP-REX-0346"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\${"\\x[^"]+"}\["[^"]+"\]=.+?\);\s*exit\(\s*\);\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0347"
    name: "PHP-REX-0347"
    description: "Malware detection signature PHP-REX-0347"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*ol\s+Erivfvhz'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0348"
    name: "PHP-REX-0348"
    description: "Malware detection signature PHP-REX-0348"
    severity: critical
    category: php_backdoor
    pattern: 'if \(!defined\(''ALREADY_RUN.+eval\s*(/\*\w+\*/)?\s*\(\s*\w+\s*\(\$\w+\s*,\s*\$\w+\)\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0349"
    name: "PHP-REX-0349"
    description: "Malware detection signature PHP-REX-0349"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,20}\s*=\s*''[^'']+''\s*;\s*){6,}.+(\$\w{1,20}\[\s*[''"]?\d+[''"]?\s*\]\s*\.?\s*){5,}\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0350"
    name: "PHP-REX-0350"
    description: "Malware detection signature PHP-REX-0350"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\$\w+===0\){@\${\w+}\(\$\w+\);}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0351"
    name: "PHP-REX-0351"
    description: "Malware detection signature PHP-REX-0351"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_COOKIE\[[^]]+]\)\s*&&\s*isset\(\$_COOKIE\[[^]]+\]\)\)\s*{.+include\(\$f\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0352"
    name: "PHP-REX-0352"
    description: "Malware detection signature PHP-REX-0352"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+file_get_contents\(''index\.html(\.bak)+''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0355"
    name: "PHP-REX-0355"
    description: "Malware detection signature PHP-REX-0355"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(\$arrUrlId\[''[^'']+''\]=''[^'']+'';\s*)+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0356"
    name: "PHP-REX-0356"
    description: "Malware detection signature PHP-REX-0356"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\s*isset\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\["test_url"\]\s*\)\s*\)\s*{\s*echo "file test okay";\s*}.+\$f\s*=\s*\$a\("",\s*\$array_name\(\$string\)\);\s*\$f\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0357"
    name: "PHP-REX-0357"
    description: "Malware detection signature PHP-REX-0357"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+(\$\w+=base64_decode\(("[a-zA-Z0-9=/]+"|\s|\.|chr\(\d+\))+\);)+eval\(\$\w+\(\$_POST\[base64_decode\(("[a-zA-Z0-9=/]+"|\s|\.|chr\(\d+\))+\)\]\)\);.+base64_decode\(("[a-zA-Z0-9=/]+"|\s|\.|chr\(\d+\))+\)]\);\s*};\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0358"
    name: "PHP-REX-0358"
    description: "Malware detection signature PHP-REX-0358"
    severity: critical
    category: php_backdoor
    pattern: 'ini_set\(''display_errors'',''Off''\);\s*error_reporting\(''E_ALL''\);\s*if\(isset\(\$_FILES\[''u''\]\)\s*&&\s*isset\(\$_POST\[''n''\]\)\)\s*move_uploaded_file\(\$_FILES\[''u''\]\[''tmp_name''\],\$_POST\[''n''\]\);\s*setcookie\(''server'',1,time\(\)\+1e6\);\s*\$s=\$_SERVER;\s*if\(\$server!=1\s*&&\s*\$s\[''HTTP_REFERER''\]\s*&&\s*strpos\(\$s\[''HTTP_REFERER''\],\$s\[''HTTP_HOST''\]\)===false\s*&&\s*\$_COOKIE\[''server''\]!=1\)\s*{\s*\$server=1;\s*eval\(file_get_contents\(base64_decode\(''\w+''\)\.\$s\[''HTTP_HOST''\]\)\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0359"
    name: "PHP-REX-0359"
    description: "Malware detection signature PHP-REX-0359"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,30}\s*=\s*[^;]+;){1,}\s*@\$\w{1,30}\(@\$\w{1,30}\(@\$\w+\(\$_POST\[[^\]]+\]\)\)\);\s*die\(\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0360"
    name: "PHP-REX-0360"
    description: "Malware detection signature PHP-REX-0360"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_POST\[.+@\$\w{1,30}\(@\$\w{1,30}\(@\$\w{1,30}\(\$_POST.+<h2>Error 404</h2>\s*</body>\s*</html>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0362"
    name: "PHP-REX-0362"
    description: "Malware detection signature PHP-REX-0362"
    severity: critical
    category: php_backdoor
    pattern: '<?php\s*\$jquery_start\s*=\s*true;.*?\$jquery_end\s*=\s*true;.*?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0363"
    name: "PHP-REX-0363"
    description: "Malware detection signature PHP-REX-0363"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteEngine\s+On\s*(RewriteCond\s*%{HTTP_REFERER\}\s*\.\*[^.]+\.\*\$\s*\[NC(,OR)?\]\s*)+RewriteRule\s*\.\*\s*http://[^[]+\[R,L\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0364"
    name: "PHP-REX-0364"
    description: "Malware detection signature PHP-REX-0364"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteEngine\s+On\s*RewriteRule\s+\^\(\[A-Za-z0-9-\]\+\)\.html\$\s+\w+\.php\?br=\$1\s+\[L\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0365"
    name: "PHP-REX-0365"
    description: "Malware detection signature PHP-REX-0365"
    severity: critical
    category: php_backdoor
    pattern: '<IfModule mod_rewrite\.c>\s*RewriteEngine On\s*RewriteCond %{HTTP_REFERER}\s+\^\.\*\([^)]+\)\\.\(\.\*\)\s*RewriteCond\s*%{HTTP_USER_AGENT}\s*\^\.\*\(msie\|opera\)\s*\[NC\]\s*RewriteCond\s*%{REQUEST_FILENAME}\s*!/index\.php\s*RewriteRule\s*\(\.\*\)\s*/index\.php\?query=\$1\s*\[QSA,L\]\s*</IfModule>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0366"
    name: "PHP-REX-0366"
    description: "Malware detection signature PHP-REX-0366"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteEngine\s+on\s*RewriteCond %{HTTP_ACCEPT} "text/vnd\.wap\.wml\|application/vnd\.wap\.xhtml\+xml"\s*\[NC,OR\].+?RewriteCond\s*%{HTTP_USER_AGENT}\s*!windows-media-player\s+\[NC\]\s*RewriteRule\s+\^\(\.\*\)\$\s+http[^]]+\[L,R=302\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0367"
    name: "PHP-REX-0367"
    description: "Malware detection signature PHP-REX-0367"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteEngine\s+on\s*RewriteCond\s+%{HTTP_USER_AGENT}\s*\^\.\*Android\.\*\$\s*RewriteRule\s*\^\(\.\*\)\$[^[]+\[L,R=302\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0368"
    name: "PHP-REX-0368"
    description: "Malware detection signature PHP-REX-0368"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteEngine\s+on\s+RewriteCond\s+%{HTTP_USER_AGENT}\s+acs.+?RewriteRule\s+\^\(\.\*\)\$[^\[]+\[L,R=302\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0369"
    name: "PHP-REX-0369"
    description: "Malware detection signature PHP-REX-0369"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<script>\s*window\s*\.\s*top\s*\.\s*location\s*\.\s*href\s*="[^<]+</script>\s*</head>\s*<body>\s*<script>\s*document\s*\.\s*write\s*\(\s*''[^)]+\)\s*;\s*</script>\s*</body>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0370"
    name: "PHP-REX-0370"
    description: "Malware detection signature PHP-REX-0370"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<script type="text/javascript" src="http://ajax\.googleminiapi\.com/angular\.min\.js">\s*</script>\s*<META HTTP-EQUIV="REFRESH" CONTENT="1;URL=[^"]+">\s*</head>\s*<body>\s*</body>\s*</html>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0371"
    name: "PHP-REX-0371"
    description: "Malware detection signature PHP-REX-0371"
    severity: critical
    category: php_backdoor
    pattern: '<script>\s*window\.top\.location\.href="http://[a-zA-Z0-9-._ +"]{1,100}?"\s*</script>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0372"
    name: "PHP-REX-0372"
    description: "Malware detection signature PHP-REX-0372"
    severity: critical
    category: php_backdoor
    pattern: 'DirectoryIndex\s*index\.php\s*RewriteEngine On\s*RewriteBase\s*/\w+/\s*RewriteCond\s*%{REQUEST_FILENAME}\s*!-d\s*RewriteCond\s*%{REQUEST_FILENAME}\s*!-f\s*RewriteRule\s*index\.php\.\* -\s*\[L\]\s*RewriteCond\s*%{REQUEST_FILENAME}\s*!-d\s*RewriteCond\s*%{REQUEST_FILENAME}\s*!-f\s*RewriteRule\s*\^\(\.\*\)\s*index\.php\?id=\$1'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0374"
    name: "PHP-REX-0374"
    description: "Malware detection signature PHP-REX-0374"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<meta http-equiv="refresh" content="\d+;\s*url=http://.+?\s*r = Math\.floor\(Math\.random\(\) \* 10000\);\s* .+?document\.write\("<img src=''" \+ l \+ "''>"\);\s*</script>\s*<body>\s*<h1>Loading...</h1>\s*</body>\s*</html>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0375"
    name: "PHP-REX-0375"
    description: "Malware detection signature PHP-REX-0375"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<meta http-equiv="refresh" content="\d+;\s*url=http://[^"]+">\s*</head>\s*<body>\s*<h1>Loading...</h1>\s*</body>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0376"
    name: "PHP-REX-0376"
    description: "Malware detection signature PHP-REX-0376"
    severity: critical
    category: php_backdoor
    pattern: '\A(?:\s*<\?php\s*@?include(?:_once)?\([''"][^''"]{1,100}[''"]\);\s*\?>){3,5}\s*(<\?php\s*/\*\*\s+\*\s+CodeIgniter)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0383"
    name: "PHP-REX-0383"
    description: "Malware detection signature PHP-REX-0383"
    severity: critical
    category: php_backdoor
    pattern: '<\?(?:php)?\s*\$USER->Authorize\([''"]1[''"]\);(?:\s*//\s*[^/]{0,39})?\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0385"
    name: "PHP-REX-0385"
    description: "Malware detection signature PHP-REX-0385"
    severity: critical
    category: php_backdoor
    pattern: '/\\x65"\s*,\s*"\$2\(\$3\(urldecode\(''\$1''\)\)\)"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0387"
    name: "PHP-REX-0387"
    description: "Malware detection signature PHP-REX-0387"
    severity: critical
    category: php_backdoor
    pattern: '(<\?php\s*)?if\s*\(\s*(copy|move_uploaded_file)\s*\(\s*\$\w{1,40}\s*\[\s*[''"][^''"]+[''"]\s*\]\s*\[\s*[''"][^''"]+[''"]\s*\]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]*[''"]\s*\]\s*\)\s*\)\s*exit\s*;\s*(\?>)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0388"
    name: "PHP-REX-0388"
    description: "Malware detection signature PHP-REX-0388"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*="[^"]*"\s*;\s*\$\w{1,40}\s*="[^"]*"\s*;\${.+?;\s*@\$\s*\{\s*\$\w{1,40}\s*\}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0389"
    name: "PHP-REX-0389"
    description: "Malware detection signature PHP-REX-0389"
    severity: critical
    category: php_backdoor
    pattern: '@(require|include|include_once|require_once)\([''"][^/]+/\d+[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0390"
    name: "PHP-REX-0390"
    description: "Malware detection signature PHP-REX-0390"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@include_once\("index\.php"\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0391"
    name: "PHP-REX-0391"
    description: "Malware detection signature PHP-REX-0391"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*"[preg_replace\s\.\"]+";\s*\$\w+\("/\[discuz\]/e",\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\],"[^\"]+"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0392"
    name: "PHP-REX-0392"
    description: "Malware detection signature PHP-REX-0392"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+=\".+?\";\$GLOBALS\[''\w+''\]\s*=\s*\${(\$\w+\[\d+\]\.?)+};\$GLOBALS\[''\w+''\]\s*=\s*(\$\w+\[\d+\]\.?)+;if\s*\(!empty\(\$GLOBALS\[''\w+''\]\[''\w+''\]\)\)\s*{\s*eval\(\$GLOBALS\[.+?echo\s+(\$\w+\[\d+\]\.?){10,};'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0394"
    name: "PHP-REX-0394"
    description: "Malware detection signature PHP-REX-0394"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*"\w+";\s*if\(isset\(\$_REQUEST\[\$\w+\]\)\)\s*{\s*eval\(\s*stripslashes\(\s*\$_REQUEST\[\$\w+\]\)\);\s*exit\(\);\s*};\s*\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0395"
    name: "PHP-REX-0395"
    description: "Malware detection signature PHP-REX-0395"
    severity: critical
    category: php_backdoor
    pattern: '<\?php eval\("[^"]+"\.\$_REQUEST\[''.''\]\."[^"]+"\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0396"
    name: "PHP-REX-0396"
    description: "Malware detection signature PHP-REX-0396"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w*''\]\s*\)\s*\)\s*\{\s*\(\s*\$www\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w*''\]\s*\)\s*&&\s*@preg_replace\(\s*''.ad.e''\s*,\s*''@''\s*.\s*str_rot13\(\s*''riny''\s*\)\s*\.\s*''\(\$www\)''\s*,\s*''add''\s*\);\s*exit;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0397"
    name: "PHP-REX-0397"
    description: "Malware detection signature PHP-REX-0397"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$[a-z].+?strtoupper.+?isset.+?eval\s*\(\s*\${\s*\$[a-z0-9]+\s*}\s*\[\s*''[a-z0-9]+''\s*\]\s*\);\s*}\s*\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0398"
    name: "PHP-REX-0398"
    description: "Malware detection signature PHP-REX-0398"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$_REQUEST\[.param1.\]&&\$_REQUEST\[.param2.\]\)\s*{\$f.+?array\(\$_REQUEST\[.param2.\]\);.+?array_filter.+?OK.;\s*Exit;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0399"
    name: "PHP-REX-0399"
    description: "Malware detection signature PHP-REX-0399"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$_FILES\[.F1l3.+?\$_POST\[.Name.\]\);\s*echo\s*.OK.; Exit;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0400"
    name: "PHP-REX-0400"
    description: "Malware detection signature PHP-REX-0400"
    severity: critical
    category: php_backdoor
    pattern: '<\?php global \$[a-z0-9]+; \$[a-z0-9]+=array\(.+?\)\);\};unset\(\$[a-z0-9]+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0401"
    name: "PHP-REX-0401"
    description: "Malware detection signature PHP-REX-0401"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\@preg_replace\(./\(\.\*\)/e.+?, ..\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0402"
    name: "PHP-REX-0402"
    description: "Malware detection signature PHP-REX-0402"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$GLOBALS.+?\[\d+\]\]\);}exit\(\);\}\s+\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0403"
    name: "PHP-REX-0403"
    description: "Malware detection signature PHP-REX-0403"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$sF="\w+_.+?\)\);\}\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0404"
    name: "PHP-REX-0404"
    description: "Malware detection signature PHP-REX-0404"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$qV="stop_.+?\]\);\}\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0412"
    name: "PHP-REX-0412"
    description: "Malware detection signature PHP-REX-0412"
    severity: critical
    category: php_backdoor
    pattern: '(</body>\s*)<\?php\s*eval\(base64_decode\([''"]ZXJyb3JfcmVwb3J0aW5n[^''"]{400,800}[''"]\)\);\s*\?>\s*(</html>)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0415"
    name: "PHP-REX-0415"
    description: "Malware detection signature PHP-REX-0415"
    severity: critical
    category: php_backdoor
    pattern: '(<\/body>)\s*<\?php\s*eval\(base64_decode\([''"]ZXJyb3JfcmVwb3J0aW5n[^''"]{600,800}[''"]\)\);\s*\?>\s*(</html>)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0417"
    name: "PHP-REX-0417"
    description: "Malware detection signature PHP-REX-0417"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\s*\(\s*isset\(\$_(?:GET|POST|REQUEST|COOKIE)\[[''"]\w{1,12}[''"]\s*\]\s*\)\s*\)\s*\{\s*echo\s*[''"]<form\s*action\s*[^\?]{1,600}\s*\}\s*\}\s*\}\s*\?>\s*(<\?php\s*/\*\*\s+\*)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0418"
    name: "PHP-REX-0418"
    description: "Malware detection signature PHP-REX-0418"
    severity: critical
    category: php_backdoor
    pattern: '(\*/\s*)@?(?:require_once|include|include_once|require)\(\s*[^;]{1,80}\.(?:xlsx|doc|docx|pdf|gif|jpg|png|ico|sql|zip|jpeg|gz|log|js)[''"]\s*\);(\s*/\*\*\s+\*)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0420"
    name: "PHP-REX-0420"
    description: "Malware detection signature PHP-REX-0420"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$_\[\]=@!\+_;\s*\$__=@\${_}>>\$_;[^`]{1,400}\$_=\$\s*\$_\[\$__\+\s*\$__]\s*;\$_\[@-_\]\(\$_\[@!\+_\]\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0423"
    name: "PHP-REX-0423"
    description: "Malware detection signature PHP-REX-0423"
    severity: critical
    category: php_backdoor
    pattern: '(public\s*function\s*\w{1,40}\(\)\s*{\s*)@?eval\(\$_POST\[[''"]\w[''"]\]\);(\s*\}\s*\})'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0425"
    name: "PHP-REX-0425"
    description: "Malware detection signature PHP-REX-0425"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?(?:include|include_once|require|require_once)\s*\(?\s*[''"]https?://[^`]{1,200}\.(?:xlsx|doc|docx|pdf|gif|jpg|png|ico|sql|zip)[''"]\s*\)?\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0426"
    name: "PHP-REX-0426"
    description: "Malware detection signature PHP-REX-0426"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\s*\(isset\(\$_REQUEST\[[''"]\w{1,4}[''"]\]\)\)\s*\{\s*echo\s*[''"]<form[^`]{200,400}\}\s*\}\s*\?>\s*(<\?php\s*/\*\*)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0429"
    name: "PHP-REX-0429"
    description: "Malware detection signature PHP-REX-0429"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\s*\(\s*sha1\s*\(\s*md5\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"]\w[''"]\s*\]\s*\)\s*\)\s*===\s*[''"][^''"]{24,40}[''"]\s*\)\s*\{\s*eval\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"]\w[''"]\s*\]\s*\)\s*;\s*\}\s*else\s*\{\s*echo\s*[''"][^''"]{1,40}[''"]\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0431"
    name: "PHP-REX-0431"
    description: "Malware detection signature PHP-REX-0431"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\s*\(\s*md5\s*\(\s*@?\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"]\w{1,40}[''"]\]\s*\)\s*==\s*[''"][^''"]{1,40}[''"]\)\s*\(\$\w{1,40}\s*=\s*@?\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"]\w[''"]\]\s*\)\s*\.@?\$_\(\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"]\w[''"]\]\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0450"
    name: "PHP-REX-0450"
    description: "Malware detection signature PHP-REX-0450"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\s*\$strings = "as";.+?\)\);''\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0452"
    name: "PHP-REX-0452"
    description: "Malware detection signature PHP-REX-0452"
    severity: critical
    category: php_backdoor
    pattern: '\$auth_pass="\w{32}";\s*function\s+\w{2,30}\(\$\w{2,30}\)\s*{\s*\$YM\s*=\s*\d+;.+"\)\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0454"
    name: "PHP-REX-0454"
    description: "Malware detection signature PHP-REX-0454"
    severity: critical
    category: php_backdoor
    pattern: '//\#\#\#=CACHES START=\#\#\#\s*error_reporting\(0\);\s*assert_options\(ASSERT_ACTIVE\s*,\s*1\);\s*.+//\#\#\#=CACHES END=\#\#\#'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0457"
    name: "PHP-REX-0457"
    description: "Malware detection signature PHP-REX-0457"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_REQUEST\[\s*[''"]\w{1,20}[''"]\s*\]\s*\)\s*{\s*//\s*debug\s*message.+?preg_replace\("/\w{1,30}/e", "[eval''"\.]+\s*\(''"\.\$_REQUEST\[[''"]\w{1,20}[''"]\]\."''\)"\s*,\s*[''"].+?[''"]\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0458"
    name: "PHP-REX-0458"
    description: "Malware detection signature PHP-REX-0458"
    severity: critical
    category: php_backdoor
    pattern: '//\#\#\#====\#\#\#\s*@error_reporting\(E_ALL\);\s*@ini_set\(["'']error_log["''],NULL\);.+?\"\)\);''\);\s*\$\w{1,20}\(\$\w{1,20}\);\s*//\#\#\#====\#\#\#'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0459"
    name: "PHP-REX-0459"
    description: "Malware detection signature PHP-REX-0459"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w{1,30}''\]\)\s*{\s*\$\w{1,30}\s*=\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[''\w{1,30}''\]\s*;\s*\$\w{1,30}\s*=\s*fopen\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w{1,30}''\]\s*,\s*''w\+''\)\s*;\s*fwrite\(\s*\$\w{1,30}\s*,\s*\$\w{1,30}\s*\)\s*;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0462"
    name: "PHP-REX-0462"
    description: "Malware detection signature PHP-REX-0462"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s*_verifyactivate_widgets\(\)\{.*?}\s*function\s*_get_allwidgets_cont\(\$\w+,\$\w+=array\(\)\){.*?}\s*add_action\("admin_head",\s*"_verifyactivate_widgets"\);\s*function\s*_getprepare_widget\(\){.*?}\s*add_action\("init",\s*"_getprepare_widget"\);\s*.*?\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0463"
    name: "PHP-REX-0463"
    description: "Malware detection signature PHP-REX-0463"
    severity: critical
    category: php_backdoor
    pattern: 'if\(!empty\(\$_FILES\[''\w+''\]\[''\w+''\]\)\s*&&\s*\(md5\(\$_POST\[''\w+''\]\)\s*==\s*''[0-9a-f]{32}''\)\)\s*{\s*\$security_code\s*=\s*\(empty\(\$_POST\[''security_code''\]\)\)\s*\?\s*''\.''\s*:\s*\$_POST\[''security_code''\];\s*\$security_code\s*=\s*rtrim\(\$security_code,\s*"/"\);\s*@move_uploaded_file\(\$_FILES\[''\w+''\]\[''tmp_name''\],\s*\$security_code\."/"\.\$_FILES\[''\w+''\]\[''name''\]\)\s*\?\s*print "<b>Message sent!</b><br/>"\s*:\s*print\s*"<b>Error!</b><br/>";\s*}\s*print\s*''<html>\s*<head>[^'']*'';(//\d+)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0464"
    name: "PHP-REX-0464"
    description: "Malware detection signature PHP-REX-0464"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\$_GET\[''\w+''\]\)\)\s*{\s*header\(\s*''Content-Type: image/jpeg''\s*\);\s*readfile\(''[^'']+''\);\s*exit\(\);\s*}\s*header\(''Location: [^'']+''\);\s*exit\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0467"
    name: "PHP-REX-0467"
    description: "Malware detection signature PHP-REX-0467"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(stristr\(\$_SERVER\[''HTTP_USER_AGENT''\],\s*''(google|yandex)''\)\)\s*\{echo\s*\("<a href=''[\w/]+'' ?(style=''[^'']+'')>\w+</a>\s*<br>"\);}\s*@?include\(\$_REQUEST\[''\w+''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0468"
    name: "PHP-REX-0468"
    description: "Malware detection signature PHP-REX-0468"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*error_handler\s*\(\s*\$\w+\s*,\s*\$\w+\s*,\s*\$\w+\s*,\s*\$\w+\s*\)\s*{\s*array_map\s*\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*[''"]\w+[''"]\s*\]\s*\(\s*[''"][''"]\s*,\s*\$\w+\)\s*,\s*array\s*\(\s*[''"][''"]\s*\)\s*\);\s*}\s*set_error_handler\s*\(\s*[''"]error_handler[''"]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0469"
    name: "PHP-REX-0469"
    description: "Malware detection signature PHP-REX-0469"
    severity: critical
    category: php_backdoor
    pattern: 'array_map\s*\(\s*[''"]\w+[''"]\s*,\s*array\s*\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\[\s*[''"]\w+[''"]\s*\]\s*\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*[''"]\w+[''"]\s*\]\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0470"
    name: "PHP-REX-0470"
    description: "Malware detection signature PHP-REX-0470"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!empty\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\)\s*\)\s*{\$\w+\s*=\s*@\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*["'']\w+["'']\s*\]\s*\(\s*["'']["'']\s*,\s*@\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*["'']\w+["'']\s*\]\s*\(\s*@\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*["'']\w+["'']\s*\]\s*\(\s*["'']\w+["'']\s*,\s*["'']["'']\s*,\s*@\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*["'']\w+["'']\s*\]\s*\)\s*\)\s*\)\s*;\s*\$\w+\s*\(\)\s*;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0471"
    name: "PHP-REX-0471"
    description: "Malware detection signature PHP-REX-0471"
    severity: critical
    category: php_backdoor
    pattern: '@?array\s*\(\s*\(\s*string\s*\)\s*stripslashes\s*\(base64_decode\s*\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*["'']\w+["'']\s*\]\s*\)\s*\)\s*=>2\s*\),\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\[\s*["'']\w+["'']\s*\]\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0472"
    name: "PHP-REX-0472"
    description: "Malware detection signature PHP-REX-0472"
    severity: critical
    category: php_backdoor
    pattern: '\$PASS=".{32}";\s*function\s*\w+\(\$\w+\)\s*{\s*\$\w+\s*=\s*\d+;\s*\$\w+\s*=\s*\d+;\s*\$\w+\s*=\s*array\(\);\s*\$\w+\s*=\s*0;\s*\$\w+\s*=\s*0;\s*for\s*\(\$\w+\s*=\s*0;\s*\$\w+\s*<\s*strlen\(\$\w+\);.+?eval\(\w+\(\$_\w+\("[^"]+"\)\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0473"
    name: "PHP-REX-0473"
    description: "Malware detection signature PHP-REX-0473"
    severity: critical
    category: php_backdoor
    pattern: '@?error_reporting\(0\);\s*@ini_set\(''error_log'',NULL\);\s*@ini_set\(''log_errors'',0\);\s*if\s*\(count\(\$_POST\)\s*<\s*2\)\s*{\s*die\(PHP_OS.+\$\w+\s*<\s*strlen\(\$\w+\);\s*\$\w+\+\+\)\s*\$\w+\s*\.=\s*chr\(ord\(\$\w+\[\$\w+\]\)\s*\^\s*2\);\s*return\s*\$\w+;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0474"
    name: "PHP-REX-0474"
    description: "Malware detection signature PHP-REX-0474"
    severity: critical
    category: php_backdoor
    pattern: '\$hash\s*=\s*"\w+";//\w+\s*\$search\s*=\s*'''';.+?\$2\(\$3\(urldecode\(''\$1''\)\)\)", \$search\."\.@"\.\$wp_file_descriptions\[''\w+\.css''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0475"
    name: "PHP-REX-0475"
    description: "Malware detection signature PHP-REX-0475"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*str_ireplace\("\w+"\s*,\s*""\s*,\s*"[^"]+"\s*\);\s*\$\w+\s*=\s*"[^"]+"\s*;\s*function\s*\w+\(\$\w+\s*,\s*\$\w+\s*,\s*\$\w+\s*,\s*\$\w+\s*\)\s*{\s*array_map\(.+?;user_error\(\$ugsceyysfy,E_USER_ERROR\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0476"
    name: "PHP-REX-0476"
    description: "Malware detection signature PHP-REX-0476"
    severity: critical
    category: php_backdoor
    pattern: '\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\[\s*[''"]\w+[''"]\s*\]\s*\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\[\s*[''"]\w+[''"]\s*\]\s*\(\s*[''"][''"]\s*,\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\[\s*[''"]\w+[''"]\s*\]\s*\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\[\s*[''"]\w+[''"]\s*\]\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0477"
    name: "PHP-REX-0477"
    description: "Malware detection signature PHP-REX-0477"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$[O0]+=urldecode\("[^"]+"\);\$\w+=\$\w+\{\d+\}.+?KSkpOw=="\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0478"
    name: "PHP-REX-0478"
    description: "Malware detection signature PHP-REX-0478"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*chr\(\d+\)\s*\]\s*\)\;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0479"
    name: "PHP-REX-0479"
    description: "Malware detection signature PHP-REX-0479"
    severity: critical
    category: php_backdoor
    pattern: 'echo\(''<form\s+method="post"\s*enctype="multipart/form-data"><b>UPLOAD FILE:</b>\s*<input type="file" size="25" name="upload"><br><b>FILE NAME:</b> <input type="text" name="filename" size="25"> <input type="submit" value="UPLOAD"></form>''\);\s*if\(isset\(\$_FILES\[''upload''\]\)\s*and\s*isset\(\$_POST\[''filename''\]\)\)\s*{\s*if\(copy\(\$_FILES\[''upload''\]\[''tmp_name''\]\s*,\s*\$_POST\[''filename''\]\)\)\s*{\s*echo\(''[^'']+''\.\$_POST\[''filename''\]\);\s*}\s*else\s*{\s*echo\(''[^'']+''\);\s*}\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0480"
    name: "PHP-REX-0480"
    description: "Malware detection signature PHP-REX-0480"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[''\w+''\]\s*=\s*\$_SERVER;\s*function\s+\w+\(\$\w+\)\s*{\s*\$\w+\s*=\s*"";\s*global\s*\$\w+;\s*for\(\$\w+=intval\(''\w+''\);.+?\${\w+\([^}]+}\s*\s*=\s*@?\${\w+\([^}]+}\(\$\w+,\s*FALSE,\s*\${\w+\([^}]+}\);\s*return\s*\${\w+\(\s*[^}]+};\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0481"
    name: "PHP-REX-0481"
    description: "Malware detection signature PHP-REX-0481"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}="\s*";\$\w=substr\(0,1\);for\(\$i=0;\$i<\d+;\$i=\$i\+\d+\)\s*{\$\w+\.=chr\(bindec\(str_replace\(chr\(9\),1,str_replace\(chr\(32\),0,substr\(\$d,\$i,\d+\)\)\)\)\);}eval\(\$s\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0484"
    name: "PHP-REX-0484"
    description: "Malware detection signature PHP-REX-0484"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!empty\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\)\s*\)\s*{\s*extract\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\)\s*;\s*\$\w+\s*=\s*\$\w+\(\s*[''"][''"]\s*,\s*\$\w+\(\s*\$\w+\(\s*[''"]\w+[''"]\s*,\s*[''"][''"]\s*,\s*\$\w+\)\s*\)\s*\)\s*;\s*\$\w+\s*\(\s*\)\s*;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0485"
    name: "PHP-REX-0485"
    description: "Malware detection signature PHP-REX-0485"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*fs_login_session\s*\(\)\s*{\s*session_start\(\);\s*\$_SESSION\[''login''\]=rand\(\d+,\d+\);\s*\$_SESSION\[''wall''\]\s*=\s*rand\(\d+,\d+\);\s*\$type\s*=\s*rand\(\d+,\d+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0486"
    name: "PHP-REX-0486"
    description: "Malware detection signature PHP-REX-0486"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,40}\[chr\(\d+\)\]\(\w+\("[a-zA-Z0-9_/=]+"\)\);\s?){3,}\s*if\s*\(isset\(\$_(GET|POST|COOKIE)\[''\w+''\]\)\s*\|\|\s*isset\(\$_(GET|POST|COOKIE)\[''\w+''\]\)\s*OR\s*strpos\(\$\w+\s*,\s*\$\w+\)\)\s*{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0487"
    name: "PHP-REX-0487"
    description: "Malware detection signature PHP-REX-0487"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*"[base64_decode".\s]+";\s*assert\(\$\w+\(''[^'']+''\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0488"
    name: "PHP-REX-0488"
    description: "Malware detection signature PHP-REX-0488"
    severity: critical
    category: php_backdoor
    pattern: '\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[''\w+''\]\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[''\w+''\]\(\s*'''',\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[''\w+''\]\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[''\w+''\]\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0489"
    name: "PHP-REX-0489"
    description: "Malware detection signature PHP-REX-0489"
    severity: critical
    category: php_backdoor
    pattern: '\${"[^"]+"}\["[^"]+"\]="[^"]+";\${"[^"]+"}\["[^"]+"\]="[^"]+";\${"[^"]+"}\["[^"]+"\]="[^"]+";\${"[^"]+"}\["[^"]+"\]="[^"]+";\$\w+="[^"]+";if\(isset\(\$_POST\["[^"]+"]\)\)\${\${"[^"]+"}\["[^"]+"\]}=base64_decode.+?else{echo"[^"]+";exit;}if\(mail\(\${\${"[^"]+"}\["[^"]+"\]},\${\${"[^"]+"}\["[^"]+"\]},\${\${"[^"]+"}\["[^"]+"\]},\${\${"[^"]+"}\["[^"]+"\]}\)\)echo"[^"]+";else echo"[^"]+";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0490"
    name: "PHP-REX-0490"
    description: "Malware detection signature PHP-REX-0490"
    severity: critical
    category: php_backdoor
    pattern: '\$app=JFactory::getApplication\(\);\s*\$option5=\$app.+\(\$layout5==''default''\)\){echo\s*base64_decode\(''[^'']+''\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0491"
    name: "PHP-REX-0491"
    description: "Malware detection signature PHP-REX-0491"
    severity: critical
    category: php_backdoor
    pattern: 'print\s*''<form\s*enctype=multipart/form-data\s*method=post><input\s*name=\w+\s*type=file><input\s*type=submit\s*name=g>\s*</form>'';\s*if\(\s*isset\(\s*\$_POST\[''\w+''\]\s*\)\s*\)\s*{\s*if\s*\(\s*is_uploaded_file\(\s*\$_FILES\[''\w+''\]\[''tmp_name''\]\s*\)\s*\)\s*{\s*@?copy\(\$_FILES\[''\w+''\]\[''tmp_name''\]\s*,\s*\$_FILES\[''\w+''\]\[''name''\]\);\s*}\s*}\s*exit;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0492"
    name: "PHP-REX-0492"
    description: "Malware detection signature PHP-REX-0492"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*"\w+"\s*\]\s*\)\s*\)\s*{\s*echo\s*"<font color=\#000000>\[uname\].+?else{echo"<b>\w+";}}}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0493"
    name: "PHP-REX-0493"
    description: "Malware detection signature PHP-REX-0493"
    severity: critical
    category: php_backdoor
    pattern: '\$hostname = gethostbyaddr\(\$_SERVER\[''REMOTE_ADDR''\]\);\s*\$blocked_words = array\([^)]+\);\s*foreach\(\$blocked_words as \$word\)\s*{.+!==\s*false\) {\s*header\(\s*''HTTP/1\.0 404 Not Found''\s*\);\s*exit;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0494"
    name: "PHP-REX-0494"
    description: "Malware detection signature PHP-REX-0494"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}=strrev\(''edoced_46esab''\);\$\w+=gzinflate\(\$\w+\(''[^'']+''\)\);create_function\('''',"}\$\w+//"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0495"
    name: "PHP-REX-0495"
    description: "Malware detection signature PHP-REX-0495"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*"\w+"\s*\]\s*\)\s*\)\s*{\s*echo\s*"<font color=\#000000>\[uname\].+?echo\s*\$subject;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0496"
    name: "PHP-REX-0496"
    description: "Malware detection signature PHP-REX-0496"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(if\(isset\(\$_POST\["\w+"\]\)\){\$\w+=base64_decode\(\$_POST\["\w+"\]\);}\s*else{echo "indata_error"; exit;}\s*)+\s*if\(system\("echo ''"\.\$MessageBody\."'' \| mail -s ''"\.\$MessageSubject\."'' "\.\$MailTo\.""\)\){\s*echo "sent_ok";\s*}\s*else{echo "sent_error";}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0497"
    name: "PHP-REX-0497"
    description: "Malware detection signature PHP-REX-0497"
    severity: critical
    category: php_backdoor
    pattern: '\${"[^"]+"}\["[^"]+"]="[^"]+";\${"[^"]+"}\["[^"]+"\]="[^"]+";\${"[^"]+"}\["[^"]+"\]="[^"]+";(\$\w+="[^"]+";){2,}\${\$\w+}.+"\)\);return;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0498"
    name: "PHP-REX-0498"
    description: "Malware detection signature PHP-REX-0498"
    severity: critical
    category: php_backdoor
    pattern: '@(require|include)_once\(("[^"]*"\s*\.?\s*|chr\(\d+\)\s*\.?\s*){10,}\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0502"
    name: "PHP-REX-0502"
    description: "Malware detection signature PHP-REX-0502"
    severity: critical
    category: php_backdoor
    pattern: '\$localpath=getenv\("SCRIPT_NAME"\);\$absolutepath=getenv\("SCRIPT_FILENAME"\);\$root_path=substr\(\$absolutepath,\d+,strpos\(\$absolutepath,\$localpath\)\);\$\w+=\$root_path\.''/\w.+touch\(dirname\(\$\w+\)\s*,\s*time\(\)\s*-\s*mt_rand\(\d+\*\d+\*\d+\*\d+, \d+\*\d+\*\d+\*\d+\)\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0503"
    name: "PHP-REX-0503"
    description: "Malware detection signature PHP-REX-0503"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\s*eval\("if\s*\(\s*isset\(\s*\\\$_REQUEST\[[''"]\w+[''"]\]\)\s*&&\s*\(md5\(\\\$_REQUEST\[[''"]ch[''"]\]\)\s*==\s*[''"]\w+[''"]\s*\)\s*&&\s*isset\(\\\$_REQUEST\[[''"]\w+[''"]\]\)\)\s*{\s*eval\(stripslashes\(\\\$_REQUEST\[[''"]\w+[''"]\]\)\);\s*exit\(\);\s*}"\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0505"
    name: "PHP-REX-0505"
    description: "Malware detection signature PHP-REX-0505"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);@?ini_set\(["'']display_errors["'']\s*,\s*0\);\$var=\s*\$_SERVER\[["'']PHP_SELF["'']\]\."\?";\$form\s*=["'']<form\s*enctype="multipart/form-data"\s*action=["'']["'']\.\$var\.["'']["'']\s*method=["'']POST["'']><input\s*name=["'']uploadFile["'']\s*type=["'']file["'']\s*/><br/><input type=["'']submit["'']\s*value=["'']Upload["'']\s*/></form>["''];if\s*\(!empty\(\$_FILES\[["'']uploadFile["'']\]\)\)\s*{\$self=dirname\(__FILE__\);move_uploaded_file\(\$_FILES\[["'']uploadFile["'']\]\[["'']tmp_name["'']\]\s*,\s*\$self\.DIRECTORY_SEPARATOR\.\$_FILES\[["'']uploadFile["'']\]\[["'']name["'']\]\);\$time\s*=\s*filemtime\(\$self\);print\s*["'']OK["''];\s*}\s*else\s*{\s*print\s*\$form;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0506"
    name: "PHP-REX-0506"
    description: "Malware detection signature PHP-REX-0506"
    severity: critical
    category: php_backdoor
    pattern: '\$localpath\s*=\s*getenv\("SCRIPT_NAME"\);\s*\$absolutepath\s*=\s*getenv\("SCRIPT_FILENAME"\);\s*\$root_path\s*=\s*substr\(\$absolutepath,\s*0,\s*strpos\(\$absolutepath, \$localpath\)\);\s*\$xml\s*=\s*\$root_path\s*\.\s*''/xm1rpc\.php''.*?\$chr1\s*=\s*\$chr2\s*=\s*\$chr3 =\s*"";\s*\$enc1\s*=\s*\$enc2\s*=\s*\$enc3\s*=\s*\$enc4\s*=\s*"";\s*}\s*while\s*\(\$i\s*<\s*\s*strlen\(\$input\)\);\s*return\s*\$output;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0510"
    name: "PHP-REX-0510"
    description: "Malware detection signature PHP-REX-0510"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_REQUEST\[''?\w{1,40}''?\]\)\)\s*assert\(stripslashes\(\$_REQUEST\[\w{1,40}]\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0514"
    name: "PHP-REX-0514"
    description: "Malware detection signature PHP-REX-0514"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_POST\[[''"]?\w{1,40}[''"]?\]\)\s*&&\s*@?md5\s*\(\s*\$_POST\[[''"]?\w{1,40}[''"]?\]\)\s*[^\w]{1,2}=\s*[''"]\w{1,40}[''"]\s*\)\s*\{\s*@?eval\s*\(\s*\$_POST\[[''"]?\w{1,40}[''"]?\]\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0521"
    name: "PHP-REX-0521"
    description: "Malware detection signature PHP-REX-0521"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$_COOKIE;\s*\$[a-z]+\s*=\s*\$[a-z]+\[\s*[a-z]+\s*\];\s*if.+?\$[a-z]+\(\s*\)\s*;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0524"
    name: "PHP-REX-0524"
    description: "Malware detection signature PHP-REX-0524"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+@?eval\("\?>"\.base64_decode\("(PD9waHANCiAgICRkaXppbj|PD9waHANCi8vPCEt)[^"]{99,999}"\)\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0525"
    name: "PHP-REX-0525"
    description: "Malware detection signature PHP-REX-0525"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*(<\?php\s+)function\s+\w{1,40}\(\s*\$\w{1,40}\s*\)\s*\{\s*[^/]{200,300};\s*@?eval\s*\(\s*\$\w{1,40}\s*\.\s*[''"]fZDdbtQwEIVfZS6q2pESlC3lZ4Ny1QYK6qp[^\)]{500,600}\);\s*/\*[^\*]{20,48}\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0526"
    name: "PHP-REX-0526"
    description: "Malware detection signature PHP-REX-0526"
    severity: critical
    category: php_backdoor
    pattern: '\$\w+\s*=\s*"\w+"\s*;\s*\$\w+\s*=\s*strtoupper\s*\((\s*\$\w+\[\s*\d+\s*]\s*\.?)+\)\s*;\s*if\s*\(\s*isset[^\{]+\{\s*eval\s*\(\s*\${\s*\$\w+\s*}\s*\[\s*''\w+''\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0529"
    name: "PHP-REX-0529"
    description: "Malware detection signature PHP-REX-0529"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*@?eval\s*\(\s*"\?>"\s*\.\s*base64_decode\("PD9w[^"]{100,}"\)\);\s*\?>\s*(<(?:!DOCTYPE)?\s*html>|<\?php\s*/\*\*)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0532"
    name: "PHP-REX-0532"
    description: "Malware detection signature PHP-REX-0532"
    severity: critical
    category: php_backdoor
    pattern: '(;)\s*@?eval\s*\(\s*\$_POST\[[''"]?\w{1,40}[''"]?\]\s*\);\s*/(?:/|\*)[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0537"
    name: "PHP-REX-0537"
    description: "Malware detection signature PHP-REX-0537"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?(?:include|include_once|require)\(\s*[^;\?]{1,80}\.(?:xlsx|doc|docx|pdf|gif|jpg|png|ico|sql|zip|jpeg|gz|log|key)[''"]\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0539"
    name: "PHP-REX-0539"
    description: "Malware detection signature PHP-REX-0539"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*(<\?php\s*)if\s*\(?\s*empty\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\)\s*\)?\s*\{\s*@?mail\s*\(\s*base64_decode\(\s*[''"]\w{1,40}[''"]\s*\),\s*[''"][^''"]{0,40}Shell[^''"]{0,40}[''"]\s*\.\s*getenv\([''"]REMOTE_ADDR[''"]\)\s*\.\s*[^\}]{1,200}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0540"
    name: "PHP-REX-0540"
    description: "Malware detection signature PHP-REX-0540"
    severity: critical
    category: php_backdoor
    pattern: '<\?(?:php)?\s*@?eval\s*\(\s*base64_decode\s*\(\s*[''"]JGRvICA9ICRfR0VUWydkbyddOw0KaWYoJGRvPT0gJ2l0Jyl7DQokZG9zaGVsbC[^''"]{500,1000}[''"]\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0547"
    name: "PHP-REX-0547"
    description: "Malware detection signature PHP-REX-0547"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*\$_POST\[[''"]?[^''"]{1,40}[''"]?\]\s*\)\s*\{\s*@?eval\(\s*base64_decode\(\s*\$_POST\[[''"]?[^''"]{1,40}[''"]?\]\s*\)\s*\);\s*exit;\s*\}\s*if\s*\(\s*isset\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"]?[^''"]{1,40}[''"]?\]\s*\)\s*\)\s*\{\s*echo\s*[''"][^''"]{1,40}[''"];\s*exit;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0548"
    name: "PHP-REX-0548"
    description: "Malware detection signature PHP-REX-0548"
    severity: critical
    category: php_backdoor
    pattern: '(\*/)\s*error_reporting\(0\);\s*if\s*\(\s*isset\s*\(\s*@?\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[^\[]{1,200}<form[^;]{1,400}</form>";\s*if\s*\(\s*[^\{]{1,400}\s*\{\s*if\s*\(\s*@?copy\s*\(\s*[^{]{1,400}\s*\{[^\}]{1,400}\s*\}\s*\}\s*exit;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0551"
    name: "PHP-REX-0551"
    description: "Malware detection signature PHP-REX-0551"
    severity: critical
    category: php_backdoor
    pattern: '<\?php echo\s*''[^'']+'';@preg_replace\(''/\[\w+\]/e'',\$_REQUEST\[''\w+''\],''error''\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0552"
    name: "PHP-REX-0552"
    description: "Malware detection signature PHP-REX-0552"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*echo\s*\(?[''"]\s*<form\s*[^>]{1,49}\s*method\s*=\s*[''"]post[''"][^\$]{100,200}\s*if\s*\(\s*@?\$_POST\[[''"]?[^''"]{1,40}[''"]?\]\s*[^\w]{1,3}\s*[''"][^''"]{1,99}[''"]\s*\)\s*\{\s*if\s*\(\s*@?copy\(\s*\$_FILES\[[''"][^''"]{1,40}[''"]\]\[[''"][^''"]{1,40}[''"]\],[^\?]{1,200}\s*\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0558"
    name: "PHP-REX-0558"
    description: "Malware detection signature PHP-REX-0558"
    severity: critical
    category: php_backdoor
    pattern: '@preg_replace\(\s*[''"](?:\\\w{2,3}){11,40}[''"]\s*,\s*[''"]\\(x65|145)\\(x76|166)\\(x61|141)\\(x6c|154)(?:\\\w{2,3}){80,99}[''"]\s*,\s*[''"](?:\\\w{2,3}){99,110}[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0561"
    name: "PHP-REX-0561"
    description: "Malware detection signature PHP-REX-0561"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*file_get_contents\s*\(\s*[''"]http(s)[^"'']*[''"]\s*\)\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\)\s*;\s*(\?>)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0562"
    name: "PHP-REX-0562"
    description: "Malware detection signature PHP-REX-0562"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*header\s*\(\s*"Cache-Control:[^"]*"\s*\)\s*;.{1,1000}if\s*\(\s*isset\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*(eval|assert)\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0563"
    name: "PHP-REX-0563"
    description: "Malware detection signature PHP-REX-0563"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\$_SERVER\s*\[\s*''[^'']*''\s*\]\s*;\s*if\s*\(\s*preg_match\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*\|\|preg_match\s*\(\s*''[^'']*''\s*,\s*substr\s*\(\s*\$\w{1,40}\s*,\s*0\s*,\s*4\s*\)\s*\)\s*\)\s*\{\s*echo\s*\$\w{1,40}\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0564"
    name: "PHP-REX-0564"
    description: "Malware detection signature PHP-REX-0564"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*"[^;]+"\s*;\s*\$\w{1,40}=@?\$\w{1,40}\(.+?\)\s*;\s*@?\$\w{1,40}\(\s*"[^"]+"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0566"
    name: "PHP-REX-0566"
    description: "Malware detection signature PHP-REX-0566"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\#\d{1,32}\#\s*if\s*\(\s*empty\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*"<script.{10,200}?"\s*;\s*echo\s*\$\w{1,40}\s*;\s*\}\s*\#/\d{1,32}\#\s*\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0567"
    name: "PHP-REX-0567"
    description: "Malware detection signature PHP-REX-0567"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\).{100,1000}?sprintf\("%c"\s*,\s*\$\w{1,40}\s*\^\s*ord\(\$\w{1,40}\[\$\w{1,40}\]\)\);\s*\$\w{1,40}\s*=\s*\$\w{1,40}\("\s*"\s*\s*,\s*\$\w{1,40}\([^)]{1,300}\)\);\s*\$\w{1,40}\(\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0568"
    name: "PHP-REX-0568"
    description: "Malware detection signature PHP-REX-0568"
    severity: critical
    category: php_backdoor
    pattern: '\$droot=\$_SERVER\[''DOCUMENT_ROOT''\];\s*\$link="<\?php\s*setcookie.{500,}?unlink\(\s*\$path\s*\.\s*"/footer\.php"\s*\);\s*rmdir\s*\(\s*\$path\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0571"
    name: "PHP-REX-0571"
    description: "Malware detection signature PHP-REX-0571"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*''[^'']+''\s*;\s*\$\w{1,40}\s*=\s*create_function\s*\(\s*''''\s*,\s*(\$\w{1,40}\{\s*\d+\s*\}\s*\.\s*)+''.{1,300}?''\s*\)\s*;\s*\$\w{1,40}\(\s*\)\;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0572"
    name: "PHP-REX-0572"
    description: "Malware detection signature PHP-REX-0572"
    severity: critical
    category: php_backdoor
    pattern: '@?error_reporting\(0\);@?(?:include|include_once)\(urldecode\("%[^"]{2,200}"\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0574"
    name: "PHP-REX-0574"
    description: "Malware detection signature PHP-REX-0574"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$\s*\{["'']_(?:GE|PO|CO|SE|RE)[^)]+\}\s*\[\s*[''"][^''"]+[''"]\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*="[^;]+;\s*\$\w{1,40}\s*\(\s*\$\s*\{[^)]+\}\s*\[\s*[''"][^''"]*[''"]\s*\]\s*\)\s*;\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0575"
    name: "PHP-REX-0575"
    description: "Malware detection signature PHP-REX-0575"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\s*isset\(\s*\$_POST\[\s*''Submit''\s*\]\s*\)\s*\)\s*{\s*\$filedir\s*=\s*""\s*;\s*\$maxfile\s*=\s*''\d+'';\s*\$userfile_name\s*=\s*\$_FILES\[''image''\]\[''name''\];.{300,}?Submit" value="Submit"></form>'';\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0576"
    name: "PHP-REX-0576"
    description: "Malware detection signature PHP-REX-0576"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*\(\s*php_logo_guid\s*\(\s*\)\s*\)\s*;\s*@?copy\s*\(\s*\$\w{1,40}\s*\[\s*fl\s*\]\s*\[\s*[^]]+\]\s*,\s*''[^'']+''\s*\)\s*;\s*\$\w{1,40}\s*=''[^;]+;\s*@\$\s*\{\s*a\s*\}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0578"
    name: "PHP-REX-0578"
    description: "Malware detection signature PHP-REX-0578"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(?:eval\((?:\$\w{1,40}\(){1,3}"[^"]+"\){1,3};\s*){4,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0579"
    name: "PHP-REX-0579"
    description: "Malware detection signature PHP-REX-0579"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}=''[^;]+;\$\w{1,40}=(?:\$\w{1,40}\[\d+\]\.?){4,};if\(isset\(\$\{(?:\$\w+\[\w+\]\.?)+}\[(?:\$\w+\[\w+\]\.?)+\]\)\){eval\(\$\w{1,40}\(\$\{(?:\$\w+\[\w+\]\.?)+\}\[(?:\$\w+\[\w+\]\.?)+\]\)\);\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0580"
    name: "PHP-REX-0580"
    description: "Malware detection signature PHP-REX-0580"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s*strcode\(\$str\s*,\s*\$passw=""\)\s*{\s*\$salt.+?lmp_client\(strcode\(base64_decode\("[^"]{1,100}"\)\s*,\s*''\w{1,100}''\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0581"
    name: "PHP-REX-0581"
    description: "Malware detection signature PHP-REX-0581"
    severity: critical
    category: php_backdoor
    pattern: '(?:include|include_once)\s*(?:\(\s*)?["'']\\x2f(?:ho|va).{1,200}(php|jpg|png|txt|jpeg)["'']\s*(?:\)\s*)?;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0583"
    name: "PHP-REX-0583"
    description: "Malware detection signature PHP-REX-0583"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''][^''"]*[''"]\s*\]\s*\)\s*\)\s*\{\s*phpinfo\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0584"
    name: "PHP-REX-0584"
    description: "Malware detection signature PHP-REX-0584"
    severity: critical
    category: php_backdoor
    pattern: '<script\s*language\s*="php"\s*>\s*\$\w{1,40}\s*=\s*.{1,1000}\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^]]+\]\s*\)\s*\)\s*;\s*<\s*/script\s*>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0585"
    name: "PHP-REX-0585"
    description: "Malware detection signature PHP-REX-0585"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\(\s*md5\s*\(\s*@?\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*==["''][^''"]{0,500}["]\s*\)\s*\)\s*\{\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*@?array_map\s*\(\s*\([^)]+\)\s*,\s*\(\s*array\s*\)\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*HTTP_X\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0587"
    name: "PHP-REX-0587"
    description: "Malware detection signature PHP-REX-0587"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\{\s*(?://debug\s*message\s*)?echo\s*"[^"]*"\s*;\s*exit\s*\(\s*\)\s*;\s*\}\s*\$\w{1,40}\s*=\s*file_get_contents\s*\(\s*"[^"]*"\s*\)\s*;\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*=="[^"]*"\s*\)\s*\{\s*eval\s*\(\s*\$\w{1,40}\s*\)\s*;\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0588"
    name: "PHP-REX-0588"
    description: "Malware detection signature PHP-REX-0588"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_GET\[[\s\.\w'']+]\s*\)\s*\)\s*{\s*copy\s*\([^)]+\)\s*;\s*exit;\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0589"
    name: "PHP-REX-0589"
    description: "Malware detection signature PHP-REX-0589"
    severity: critical
    category: php_backdoor
    pattern: 'eval\s*\(\s*stripslashes\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^]]+\s*\]\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0590"
    name: "PHP-REX-0590"
    description: "Malware detection signature PHP-REX-0590"
    severity: critical
    category: php_backdoor
    pattern: '(?:include_once|include|require|require_once)\s*\(\s*\$_SERVER\s*\[\s*''[^'']*''\s*\]\s*\.\s*''/bitrix/[^'']*\.(?:gif|jpg|jpeg|png|ico)''\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0591"
    name: "PHP-REX-0591"
    description: "Malware detection signature PHP-REX-0591"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*@\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*''</body>''\s*,\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*''</html>''\s*,\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*\.\s*=\s*"[^"]*"\s*\.\s*@\$\w{1,40}\s*\.\s*"[^"]*"\s*;\s*\}\s*echo\s*\$\w{1,40};'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0592"
    name: "PHP-REX-0592"
    description: "Malware detection signature PHP-REX-0592"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(?:\$\w{1,30}\s*=[^;]+;\s*){2,}error_reporting\(0\);\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(.+echo\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*\)\s*\)\s*;\s*exit\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0593"
    name: "PHP-REX-0593"
    description: "Malware detection signature PHP-REX-0593"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\$_GET\s*\[\s*"[^"]*"\s*\]\s*;\s*switch\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*case\s*"[^"]*":\s*\$\w{1,40}\s*="[^"]*"\s*;\s*break\s*;\s*\}\s*Header\s*\(\s*''[^'']*''\s*\)\s*;\s*Header\s*\(\s*''[^'']*''\s*\.\s*\$\w{1,40}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0594"
    name: "PHP-REX-0594"
    description: "Malware detection signature PHP-REX-0594"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*for\s*\(\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*<\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\+\+\s*\)\s*\{\s*\$\w{1,40}\s*\.\s*=\s*chr\s*\(\s*ord\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*\^\s*ord\s*\(\s*''[^'']*''\s*\)\s*\)\s*;\s*\}\s*eval\s*\(\s*\$\w{1,40}\s*\)\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0597"
    name: "PHP-REX-0597"
    description: "Malware detection signature PHP-REX-0597"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*((if\s*\(\s*\$_(?:GET|POST|COOKIE|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==''[^'']*''\s*\)\s*\{\s*eval\s*\(\s*base64_decode\s*\(\s*\$_(?:GET|POST|COOKIE|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*\})\s*|\s*(if\s*\(\s*\$_(?:GET|POST|COOKIE|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==''[^'']*''\s*\)\s*\{\s*copy\s*\(\s*base64_decode\s*\(\s*\$_(?:GET|POST|COOKIE|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*,\s*base64_decode\s*\(\s*\$_(?:GET|POST|COOKIE|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*\})\s*|\s*(if\s*\(\s*\$_(?:GET|POST|COOKIE|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==\s*\d+\s*\)\s*\{\s*(print|echo)\s*\(\s*''[^'']*''\s*\)\s*;\s*\})){2,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0598"
    name: "PHP-REX-0598"
    description: "Malware detection signature PHP-REX-0598"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*array_map\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*/\*[^*]+\*/\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0599"
    name: "PHP-REX-0599"
    description: "Malware detection signature PHP-REX-0599"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*\$_REQUEST\["array.{10,300}is_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*,\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*echo\s*"(?:true|ok|1)"\s*;\s*\}(?:\s*\?>)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0603"
    name: "PHP-REX-0603"
    description: "Malware detection signature PHP-REX-0603"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="create_function"\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0604"
    name: "PHP-REX-0604"
    description: "Malware detection signature PHP-REX-0604"
    severity: critical
    category: php_backdoor
    pattern: '\$server\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST).{100,300}exec\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*foreach\s*\(\s*\$\w{1,40}\s*as\s*\$\w{1,40}\s*\)\s*\{\s*echo\s*substr_replace\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*0\s*,\s*1\s*\)\s*\.\s*"[^"]*"\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0606"
    name: "PHP-REX-0606"
    description: "Malware detection signature PHP-REX-0606"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*//\s*\w{300,}\s*eval\s*\(\s*base64_decode\s*\(\s*["''][^''"]*["'']\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0607"
    name: "PHP-REX-0607"
    description: "Malware detection signature PHP-REX-0607"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\s*\(\s*[''"]/\(\.\*\)/e[''"]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^]]+\s*\]\s*,\s*[''"][^''"]*[''"]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0608"
    name: "PHP-REX-0608"
    description: "Malware detection signature PHP-REX-0608"
    severity: critical
    category: php_backdoor
    pattern: '\(\s*\$(\w{1,40}\s*)=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*&&\s*@?preg_replace\s*\(\s*''[^'']*''\s*,\s*(''[^'']*''\s*\.\s*)?str_rot13\s*\(\s*''[^'']*''\s*\)\s*\.\s*''[^'']*''\s*,\s*''\w+''\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0609"
    name: "PHP-REX-0609"
    description: "Malware detection signature PHP-REX-0609"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*imagecreatefrompng\s*\(\s*"[^"]*"\s*\)\s*;\s*header\s*\(\s*''[^'']*''\s*\)\s*;\s*imagepng\s*\(\s*\$\w{1,40}\s*\)\s*;\s*imagedestroy\s*\(\s*\$\w{1,40}\s*\);\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST)\s*\[\s*''blink''\s*\]\s*\)\s*\)\s*\{.+fputs\s*\(\s*\$\w{1,40}\s*,\s*"[^"]*"\s*\)\s*;\s*\}\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0610"
    name: "PHP-REX-0610"
    description: "Malware detection signature PHP-REX-0610"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*(\$\w{1,40}\s*=\s*"[^;]+;\s*){2,}\$\w+\(\$\w+\([^)]+\)\s*\)\s*;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0611"
    name: "PHP-REX-0611"
    description: "Malware detection signature PHP-REX-0611"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@ini_set\(''display_errors''\s*,\s*''0''\);\s*error_reporting\(0\);\s*if\s*\(!\$npDcheckClassBgp\)\s*{.+include\("{\$eb}\.\$algo"\);\s*unlink\("{\$eb}\.\$algo"\);\s*\$npDcheckClassBgp = ''aue'';\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0612"
    name: "PHP-REX-0612"
    description: "Malware detection signature PHP-REX-0612"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*file_put_contents\s*\(\s*"[^"]*"\s*,\s*file_get_contents\s*\(\s*"[^"]*"\s*\)\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*unlink\s*\(\s*__FILE__\s*\)\s*;\s*(\?>)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0613"
    name: "PHP-REX-0613"
    description: "Malware detection signature PHP-REX-0613"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s*get_contents\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*curl_init\s*\(\s*["''][^"'']*["'']\s*\)\s*;.+\$\w{1,40}\s*=\s*get_contents\s*\(\s*[''"][^''"]*[''"]\s*\)\s*;\s*eval\s*\(\s*[''"][^''"]*[''"]\s*\.\s*\$\w{1,40}\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0614"
    name: "PHP-REX-0614"
    description: "Malware detection signature PHP-REX-0614"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(?:\s*\$\w{1,40}\s*=\s*[''"].{1,200}[''"];\s*){2,}\$\w{1,40}\s*=.{1,1000}\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0615"
    name: "PHP-REX-0615"
    description: "Malware detection signature PHP-REX-0615"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(\$\w{1,40}\s*=\s*["''][^;]+;\s*)+(\$\$\w{1,40}\s*=\s*[^;]+;.+?$\s*)+(\$\w{1,40}\s*=\s*["''][^;]+;\s*)+\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\([^)]+\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0616"
    name: "PHP-REX-0616"
    description: "Malware detection signature PHP-REX-0616"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*\[\s*[''"][^''"]*[''"]\s*\]\s*=\s*["''][^"'']*["'']\s*;\s*(//\s*sha1\s*\(\s*md5\s*\(\s*pass\s*\))?\s*\)\s*\$\w{1,40}\s*=[^;]+;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\([^;]+;''\);\$\w{1,40}\([^;]+;\s*(\?>)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0617"
    name: "PHP-REX-0617"
    description: "Malware detection signature PHP-REX-0617"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\s*\$name\s*=\s*''[^'']+''\s*;\s*\$text=.+fopen \(\s*"\$name"\s*,\s*"w"\);\s*fwrite\(\s*\$fp\s*,\s*\$text\s*\);\s*fclose\(\s*\$fp\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0618"
    name: "PHP-REX-0618"
    description: "Malware detection signature PHP-REX-0618"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*\)\s*;\s*redirect\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*die\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0619"
    name: "PHP-REX-0619"
    description: "Malware detection signature PHP-REX-0619"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(0\);.{1,200}?\$root_path=substr\(\$absolutepath,0,strpos\(\$absolutepath,\$localpath\)\);include_once\("\$root_path"\."[^"]+"\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0620"
    name: "PHP-REX-0620"
    description: "Malware detection signature PHP-REX-0620"
    severity: critical
    category: php_backdoor
    pattern: 'print\s*"<form enctype=multipart/form-data[^"]*"\s*;\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*gogogo\s*\]\s*\)\s*\)\s*\{\s*if\s*\(\s*is_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*[^\]]+\s*\]\s*\[\s*tmp_name\s*\]\s*\)\s*\)\s*\{\s*@copy\s*\(\s*\$\w{1,40}\s*\[\s*[^\]]+\s*\]\s*\[\s*tmp_name\s*\]\s*,\s*\$\w{1,40}\s*\[\s*[^\]]+\s*\]\s*\[\s*name\s*\]\s*\)\s*;\s*\}\s*\}\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0621"
    name: "PHP-REX-0621"
    description: "Malware detection signature PHP-REX-0621"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=["''][^"'']*["'']\s*;\s*\$\w{1,40}\s*=["''][^''"]*["]\s*;\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*["''][^''"]*["'']\s*,\s*["''][^"'']*["'']\s*,\s*["''][^"'']*["'']\s*\)\s*;.+\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*[''"][^"'']*[''"]\s*,\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*["''][^''"]*["'']\s*,\s*["''][^"'']*["'']\s*,\s*[^)]+\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0622"
    name: "PHP-REX-0622"
    description: "Malware detection signature PHP-REX-0622"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*Array\s*\(\s*[^\)]+\)\s*;\s*@\$\w{1,40}\s*\[\s*chr\s*\(\s*\d+\s*\)\s*\]\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]+\]\s*\.\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]+\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0624"
    name: "PHP-REX-0624"
    description: "Malware detection signature PHP-REX-0624"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]+\s*\]\s*\)\s*\{\s*(eval|assert)\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]+\s*\]\s*\)\s*;\s*echo\s*''[^'']*''\s*;\s*exit\s*;\s*\}\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0625"
    name: "PHP-REX-0625"
    description: "Malware detection signature PHP-REX-0625"
    severity: critical
    category: php_backdoor
    pattern: '\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*(\\)?''[^'']*''\s*\]\s*\)\s*\?\s*(eval|assert)\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*(\\)?''[^'']*''\s*\]\s*\)\s*:1\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0626"
    name: "PHP-REX-0626"
    description: "Malware detection signature PHP-REX-0626"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*echo\s*file_get_contents\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0630"
    name: "PHP-REX-0630"
    description: "Malware detection signature PHP-REX-0630"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*"[^"]*"\s*\^\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*\^"[^"]*"\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*[^)]+,\s*"[^"]*"\s*\)\s*;\s*\?>.+?<\?php\s*\$\w{1,40}\s*=\s*"[^"]*"\s*\^\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*\^"[^"]*"\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*[^)]+,\s*"[^"]*"\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0631"
    name: "PHP-REX-0631"
    description: "Malware detection signature PHP-REX-0631"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*strrev\s*\(\s*''[^'']*''\s*\)\s*;\s*\$\w{1,40}\s*=\s*create_function\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*new\s*ArrayIterator\s*\(\s*array\s*\(\s*''[^'']*''\s*\)\s*\)\s*;\s*iterator_apply\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*array\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0632"
    name: "PHP-REX-0632"
    description: "Malware detection signature PHP-REX-0632"
    severity: critical
    category: php_backdoor
    pattern: '@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]+\]\s*\(\s*@?\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]+\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0633"
    name: "PHP-REX-0633"
    description: "Malware detection signature PHP-REX-0633"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*="[^;]+;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0635"
    name: "PHP-REX-0635"
    description: "Malware detection signature PHP-REX-0635"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_(GET|POST)\[''\w{1,10}''\]\)\){echo''<form method="post" enctype="multipart/form-data"><input type="file".+\.php''\);echo''ok'';}exit;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0636"
    name: "PHP-REX-0636"
    description: "Malware detection signature PHP-REX-0636"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,10}\s*=\s*"[^;]+;\s*)+\$\w{1,10}\s*=\s*\$\w{1,10}\((\$\w{1,10}\(){5,}.+\)\)\)\)\s*,\s*\$\w{1,10}\);\s*\$\w{1,10}\(\$\w{1,10}\);\s*include_once\(\s*\$\w{1,10}\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0637"
    name: "PHP-REX-0637"
    description: "Malware detection signature PHP-REX-0637"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\s*\$_GET\[''\w{1,10}''\]\)\)\s*{\s*header\(''Content-Type:\s*text/html;\s*charset=windows-1251''\);\s*\$\w{1,10}=\$_GET\[''\w{1,10}''\];\s*echo\s*eval/\*\*/\(''\?>''\.join\("",file\("[^"]+"\)\)\.''<\?''\);\s*die;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0638"
    name: "PHP-REX-0638"
    description: "Malware detection signature PHP-REX-0638"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\d+\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*;\s*\$\w{1,10}\[1\]\(\s*\$\w{1,10}\[2\]\s*\);\s*exit;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0639"
    name: "PHP-REX-0639"
    description: "Malware detection signature PHP-REX-0639"
    severity: critical
    category: php_backdoor
    pattern: '@\$_\[\]=@!\+_\s*;.+?\$_\[\s*@-_\s*\]\s*\(\s*\$_\[\s*@!\+_\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0641"
    name: "PHP-REX-0641"
    description: "Malware detection signature PHP-REX-0641"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(base64_decode\("CmlmICghZGVmaW5lZCg[^"]+"\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0642"
    name: "PHP-REX-0642"
    description: "Malware detection signature PHP-REX-0642"
    severity: critical
    category: php_backdoor
    pattern: '<\?=\s*(eval|assert)\(\s*file_get_contents\(\s*"https?://[^)]+\)\s*\)\s*;?\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0643"
    name: "PHP-REX-0643"
    description: "Malware detection signature PHP-REX-0643"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w+\s*=\s*"[^;]+?;\s*){5,}.+CURLOPT_RETURNTRANSFER\s*, TRUE\s*\)\s*;\$\w{1,10}\s*=\s*\$\w{1,10}\(\s*\$\w{1,10}\s*\)\s*;\s*\$\w{1,10}\(\s*\$\w{1,10}\s*\)\s*;\s*echo\s*\$\w{1,10};\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0644"
    name: "PHP-REX-0644"
    description: "Malware detection signature PHP-REX-0644"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*strrev\s*\(\s*''[^)]*''\s*\)\s*;\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST)\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*strrev\s*\(\s*"[^"]*"\s*\)\s*;\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*\$\w{1,40}\s*=\s*str_replace.+?\s*file\s*\(\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*\)\s*\.\s*\$\w{1,40}\s*\)\s*;\s*foreach\s*\(\s*\$\w{1,40}\s*as\s*\$\w{1,40}\s*\)\s*\{\s*echo\s*\$\w{1,40}\s*;\s*\}\s*die\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0645"
    name: "PHP-REX-0645"
    description: "Malware detection signature PHP-REX-0645"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*strrev\s*\(\s*"edoced_46esab"\s*\)\s*;\s*include_once\s*\(\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0646"
    name: "PHP-REX-0646"
    description: "Malware detection signature PHP-REX-0646"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(gzuncompress\(base64_decode\(''eF6FVG1vokAQ.+''\)\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0647"
    name: "PHP-REX-0647"
    description: "Malware detection signature PHP-REX-0647"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*echo\s*1\s*;\s*exit\s*;.+?\$login\s*=\s*"[^"]*"\s*;\s*\$pass\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*''[^'']{1000,}''\s*\)\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0648"
    name: "PHP-REX-0648"
    description: "Malware detection signature PHP-REX-0648"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*print\s*"[^"]*"\s*;\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*\w+\s*\]\s*\)\s*\)\s*\{\s*if\s*\(\s*is_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*\w+\s*\]\s*\[\s*tmp_name\s*\]\s*\)\s*\)\s*\{\s*@copy\s*\(\s*\$\w{1,40}\s*\[\s*\w+\s*\]\s*\[\s*tmp_name\s*\]\s*,\s*\$\w{1,40}\s*\[\s*\w+\s*\]\s*\[\s*name\s*\]\s*\)\s*;\s*\}\s*\}\s*;\s*\}\s*else\s*\{\s*header\s*\(\s*"[^"]*"\s*\)\s*;\s*print\s*"<title>404 Not Found</title><h1>404 Not Found</h1>"\s*;\s*exit\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0649"
    name: "PHP-REX-0649"
    description: "Malware detection signature PHP-REX-0649"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*</head>\s*<body>\s*<style\s*type\s*="[^"]*">.+?<\s*/style\s*>\s*<\?php\s*eval\s*\(\s*pack\s*\(\s*''H\*''\s*,\s*''[^'']*''\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0650"
    name: "PHP-REX-0650"
    description: "Malware detection signature PHP-REX-0650"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$zip\s*=\s*new\s*ZipArchive\s*\(\s*\)\s*;\s*\$zip_status\s*=\s*\$\w{1,40}-\s*>\s*open\s*\(\s*"[^"]*"\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}\s*===\s*true\s*\)\s*\{.+\."\)"\);\s*}\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0651"
    name: "PHP-REX-0651"
    description: "Malware detection signature PHP-REX-0651"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$archive_path\s*=\s*''[^'']*''\s*;\s*\$extract_path\s*=\s*''[^'']*''\s*;\s*if\s*\(\s*!file_exists.+}\s*}\s*echo\s*"OK"\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0652"
    name: "PHP-REX-0652"
    description: "Malware detection signature PHP-REX-0652"
    severity: critical
    category: php_backdoor
    pattern: 'foreach\s*\(\s*\$RandomNum\s*as\s*\$key\s*\)\s*\{\s*\$Keys\s*\.\s*=\s*chr\s*\(\s*bindec\s*\(\s*\$\w{1,40}\s*\*\s*\d+\s*-\s*\d+\s*\)\s*\)\s*;\s*\}\s*@?(eval|echo)\s*\(\s*\$\w{1,40}\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0653"
    name: "PHP-REX-0653"
    description: "Malware detection signature PHP-REX-0653"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*mail\s*\(\s*stripslashes\s*\(\s*\$_(POST|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*,\s*stripslashes\s*\(\s*\$_(POST|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*,\s*stripslashes\s*\(\s*\$_(POST|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*echo\s*''[^'']*''\s*;\s*\}\s*else\s*\{\s*echo\s*''[^'']*''\s*\.\s*\$\w{1,40}\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0654"
    name: "PHP-REX-0654"
    description: "Malware detection signature PHP-REX-0654"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$archive_path\s*=\s*''\w+\.zip'';\s*\$extract_path = ''[^'']+'';\s*.+touch\(\s*\$extract_path\s*\.\s*\$value\s*,\s*filemtime\(\$archive_path\s*\)\s*\);\s*}\s*}\s*echo\s*"Ok!";\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0655"
    name: "PHP-REX-0655"
    description: "Malware detection signature PHP-REX-0655"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*\w+\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*gzuncompress\s*\(\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;\s*for\s*\(.+?eval\(\w+\("[^)]+\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0656"
    name: "PHP-REX-0656"
    description: "Malware detection signature PHP-REX-0656"
    severity: critical
    category: php_backdoor
    pattern: 'if\(count\(\$_GET\)>0\){\$c_=0;\$c0=explode\(''&'',\$_SERVER\[''QUERY_STRING''\]\);.+?}}}}if\(\$c_==1\){unset\(\$_GET\[\$c1\]\);\$c4=false;\$c5='''';\$c6='''';include ''class-wp-filesystem-admin\.php'';exit\(0\);}};'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0657"
    name: "PHP-REX-0657"
    description: "Malware detection signature PHP-REX-0657"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*''[^;]+;\s*/\*[^*]+\*/.+if\(\s*crc32\(\$\w+\)\s*==\s*\$\w+\)\s*{\s*\$\w{1,40}\s*=\s*create_function\(''\$\w+'',\$\w{1,40}\);\s*\$\w{1,40}\("[^"]+"\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0658"
    name: "PHP-REX-0658"
    description: "Malware detection signature PHP-REX-0658"
    severity: critical
    category: php_backdoor
    pattern: '@require\(''\./images/\d+''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0659"
    name: "PHP-REX-0659"
    description: "Malware detection signature PHP-REX-0659"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_REQUEST\s*\[\s*"\w+"\s*\]\s*\)\s*\)\s*{.+?@arsort\s*\(\s*\$\w{1,40}\s*\)\s*;\s*@\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*exit\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0660"
    name: "PHP-REX-0660"
    description: "Malware detection signature PHP-REX-0660"
    severity: critical
    category: php_backdoor
    pattern: 'public\s*function\s*getConfigOpt\s*\(\s*\)\s*\{\s*\$\w{1,40}\s*=\s*@file_get_contents\s*\(\s*''[^'']*''\s*\.\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*return\s*@unserialize\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0661"
    name: "PHP-REX-0661"
    description: "Malware detection signature PHP-REX-0661"
    severity: critical
    category: php_backdoor
    pattern: '\$color\s*=\s*"\#df5";.+?ololo_VERSION.+''\)\)\);\s*exit;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0662"
    name: "PHP-REX-0662"
    description: "Malware detection signature PHP-REX-0662"
    severity: critical
    category: php_backdoor
    pattern: 'assert\s*\(\s*stripslashes\s*\(\s*@?\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^]]+\]\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0663"
    name: "PHP-REX-0663"
    description: "Malware detection signature PHP-REX-0663"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*copy\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''tmp_name''\s*\]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*exit\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0664"
    name: "PHP-REX-0664"
    description: "Malware detection signature PHP-REX-0664"
    severity: critical
    category: php_backdoor
    pattern: '(var_dump|print|echo|die)\(\s*(shell_exec|exec|popen|system)\s*\(\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[[^]]+\]\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0665"
    name: "PHP-REX-0665"
    description: "Malware detection signature PHP-REX-0665"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\s*\(\s*\d+\s*\)\s*;\s*@define\s*\(\s*urldecode\s*\(\s*''[^'']*''\s*\)\s*,\s*''[^'']*''\s*\)\s*;\s*@include_once\s*\(\s*dirname\s*\(\s*__FILE__\s*\)\s*\.\s*''[^'']*''\s*\.\s*urldecode\s*\(\s*''[^'']*''\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0666"
    name: "PHP-REX-0666"
    description: "Malware detection signature PHP-REX-0666"
    severity: critical
    category: php_backdoor
    pattern: '^\s*<\?php\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*eval\s*\(\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;\s*exit\s*\(\s*\)\s*;\s*\?>\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0667"
    name: "PHP-REX-0667"
    description: "Malware detection signature PHP-REX-0667"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\$_REQUEST\s*\[\s*''sort''\s*\]\s*\)\s*\){\s*\$string\s*=\s*\$_REQUEST\[''sort''\];\s*\$array_name\s*=\s*'''';\s*\$alphabet.+?exit\s*\(\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0668"
    name: "PHP-REX-0668"
    description: "Malware detection signature PHP-REX-0668"
    severity: critical
    category: php_backdoor
    pattern: '(include|include_once)\(\s*\$path\s*\.\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\[\s*"\w+"\s*\]\s*\)\s*;\s*die\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0669"
    name: "PHP-REX-0669"
    description: "Malware detection signature PHP-REX-0669"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*@?\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*g\s*\]\s*\)\s*\{\s*\$\w{1,40}\s*=\s*@fopen\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*p\s*\]\s*,\s*''[^'']*''\s*\)\s*;\s*fwrite\s*\(\s*\$\w{1,40}\s*,\s*file_get_contents\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*g\s*\]\s*\)\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0670"
    name: "PHP-REX-0670"
    description: "Malware detection signature PHP-REX-0670"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*@?\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*c\s*\]\s*\)\s*\{\s*echo\s*\(\s*\$\w{1,40}=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*c\s*\]\s*\)\s*\.\s*\$\w{1,40}\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*f\s*\]\s*\)\s*;\s*exit\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0672"
    name: "PHP-REX-0672"
    description: "Malware detection signature PHP-REX-0672"
    severity: critical
    category: php_backdoor
    pattern: '<\s*center\s*>\s*<\s*h5\s*>[^<]+<\s*/h5\s*>\s*<\?php\s*eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*str_rot13\s*\(\s*"[^"]*"\s*\)\s*\)\s*\)\s*\)\s*;\s*\?>\s*<\s*/center\s*>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0673"
    name: "PHP-REX-0673"
    description: "Malware detection signature PHP-REX-0673"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*echo\s*"[^"]*"\s*;\s*\}\s*\$\w{1,40}\s*=\s*''[^;]+;\s*@eval\s*\(\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0674"
    name: "PHP-REX-0674"
    description: "Malware detection signature PHP-REX-0674"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*array\s*\([^)]+\)\s*;\s*\$\w{1,40}\s*=\s*implode\s*\(\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0675"
    name: "PHP-REX-0675"
    description: "Malware detection signature PHP-REX-0675"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*''[^;]+;(\$\w{1,40}\s*=\s*(\$\w{1,40}\[\d+\]\.?){3,};)+.+?;\${(\$\w{1,40}\[\d+\]\.?)+}\(\);}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0676"
    name: "PHP-REX-0676"
    description: "Malware detection signature PHP-REX-0676"
    severity: critical
    category: php_backdoor
    pattern: '\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*="[^"]*"\s*;\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*="[^"]*"\s*;\s*\$\s*\{\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*\}\s*=__FILE__\s*;\s*\$\s*\{\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*\}\s*="[^"]*"\s*;\s*eval\s*\(\s*base64_decode\s*\(\s*"[^"]*"\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0677"
    name: "PHP-REX-0677"
    description: "Malware detection signature PHP-REX-0677"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\$_REQUEST\[''\w+'']\s*\)\s*\)\s*die\(\s*pi.+eval\(\s*\${\s*\$\w+\s*}\s*\["[^"]+"\s*\]\s*\)\s*;\s*}\s*exit\(\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0678"
    name: "PHP-REX-0678"
    description: "Malware detection signature PHP-REX-0678"
    severity: critical
    category: php_backdoor
    pattern: '@copy\s*\(\s*["'']https?://[^"'']+["'']\s*,\s*["''].+?\.ph\w+["'']\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0679"
    name: "PHP-REX-0679"
    description: "Malware detection signature PHP-REX-0679"
    severity: critical
    category: php_backdoor
    pattern: '//\s*installbg\s*\$\w{1,40}=''[^'']+'';\s*require\("\$\w{1,40}"\);\s*//\s*installend'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0680"
    name: "PHP-REX-0680"
    description: "Malware detection signature PHP-REX-0680"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*include\s*\(\s*''/.+?/bitrix/images/iblock/ib\.php''\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0681"
    name: "PHP-REX-0681"
    description: "Malware detection signature PHP-REX-0681"
    severity: critical
    category: php_backdoor
    pattern: '\$USER->Authorize\s*\(\s*1\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0682"
    name: "PHP-REX-0682"
    description: "Malware detection signature PHP-REX-0682"
    severity: critical
    category: php_backdoor
    pattern: 'class\s*lTransmiter\s*{\s*var\s*\$version.+return \$this->raise_error\(''<!--ERROR: Unable to use transport\.-->''\);\s*}\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0683"
    name: "PHP-REX-0683"
    description: "Malware detection signature PHP-REX-0683"
    severity: critical
    category: php_backdoor
    pattern: '\$path\s*=\s*\$_SERVER\[''DOCUMENT_ROOT''\]\s*\.\s*''/upload/\w+/''\.SITE_ID.+?fclose\(\$fp\);\s*include_once\(\$path\."/footer\.php"\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0684"
    name: "PHP-REX-0684"
    description: "Malware detection signature PHP-REX-0684"
    severity: critical
    category: php_backdoor
    pattern: '<\s*\?\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*assert_options\s*\(\s*ASSERT_ACTIVE\s*,\s*1\s*\)\s*;.+?\$\w{1,40}\s*\(\s*str_rot13\s*\(\s*''[^'']*''\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0685"
    name: "PHP-REX-0685"
    description: "Malware detection signature PHP-REX-0685"
    severity: critical
    category: php_backdoor
    pattern: '\.\s*''</div>'';\s*\$\w+\s*=\s*''PGRpdi[^'']+'';\s*echo\s+base64_decode\(\$\w+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0686"
    name: "PHP-REX-0686"
    description: "Malware detection signature PHP-REX-0686"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*="[^"]*"\s*;\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*=.+?Smarty3::redirect\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*true\s*,\s*true\s*,\s*\$\s*\{\s*\$\s*\{\s*"[^"]*"\s*\}\s*\[\s*"[^"]*"\s*\]\s*\}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0687"
    name: "PHP-REX-0687"
    description: "Malware detection signature PHP-REX-0687"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*md5\(\s*reset\(\s*\$_COOKIE\s*\)\s*\)\s*==\s*''\w+''\s*&&\s*count\(\s*\$_COOKIE\s*\)\s*>\s*\d+\s*\)\s*{\s*\$_sessions_debug_data.+?unlink\(\s*\$_session_debug_stream\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0688"
    name: "PHP-REX-0688"
    description: "Malware detection signature PHP-REX-0688"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(\d+\);\s*\$filename\s*=\s*"\w+";\s*\$task_id="\w+";\s*if\(\s*!file_exists\(\$filename\)\s*&&\s*function_exists\(\s*"parse_url"\s*\)\s*&&\s*function_exists\(\s*"socket_create"\s*\).+?\$f\s*=\s*@fopen\(\s*\$filename\s*,\s*"w"\s*\);\s*fclose\(\$f\);\s*}\s*socket_close\(\s*\$fp\s*\);\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0689"
    name: "PHP-REX-0689"
    description: "Malware detection signature PHP-REX-0689"
    severity: critical
    category: php_backdoor
    pattern: '{\${@(eval|assert)\(\s*base64_decode\(\s*\$_(GET|GET|POST|COOKIE|REQUEST|SERVER)\[\s*[^]]+\s*\]\s*\)\s*\)\s*}}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0690"
    name: "PHP-REX-0690"
    description: "Malware detection signature PHP-REX-0690"
    severity: critical
    category: php_backdoor
    pattern: '\("/usr/local/apache/bin/httpd -DSSL","/sbin/syslogd","\[eth0\]","/sbin/klogd'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0691"
    name: "PHP-REX-0691"
    description: "Malware detection signature PHP-REX-0691"
    severity: critical
    category: php_backdoor
    pattern: 'add_filter\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*,\s*10001\s*\)\s*;\s*function\s*_bloginfo\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*global\s*\$\w{1,40}\s*;\s*if\s*\(\s*is_single\s*\(\s*\)\s*&&\s*\(\s*\$\w{1,40}\s*=@eval\s*\(\s*get_option\s*\(\s*''[^'']*''\s*\)\s*\)\s*\)\s*!==\s*false\s*\)\s*\{\s*return\s*\$\w{1,40}\s*;\s*\}\s*else\s*return\s*\$\w{1,40}\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0692"
    name: "PHP-REX-0692"
    description: "Malware detection signature PHP-REX-0692"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*,\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0693"
    name: "PHP-REX-0693"
    description: "Malware detection signature PHP-REX-0693"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*eval\s*\(\s*gzuncompress\s*\(\s*"[^"]*"\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0694"
    name: "PHP-REX-0694"
    description: "Malware detection signature PHP-REX-0694"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?(assert|eval)\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^"'']*[''"]\s*\]\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0695"
    name: "PHP-REX-0695"
    description: "Malware detection signature PHP-REX-0695"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(\s*E_ALL\s*&\s*.E_NOTICE\s*\);.+?exit\s*\(\s*">\|1\|<"\s*\)\s*;\s*\}\s*\}\s*\}\s*else\s*\{\s*header\s*\(\s*"[^"]*"\s*\)\s*;\s*exit\s*\(\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0696"
    name: "PHP-REX-0696"
    description: "Malware detection signature PHP-REX-0696"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\)\s*&&\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=\s*array\s*\(\s*''[^)]+\)\s*;\s*echo\s*\$\w{1,40}\s*\[\s*chr\s*\(\s*\d+\s*\)\s*\]\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*exit\s*;\s*\}\s*\?>\s*<form.+?</form>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0697"
    name: "PHP-REX-0697"
    description: "Malware detection signature PHP-REX-0697"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*[^;]+;\s*\$\w{1,40}\s+=[^;]+;\s*@\s*\$\w{1,40}\s*\([^;]+;[''"]\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0698"
    name: "PHP-REX-0698"
    description: "Malware detection signature PHP-REX-0698"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(echo[^;]+;)?\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*array\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\)\s*;\s*array_filter\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0699"
    name: "PHP-REX-0699"
    description: "Malware detection signature PHP-REX-0699"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*//[^)]+\);\s*(?:\$[O0_]+=(?:''[^'']+''|\d+);\s*){2,10}.+"]\(\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0700"
    name: "PHP-REX-0700"
    description: "Malware detection signature PHP-REX-0700"
    severity: critical
    category: php_backdoor
    pattern: '@assert\(@base64_decode\(@str_rot13\(\$_POST\["data"]\)\)\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0701"
    name: "PHP-REX-0701"
    description: "Malware detection signature PHP-REX-0701"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*Array\([^;]+;\$\w{1,40}\s*=\s*Array\([^;]+;\s*@\$\w{1,40}\s*\[\s*chr\s*\(\s*\d+\s*\)\s*\]\s*\(\s*\$\w{1,40}\s*\[\s*chr\s*\(\s*\d+\s*\)\s*\]\s*\(\s*"[^"]*"\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0702"
    name: "PHP-REX-0702"
    description: "Malware detection signature PHP-REX-0702"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*([''"][^''"]*[''"]\s*\.?\s*){15,}\)\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0703"
    name: "PHP-REX-0703"
    description: "Malware detection signature PHP-REX-0703"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^''"]*["'']\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}=\s*explode\s*\(\s*["][^"'']*["'']\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*["''][^"'']*["'']\s*\]\s*\)\s*;\s*@die\s*\(\s*\$\w+\[\d+\]\(\$\w+\[\d+\]\)\);\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0704"
    name: "PHP-REX-0704"
    description: "Malware detection signature PHP-REX-0704"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*''PGRpdi[^'']*''\s*;\s*echo\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0705"
    name: "PHP-REX-0705"
    description: "Malware detection signature PHP-REX-0705"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*"[^"]*"\s*\)\s*\)\s*\)\s*;(\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*\)\s*\)\s*\)\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*\)\s*\)\s*\)\s*;\s*)+\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0706"
    name: "PHP-REX-0706"
    description: "Malware detection signature PHP-REX-0706"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*_parseReqRoute\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*if\s*\(\s*\$\w{1,40}\s*=\s*JRequest::getVar\s*\(\s*''[^'']*''\s*\)\s*AND\s*md5\s*\(\s*\$_SERVER\s*\[\s*''[^'']*''\s*\]\s*\)\s*==\s*''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*if\s*\(\s*@\$\w{1,40}\s*\(\s*get_magic_quotes_gpc\s*\(\s*\)\s*\?\s*stripslashes\s*\(\s*\$\w{1,40}\s*\)\s*:\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*return\s*true\s*;\s*\}\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0707"
    name: "PHP-REX-0707"
    description: "Malware detection signature PHP-REX-0707"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*\$_POST\s*\[\s*''[^'']*''\s*\]\s*;\s*if\s*\(\s*!\$\w{1,40}\s*\)\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*rtrim\s*\(\s*\$\w{1,40}\s*,\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*;\s*@move_uploaded_file\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\.\s*"[^"]*"\s*\.\s*\$\w{1,40}\s*\)\s*\?\s*print\s*"[^"]*"\s*:\s*print\s*["''][^"'']*["'']\s*;\s*\}\s*/\*[^\*]+\*/\s*print\s*[''"][^'']+[''"]\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0708"
    name: "PHP-REX-0708"
    description: "Malware detection signature PHP-REX-0708"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_REQUEST\[\s*\\\''.\\\''\s*\]\s*\)\s*{\s*eval\(\s*stripslashes\(\s*\$_REQUEST\[\s*\\\''.\\\''\s*\]\s*\)\s*\);\s*die\(\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0709"
    name: "PHP-REX-0709"
    description: "Malware detection signature PHP-REX-0709"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*&&\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==\s*[''"]1[''"]\s*\)\s*\)\s*\{\s*\?>.+?scandir\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*for\s*\(\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*<\s*=\s*count\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\+\+\s*\)\s*\{\s*echo\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\.\s*"[^"]*"\s*;\s*\}\s*\}\s*exit\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0710"
    name: "PHP-REX-0710"
    description: "Malware detection signature PHP-REX-0710"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=\s*array\s*\(\s*\)\s*;.+?;\s*eval\s*\(\s*\w+\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]+"\s*(\)\s*)+;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0711"
    name: "PHP-REX-0711"
    description: "Malware detection signature PHP-REX-0711"
    severity: critical
    category: php_backdoor
    pattern: '<\?phps\*@?assert\(@?base64_decode\(@?str_rot13\(\$_POST\["data"\]\)\)\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0712"
    name: "PHP-REX-0712"
    description: "Malware detection signature PHP-REX-0712"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\$\w{1,40}\s*=\s*iconv\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*file_get_contents\s*\(\s*"http://[^"]*"\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0713"
    name: "PHP-REX-0713"
    description: "Malware detection signature PHP-REX-0713"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*=="[^"]*"\s*\)\s*\{\s*eval\s*\(\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*;\s*die\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0714"
    name: "PHP-REX-0714"
    description: "Malware detection signature PHP-REX-0714"
    severity: critical
    category: php_backdoor
    pattern: 'ignore_user_abort\s*\(\s*true\s*\)\s*;\s*set_time_limit\s*\(\s*\d+\s*\)\s*;\s*@ini_set\s*\(\s*''[^'']*''\s*,\s*NULL\s*\)\s*;\s*@ini_set\s*\(\s*''[^'']*''\s*,\s*0\s*\)\s*;\s*function\s*getURL.+?getURL\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*exit\s*;\s*\}\s*\}\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0715"
    name: "PHP-REX-0715"
    description: "Malware detection signature PHP-REX-0715"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,10}\s*=\s*Array\s*\(\s*str_rot13\s*\([^;]+;\s*\$\w{1,40}\s*=\s*Array\s*\([^;]+;\s*@\$\w{1,40}\s*\[\s*chr\s*\(\s*\d+\s*\)\s*\]\s*\(\s*\$\w{1,40}\s*\[\s*chr\s*\(\s*\d+\s*\)\s*\]\s*\(\s*"[^"]*"\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0716"
    name: "PHP-REX-0716"
    description: "Malware detection signature PHP-REX-0716"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@assert\s*\(\s*str_rot13\s*\(\s*''[^'']+''\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0717"
    name: "PHP-REX-0717"
    description: "Malware detection signature PHP-REX-0717"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*md5\s*\(\s*@\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*==\s*"[^"]*"\s*\)\s*\{\s*print\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\.\s*basename\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*if\s*\(\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*,\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*echo\s*"[^"]*"\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0718"
    name: "PHP-REX-0718"
    description: "Malware detection signature PHP-REX-0718"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$\w+\s*=\s*\$_SERVER\[[^]]+\]\s*\.\s*["''][^"]+["'']\s*;\s*include\s*\$\w+\s*\.\s*["''][^"]+["''];\s* Smarty3::redirect\([^)]+\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0719"
    name: "PHP-REX-0719"
    description: "Malware detection signature PHP-REX-0719"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*eval\s*\(\s*file_get_contents\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*;\s*\}\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0720"
    name: "PHP-REX-0720"
    description: "Malware detection signature PHP-REX-0720"
    severity: critical
    category: php_backdoor
    pattern: '<\?(php)?\s*@?preg_replace\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*[^]]+\]\s*,\s* \$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*[^]]+\]\s*,\s*[''"][''"]\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0721"
    name: "PHP-REX-0721"
    description: "Malware detection signature PHP-REX-0721"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*"[^"]*"==\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\{\s*echo\s*"[^"]*"\s*;\s*\}\s*if\s*\(\s*is_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*move_uploaded_file\s*\(\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*,\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\[\s*"[^"]*"\s*\]\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0722"
    name: "PHP-REX-0722"
    description: "Malware detection signature PHP-REX-0722"
    severity: critical
    category: php_backdoor
    pattern: '(?:\$\w{1,40}\s*=\s*[^;]{1,100}\s*;\s*){3,}@\$\w+\s*\(\s*@\$\w{1,40}\s*\(\s*@\$\w{1,40}\s*\(\$_(?:GET|POST|COOKIE|REQUEST|SERVER)\[[^\]]+\]\s*\)\s*\)\s*\)\s*;\s*die(\(\))?\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0723"
    name: "PHP-REX-0723"
    description: "Malware detection signature PHP-REX-0723"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*&&\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*fopen\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*,\s*"[^"]*"\s*\)\s*;\s*fputs\s*\(\s*\$\w{1,40}\s*,\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*print\s*"[^"]*"\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0724"
    name: "PHP-REX-0724"
    description: "Malware detection signature PHP-REX-0724"
    severity: critical
    category: php_backdoor
    pattern: '(include|include_once)\s*(\()?\s*"\\x2f[^.]+\.(p\\x68p|\\x70h\\x70|\\x70hp|p\\x68\\x70|\\x70\\x68p)"\s*(\))?\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0725"
    name: "PHP-REX-0725"
    description: "Malware detection signature PHP-REX-0725"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*AND\s*!isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*setcookie\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*time\s*\(\s*\)\s*\+\d+\s*\)\s*;\s*\$\w{1,40}\s*=\s*array\s*\([^)]+\)\s*;\s*for\s*\(\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*<\s*count\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\+\+\s*\)\s*if\s*\(\s*strpos\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*!==\s*false\s*\)\s*\{\s*if\s*\(\s*is_mobile\s*\(\s*\)\s*\)\s*exit\s*\(\s*''[^'']*''\s*\)\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0726"
    name: "PHP-REX-0726"
    description: "Malware detection signature PHP-REX-0726"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=''[^'']*''\s*;\s*if\s*\(\s*preg_match\s*\(\s*''[^'']*''\s*,\s*\$_SERVER\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\$\w{1,40}-\s*>\s*super_query\s*\(\s*"[^"]*"\s*\.\s*PREFIX\s*\.\s*"[^"]*"\s*,\s*true\s*\)\s*;\s*\$\w{1,40}\s*=\s*explode\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*if\s*\(\s*\(\s*\(\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*\+86400\s*\)\s*<\s*time\s*\(\s*\)\s*\)\s*\|\|!\$\w{1,40}\s*\[\s*\d+\s*\]\s*\)\s*\{\s*\$\w{1,40}\s*=@file_get_contents\s*\(\s*base64_decode\s*\(\s*''[^'']*''\s*\)\s*\)\s*;\s*if\s*\(\s*!\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\$\w{1,40}\s*\[\s*\d+\s*\]\s*;\s*\}\s*\$\w{1,40}-\s*>\s*query\s*\(\s*"[^"]*"\s*\.\s*PREFIX\s*\.\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}-\s*>\s*query\s*\(\s*"[^"]*"\s*\.\s*PREFIX\s*\.\s*"[^"]*"\s*\.\s*time\s*\(\s*\)\s*\.\s*"[^"]*"\s*\.\s*\$\w{1,40}-\s*>\s*safesql\s*\(\s*\$\w{1,40}\s*\)\s*\.\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\s*\(\s*base64_decode\s*\(\s*''[^'']*''\s*\)\s*\)\s*\.\s*\$_SERVER\s*\[\s*''[^'']*''\s*\]\s*;\s*@file_get_contents\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*;\s*\}\s*else\s*\{\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0727"
    name: "PHP-REX-0727"
    description: "Malware detection signature PHP-REX-0727"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*preg_match\s*\(\s*''[^'']*''\s*,\s*\$_SERVER\s*\[\s*''HTTP_USER_AGENT''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*curl_init\s*\(\s*\)\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*curl_setopt\s*\(\s*\$\w{1,40}\s*,\s*CURLOPT_URL\s*,\s*''[^'']*''\s*\)\s*;\s*curl_setopt\s*\(\s*\$\w{1,40}\s*,\s*CURLOPT_RETURNTRANSFER\s*,\s*1\s*\)\s*;\s*curl_setopt\s*\(\s*\$\w{1,40}\s*,\s*CURLOPT_CONNECTTIMEOUT\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*curl_exec\s*\(\s*\$\w{1,40}\s*\)\s*;\s*curl_close\s*\(\s*\$\w{1,40}\s*\)\s*;\s*echo\s*\$\w{1,40}\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0728"
    name: "PHP-REX-0728"
    description: "Malware detection signature PHP-REX-0728"
    severity: critical
    category: php_backdoor
    pattern: '//Footer-Template.+?//Footer-Template'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0737"
    name: "PHP-REX-0737"
    description: "Malware detection signature PHP-REX-0737"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*@?eval\s*\(\s*base64_decode\s*\(\s*(?:ZXZhbCAoIGJhc2U2NF8|ZXZhbCAoYmFzZTY0Xw|ZXZhbChiYXNlNjRf|QGV2YWwoYmFzZTY0X|QGV2YWwgKGJhc2U2NF8|QGV2YWwgKCBiYXNlNjRf|QGV2YWwoIGJhc2U2NF8)[^?]{50,999}\)\s*\)\s*;?\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0740"
    name: "PHP-REX-0740"
    description: "Malware detection signature PHP-REX-0740"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*(<\?php\s+)(?:shell_exec|exec)\s*\(\s*[''"]/bin/bash[^\>]{1,20}-i\s+>&\s+/dev/tcp/[\d+\.]{1,20}/\d{1,6}\s+\d>&\d[''"][''"]\s*\)\s*;?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0757"
    name: "PHP-REX-0757"
    description: "Malware detection signature PHP-REX-0757"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*(<\?php\s+)@?(?:eval|assert|system|shell_exec|exec|popen|passthru)\s*\(\s*str_rot13\s*\(\s*[''"]\s*riny[^\$]{1,9}\$_\w{1,6}\[\w{1,9}\]\s*\)\s*;\s*[''"]\s*\)\s*\)\s*;?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0763"
    name: "PHP-REX-0763"
    description: "Malware detection signature PHP-REX-0763"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*(<\?php\s+)[^\(]{1,99}\s*(?:exec|shell_exec)\s*\(\s*[''"]\s*if\s+curl\s*(?:127\.0\.0\.1|localhost)\s+-o\s+/dev/null\s+2>/dev/null;\s+then curl\s+-o\s*-\s*https?://[^\)]{1,99}\)\s*;?\s*(?:echo\s*\(?\s*[''"][^''"]*[''"]\s*;?)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0771"
    name: "PHP-REX-0771"
    description: "Malware detection signature PHP-REX-0771"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*(<\?php\s*)@?eval\s*\(\s*base64_decode\s*\(\s*[''"]ZXJyb3JfcmVwb3J0aW5nKDApO[^''"]{1,600}(?:PHRpdGxlPg|dGl0bGU|aXRsZT4|SFRUUF9SRUZFUg|VFRQX1JFRkVS|VFBfUkVGRVI)[^''"]{1,600}[''"]\s*\)\s*\)\s*;?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0772"
    name: "PHP-REX-0772"
    description: "Malware detection signature PHP-REX-0772"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*(<\?php\s*)@?eval\s*\(\s*base64_decode\s*\(\s*[''"][^''"]{1,600}(?:QGN1cmxfc2V0b3B0|Y3VybF9zZXRvcHQ)[^''"]{1,600}(?:ZXZhbA|dmFs|YWwo)[^''"][^''"]{1,600}[''"]\s*\)\s*\)\s*;?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0773"
    name: "PHP-REX-0773"
    description: "Malware detection signature PHP-REX-0773"
    severity: critical
    category: php_backdoor
    pattern: '<IfModule\s+mod_rewrite\.c>[^\?]+?google\|yahoo\|msn\|aol\|bing[^\*]+?index\.php\s+\[L\]\s*</IfModule>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0779"
    name: "PHP-REX-0779"
    description: "Malware detection signature PHP-REX-0779"
    severity: critical
    category: php_backdoor
    pattern: '(<\?php\s*)@?eval\s*\(\s*base64_decode\s*\(\s*[''"]\w{0,40}(?:cnJvcl9yZXBvcnRpbmcoMCk|ZXJyb3JfcmVwb3J0aW5nKDAp)[^''"]{1,300}(?:VFBfVVNFUl9BR0VOVC|VFRQX1VTRVJfQUdFTlQ|SFRUUF9VU0VSX0FHRU5U)[^''"]{1,999}(?:cmVnX21hdGNo|cHJlZ19tYXRjaA|ZWdfbWF0Y2g)[^''"]{1,999}(?:aXQoKTs|eGl0KCk7|ZXhpdCgp)[^''"]{1,300}[''"]\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0785"
    name: "PHP-REX-0785"
    description: "Malware detection signature PHP-REX-0785"
    severity: critical
    category: php_backdoor
    pattern: '<script\s+language\s*=\s*[''"]php[''"]\s*>\s*\s*@?(?:eval|assert|system|shell_exec|exec|popen|passthru)\s*\((?:\s*(?:base64_decode|gzinflate|gzuncompress|str_rot13|strrev)\s*\(){0,5}\s*\(?\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[[^\]]{1,40}\](?:\s*\)\s*){1,6};?\s*</script>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0788"
    name: "PHP-REX-0788"
    description: "Malware detection signature PHP-REX-0788"
    severity: critical
    category: php_backdoor
    pattern: '(\{)\s*@?\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]{1,40}\s*\]\s*\(\s*@?\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]{1,40}\s*\]\s*\(\s*[''"][^''"]*[''"]\s*,\s*@?\$\w{1,40}\s*\)\s*\)\s*;\s*(\})'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0789"
    name: "PHP-REX-0789"
    description: "Malware detection signature PHP-REX-0789"
    severity: critical
    category: php_backdoor
    pattern: '(?:\$\w+\s*=\s*[''"][\w\\]+?[''"]\s*\^\s*[''"][\w\\]+?[''"];\s*)+\$\w+\(\$\w+\s*,\s*[''"][\w\\]+?[''"]\^[''"][\w\\]+?[''"]\s*,\s*[''"]\w+[''"]\);(?://\w{16,64})?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0801"
    name: "PHP-REX-0801"
    description: "Malware detection signature PHP-REX-0801"
    severity: critical
    category: php_backdoor
    pattern: '(<\?php\s*echo\s*[^''"]{1,40}\s*;\s*@)eval(\(\$_POST\[\w+\]\);\s*\?>)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0802"
    name: "PHP-REX-0802"
    description: "Malware detection signature PHP-REX-0802"
    severity: critical
    category: php_backdoor
    pattern: '(<\?php\s+)eval\(base64_decode\([''"]DQplcnJvcl9yZXBvcnRpbmcoMCk7[^''"]{1,600}cmVmZXJl[^''"]{1,999}eGl0[^''"]{1,500}[''"]\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0805"
    name: "PHP-REX-0805"
    description: "Malware detection signature PHP-REX-0805"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(is_object\(\$_SESSION\["__default"\]\["user"\]\)\s*&&\s*!\(\$_SESSION\["__default"\]\["user"\]->id\)\)\s*{echo\s*"\s*<script\s*language=JavaScript\s*id=onDate\s*>\s*</script>\s*<script\s*language=JavaScript\s*src=[^>]+>\s*</script>\s*"\s*;?\s*\}\s*;?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0806"
    name: "PHP-REX-0806"
    description: "Malware detection signature PHP-REX-0806"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\s*\(\s*is_file\(\s*[''"]/[^''"]+\.php[''"]\s*\)\s*\)\s*\{\s*include(?:_once)?\s*\(\s*[''"]/[^''"]+/wp\-[\w\-]{1,20}\.php[''"]\s*\);\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0809"
    name: "PHP-REX-0809"
    description: "Malware detection signature PHP-REX-0809"
    severity: critical
    category: php_backdoor
    pattern: '(\{)\s*@?copy\(\s*["]https?://[^"'']+["]\s*,\s*["''][^\$][^.]+\.php["'']\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0815"
    name: "PHP-REX-0815"
    description: "Malware detection signature PHP-REX-0815"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(base64_decode\(''(?:JGY9|JGYgP)[^''"]+?''\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0828"
    name: "PHP-REX-0828"
    description: "Malware detection signature PHP-REX-0828"
    severity: critical
    category: php_backdoor
    pattern: '\$\{[''"](?:G|\\x47)(?:L|\\x4c)[^]]{9,49}\]=[''"][^''"]{3,12}[''"];\$\{\$\{[''"](?:G|\\x47)(?:L|\\x4c)[^]]{9,49}\]\}=[''"][^''"]{99,500}\\x31\\x30\\x34\\x2e\\x31\\x33\\x31\\x2e\\x31\\x35\\x34\\x2e\\x31\\x35\\x34[^''"]+[''"];@?exec\([''"](?:p|\\x70)(?:e|\\x65)(?:r|\\x72)(?:l|\\x6c)[^''"]{1,99}[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0851"
    name: "PHP-REX-0851"
    description: "Malware detection signature PHP-REX-0851"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*\$\w{0,9}_pass\s*=\s*[''"]\w{1,40}[''"]\s*;\s*(?:\?>\s*<\?php\s*)?\s*@?eval\s*\([''"][^''"]{0,20}[''"]\s*\.\s*base64_decode\s*\(\s*[''"][^''"]+[''"]\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0856"
    name: "PHP-REX-0856"
    description: "Malware detection signature PHP-REX-0856"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(strpos\(\$_SERVER\[''REQUEST_URI''\]\s*,\s*''[^'']+''\)\s*!==\s*false\)\s*{\s*error_reporting\(0\);\s*ini_set\(''display_errors'',\s*0\);\s*set_time_limit\(0\);.+add_filter\( ''wp_title'',\s*''\w+''\s*\);\s*}\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0857"
    name: "PHP-REX-0857"
    description: "Malware detection signature PHP-REX-0857"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]{200,}"\s*;\s*(\$\w{1,40}\s*=\s*str_replace\s*\(\s*[''"][^;]+;\s*)+preg_replace\(\s*[''"][^;]+;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0858"
    name: "PHP-REX-0858"
    description: "Malware detection signature PHP-REX-0858"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[''\w+''\];global\$\w+;\$\w+=\$GLOBALS;\${[''"](\\x[a-f0-9A-F]+)+[''"]}\[[''"]\w+[''"]\]="(\\x[a-f0-9A-F]+)+";.+?\]\){eval\(\$\w+\[\$\w+\[["'']\w+["'']\]\[\d+\]\]\);}exit\(\);}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0859"
    name: "PHP-REX-0859"
    description: "Malware detection signature PHP-REX-0859"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(base64_decode\("IGVycm9yX.+="\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0860"
    name: "PHP-REX-0860"
    description: "Malware detection signature PHP-REX-0860"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);ini_set\("display_errors", 0\);\$localpath=getenv\("SCRIPT_NAME"\);\$absolutepath=getenv\("SCRIPT_FILENAME"\);\$root_path=substr\(\$absolutepath,0,strpos\(\$absolutepath,\$localpath\)\);include_once\(\$root_path\."/SESS_\w{32}\.php"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0861"
    name: "PHP-REX-0861"
    description: "Malware detection signature PHP-REX-0861"
    severity: critical
    category: php_backdoor
    pattern: '\$var= \$_SERVER\[''PHP_SELF''\];\s*\$form =<<<HTML\s*<form enctype="multipart/form-data" action="\$var" method="POST">\s*<input name="uploadFile" type="file"/><br/>\s*<input type="submit"\s+value="Upload"\s*/>\s*</form>\s*HTML;\s*if \(!empty\(\$_FILES\[''uploadFile''.+?print\s*"OK";\s*}\s*else\s*{\s*print\s*\$form;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0862"
    name: "PHP-REX-0862"
    description: "Malware detection signature PHP-REX-0862"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(0\);ini_set\("display_errors", 0\);\$localpath=getenv\("SCRIPT_NAME"\);\$absolutepath=getenv\("SCRIPT_FILENAME"\);\$\w+=substr\(\$\w+,0,strpos\(\$absolutepath,\$localpath\)\);include_once\(\$root_path\."/\w+.zip"\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0863"
    name: "PHP-REX-0863"
    description: "Malware detection signature PHP-REX-0863"
    severity: critical
    category: php_backdoor
    pattern: 'set_time_limit\(0\);\s*ignore_user_abort\(\);\s*if\s*\(\s*filesize\(\s*"\.htaccess"\s*\)\s*>\s*\d+\s*\)\s*{\s*\$\w+\s*=\s*fopen.+?\(\s*sys_get_temp_dir\(\)\s*\.\s*"/\$\w+"\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0864"
    name: "PHP-REX-0864"
    description: "Malware detection signature PHP-REX-0864"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteRule\s+\^\(\[A-Za-z0-9-\]\+\)\.html\$\s+\w+\.php\?hl=\$1\s+\[L\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0865"
    name: "PHP-REX-0865"
    description: "Malware detection signature PHP-REX-0865"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*file_get_contents\(\s*"https?[^"]+"\s*\);\s*\$\w+\s*=\s*fopen\(\s*"\w+\.php"\s*,\s*"w\+"\s*\);\s*fwrite\(\s*\$\w+\s*,\s*\$\w+\);\s*fclose\(\s*\$fo\s*\);\s*(\?>)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0866"
    name: "PHP-REX-0866"
    description: "Malware detection signature PHP-REX-0866"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*md5\(\s*@?\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*\w+\s*\]\)\s*==\s*''\w+''\s*\)\s*\s*\(\s*\$_=\s*@\$_REQUEST\[\s*\w+\s*\]\)\s*\.\s*@?\$_\(\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*\w+\s*\]\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0867"
    name: "PHP-REX-0867"
    description: "Malware detection signature PHP-REX-0867"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}=\$_(GET|POST|COOKIE|REQUEST|SERVER);\s*\$\w+\s*=\s*\$\w+\[\s*\w+\s*\];\s*if\s*\(\s*\$\w+\s*\)\s*{\s*\$\w+=\s*\$\w+\s*\(\$\w+\s*\[\s*\w+\s*\]\s*\);\s*\$\w+\s*=\s*\$\w+\s*\(\s*\$\w+\s*\[\s*\w+\s*\]\s*\);\s*\$\w+\s*=\s*\$\w+\s*\(""\s*,\s*\$\w+\s*\);\s*\$\w+\s*\(\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0868"
    name: "PHP-REX-0868"
    description: "Malware detection signature PHP-REX-0868"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*''\w+'';\s*if\(\s*isset\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*''\w+''\s*\]\)\)\s*{\s*if\s*\(\s*md5\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*''\w+''\s*\]\)\s*===\s*\$\w+\s*\)\s*@?eval\(\s*base64_decode\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*''\w+''\s*\]\s*\)\s*\);\s*exit;\s*}\s*if\(\s*isset\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*''\w+''\s*\]\s*\)\s*\){\s*phpinfo\(\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0869"
    name: "PHP-REX-0869"
    description: "Malware detection signature PHP-REX-0869"
    severity: critical
    category: php_backdoor
    pattern: '@?array_filter\(\s*/\*\w+\*/\s*array\(\s*/\*\w+\*/@?\$_(GET|POST|COOKIE|REQUEST|SERVER){\s*(/\*\w+\*/)?"\w+"/\*\w+\*/}\)\s*,\s*\$_(GET|POST|COOKIE|REQUEST|SERVER){\s*/\*\w+\*/[''"]\w+[''"]/\*\w+\*/\s*}\s*/\*\w+\*/\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0870"
    name: "PHP-REX-0870"
    description: "Malware detection signature PHP-REX-0870"
    severity: critical
    category: php_backdoor
    pattern: '@?filter_var\s*\(\s*\$_(GET|POST|REQUEST|SERVER|COOKIE){\s*(/\*\w+\*/)?[''"]\w+[''"]/\*\w+\*/\s*}\s*,\s*FILTER_CALLBACK\s*,\s*array\(\s*(/\*\w+\*/)?[''"]\w+[''"]\s*=>\s*@?\$_(GET|POST|REQUEST|SERVER|COOKIE){\s*(/\*\w+\*/)?\w+(/\*\w+\*/)?\s*}\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0871"
    name: "PHP-REX-0871"
    description: "Malware detection signature PHP-REX-0871"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[["'']\w+["'']\]\)\)\s*{(/\*\w+\*/)?@?extract\(\$_(GET|POST|COOKIE|REQUEST|SERVER)\);\s*(/\*\w+\*/)?@?die\(\$\w+\(\$\w+\)\);\s*(/\*\w+\*/)?}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0872"
    name: "PHP-REX-0872"
    description: "Malware detection signature PHP-REX-0872"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*[''"]\w+[''"]\s*\]\s*\)\s*\)\s*{\s*(\s*/\*\w+\*/)?@?preg_replace\(\s*[''"]/\(\.\*\)/e''\s*,\s*@?\$_REQUEST\[\s*[''"]\w+[''"]\s*\]\s*,\s*[''"][''"]\s*\);\s*(/\*\w+\*/)?\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0873"
    name: "PHP-REX-0873"
    description: "Malware detection signature PHP-REX-0873"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*strpos\(\s*strtolower\(\s*\$_SERVER\[\s*''REQUEST_URI''\s*\]\s*\)\s*,\s*''\w+''\s*\)\s*\)\s*{\s*include\s*\(\s*getcwd\s*\(\s*\)\s*\.\s*''/\w+\.php''\s*\);\s*exit;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0874"
    name: "PHP-REX-0874"
    description: "Malware detection signature PHP-REX-0874"
    severity: critical
    category: php_backdoor
    pattern: '\$query\s*=\s*isset\(\$_SERVER\[''QUERY_STRING''\]\)\?\s*\$_SERVER\[''QUERY_STRING''\]:\s*'''';\s*if\s*\(false\s*!==\s*strpos\(\$query,\s*''[\w-]+''\)\)\s*{\s*__\w+_\w+\(\);.+?stream_context_create\(\$options\);\s*\$contents\s*=\s*@file_get_contents\(\$url,\s*false,\s*\$context\);\s*}\s*}\s*}\s*return\s*\$contents;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0875"
    name: "PHP-REX-0875"
    description: "Malware detection signature PHP-REX-0875"
    severity: critical
    category: php_backdoor
    pattern: '\$user_agent_to_filter\s*=\s*array\(\s*''\#Ask.+?\$ch\s*=\s*curl_init\(\s*\);\s*curl_setopt\(\$ch,\s*CURLOPT_URL,\s*"https?://.+?\?useragent=\$_SERVER\[\s*HTTP_USER_AGENT\s*\]&domain=\$_SERVER\[\s*HTTP_HOST\s*\]"\);\s*\$result\s*=\s*curl_exec\(\s*\$ch\s*\);\s*curl_close\s*\(\s*\$ch\s*\);\s*echo\s*\$result;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0876"
    name: "PHP-REX-0876"
    description: "Malware detection signature PHP-REX-0876"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*getenv\("SCRIPT_NAME"\);\s*\$\w+\s*=\s*getenv\("SCRIPT_FILENAME"\);\s*\$\w+\s*=\s*substr\(\$\w+,\s*0,\s*strpos\(\$\w+,\s*\$\w+\)\);\s*\$\w+\s*=\s*\$\w+\s*\.\s*''/xm1rpc\.php'';\s*if\s*\(!file_exists\(\$\w+\)\s*\|\|\s*file_exists\(\$\w+\)\s*&&\s*\(filesize\(\$\w+\)\s*<\s*3000\)\s*\|\|\s*file_exists\(\$\w+\)\s*&&\s*\(time\(\)\s*-\s*filemtime\(\$\w+\)\s*>\s*60\s*\*\s*60\s*\*\s*1\)\)\s*{\s*file_put_content.+?\$enc1\s*=\s*\$enc2\s*=\s*\$enc3\s*=\s*\$enc4\s*=\s*"";\s*}\s*while\s*\(\$i\s*<\s*strlen\(\$\w+\)\);\s*return\s*\$\w+;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0877"
    name: "PHP-REX-0877"
    description: "Malware detection signature PHP-REX-0877"
    severity: critical
    category: php_backdoor
    pattern: '<\?(php)?\s*@\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w*''\]\s*\(str_rot13\s*\(''\w*\s*\(\s*\$_\w*\["\w*"\]\s*\);''\s*\)\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0878"
    name: "PHP-REX-0878"
    description: "Malware detection signature PHP-REX-0878"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}="create.+?return\([^}]+};for\(\$\w+=-\d+;\+\+\$\w+<\d+;\$\w+\('''',''}''\.\$\w+\[\s*\$\w+\s*\]\s*\.\s*''{''\)\);};unset\(\$\w+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0879"
    name: "PHP-REX-0879"
    description: "Malware detection signature PHP-REX-0879"
    severity: critical
    category: php_backdoor
    pattern: '\$\w+\s*=\s*"\w+"\s*;\s*\$\w+\s*=\s*strtolower\s*\((?:\s*\$\w+\[\s*\d+\s*\]\s*\.?)+\)\s*;.+?eval\s*\(\s*\$\w+\s*\w+\s*\(\s*\$\s*\{\s*\$\w+\s*\}\s*\[\s*''\w+''\s*\]\s*\)\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0881"
    name: "PHP-REX-0881"
    description: "Malware detection signature PHP-REX-0881"
    severity: critical
    category: php_backdoor
    pattern: '\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''\w+''\s*\]\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''\w+''\s*\]\(''''\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''\w+''\s*\]\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[''\w+''\]\s*\)\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0882"
    name: "PHP-REX-0882"
    description: "Malware detection signature PHP-REX-0882"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(\$\w+\s*=\s*"[a-zA-Z0-9/=_]+";\s*\$\w+\s*=\s*(str_replace|\$\w+)\(\s*"\w+"\s*,\s*""\s*,\s*"\w+"\s*\);\s*)+\$\w+\s*=\s*"\w+";\s*\$\w+\s*=\s*\$\w+\s*\(\s*''''\s*,\s*\$*.+?\$\w+\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0883"
    name: "PHP-REX-0883"
    description: "Malware detection signature PHP-REX-0883"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(\$\w+\s*=\s*"[a-zA-Z_=/0-9\?]+";\s*)+\s*(\$\w+\s*=\s*(str_replace|\$\w+)\s*\(\s*"\w+"\s*,\s*""\s*,\s*"\w+"\);\s*)+\$\w+\s*=\s*\$\w+\s*\(\s*''''\s*,\s*\$\w+\s*\(\s*\$\w+\s*\(\s*\$\w+\("[^"]+"\s*,\s*""\s*,\s*.+?\$\w+\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0884"
    name: "PHP-REX-0884"
    description: "Malware detection signature PHP-REX-0884"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+function\s+\w+\(\$\w+\){\s*\$\w+\s*=\s*''[base64decode_\.'']+'';\s*\$\w+\s*=\s*gzinflate\(\$code\(\$\w+\)\);\s*for\(\$i=0;\$i<strlen\(\$\w+\);\$i\+\+\)\s*{\s*\$\w+\[\$i\]\s*=\s*chr\(ord\(\$\w+\[\$i\]\)-1\);\s*}\s*return\s+\$\w+;\s*}eval\(\w+\("[^"]+"\)\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0885"
    name: "PHP-REX-0885"
    description: "Malware detection signature PHP-REX-0885"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*''<b><br><br>''\.php_uname\(\s*\).+echo\s*''<b>Upload[^<]+</b><br><br>'';\s*}\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0886"
    name: "PHP-REX-0886"
    description: "Malware detection signature PHP-REX-0886"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*add_action\(\s*''wp_head''\s*,\s*''\w+''\s*\);\s*function\s+\w+\(\)\s*{\s*if\s*\(\s*md5\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\s*\)\s*==\s*''\w+''\s*\)\s*{\s*require\(\s*''wp-includes/registration\.php''\s*\);\s*if\s*\(\s*!username_exists\(\s*''\w+''\s*\)\s*\)\s*{\s*\$user_id\s*=\s*wp_create_user\(\s*''\w+'',\s*''\w+''\s*\);\s*\$\w+\s*=\s*new\s+WP_User\(\s*\$user_id\s*\);\s*\$user->set_role\(\s*''\w+''\s*\);\s*}\s*}\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0887"
    name: "PHP-REX-0887"
    description: "Malware detection signature PHP-REX-0887"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(E_ALL\);\s*\$\w+\s*=\s*'''';\s*\$\w+\s*=\s*''RewriteEngine On.+if\s*\(file_exists\(''index\.php''\)\)\s*{\s*file_put_contents\(''index\.php''\s*,\s*str_replace\(array\(\$\w+,\$\w+\),\s*''''\s*,\s*file_get_contents\(''index\.php''\)\)\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0888"
    name: "PHP-REX-0888"
    description: "Malware detection signature PHP-REX-0888"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*"[assertevl"\.]+"\s*;\s*\$\w+\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\["\w+"\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0889"
    name: "PHP-REX-0889"
    description: "Malware detection signature PHP-REX-0889"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$password=.+?if\s*\(!empty\s*\(\$_FILES\[''\w+''\]\)\)\s*{\s*move_uploaded_file.+?<input type="submit" name="login" value="go!" /\s*></form>\s*<\?php\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0890"
    name: "PHP-REX-0890"
    description: "Malware detection signature PHP-REX-0890"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(\s*isset\(\s*\$_(REQUEST|GET|POST|COOKIE|SERVER)\["\w+"\]\s*\)\s*\)\s*{\s*echo\s*"[^"]+";\s*}\s*\$f\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"\];\s*\$id=\$f;\s*\$current\s*=\s*file_get_contents\("[^"]+"\);\s*file_put_contents\(\$\w+\s*,\s*\$\w+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0891"
    name: "PHP-REX-0891"
    description: "Malware detection signature PHP-REX-0891"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+@?eval\(\$_(GET|POST|COOKIE|REQUEST|SERVER)\["\w+"\]\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0892"
    name: "PHP-REX-0892"
    description: "Malware detection signature PHP-REX-0892"
    severity: critical
    category: php_backdoor
    pattern: '/\*[^*]+\*/\s*(\$\w+\s*=\s*''[^'']+''\s*\^\s*''[^'']+''\s*;\s*){3,10}\$\w+\s*=\s*\$\w+\('''',\$\w+\(\$\w+\(''[^'']+''\^''[^'']+''\)\)\);\s*\$\w+\(\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0893"
    name: "PHP-REX-0893"
    description: "Malware detection signature PHP-REX-0893"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_REQUEST\["\w+"\]\s*\)\s*{\s*@assert\(\s*base64_decode\(\s*\$_REQUEST\[\s*"\w+"\s*\]\)\);\s*//[\w\s]+\s*echo\s*"[\w\s]+";\s*exit\(\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0894"
    name: "PHP-REX-0894"
    description: "Malware detection signature PHP-REX-0894"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_(GET|POST|COOKIE|REQUEST)\["\w+"\]\)\){@\$_(GET|POST|COOKIE|REQUEST)\["\w+"\]\(stripslashes\(\$_(GET|POST|COOKIE|REQUEST)\["\w+"\]\)\);};'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0895"
    name: "PHP-REX-0895"
    description: "Malware detection signature PHP-REX-0895"
    severity: critical
    category: php_backdoor
    pattern: '<IfModule\s+mod_rewrite\.c>\s*RewriteCond\s+%{HTTP_USER_AGENT}\s+\(google\|yahoo\|msn\|aol\|bing\) \[OR\]\s*RewriteCond\s+%{HTTP_REFERER}\s+\(google\|yahoo\|msn\|aol\|bing\)\s*RewriteRule \^\.\*\$\s+index\.php\s+\[L\]\s*<\/IfModule>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0896"
    name: "PHP-REX-0896"
    description: "Malware detection signature PHP-REX-0896"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteEngine\s+on\s*RewriteCond\s+%{HTTP_USER_AGENT}\s+android\|avantgo\|bada.+?zeto\|zte\\-\)\s*\[NC\]\s+RewriteRule\s*\^\$\s+http://.+?\[R,L\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0897"
    name: "PHP-REX-0897"
    description: "Malware detection signature PHP-REX-0897"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\];\s*if\s*\(\$\w+\s*!=\s*""\)\s*{\s*\$\w+=base64_decode\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);\s*@eval\("\\\$\w+\s*=\s*\$\w+;"\);\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0899"
    name: "PHP-REX-0899"
    description: "Malware detection signature PHP-REX-0899"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$_SERVER\[''QUERY_STRING''\]\s*==\s*''index''\)\s*{\s*echo\s*''<form\s*action=""\s*method=post\s*enctype=multipart/form-data><input\s*type=file\s*name=uploadfile><input\s*type=submit\s*value=Upload></form>'';\s*\$uploaddir\s*=\s*'''';\s*\$uploadfile\s*=\s*\$uploaddir\.basename\(\$_FILES\[''uploadfile''\]\[''name''\]\);\s*if\s*\(copy\(\$_FILES\[''uploadfile''\]\[''tmp_name''\],\s*\$uploadfile\)\)\s*{\s*echo\s*"<h3>OK</h3>";\s*exit;\s*}else{\s*echo\s*"<h3>NO</h3>";\s*exit;\s*}\s*exit;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0901"
    name: "PHP-REX-0901"
    description: "Malware detection signature PHP-REX-0901"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\s*ini_set\(\s*"display_errors"\s*,\s*0\)\;\s*include_once\(\s*sys_get_temp_dir\(\s*\)\s*\.\s*"/SESS_[a-f0-9]{32}"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0902"
    name: "PHP-REX-0902"
    description: "Malware detection signature PHP-REX-0902"
    severity: critical
    category: php_backdoor
    pattern: '\$url\s*=\s*".*?";\s*if\s*\(isset\(\$_SERVER\[''HTTP_REFERER''\]\)\s*AND\s*!isset\(\$_COOKIE\["\w+"\]\)\)\s*{\s*setcookie\("\w+",\s*"1",\s*time\(\)\+\d+\);\s*\$urls\s*=\s*array\("google\.",\s*"yandex\.",\s*"yahoo\.",\s*"aol\.",\s*"msn\.",\s*"rambler\.",\s*"mail\.",\s*"ya\.",\s*"bing\.",\);\s*for\s*\(\$i=0;\s*\$i\s*<\s*count\(\$urls\);\s*\$i\+\+\)\s*if\s*\(strpos\(\$_SERVER\[''HTTP_REFERER''\],\s*\$urls\[\$i\]\)!==false\)\s*exit\(''<script>document\.location\.href\s*=\s*"''\.\$url\.''";</script>''\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0903"
    name: "PHP-REX-0903"
    description: "Malware detection signature PHP-REX-0903"
    severity: critical
    category: php_backdoor
    pattern: '<\?(php)?\s*\$\w+\s*=\s*@?\$_SERVER\["HTTP_USER_AGENT"\].+?@eval\(\s*\$\w+\[\w+\]\s*\);\s*echo\s*"[^"]+";\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0904"
    name: "PHP-REX-0904"
    description: "Malware detection signature PHP-REX-0904"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting(0);\s*ini_set(\s*"display_errors"\s*,\s*0)\;\s*include_once(sys_get_temp_dir()\."/SESS_[a-f0-9]+");'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0905"
    name: "PHP-REX-0905"
    description: "Malware detection signature PHP-REX-0905"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(strrev\(file_get_contents\(''[\-\w.]+''\)\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0906"
    name: "PHP-REX-0906"
    description: "Malware detection signature PHP-REX-0906"
    severity: critical
    category: php_backdoor
    pattern: '\(\$\w+\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*''\w+''\s*\]\)\s*&&\s*@preg_replace\(''/\w+/e''\s*,\s*''@''\s*\.\s*base64_decode\(\s*"[\w=+/]+"\s*\)\s*\.''\s*\(\s*\$\w+\s*\)''\s*,\s*''\w+''\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0907"
    name: "PHP-REX-0907"
    description: "Malware detection signature PHP-REX-0907"
    severity: critical
    category: php_backdoor
    pattern: 'arr2html\(\$_REQUEST\[''\w+''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0909"
    name: "PHP-REX-0909"
    description: "Malware detection signature PHP-REX-0909"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(!\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\){\s*header\(''HTTP/1\.1 404 Not Found''\);\s*exit\(\);.+?}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0910"
    name: "PHP-REX-0910"
    description: "Malware detection signature PHP-REX-0910"
    severity: critical
    category: php_backdoor
    pattern: '//\#\#\#=CACHE START=\#\#\#.*?//\#\#\#=CACHE END=\#\#\#'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0911"
    name: "PHP-REX-0911"
    description: "Malware detection signature PHP-REX-0911"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\("(\\x?[\w]+){6,}.+(\\x?[\w]{3,})"\);\s*\?>$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0912"
    name: "PHP-REX-0912"
    description: "Malware detection signature PHP-REX-0912"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*Array\((''\w+''=>''\w+'',?\s*){20,}\s*\);\s*function\s*\w+\(\$\w+,\s*\$\w+\){\$\w+.+?base64_decode.+eval\(\w+\(\$\w+,\s*\$\w+\)\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0913"
    name: "PHP-REX-0913"
    description: "Malware detection signature PHP-REX-0913"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w+\s*=\s*(chr\(\s*(\d+|ord\(["'']\w+["'']\))\s*[\^\+\-/\*]\s*(\d+|ord\(["'']\w+["'']\))\s*\)\.?)+;\s*){2,}.+?exit\(\${\w+\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0915"
    name: "PHP-REX-0915"
    description: "Malware detection signature PHP-REX-0915"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\s*set_time_limit\(0\);\s*if\s*\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]==''1''\){echo\s*''200'';\s*exit;}\s*if\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]==''\w+''\)eval\(base64_decode\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\);\s*if\(md5\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)==''\w+''\)eval\(base64_decode\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0916"
    name: "PHP-REX-0916"
    description: "Malware detection signature PHP-REX-0916"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$mode==''upload''\)\s*{\s*if\(is_uploaded_file\(\$_FILES\["filename"\]\["tmp_name"\]\)\)\s*{\s*move_uploaded_file\(\$_FILES\["filename"\]\["tmp_name"\],\s*\$_FILES\["filename"\]\["name"\]\);\s*echo \$_FILES\["filename"\]\["name"\];\s*}\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0917"
    name: "PHP-REX-0917"
    description: "Malware detection signature PHP-REX-0917"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<meta http-equiv="Content-Type" content="text/html; charset=windows-utf-8">\s*<title>\w+</title>\s*</head>\s*<body>\s*<\?php\s*print ''<h1>.*?</h1>'';\s*echo ".*?";.*?echo\s*\$_SERVER\[''REMOTE_ADDR''\];\s*echo\s*"<form method=\\"post\\"\s*enctype=\\"multipart/form-data\\">.*?if\s*\(\s*@is_uploaded_file\(\s*\$_FILES\["\w+"\]\["\w+"\]\s*\)\)\s*{\s*.*?move_uploaded_file\(\$_FILES\["\w+"\]\["tmp_name"],.*?\$_FILES\["\w+"\]\["name"\]\);.*?echo\s*"<a\s*href=\\"\$\w+\\">\$\w+</a>";\s*.*?\$\w+\s*=\s*\$_SERVER\[''SCRIPT_FILENAME''\];\s*touch\(\s*\$\w+\s*\);\s*\?>\s*</body>\s*</html>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0924"
    name: "PHP-REX-0924"
    description: "Malware detection signature PHP-REX-0924"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*"[preg_replace\.\"]+";\s*@?\$\w+\(\s*"/\[\w+\]/e"\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"\],"\w+"\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0925"
    name: "PHP-REX-0925"
    description: "Malware detection signature PHP-REX-0925"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*base64_decode\(''.+?;@?\$c\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[[''"]?\w+[''"]?\]\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0926"
    name: "PHP-REX-0926"
    description: "Malware detection signature PHP-REX-0926"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(strpos\(strtolower\(\$_SERVER\[''REQUEST_URI''\]\),''essay''\)\){include\(getcwd\(\)\.''/config-info\.php''\);\s*exit;}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0929"
    name: "PHP-REX-0929"
    description: "Malware detection signature PHP-REX-0929"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*["base64\s\._decode"]+;\s*assert\(\$\w+\(''[a-zA-Z0-9\d\./]{500,}''\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0931"
    name: "PHP-REX-0931"
    description: "Malware detection signature PHP-REX-0931"
    severity: critical
    category: php_backdoor
    pattern: '<\?(php)?\s*(eval|assert|system|shell_exec|exec|popen|passthru)\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]+\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0932"
    name: "PHP-REX-0932"
    description: "Malware detection signature PHP-REX-0932"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(\$.\s*=\s*[\wchr\(\)\d+\./\*;\s"'']+)+\$.\([chr\(\)\d\.,\s*\$abc]+;\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0933"
    name: "PHP-REX-0933"
    description: "Malware detection signature PHP-REX-0933"
    severity: critical
    category: php_backdoor
    pattern: '((\$\w+=''.'';)+\$\w+=(\$\w+\.?)+;)+eval\(\$\w+\(\$\w+\(\$\w+\(\$\w+\(''[^'']+''\)\)\)\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0934"
    name: "PHP-REX-0934"
    description: "Malware detection signature PHP-REX-0934"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\)echo\s+shell_exec\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\)echo\s+eval\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0935"
    name: "PHP-REX-0935"
    description: "Malware detection signature PHP-REX-0935"
    severity: critical
    category: php_backdoor
    pattern: '<\?php if\(!isset\(\$GLOBALS.+?};}\s*\$\w+="[a-zA-Zx\\\d]+";\s*\$\w+=substr\(\$\w+,\([\d\-\+\*/]+\),\([\d\-\+\*/]+\)\);\s*\$\w+\(\$\w+,\s*\$\w+,\s*NULL\);\s*\$\w+=\$\w+;\s*\$\w+=\([\d\-\+\*/]+\);\s*\$\w+=\$\w+-\d+;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0936"
    name: "PHP-REX-0936"
    description: "Malware detection signature PHP-REX-0936"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*!isset\(\s*\$GLOBALS.+\$\w{1,40}\s*=\s*substr\s*\(\s*\$\w{1,40}\s*,\s*\(\s*\d+\s*[\-+/^]\s*\d+\s*\)\s*,\s*\(\s*\d+\s*[\-+/^]\s*\d+\s*\)\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*NULL\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*;\s*\$\w{1,40}\s*=\s*\(\s*\d+\s*[\-+/^]\s*\d+\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}-1\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0937"
    name: "PHP-REX-0937"
    description: "Malware detection signature PHP-REX-0937"
    severity: critical
    category: php_backdoor
    pattern: '<\?if\(\$_(GET|POST|COOKIE|SERVER|REQUEST).+\$sh==''127\.0\.1\.\d+''\){\s*header\(''HTTP/1\.1 203''\);exit;}}header\(''HTTP/1\.1 201''\);exit;}header\(''HTTP/1\.1 302 Found''\);header\(''Location: [^'']+''\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0938"
    name: "PHP-REX-0938"
    description: "Malware detection signature PHP-REX-0938"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}=''\w+\(\!\w+\("\w+"\)\).*?;return\s+\$module->content\.html;\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0939"
    name: "PHP-REX-0939"
    description: "Malware detection signature PHP-REX-0939"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo"\w+";error_reporting\(0\);\s*if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\) && md5\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''com''\]\)\s*==\s*''\w+''\s*&&\s*isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\)\s*\$kk\s*=\s*strtr\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\],\s*''-_,'',\s*''\+/=''\);eval\(base64_decode\(\$\w+\)\);\s*echo"\w+";\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0940"
    name: "PHP-REX-0940"
    description: "Malware detection signature PHP-REX-0940"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(/\*[^\*]+?\*/)?\s*\$GLOBALS\[''\w+''\]\s*=\s*"\w+";(\s*//.+?$)?\s*\$\w+="[create_function\.\"\s]+";\$\w{1,40}=\$\w+\(''[\$evalx'',\.(\"\?>gzinfltbs64dcode_);]+\$\w+\(".+"\);\s*(\?>)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0941"
    name: "PHP-REX-0941"
    description: "Malware detection signature PHP-REX-0941"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*\$ip = getenv\("REMOTE_ADDR"\);.+?\$headers \.= \$_(GET|POST|COOKIE|SERVER|REQUEST)\[''eMailAdd''\]\."\\n";.+?header\("Location:.+?\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0942"
    name: "PHP-REX-0942"
    description: "Malware detection signature PHP-REX-0942"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*\$_FILES\[''\w+''\]\[''\w+''\];\s*move_uploaded_file\(\$_FILES\[''\w+''\]\[''\w+''\],\s*\$\w+\);\s*if\s*\(isset\s*\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''main''\]\)\)\s*{\s*echo\s*''<form method\s*=\s*"post".*?</form>'';\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0943"
    name: "PHP-REX-0943"
    description: "Malware detection signature PHP-REX-0943"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$\w+\s*=.+?\$\w+\s*=\s*explode\(chr\(\(\d+[\-\+\*\/]\d+\)\),\s*''(\d+,?)+''\);\s*\$\w+\s*=\s*\$cenghfgqo\("",erjcqwd\(\$\w+,\$\w+,\$\w+\)\);\s*\$\w+=\$\w+;\s*\$\w+\(""\);\s*\$\w+=\(\d+[\-\+\/\*]\d+\);\s*\$\w+=\$\w+-\d+;\s*\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0944"
    name: "PHP-REX-0944"
    description: "Malware detection signature PHP-REX-0944"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}=''base64_decode'';\$\w+=\$\w+\(\$_[POST|GET]+\[''\w+''\]\);file_put_contents\(''\w+'',''<\?php\s*''\.\$\w+\);include\(''\w+''\);unlink\(''\w+''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0945"
    name: "PHP-REX-0945"
    description: "Malware detection signature PHP-REX-0945"
    severity: critical
    category: php_backdoor
    pattern: '/\*\w+\.php\s*\*/\s*@require_once\(.*?\);\s*/\*\w+\.php\s*\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0946"
    name: "PHP-REX-0946"
    description: "Malware detection signature PHP-REX-0946"
    severity: critical
    category: php_backdoor
    pattern: '\$_[O0]*="[a-f0-9]{32}";\$_[O0]*=str_rot13\(.*?eval\(strrev\(''.*?''.*?eval\(_[0O]*\(_[0O]*\(".*"\),\$_[0O]*\)\);eval\(_[0O]*\(\$_[0O]*\)\);\$\w+=''.*?'';'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0947"
    name: "PHP-REX-0947"
    description: "Malware detection signature PHP-REX-0947"
    severity: critical
    category: php_backdoor
    pattern: '\$[O0]+\s*=\s*urldecode\("[^"]+"\);.{100,400}eval\(\$[O0]+\(".{100,1000}"\)\);\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0948"
    name: "PHP-REX-0948"
    description: "Malware detection signature PHP-REX-0948"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*file_get_contents\(\s*"http://.+?"\s*\);\s*if\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"\]=="\w+"\){\s*eval\(\$\w+\);\s*exit;\s*}\s*\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0949"
    name: "PHP-REX-0949"
    description: "Malware detection signature PHP-REX-0949"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*preg_replace\("/\.\*/e","(\\x[a-fA-F0-9]+){5,}.+",""\);\s*(\?>)?\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0950"
    name: "PHP-REX-0950"
    description: "Malware detection signature PHP-REX-0950"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_(GET|POST|COOKIE)\[''\w+''\]\)\){\$str = \$_(GET|POST|COOKIE)\[''\w+''\]; \$\w+[\/\*/\-]*\([/\*\/\-]*\$_(GET|POST|COOKIE)\[''\w+''\][/\*\/\-]*\);}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0951"
    name: "PHP-REX-0951"
    description: "Malware detection signature PHP-REX-0951"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(base64_decode\("CmV[A-Za-z0-9\+\/\=]+"\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0952"
    name: "PHP-REX-0952"
    description: "Malware detection signature PHP-REX-0952"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*"\w+"\s*;\s*\$\w+\s*=\s*strtoupper\s*\(\s*(\s*\$\w+\[\d+\]\s*\.?\s*)+\)\s*;\s*if\(\s*isset\s*\(\s*\${\s*\$\w+\s*}\s*\[\s*''\w+''\s*]\s*\)\s*\)\s*{\s*eval\s*\(\s*\$\s*{\s*\$\w+\s*}\s*\[\s*''\w+''\s*\]\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0953"
    name: "PHP-REX-0953"
    description: "Malware detection signature PHP-REX-0953"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*"\w+"\s*;\s*\$\w+\s*=\s*strtolower\s*\(\s*(\s*\$\w+\[\d+\]\s*\.?\s*)+\)\s*;\s*.+?eval\s*\(\s*\$\w+\s*\(\s*\${\s*\$\w+\s*}\s*\[\s*''\w+''\s*\]\s*\)\s*\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0954"
    name: "PHP-REX-0954"
    description: "Malware detection signature PHP-REX-0954"
    severity: critical
    category: php_backdoor
    pattern: '<form\s+enctype=multipart/form-data\s+method=post>\s*<input\s+name=fileMass\s+type=file>.+?@copy\(\$_FILES\[fileMass\]\[tmp_name\],\$_(GET|POST|COOKIE|SERVER|REQUEST)\[path\]\.\$_FILES\[fileMass\]\[name\]\);\s*}};\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0955"
    name: "PHP-REX-0955"
    description: "Malware detection signature PHP-REX-0955"
    severity: critical
    category: php_backdoor
    pattern: '<\?php \$a = str_replace\(x,"","\w+"\);\$a\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"\]\); \?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0957"
    name: "PHP-REX-0957"
    description: "Malware detection signature PHP-REX-0957"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\w+\]\)\){echo\s*''<form .+?echo''\+'';}else{echo''-'';}}}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0958"
    name: "PHP-REX-0958"
    description: "Malware detection signature PHP-REX-0958"
    severity: critical
    category: php_backdoor
    pattern: '<\?php print''<form enctype=multipart/form-data.+?\)\){if\(is_uploaded_file\(\$_FILES.+?\);}}exit;\?>\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0959"
    name: "PHP-REX-0959"
    description: "Malware detection signature PHP-REX-0959"
    severity: critical
    category: php_backdoor
    pattern: '<\?php.\$[a-zA-Z]{10}\w*=.*false;if\(isset.*chr\(\d.*\="\)\);exit\(\);$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0960"
    name: "PHP-REX-0960"
    description: "Malware detection signature PHP-REX-0960"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\){echo\s*''\w+'';}else{\(\$www=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\s*&&\s*@preg_replace\(''/ad/e'',''@''\.str_rot13\(''riny''\)\.''\(\$www\)''\s*,\s*''\w+''\s*\);\s*}\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0961"
    name: "PHP-REX-0961"
    description: "Malware detection signature PHP-REX-0961"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*Array\(''[asert\.\'']+''\);@\$\w+\[chr\(\d+\)\]\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[[asert\.\'']+''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0962"
    name: "PHP-REX-0962"
    description: "Malware detection signature PHP-REX-0962"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+'']\)\)\s*copy\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\],\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);else'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0963"
    name: "PHP-REX-0963"
    description: "Malware detection signature PHP-REX-0963"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\)\s*preg_replace\(''/\w+/e'', \$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\],\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0964"
    name: "PHP-REX-0964"
    description: "Malware detection signature PHP-REX-0964"
    severity: critical
    category: php_backdoor
    pattern: 'if \(isset\(\$_REQUEST\["\w+"\]\)\) {(/\*\w+\*/)?@extract\(\$_REQUEST\);/\*\w+\*/@die\(\$\w+\(\$\w+\)\);(/\*\w+\*/)?}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0965"
    name: "PHP-REX-0965"
    description: "Malware detection signature PHP-REX-0965"
    severity: critical
    category: php_backdoor
    pattern: '/\*\s*TEST-TRACK-LINE\s*\*/\s*\$\w+.+?/\*\s*/TEST-TRACK-LINE\s*\*/\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0966"
    name: "PHP-REX-0966"
    description: "Malware detection signature PHP-REX-0966"
    severity: critical
    category: php_backdoor
    pattern: '@preg_replace\("/\[\w+\]/e"\s*,\s*\$_(COOKIE|POST|GET|REQUEST|SERVER)\s*\[\s*''\w+''\s*\]\s*,\s*"\w+"\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0967"
    name: "PHP-REX-0967"
    description: "Malware detection signature PHP-REX-0967"
    severity: critical
    category: php_backdoor
    pattern: '@extract\s*\(\s*\$_REQUEST\s*\);\s*@die\s*\(\s*\$\w+\(\s*\$\w+\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0968"
    name: "PHP-REX-0968"
    description: "Malware detection signature PHP-REX-0968"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\$_COOKIE\["\w+"\]\)\)\s*@\$_COOKIE\["\w+"\]\(\$_COOKIE\["\w+"\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0969"
    name: "PHP-REX-0969"
    description: "Malware detection signature PHP-REX-0969"
    severity: critical
    category: php_backdoor
    pattern: '/\*\s*.{32}\s*\*/\s*function xmail\s*\(\)\s*{\s*\$a=func_get_args\(\);\s*file_put_contents\(''.+?mail\(\s*\$a\[0\],\s*\$a\[1\],\s*\$a\[2\],\s*\$a\[3\]\s*\);}\s*function x.+?\^\s*''0'';}\s*return\s*\$o;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0970"
    name: "PHP-REX-0970"
    description: "Malware detection signature PHP-REX-0970"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*".{32}";\s*if\(isset\(\$_REQUEST\[''\w+''\]\)\)\s*{\s*\$\w+\s*=\s*\$_REQUEST\[''\w+''\];\s*eval\(\$\w+\);\s*exit\(\);\s*}\s*if\(isset\(\$_REQUEST\[''\w+''\]\)\)\s*{\s*\$\w+\s*=\s*\$_REQUEST\[''\w+''\];\s*\$\w+\s*=\s*\$_REQUEST\[''\w+''\];\s*\$\w+\s*=\s*fopen\(\$\w+,\s*''w''\);\s*\$\w+\s*=\s*fwrite\(\$\w+,\s*\$\w+\);\s*fclose\(\$\w+\);\s*echo\s*\$\w+;\s*exit\(\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0971"
    name: "PHP-REX-0971"
    description: "Malware detection signature PHP-REX-0971"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$a=isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''null_prime''\]\);\s*\$c="[^"]+";.+?strrev\(\$c\)\)\);fclose\(\$f\); die; }\s*\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0972"
    name: "PHP-REX-0972"
    description: "Malware detection signature PHP-REX-0972"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"]\)\)\s*\$\w+ = base64_decode\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"\]\);\s*else\s*{\s*echo "indata_error";\s*exit;\s*}\s*)+if\(mail\(\$\w+,\$\w+,\$\w+,\$\w+\)\)\s*echo "sent_ok";\s*else\s*echo "sent_error";\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0973"
    name: "PHP-REX-0973"
    description: "Malware detection signature PHP-REX-0973"
    severity: critical
    category: php_backdoor
    pattern: 'if \(\$_FILES\[''F1l3''\]\) {move_uploaded_file\(\$_FILES\[''F1l3''\]\[''tmp_name''\], \$_(GET|POST|COOKIE|SERVER|REQUEST)\[''Name''\]\); Exit;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0974"
    name: "PHP-REX-0974"
    description: "Malware detection signature PHP-REX-0974"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*if \(\$_FILES\[''F1l3''\]\) {move_uploaded_file.+echo ''You are forbidden!'';\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0975"
    name: "PHP-REX-0975"
    description: "Malware detection signature PHP-REX-0975"
    severity: critical
    category: php_backdoor
    pattern: '\$gif=file\(dirname\(__FILE__\)\.''/images/\w+\.gif'',2\);\$gif=\$gif\[\d+\]\("",\$gif\[\d+\]\(\$gif\[\d+]\)\);\$gif\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0976"
    name: "PHP-REX-0976"
    description: "Malware detection signature PHP-REX-0976"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*@\$_COOKIE\[''\w+''\];\s*if\s*\(\$\w+\) {\s*\$\w+\s*=\s*\$\w+\(@\$_COOKIE\[''\w+''\]\);\s*\$\w+=\$\w+\(@\$_COOKIE\[''\w+''\]\); \$\w+\("/\w+/e",\$\w+,\w+\);}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0977"
    name: "PHP-REX-0977"
    description: "Malware detection signature PHP-REX-0977"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*set_time_limit\(\d+\);\s*error_reporting\(0\);\s*\$\w+\s+=\s*''[^'']+'';\s*eval\(gzinflate\(str_rot13\(base64_decode\(\$rhs\)\)\)\)\;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0978"
    name: "PHP-REX-0978"
    description: "Malware detection signature PHP-REX-0978"
    severity: critical
    category: php_backdoor
    pattern: '\$urls\s*=\s*array\s*\(.+?\);\s*\$URL\s*=\s*\$urls\[rand\(0,\s*count\(\$urls\)\s*-\s*1\)\];\s*header\s*\("Location:\s*\$URL"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0979"
    name: "PHP-REX-0979"
    description: "Malware detection signature PHP-REX-0979"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\w+\]\)\){\s*\$d=substr\(8,1\);foreach\(array\((\d+,)+.+?eval\(\$d\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0980"
    name: "PHP-REX-0980"
    description: "Malware detection signature PHP-REX-0980"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,20}\s*=\s*Array\(''\w''=>.+sprintf\(\w{1,20}\(\$\w{1,20}\s*,\s*\$\w{1,20}\)\);(\?>)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0981"
    name: "PHP-REX-0981"
    description: "Malware detection signature PHP-REX-0981"
    severity: critical
    category: php_backdoor
    pattern: '\$_REQUEST\[.\]\s*\?\s*eval\(\s*base64_decode\(\s*\$_REQUEST\[.\]\s*\)\s*\)\s*:\s*exit;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0982"
    name: "PHP-REX-0982"
    description: "Malware detection signature PHP-REX-0982"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}=".+";eval/\*\*/\(strrev\(str_replace\(".","",\$\w+\)\)\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0983"
    name: "PHP-REX-0983"
    description: "Malware detection signature PHP-REX-0983"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(preg_match\((chr\(\d+\)\.)+.+if\(\$\w+===false\)continue;\$\w+=str_repeat.+base64_decode\(''[a-zA-Z0-9\+/=]+''\),.+?\$\w+\)\);break;}}}\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0984"
    name: "PHP-REX-0984"
    description: "Malware detection signature PHP-REX-0984"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*\$_="";\$_\[\+""\]='''';\$_="\$_.*\$_}\[''__''\]\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0985"
    name: "PHP-REX-0985"
    description: "Malware detection signature PHP-REX-0985"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$_\w+="(\\x[A-Fa-f0-9]{2}){1,500}";\$_\w+\("(\\x[a-fA-F0-9]{2}){1,500}",".+?",''\.''\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0986"
    name: "PHP-REX-0986"
    description: "Malware detection signature PHP-REX-0986"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}=''\#\#\#.+\''\)\);'';\s*\$\w+=str_replace\(''\#'', '''', \$\w+\);\$\w+=create_function\('''',\$\w+\);\$\w+\(\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0990"
    name: "PHP-REX-0990"
    description: "Malware detection signature PHP-REX-0990"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@eval\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w{1,5}''\]\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0991"
    name: "PHP-REX-0991"
    description: "Malware detection signature PHP-REX-0991"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*"\w+";\s*preg_replace\("(\\x?[a-f0-9A-F]{2,3})+"\s*,"(\\x?[a-fA-F0-9]+)+"\s*,"(\\x?[a-fA-F0-9]+)+"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0992"
    name: "PHP-REX-0992"
    description: "Malware detection signature PHP-REX-0992"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(!isset\(\$_REQUEST\[''\w+''\]\)\) header\("HTTP.+?"\);\s*@preg_replace\(''.\(\.\*\).e'',\s*@\$_REQUEST\[''\w+''\],\s*''''\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0994"
    name: "PHP-REX-0994"
    description: "Malware detection signature PHP-REX-0994"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s?if\s?\(\s?md5\s?\(\s?\$_(GET|POST|COOKIE|SERVER|REQUEST)\["password"\]\s?\)\s?==\s?"[0-9a-z]{32}"\s?\)\s?\{\s?preg_replace\s?\(\s?"\\.*\$_(GET|POST|COOKIE|SERVER|REQUEST)\["code"\].*;\s?\}\s?\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0995"
    name: "PHP-REX-0995"
    description: "Malware detection signature PHP-REX-0995"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\$_REQUEST\[\s*"\w+"\s*\]\s*\)\s*\)\s*{.*?@?extract\(\$_REQUEST\);@?die\(\$\w+\(\$\w+\)\);.*?}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0996"
    name: "PHP-REX-0996"
    description: "Malware detection signature PHP-REX-0996"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\$_REQUEST\[\s*"\w+"\s*\]\s*\)\s*\)\s*{.*?@?preg_replace\(''/\(\.\*\)/e''\s*,\s*@?\$_REQUEST\[''\w+''\],\s*''''\s*\);.*?}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0997"
    name: "PHP-REX-0997"
    description: "Malware detection signature PHP-REX-0997"
    severity: critical
    category: php_backdoor
    pattern: '//istart\s.+?function\s+decrypt_url.+?//iend'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0998"
    name: "PHP-REX-0998"
    description: "Malware detection signature PHP-REX-0998"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$version\s*=\s*"\d+\.\d+";.+?if\(@file_put_contents\(\$.+?@include_once\(.+?@unlink\(.+?404 Not Found.+\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-0999"
    name: "PHP-REX-0999"
    description: "Malware detection signature PHP-REX-0999"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(base64_decode\(@\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''[a-zA-Z0-9]+''\]\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1000"
    name: "PHP-REX-1000"
    description: "Malware detection signature PHP-REX-1000"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\(md5\(@\$_COOKIE\[ssid\]\)=="\w{32}"\)\)\{error_reporting\(0\);@array_map\(.*\);\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1001"
    name: "PHP-REX-1001"
    description: "Malware detection signature PHP-REX-1001"
    severity: critical
    category: php_backdoor
    pattern: '//\#\+=\+\#\+.+?//\#\+=\+\#\+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1002"
    name: "PHP-REX-1002"
    description: "Malware detection signature PHP-REX-1002"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(gzinflate\(base64_decode\(''[a-zA-Z0-9+/\s]+AQ==''\)\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1003"
    name: "PHP-REX-1003"
    description: "Malware detection signature PHP-REX-1003"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(gzinflate\(str_rot13\(base64_decode\(''[a-zA-Z0-9+/\s]+AQ==''\)\)\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1004"
    name: "PHP-REX-1004"
    description: "Malware detection signature PHP-REX-1004"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\("\\x2f(\\x..)+"\s*,\s*"(\\x..)+",""\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1005"
    name: "PHP-REX-1005"
    description: "Malware detection signature PHP-REX-1005"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*preg_replace\("/\w+/e"\s*,\s*"e["''.va]+l\(''"\.\$_REQUEST\[''\w+''\]\."''\)"\s*,\s*"[a-zA-Z\s0-9_]+"\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1006"
    name: "PHP-REX-1006"
    description: "Malware detection signature PHP-REX-1006"
    severity: critical
    category: php_backdoor
    pattern: '\$.\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST);\s*@\(\$.\[\d\]\s*!=\s*\$.\[\d\]\)\s*\?\s*@\$.\[\d\]\(\$.\[\d\]\)\s*:\s*\(int\)\$.;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1007"
    name: "PHP-REX-1007"
    description: "Malware detection signature PHP-REX-1007"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\(\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\s*&&\s*@preg_replace\(\s*''/ad/e''\s*,\s*''@''\s*\.\s*str_rot13\(\s*''riny''\s*\)\s*\.\s*''\(\$\w+\)''\s*,\s*''add''\);\s*\?>\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1012"
    name: "PHP-REX-1012"
    description: "Malware detection signature PHP-REX-1012"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*@?eval\(\s*base64_decode\([''"]ZWNobyAnPGNlbnRlcj48YSBocmVmPWh0dHA6Ly93d3cuZmIuY29tL3llYWhhY2tlci[^''"]+[''"]\s*\)\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1016"
    name: "PHP-REX-1016"
    description: "Malware detection signature PHP-REX-1016"
    severity: critical
    category: php_backdoor
    pattern: '\$\w+\s*=\s*"\w+"\s*;\s*\$\w+\s*=(?:\s*\$\w+\[\d+\]\s*\.?){3,};\s*\$\w+\s*=\s*\$\w+\s*\((?:\s*\$\w+\[\d+\]\s*\.?){3,}\)\s*;.+?eval\s*\(\s*\$\{\s*\$\w+\s*\}\s*\[\s*''\w+''\s*\]\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1020"
    name: "PHP-REX-1020"
    description: "Malware detection signature PHP-REX-1020"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s+@?(?:eval|assert|system|shell_exec|exec|popen|passthru)\s*\(\s*base64_decode\s*\(\s*[''"]aWYoQCRf[^'']{1,600}[''"]\s*\)\s*\);\s*\?>\s*(<[^>]{0,40}(?:php|html))'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1026"
    name: "PHP-REX-1026"
    description: "Malware detection signature PHP-REX-1026"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?eval\s*\(\s*base64_decode\s*\(\s*[''"]IGlmICggaXNzZXQoICRfQ09PS0lFWy[^''"]{1,500}[''"]\s*\)\s*\)\s*;\s*\?>(?:\s*<!--[a-z,0-9]{1,40}-->)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1028"
    name: "PHP-REX-1028"
    description: "Malware detection signature PHP-REX-1028"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]{1,40}[''"]\s*\]\s*\)\s*\)\s*\{\s*echo\s*[''"]\s*<\s*form\s*action\s*=\s*[''"][^''"]{0,40}[''"]\s*method\s*=\s*[''"]post[''"][^\}]{1,300}\s*\{\s*echo\s*[''"][^''"]{0,39}up![^''"]{0,39}[''"]\s*;\s*\}\s*\}\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1031"
    name: "PHP-REX-1031"
    description: "Malware detection signature PHP-REX-1031"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\([''"]\w{1,12}\.php[''"],\s*[''"]<\?php\s*[^`]{1,200}\s*\{?\s*eval\(\$_POST\[[''"]\w{1,12}[''"]\]\);\}?\?>[''"]\);\s/\*[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1035"
    name: "PHP-REX-1035"
    description: "Malware detection signature PHP-REX-1035"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\s*\(\s*isset\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"]\w{1,40}[''"]\]\s*\)\s*\)\s*\{[^\{]{1,600}if\s*\(\s*\$_POST\[[''"]?[^''"]{0,40}[''"]?\]\s*==\s*[''"][^''"]{0,40}[''"]\s*\)\s*\{\s*if\s*\(\s*@?copy\s*\(\$_FILES\[[''"]\w{1,40}[''"]\][^\?]{100,200}\s*\}\s*\}\s*\}\s*\?>\s*(<\?php)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1038"
    name: "PHP-REX-1038"
    description: "Malware detection signature PHP-REX-1038"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*md5\s*\(\s*@?\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"]?\w{1,40}[''"]?]\)\s*==\s*[''"]\w{1,40}[''"]\)\{\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1042"
    name: "PHP-REX-1042"
    description: "Malware detection signature PHP-REX-1042"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*echo\s*[''"][^''"]{0,40}[''"]\.php_uname\(\)\.[''"][^''"]{0,40}[''"];\s*[^\?]+if\s*\(\s*\$_POST\[[''"][^''"]{0,40}up[^''"]{0,40}[''"]\]\s*[^\w]=\s*[''"][^''"]{0,40}[''"]\s*\)\s*\{\s*if\s*\(\s*@?copy\s*\([^\)]{1,80}\)\s*\)\s*\{\s*[^\}]{1,40}\}\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1049"
    name: "PHP-REX-1049"
    description: "Malware detection signature PHP-REX-1049"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*@?md5\(\s*\$_POST\[[''"]?\w{1,40}[''"]?\]\)\s*==\s*[''"]\w{1,40}[''"]\)\s*\{\s*\$\w{1,40}=\$_POST\[[''"]?\w{1,40}[''"]?\];\s*@?eval\(stripslashes\(\$\w{1,40}\)\);\s*die;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1053"
    name: "PHP-REX-1053"
    description: "Malware detection signature PHP-REX-1053"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteCond\s+%{HTTP_USER_AGENT}\s+android\s+\[NC\]\s*RewriteRule\s+\^\(\.\*\)\$\s+https?://[a-zA-Z0-9_\-\.]+\.(xyz|info|pw)/\w+\s+\[L\s*,\s*R=302\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1054"
    name: "PHP-REX-1054"
    description: "Malware detection signature PHP-REX-1054"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteRule\s+\^\(\[A-Za-z0-9-\]\+\)\.html\$\s+\w+\.php\?fw=\$1\s+\[L\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1055"
    name: "PHP-REX-1055"
    description: "Malware detection signature PHP-REX-1055"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteEngine\s+on\s*RewriteCond\s+%{HTTP_USER_AGENT}\s+android\s+\[.+?windows-media-player\)\s+\[NC\]\s*RewriteRule\s+\^\(\.\*\)\$\s+https?://[\S]+\s+\[L,R=302\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1056"
    name: "PHP-REX-1056"
    description: "Malware detection signature PHP-REX-1056"
    severity: critical
    category: php_backdoor
    pattern: 'RewriteEngine On\s*RewriteRule\s+\^\(\.\*\),\(\.\*\)\$ \$2\.php\?rewrite_params=\$1&page_url=\$2'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1057"
    name: "PHP-REX-1057"
    description: "Malware detection signature PHP-REX-1057"
    severity: critical
    category: php_backdoor
    pattern: '<\s*IfModule\s*mod_rewrite\s*\.\s*c\s*>\s*Options\s*\+FollowSymLinks\s*RewriteEngine\s*on\s*RewriteBase\s*/\w+\s*RewriteRule\s*\^c\s*\(\\d\+\)\[-/\].+?</IfModule>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1058"
    name: "PHP-REX-1058"
    description: "Malware detection signature PHP-REX-1058"
    severity: critical
    category: php_backdoor
    pattern: '\#\s*BEGIN\s*W0RDPRESS\s*\#<IfModule\s*mod_rewrite\s*\.\s*c>\s*\#RewriteEngine\s*On\s*\#RewriteBase\s*/\s*\#RewriteCond\s*%\s*\{\s*REQUEST_FILENAME\s*\}\s*!-f\s*\#RewriteCond\s*%\s*\{\s*REQUEST_FILENAME\s*\}\s*!-d\s*\#RewriteRule\s*\.\s*/index\s*\.\s*php\s*\[\s*L\s*\]\s*\#</IfModule>\s*\#\s*END\s*WordPress'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1062"
    name: "PHP-REX-1062"
    description: "Malware detection signature PHP-REX-1062"
    severity: critical
    category: php_backdoor
    pattern: '(<\?php)\s*@?(?:eval|assert)\s*\(\s*\$_(?:POST|GET|COOKIE|REQUEST|SERVER)\[[''"]?\w{1,40}[''"]?\]\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1065"
    name: "PHP-REX-1065"
    description: "Malware detection signature PHP-REX-1065"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(isset\(\$_REQUEST\[\w+\]\)\)\s*\{\s*stripslashes\(\$_REQUEST\[\w+\]\(\$_REQ.+?\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1066"
    name: "PHP-REX-1066"
    description: "Malware detection signature PHP-REX-1066"
    severity: critical
    category: php_backdoor
    pattern: '\${"\\x\d+\\x.+;\$\{\${.+]}\["\w"\]\);}}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1069"
    name: "PHP-REX-1069"
    description: "Malware detection signature PHP-REX-1069"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s+(?:echo|print)\s*\(?\s*[''"][\!\s\-\w''"\^]{1,40}[''"]\s*\)?\s*;\s*\?>(?:\s*<\?php\s+(?:system|chmod)\s*\(\s*(?:[''"]?(?:chmod|\w{1,40}\.php|\d{3,4})\s*[''"]?\s*,?){2,3}\s*\)\s*;\s*\?>){2}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1075"
    name: "PHP-REX-1075"
    description: "Malware detection signature PHP-REX-1075"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*@?eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*[''"]BcFJkqowAADQu.Squ1xAlLG6eiEiCjIaBnHzC0kY[^''"]{400,999}[''"]\s*\)\s*\)\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1113"
    name: "PHP-REX-1113"
    description: "Malware detection signature PHP-REX-1113"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<title>\s*Webmail\s+\|?\s*Update\s*<'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1115"
    name: "PHP-REX-1115"
    description: "Malware detection signature PHP-REX-1115"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*function_exists\s*\(\s*[''"]shell_exec[''"]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*shell_exec\s*\(\s*\$\w{1,40}\s*\);\s*return\s*\$\w{1,40};\s*\}\s*return\s*[^;]{1,40};\s*\}\s*function\s*command\(\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1116"
    name: "PHP-REX-1116"
    description: "Malware detection signature PHP-REX-1116"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[\|]{0,2}\s*InboX\s+Mass\s+Mailer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1118"
    name: "PHP-REX-1118"
    description: "Malware detection signature PHP-REX-1118"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Cmd\s+by\s+ghz'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1121"
    name: "PHP-REX-1121"
    description: "Malware detection signature PHP-REX-1121"
    severity: critical
    category: php_backdoor
    pattern: '\}\s*elseif\s*\(\s*function_exists\([''"]shell_exec[''"]\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*@?shell_exec\(\$cmd\);\s*return\s*\$\w{1,40};\s*\}\s*\}\s*function\s+perms\(\$\w{1,40}\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1125"
    name: "PHP-REX-1125"
    description: "Malware detection signature PHP-REX-1125"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Sign\s*in\s*to\s*your\s*Microsoft\s*account\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1126"
    name: "PHP-REX-1126"
    description: "Malware detection signature PHP-REX-1126"
    severity: critical
    category: php_backdoor
    pattern: '\$subject\s*=\s*[''"]\s*\w{1,40}\s*\[\s*[''"]\s*\.\s*getRealIpAddr\s*\(\s*\)\s*\.\s*[''"]\s*\]\s*[''"]\s*;\s*\$headers\s*=\s*[''"]\s*From:\s*New\s+ID\s+Scan'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1127"
    name: "PHP-REX-1127"
    description: "Malware detection signature PHP-REX-1127"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*[''"]a:1:{s:13:"administrator";b:1;}[''"];\s*if\s*\(\s*isset\(\s*\$_GET\[[''"][^''"]{1,40}[''"]\]\s*\)\s*\)\s*\{\s*echo\s*[''"]<!--\s*Silence\s*is\s*golden\.?\s*-->[''"];\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1128"
    name: "PHP-REX-1128"
    description: "Malware detection signature PHP-REX-1128"
    severity: critical
    category: php_backdoor
    pattern: 'administrator'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1129"
    name: "PHP-REX-1129"
    description: "Malware detection signature PHP-REX-1129"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+\w{1,40}\s*\([^\)]{0,40}\)\s*\{\s*if\s*\(\s*!\s*defined\s*\(\s*[''"]WP_OPTION_KEY[''"]\s*\)\s*\)\s*\{\s*[^\}]{1,200}\s*\}\s*\}\s*if\s*\(\s*class_exists\s*\(\s*[''"]JFactory[''"]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1132"
    name: "PHP-REX-1132"
    description: "Malware detection signature PHP-REX-1132"
    severity: critical
    category: php_backdoor
    pattern: '\$filter\s*=\s*[''"][^''"]{0,40}[''"];\s*\$\w{1,40}\s*=\s*[''"]\s*From\s*:\s*kay\s*<\s*mailist@mailist\.com\s*>\s*[''"];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1134"
    name: "PHP-REX-1134"
    description: "Malware detection signature PHP-REX-1134"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*(?:Priv8|Private)?\s*(?:Mister|Mr)\s+Spy\s*</'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1137"
    name: "PHP-REX-1137"
    description: "Malware detection signature PHP-REX-1137"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"][^''"]{1,40}[''"]\]\s*[^\w]{1,2}=\s*[''"]?[^''"]{0,40}[''"]?\s*\)\s*\{\s*(\$\w{1,40})\s*=\s*file_get_contents\s*\(\s*[''"]https?://pastebin\.com/(?:raw|download)(?:\.php\?i=|/)\w{1,40}[''"]\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1140"
    name: "PHP-REX-1140"
    description: "Malware detection signature PHP-REX-1140"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_POST\[[''"][^''"]{1,40}[''"]\]\s*==\s*[''"][^''"]{1,40}[''"]\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\s*@?(?:eval|assert|system|shell_exec|exec|popen|passthru)\s*\(\s*[''"]wget\s*https?://pastebin\.com/(?:raw|download)(?:\.php\?i=|/)\w{1,40}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1141"
    name: "PHP-REX-1141"
    description: "Malware detection signature PHP-REX-1141"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*GIF8(?:9|7)\w?[^\s]{0,2}\s*[^`]{0,99}\s*<\?php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1142"
    name: "PHP-REX-1142"
    description: "Malware detection signature PHP-REX-1142"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*.{0,5}\s*Rebels\s+Mailer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1143"
    name: "PHP-REX-1143"
    description: "Malware detection signature PHP-REX-1143"
    severity: critical
    category: php_backdoor
    pattern: 'apple\/cssisma\/Anonisma\.css'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1144"
    name: "PHP-REX-1144"
    description: "Malware detection signature PHP-REX-1144"
    severity: critical
    category: php_backdoor
    pattern: '\$opt\("/\d+/e'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1145"
    name: "PHP-REX-1145"
    description: "Malware detection signature PHP-REX-1145"
    severity: critical
    category: php_backdoor
    pattern: 'stylesheet[^/]{1,40}href[^/]{1,40}\.?/cssisma[^\?]{1,200}Anonisma'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1146"
    name: "PHP-REX-1146"
    description: "Malware detection signature PHP-REX-1146"
    severity: critical
    category: php_backdoor
    pattern: '<TITLE>\s*dis\s+Shell\s+Commander'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1148"
    name: "PHP-REX-1148"
    description: "Malware detection signature PHP-REX-1148"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\w{0,20}\s*=\s*\$_SERVER\[[''"]REMOTE_ADDR[''"]\];\s*\$(?:from_)?shellcode\s*\.?=\s*[''"]?[^\(]{0,20}gethostbyname\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1150"
    name: "PHP-REX-1150"
    description: "Malware detection signature PHP-REX-1150"
    severity: critical
    category: php_backdoor
    pattern: 'base64_decode\s*\(\s*[''"]Y1BhbmVsIENyYWNrZXIg'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1151"
    name: "PHP-REX-1151"
    description: "Malware detection signature PHP-REX-1151"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*ZETHA\s+WEB\s*SHELL'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1154"
    name: "PHP-REX-1154"
    description: "Malware detection signature PHP-REX-1154"
    severity: critical
    category: php_backdoor
    pattern: '"[\\#-=\[]{10,12}Priv(8|ate)\s*PayPal\s*Scam'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1155"
    name: "PHP-REX-1155"
    description: "Malware detection signature PHP-REX-1155"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[:]{0,2}\s*Mailer\s+Inbox\s+-?\s*Dejector'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1156"
    name: "PHP-REX-1156"
    description: "Malware detection signature PHP-REX-1156"
    severity: critical
    category: php_backdoor
    pattern: '\$subj(?:ect)?\s*=\s*[''"]Kumasiivertigo\s*ALiBaBa'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1157"
    name: "PHP-REX-1157"
    description: "Malware detection signature PHP-REX-1157"
    severity: critical
    category: php_backdoor
    pattern: '\$headers\s*=\s*[''"]From:\s*Office[''"];\s*\$str=array\((\$send)\);\s*foreach'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1158"
    name: "PHP-REX-1158"
    description: "Malware detection signature PHP-REX-1158"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*PHP\s*Jackal'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1160"
    name: "PHP-REX-1160"
    description: "Malware detection signature PHP-REX-1160"
    severity: critical
    category: php_backdoor
    pattern: 'Kakak\s+._.\s*\.?</font><br\s*/>[''"];\s*\}\s*else(?:if)?\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1161"
    name: "PHP-REX-1161"
    description: "Malware detection signature PHP-REX-1161"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*w4l3XzY3\s+Mailer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1163"
    name: "PHP-REX-1163"
    description: "Malware detection signature PHP-REX-1163"
    severity: critical
    category: php_backdoor
    pattern: '\$headers\s*\.?=\s*[''"]From:\s*[^''"]{0,40}Spam[^''"]{0,40}[''"];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1164"
    name: "PHP-REX-1164"
    description: "Malware detection signature PHP-REX-1164"
    severity: critical
    category: php_backdoor
    pattern: 'Password\s*:\s*[''"]\.\$\w{1,40}\.[''"]\s*[=]{1,40}\s*\w{0,20}\s*FACEBOOK\s*\w{0,20}\s*[=]{1,40}\s*Email\s*:\s*[''"][^''"]{1,40}[''"]\s*Password\s*:\s*[''"][^''"]{1,40}[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1165"
    name: "PHP-REX-1165"
    description: "Malware detection signature PHP-REX-1165"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Safe\s+Mode\s+Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1166"
    name: "PHP-REX-1166"
    description: "Malware detection signature PHP-REX-1166"
    severity: critical
    category: php_backdoor
    pattern: '\)\)\s*{\s*echo\s*PHP_OS\.\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1167"
    name: "PHP-REX-1167"
    description: "Malware detection signature PHP-REX-1167"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$\w{1,40}\s*[^\w]{1,2}=\s*[''"]CheckCrd[''"]\)\s*\{\s*(?:\?>\s*<\?php)?\s*function\s+work.hard\(\$\w{1,40}\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1168"
    name: "PHP-REX-1168"
    description: "Malware detection signature PHP-REX-1168"
    severity: critical
    category: php_backdoor
    pattern: 'ZGVmYXVsdF91c2VfYWpheCA9IHRydWU'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1169"
    name: "PHP-REX-1169"
    description: "Malware detection signature PHP-REX-1169"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Sign\s+In\s*</title>\s*[^>]{1,40}(?:signin_?files|images)/\w{1,40}\.ico[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1171"
    name: "PHP-REX-1171"
    description: "Malware detection signature PHP-REX-1171"
    severity: critical
    category: php_backdoor
    pattern: 'PD9waHAgaWYoIWlzc2V0KCRfQ09PS0lFWyJtb2R4'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1172"
    name: "PHP-REX-1172"
    description: "Malware detection signature PHP-REX-1172"
    severity: critical
    category: php_backdoor
    pattern: 'JE8wTzAwMD0ibkZ1Zmt'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1173"
    name: "PHP-REX-1173"
    description: "Malware detection signature PHP-REX-1173"
    severity: critical
    category: php_backdoor
    pattern: 'Ly9OTHRScS9mcjJYRzZhM3FPd3l'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1174"
    name: "PHP-REX-1174"
    description: "Malware detection signature PHP-REX-1174"
    severity: critical
    category: php_backdoor
    pattern: 'VnXO8\$1_HU8nnjePnU8P8\$e_njsP8\$V'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1175"
    name: "PHP-REX-1175"
    description: "Malware detection signature PHP-REX-1175"
    severity: critical
    category: php_backdoor
    pattern: 'Ly9OTmhOOVUrMkRuVUkrTm9mdnhWV2RRV'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1176"
    name: "PHP-REX-1176"
    description: "Malware detection signature PHP-REX-1176"
    severity: critical
    category: php_backdoor
    pattern: 'ZXJyb3JfcmVwb3J0aW5nKDApO2lmKGlzc2V0KCRfUkVR'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1177"
    name: "PHP-REX-1177"
    description: "Malware detection signature PHP-REX-1177"
    severity: critical
    category: php_backdoor
    pattern: 'eNq1fflvU2f677/iieaqQDPhb'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1178"
    name: "PHP-REX-1178"
    description: "Malware detection signature PHP-REX-1178"
    severity: critical
    category: php_backdoor
    pattern: 'DRmNurHxXATBjbLkSGpOQnIzco'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1179"
    name: "PHP-REX-1179"
    description: "Malware detection signature PHP-REX-1179"
    severity: critical
    category: php_backdoor
    pattern: 'ZXJyb3JfcmVwb3J0aW5nKDcpOw0KQ'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1180"
    name: "PHP-REX-1180"
    description: "Malware detection signature PHP-REX-1180"
    severity: critical
    category: php_backdoor
    pattern: 'eNp9Vm1rG1cW/iu3orRSIpx508iy'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1181"
    name: "PHP-REX-1181"
    description: "Malware detection signature PHP-REX-1181"
    severity: critical
    category: php_backdoor
    pattern: 'eNqVWvtTFFfa/lc6VGoDSrC7p'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1182"
    name: "PHP-REX-1182"
    description: "Malware detection signature PHP-REX-1182"
    severity: critical
    category: php_backdoor
    pattern: 'eNq9fflzI9XV9r/S05CRBLas'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1183"
    name: "PHP-REX-1183"
    description: "Malware detection signature PHP-REX-1183"
    severity: critical
    category: php_backdoor
    pattern: 'Z2xvYmFsICRVU0VSOwokVVNFUi0'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1184"
    name: "PHP-REX-1184"
    description: "Malware detection signature PHP-REX-1184"
    severity: critical
    category: php_backdoor
    pattern: '6SgzwTnp6V5jAu8DDpIWHwHvz'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1185"
    name: "PHP-REX-1185"
    description: "Malware detection signature PHP-REX-1185"
    severity: critical
    category: php_backdoor
    pattern: 'Pz48P3BocCAkX0Y9X19GSUxFX18'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1186"
    name: "PHP-REX-1186"
    description: "Malware detection signature PHP-REX-1186"
    severity: critical
    category: php_backdoor
    pattern: 'aWYoITApJE8wMDBPME8wMD0kT09'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1187"
    name: "PHP-REX-1187"
    description: "Malware detection signature PHP-REX-1187"
    severity: critical
    category: php_backdoor
    pattern: 'aWYoaXNzZXQoJF9HRVRbIjB4Il0'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1188"
    name: "PHP-REX-1188"
    description: "Malware detection signature PHP-REX-1188"
    severity: critical
    category: php_backdoor
    pattern: 'aWYoITApJE8wMDBPME8wMD0kT09'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1189"
    name: "PHP-REX-1189"
    description: "Malware detection signature PHP-REX-1189"
    severity: critical
    category: php_backdoor
    pattern: 'JElJSUlJSUkxMTFsST0nb2JfZW5'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1190"
    name: "PHP-REX-1190"
    description: "Malware detection signature PHP-REX-1190"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(gzuncompress\(base64_decode\(''eNqtWVlv21YWfm6B\+Q9MYIR'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1191"
    name: "PHP-REX-1191"
    description: "Malware detection signature PHP-REX-1191"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,12}\s*\.\s*=\s*[''"][^''"]{0,20}Social\s+Security[^''"]{0,20}\s*[''"]\s*\.?\s*\$_POST\s*\[\s*[''"]ssn[''"]\s*\]\s*\.\s*[^;]{1,40}\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1192"
    name: "PHP-REX-1192"
    description: "Malware detection signature PHP-REX-1192"
    severity: critical
    category: php_backdoor
    pattern: '\);eval\(base64_decode\("aWYoIWZ1bmN0aW9uX2V4aXN0cygiWWl1bklVWTc2YkJod'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1193"
    name: "PHP-REX-1193"
    description: "Malware detection signature PHP-REX-1193"
    severity: critical
    category: php_backdoor
    pattern: '\$O00OO0\{30\};eval\(\$O00O0O\("JE8wTzAwMD0iVFF3cVJQTGR0ZkZEeHVZeUVJVktXQ2tyY0poTlNaSGlib3Z'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1194"
    name: "PHP-REX-1194"
    description: "Malware detection signature PHP-REX-1194"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*(?:Priv8|Private)\s+Mailer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1196"
    name: "PHP-REX-1196"
    description: "Malware detection signature PHP-REX-1196"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=__FILE__\s*;\s*\$\w{1,40}\s*=''P2lCP1ouWg1WDVYkcnNXTUVlWU0\+Uz4iMi5NMnluUVluWFk5TCI7DVYkLy5NMnluUVlucnNXTXRlbi4\+Uz4iMTE8QVBrUExVQTFBMFt'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1197"
    name: "PHP-REX-1197"
    description: "Malware detection signature PHP-REX-1197"
    severity: critical
    category: php_backdoor
    pattern: '\$d?doss(?:tr)?;\s*\}\s*while\s*\(\s*\w{1,40}\s*\)\s*\{\s*\$[o0]{5,60}\s*=\s*@?include(?:_once)?\s*\(?\$[o0]{5,60}\)?;\s*if\s*\(\s*\$[o0]{5,60}\s*==\s*[''"][^''"]{0,60}[''"]\s*\)\s*\{\s*\$[o0]{5,60}\+\+;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1199"
    name: "PHP-REX-1199"
    description: "Malware detection signature PHP-REX-1199"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[\s:]{0,4}g(?:0|o)nz\s*[\s:]{0,4}\s*PHP\s+MAILER'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1204"
    name: "PHP-REX-1204"
    description: "Malware detection signature PHP-REX-1204"
    severity: critical
    category: php_backdoor
    pattern: 'window\.miner\.stop\s*==\s*[''"]function[''"]\)\s*window\.miner\.stop\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1207"
    name: "PHP-REX-1207"
    description: "Malware detection signature PHP-REX-1207"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*(?:Sign\s+In\s*-)?\s*DocuSign\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1208"
    name: "PHP-REX-1208"
    description: "Malware detection signature PHP-REX-1208"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(crawlerDetect\(\$_SERVER\[[''"]?HTTP_USER_AGENT[''"]?\]\)\)\s*\{\s*header\([''"]HTTP/1\.\d\s+404\s+Not\s+Found[''"]\);\s*die\([''"][^''"]{1,100}[''"]\);\s*\}\s*\$IP_Connected\s*=\s*\$_SERVER\[[''"]?REMOTE_ADDR[''"]?\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1209"
    name: "PHP-REX-1209"
    description: "Malware detection signature PHP-REX-1209"
    severity: critical
    category: php_backdoor
    pattern: 'exit\s*\(\);\s*\}?\s*if\s*\(\$_POST\[[''"]?[^\?]{1,40}[''"]?\]\)\s*@?eval\(\$_POST\[[''"]?[^\?]{1,40}[''"]?\]\);\s*if\s*\(\s*\$_POST\[[''"]?[^''"]{0,20}up[^''"]{0,20}[''"]?\]\s*[^\w]=\s*[''"][^''"]{0,40}[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1210"
    name: "PHP-REX-1210"
    description: "Malware detection signature PHP-REX-1210"
    severity: critical
    category: php_backdoor
    pattern: '<br/>Mr Secretz</center>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1211"
    name: "PHP-REX-1211"
    description: "Malware detection signature PHP-REX-1211"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Mr\s*Secretz\s+Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1212"
    name: "PHP-REX-1212"
    description: "Malware detection signature PHP-REX-1212"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*View\s*Document\s*-\s*Sign\s+In</title>\s*</head>\s*<script\s*type="text/javascript">\s*(?:<!--)?\s*function popupwnd\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1215"
    name: "PHP-REX-1215"
    description: "Malware detection signature PHP-REX-1215"
    severity: critical
    category: php_backdoor
    pattern: 'phpddos\.com[^''"]{0,40}[''"];\s*echo\s*[''"]\s*SYN\s*Flood'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1217"
    name: "PHP-REX-1217"
    description: "Malware detection signature PHP-REX-1217"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*DropBox\s+Buisness\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1218"
    name: "PHP-REX-1218"
    description: "Malware detection signature PHP-REX-1218"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*posix_getpwuid\(@?fileowner\([''"]/etc/valiases/[''"]\.\$domains?\[\d\]\[\d\]\)\);\s*echo'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1220"
    name: "PHP-REX-1220"
    description: "Malware detection signature PHP-REX-1220"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[\.]{1,5}\s*[:]{1,5}\s*Snff\s+P90\s*[:]{1,5}\s*[\.]{1,5}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1222"
    name: "PHP-REX-1222"
    description: "Malware detection signature PHP-REX-1222"
    severity: critical
    category: php_backdoor
    pattern: '/\*\s*Created\s+by\s+l33bo_phishers'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1225"
    name: "PHP-REX-1225"
    description: "Malware detection signature PHP-REX-1225"
    severity: critical
    category: php_backdoor
    pattern: 'exec\(\\?[''"]unzip\s+\w{1,40}\.zip\\?["'']\);\s*\?>[''"];\s*\$\w{1,4}\s*=\s*fopen\([''"][^''"]{0,40}wp-login\.php[''"],\s*[''"]\w[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1226"
    name: "PHP-REX-1226"
    description: "Malware detection signature PHP-REX-1226"
    severity: critical
    category: php_backdoor
    pattern: 'gagal[''"]\;\}\}\}\?>\s*<title>\s*Hacked\s+by'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1227"
    name: "PHP-REX-1227"
    description: "Malware detection signature PHP-REX-1227"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?(?:php)?\s*if\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"]?\w{1,40}[''"]?\]\s*==\s*[''"](clear|remove|delete)[''"]\s*\)\s*\{?\s*(?:system|exec|passthru|shell_exec|popen|eval|assert)\s*\(\s*[''"][^'']{0,40}[^\w]b(?:o|0)t[^\w][^'']{0,40}[''"]\s*\);\s*echo'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1228"
    name: "PHP-REX-1228"
    description: "Malware detection signature PHP-REX-1228"
    severity: critical
    category: php_backdoor
    pattern: '>Upload\s+Form\s+Yunkers\s+Crew<'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1230"
    name: "PHP-REX-1230"
    description: "Malware detection signature PHP-REX-1230"
    severity: critical
    category: php_backdoor
    pattern: 'addFromString\(\s*[''"](?:\.\.\\){7,10}[^`]{1,40}\.php[''"],\s*[''"]<\?php exec\(\[[''"]?cmd[''"]?\]\);\s*\?>[''"]\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1231"
    name: "PHP-REX-1231"
    description: "Malware detection signature PHP-REX-1231"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Ghost\s*by\s*dandan'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1233"
    name: "PHP-REX-1233"
    description: "Malware detection signature PHP-REX-1233"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*\w{1,40}\(\$hax\)\s*\{return\s+pack\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1234"
    name: "PHP-REX-1234"
    description: "Malware detection signature PHP-REX-1234"
    severity: critical
    category: php_backdoor
    pattern: '\$\{\$\{[''"][^''"]{1,60}[''"]\}\[[''"][^''"]{1,60}[''"]\]\}=[''"]/[''"]\.uniqid\(\)\.uniqid\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1236"
    name: "PHP-REX-1236"
    description: "Malware detection signature PHP-REX-1236"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[''"]?\.?getcwd\(\s*\)\.[''"]<'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1237"
    name: "PHP-REX-1237"
    description: "Malware detection signature PHP-REX-1237"
    severity: critical
    category: php_backdoor
    pattern: '\]\},ob_get_contents\(\s*\)\);\s*fclose\(\s*\$\s*\{\s*\$\w{1,40}\s*\}\);\s*ob_end_flush\(\s*\);\s*\}\s*cache_start\(\$\s*\{\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1238"
    name: "PHP-REX-1238"
    description: "Malware detection signature PHP-REX-1238"
    severity: critical
    category: php_backdoor
    pattern: '\}\s*\)\s*;\s*\}\s*\}\s*function\s+visitor_country\(\)\{\$\{[''"](G|L|O|\\x47|\\x4c|\\x4f){3}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1239"
    name: "PHP-REX-1239"
    description: "Malware detection signature PHP-REX-1239"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*/\*\s*AthenaHTTP\s*\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1241"
    name: "PHP-REX-1241"
    description: "Malware detection signature PHP-REX-1241"
    severity: critical
    category: php_backdoor
    pattern: ';\$default_use_ajax=true;\$default_charset=_\w{1,40}\(\d\);\$GLOBALS'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1242"
    name: "PHP-REX-1242"
    description: "Malware detection signature PHP-REX-1242"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*GFX\s+\|\s*GForce\s*X-Sender\s*by\s*Mr-Anobs\s*2018'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1246"
    name: "PHP-REX-1246"
    description: "Malware detection signature PHP-REX-1246"
    severity: critical
    category: php_backdoor
    pattern: '\$header\s*\.?\s*=\s*quoted_printable_encode\s*\(\s*\$\w{1,40}\)\s*\.?[''"]?(?:\\r)?\\n[''"];\s*mail\s*\([^\)]{1,40}\);\s*print\s*[''"]Spammed'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1247"
    name: "PHP-REX-1247"
    description: "Malware detection signature PHP-REX-1247"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[:]{0,2}\s*eBuKa\s*mAx\s*INbOx\s*sEnDeR'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1248"
    name: "PHP-REX-1248"
    description: "Malware detection signature PHP-REX-1248"
    severity: critical
    category: php_backdoor
    pattern: '<meta\s*name\s*=\s*[''"]description[''"]\s*content\s*=\s*[''"]Banco\s*Financiero\s*del\s*Peru[''"]\s*\/>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1249"
    name: "PHP-REX-1249"
    description: "Malware detection signature PHP-REX-1249"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Injected\s+By\s*Mrs\.Poisoner'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1250"
    name: "PHP-REX-1250"
    description: "Malware detection signature PHP-REX-1250"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+sql_inject\s*\(\$\w{1,40}\s*=\s*FALSE\s*,\$bdestroy_sessio'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1251"
    name: "PHP-REX-1251"
    description: "Malware detection signature PHP-REX-1251"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\])\s*;\s*(?:\$\w{1,40}\s*\.?=\.?\s*[^;]{1,80}\s*;\s*){4,8}\s*@?mail\([^)]{1,80}\)\s*;\s*header\s*\(\s*[''"]Location\s*:[^)]+\);\s*exit;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1254"
    name: "PHP-REX-1254"
    description: "Malware detection signature PHP-REX-1254"
    severity: critical
    category: php_backdoor
    pattern: '\$sql\s*=\s*[''"][^\?]{1,40}\s*,\s*[''"]\s*<\?(?:php)?\s*system\s*\(\\\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[\w{1,12}\]\s*\);\s*exit;\s*\?>[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1255"
    name: "PHP-REX-1255"
    description: "Malware detection signature PHP-REX-1255"
    severity: critical
    category: php_backdoor
    pattern: '\A<\?(?:php)?\s*.{0,40}\s*\$ip\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\])\s*;\s*\$\w{1,40}\s*=\s*date\([^)]{1,40}\)\s*;\s*\$\w{1,40}\s*=\s*[''"][^''"]{80,120}[''"]\s*;\s*\s*(?:\$\w{1,40}\s*\.?=\.?\s*[^;]{1,80}\s*;\s*){2,5}\s*@?mail\([^)]{1,80}\)\s*;\s*header\s*\(\s*[''"]Location\s*:'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1258"
    name: "PHP-REX-1258"
    description: "Malware detection signature PHP-REX-1258"
    severity: critical
    category: php_backdoor
    pattern: '\A<\?(?:php)?\s*.{0,80}\s*\$ipv?\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\])\s*;\s*(?:\$\w{1,40}\s*\.?=\.?\s*[^;]{1,80}\s*;\s*){4,8}\s*@?mail\([^)]{1,80}\)\s*;\s*header\s*\(\s*[''"]Location\s*:[^)]+\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1260"
    name: "PHP-REX-1260"
    description: "Malware detection signature PHP-REX-1260"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+return_index\(\)\s*\{\s*global \$exec_file\s*,\s*\$index_page'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1261"
    name: "PHP-REX-1261"
    description: "Malware detection signature PHP-REX-1261"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]*[''"]\s*\]\s*\)\s*\)\s*\{\s*\$ip\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\]);(\s*\$\w{1,40}\s*=\s*[^;]{1,40};){0,5}\s*\$\w{1,40}\s*=\s*rand\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1262"
    name: "PHP-REX-1262"
    description: "Malware detection signature PHP-REX-1262"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<title>Sucursal\s+Virtual\s+BANCOLOMBIA'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1264"
    name: "PHP-REX-1264"
    description: "Malware detection signature PHP-REX-1264"
    severity: critical
    category: php_backdoor
    pattern: '\$send="[^"]{1,60}";\s*\$subject\s*=\s*"Apple Result : \$email";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1267"
    name: "PHP-REX-1267"
    description: "Malware detection signature PHP-REX-1267"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*download_code\s*\(\s*\)\s*\{\s*(?:\$\w{1,40}\s*=\s*[''"][^''"]{1,40}[''"]\s*;)?\s*if\s*\(\s*isset\s*\(\s*\$_POST\s*\[\s*[''"]key[''"]\s*\]\s*\)\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1271"
    name: "PHP-REX-1271"
    description: "Malware detection signature PHP-REX-1271"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(0\);\s*(?:require\s*[''"](?:(?:\.\./){0,2}(check|email)\.php)[''"]\s*;\s*){2}\s*(?:\$\w{1,40}\s*=\s*[''"][^''"]{0,40}[''"]\s*;\s*)?if\s*\(\s*(?:trim|isset)\s*\(\s*\$_POST\s*\[\s*[''"]submit[''"]\s*\]\)\)\{\s*if\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1272"
    name: "PHP-REX-1272"
    description: "Malware detection signature PHP-REX-1272"
    severity: critical
    category: php_backdoor
    pattern: 'include\s*[''"]\./send\.php[''"];(\s*\$\w{1,40}\s*=\s*\$_POST\[[''"][^''"]{1,40}[''"]\];){2,10}\s*\$\w{1,40}\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\]);\s*\$time'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1273"
    name: "PHP-REX-1273"
    description: "Malware detection signature PHP-REX-1273"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\]);\s*//\s*\w{1,40}\s*(\s*\$\w{1,40}\s*=\s*\$_POST\[[''"][^''"]{1,40}[''"]\];){2,16}\s*\$fw2\s*=\s*fopen\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1274"
    name: "PHP-REX-1274"
    description: "Malware detection signature PHP-REX-1274"
    severity: critical
    category: php_backdoor
    pattern: '\$msg\s*=\s*[''"]Alibaba\s*login'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1277"
    name: "PHP-REX-1277"
    description: "Malware detection signature PHP-REX-1277"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*date\([''"][^''"]{1,40}[''"]\);\s*(?:\$\w{1,40}\s*=\s*\$_POST\[[''"]\w{1,40}[''"]\];\s*)+\$ip\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\]);\s*.{0,400}\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*[''"]from\s[^''"]{1,40}[''"]\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1278"
    name: "PHP-REX-1278"
    description: "Malware detection signature PHP-REX-1278"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*[''"]\w{1,40}\s*BANCOLOMBIA\s*\(\s*[''"]\s*\.\$ip\.\s*[''"]\s*\)[''"]\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1279"
    name: "PHP-REX-1279"
    description: "Malware detection signature PHP-REX-1279"
    severity: critical
    category: php_backdoor
    pattern: '<\?(?:php)?\s*\$ip\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\]);\s*.{1,400}\s*mail\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$mensaje\s*,\s*\$\w{1,40}\s*\)\s*;\s*header\s*\(\s*[''"]Location:[^''"]{1,40}[''"]\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1282"
    name: "PHP-REX-1282"
    description: "Malware detection signature PHP-REX-1282"
    severity: critical
    category: php_backdoor
    pattern: 'CoffeeCup Web Form Builder\s*-->\s*<title>Yahoo\s+Update</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1283"
    name: "PHP-REX-1283"
    description: "Malware detection signature PHP-REX-1283"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Sign\s+in\s*</title>.{350}\s*<\s*script type\s*=\s*[''"]\s*text/javascript\s*[''"]>\s*function unhideBody\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1284"
    name: "PHP-REX-1284"
    description: "Malware detection signature PHP-REX-1284"
    severity: critical
    category: php_backdoor
    pattern: '<title>Yahoo</title>\s*<\s*meta http-equiv\s*=\s*[''"]refresh[''"]\s*content\s*=\s*[''"]\d+;\s*url\s*=\s*https://yahoo\.com[''"]\s*>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1285"
    name: "PHP-REX-1285"
    description: "Malware detection signature PHP-REX-1285"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Sign\s+in\s*-\s*Google\s+Drive</title>\s*<style>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1286"
    name: "PHP-REX-1286"
    description: "Malware detection signature PHP-REX-1286"
    severity: critical
    category: php_backdoor
    pattern: 'charset\s*=\s*UTF-8[''"]>\s*<title>\s*Google\s+Drive\s*-\s*Google\s+Drive\s*</title'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1287"
    name: "PHP-REX-1287"
    description: "Malware detection signature PHP-REX-1287"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<meta\s*http-equiv=[''"]Content-Type[''"]\s*content=[''"]text/html;\s*charset=UTF-8[''"]>\s*<title>\s*Google\s+Drive\s*</title>\s*<script\s*language=[''"]javascript[''"]>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1288"
    name: "PHP-REX-1288"
    description: "Malware detection signature PHP-REX-1288"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<!DOCTYPE html>\s*<!--\s+saved\s+from\s+url=.{200,600}https?://login\.live\.com'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1289"
    name: "PHP-REX-1289"
    description: "Malware detection signature PHP-REX-1289"
    severity: critical
    category: php_backdoor
    pattern: ';\$b374k\s*=\s*\$\w{1,40}\(\s*[''"]\$\w{1,40}[''"]\s*,\s*[''"\.,\seval]{7,40}\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1290"
    name: "PHP-REX-1290"
    description: "Malware detection signature PHP-REX-1290"
    severity: critical
    category: php_backdoor
    pattern: 'public\s*function\s*root_vuln\s*\(\s*\)\s*\{\s*\$\w{1,40}\s*=\s*php_uname'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1293"
    name: "PHP-REX-1293"
    description: "Malware detection signature PHP-REX-1293"
    severity: critical
    category: php_backdoor
    pattern: '<script\s+src\s*=\s*[''"](?:\.\./){1,5}www1\.bac-assets\.com/online-banking/spa-assets/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1294"
    name: "PHP-REX-1294"
    description: "Malware detection signature PHP-REX-1294"
    severity: critical
    category: php_backdoor
    pattern: '<!--\s*Mirrored\s*from\s*(www\.)?bankofamerica\.com/online-banking/sign-in/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1295"
    name: "PHP-REX-1295"
    description: "Malware detection signature PHP-REX-1295"
    severity: critical
    category: php_backdoor
    pattern: '\$inj\s*=\s*[''"][''"\s\.\/\_\=windovarsfcebg]{30,40}[''"]\s*\.\$\w{1,40}\s*\.\s*[''"]\s*;\s*[''"]\s*;\s*\}\s*if\s*\(\s*file_exists\s*\(\s*\$_SERVER\s*\[[''"]DOCUMENT_ROOT[''"]\s*\]\s*\.?\s*[''"\s\.\/,\_bitrxjsmancoeld]{41,60}\s*\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1296"
    name: "PHP-REX-1296"
    description: "Malware detection signature PHP-REX-1296"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Priv8\s+Tools'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1297"
    name: "PHP-REX-1297"
    description: "Malware detection signature PHP-REX-1297"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*MIME::Base64::decode\s*\(\s*\$cheataer\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1298"
    name: "PHP-REX-1298"
    description: "Malware detection signature PHP-REX-1298"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Mini\s+Shell\s*[&nbsp|]{1,80}\s*TiGER'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1299"
    name: "PHP-REX-1299"
    description: "Malware detection signature PHP-REX-1299"
    severity: critical
    category: php_backdoor
    pattern: 'return\(eval\([^\)]{1,}\)\);\s*\?>\s*\#!/usr/bin/php\s*-q'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1300"
    name: "PHP-REX-1300"
    description: "Malware detection signature PHP-REX-1300"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*ManToed\s*Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1301"
    name: "PHP-REX-1301"
    description: "Malware detection signature PHP-REX-1301"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*\[S\]uper\[BAD\]\s*Mailer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1302"
    name: "PHP-REX-1302"
    description: "Malware detection signature PHP-REX-1302"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[|]{0,2}\s*NOMAN\s*HACKING\s*COMPANY'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1303"
    name: "PHP-REX-1303"
    description: "Malware detection signature PHP-REX-1303"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+payload_download\s*\(\s*\$cwd\s*,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1304"
    name: "PHP-REX-1304"
    description: "Malware detection signature PHP-REX-1304"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*\$\w{1,40}\s*=\s*[''"]\s*find\s*/\s*-type\s*f\s*-name\s*[''"]\*[''"]\s*\|\sxargs\sgrep\s-rl\s[''"]<head[''"][''"]\s*;\s*\$\w{1,40}\s*='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1305"
    name: "PHP-REX-1305"
    description: "Malware detection signature PHP-REX-1305"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[+\[]{0,2}\s*Powered\s*by\s*KcB\s*[\]+]{0,2}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1306"
    name: "PHP-REX-1306"
    description: "Malware detection signature PHP-REX-1306"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*socket_listen\s*\(\s*\$sock\s*,\s*\d+\s*\)\s*===\s*false\s*\)\s*\{\s*echo\s*[''"]HaHa'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1307"
    name: "PHP-REX-1307"
    description: "Malware detection signature PHP-REX-1307"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*-\s*r\s*w\s*-\s*r\s*-\s*-\s*r-\s*-<'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1308"
    name: "PHP-REX-1308"
    description: "Malware detection signature PHP-REX-1308"
    severity: critical
    category: php_backdoor
    pattern: '5YN15T3R_742\s+shell</font>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1309"
    name: "PHP-REX-1309"
    description: "Malware detection signature PHP-REX-1309"
    severity: critical
    category: php_backdoor
    pattern: '\$Report\s*=\s*new Report\(\$DBData,\s*file_get_contents\(''php://input''\), intval\(\$_SERVER\[''CONTENT_LENGTH''\]\), ENCKEY_, TEMP_\);\s*\$Report = NULL;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1310"
    name: "PHP-REX-1310"
    description: "Malware detection signature PHP-REX-1310"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*MakMan\s*[-\s]{0,3}\s*Root\s*Exploiter'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1311"
    name: "PHP-REX-1311"
    description: "Malware detection signature PHP-REX-1311"
    severity: critical
    category: php_backdoor
    pattern: 'Data\s*=\s*\$LokiDBCon->ExportDatabyID\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1312"
    name: "PHP-REX-1312"
    description: "Malware detection signature PHP-REX-1312"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*:.Spade\s*Mini\s*Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1313"
    name: "PHP-REX-1313"
    description: "Malware detection signature PHP-REX-1313"
    severity: critical
    category: php_backdoor
    pattern: 'private\s+function\s+backdoorFiles\s*\(\s*\$\w{1,40}\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1314"
    name: "PHP-REX-1314"
    description: "Malware detection signature PHP-REX-1314"
    severity: critical
    category: php_backdoor
    pattern: 'name\s*===\s*"webconsole"\)\s*\$get\s*=\s*array\([''"]https?\:\/\/pastebin\.com\/raw'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1315"
    name: "PHP-REX-1315"
    description: "Malware detection signature PHP-REX-1315"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*"This\s*shit\s*works!";\s*if\s*\(isset\(\$_FILES'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1316"
    name: "PHP-REX-1316"
    description: "Malware detection signature PHP-REX-1316"
    severity: critical
    category: php_backdoor
    pattern: '<center>\$\s+root@x48'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1317"
    name: "PHP-REX-1317"
    description: "Malware detection signature PHP-REX-1317"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*BlackTools\s*Folder\s*Mass\s*Defacer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1318"
    name: "PHP-REX-1318"
    description: "Malware detection signature PHP-REX-1318"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+file_get_contents\(''/home/''\.\$user\.''/\.my\.cnf'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1319"
    name: "PHP-REX-1319"
    description: "Malware detection signature PHP-REX-1319"
    severity: critical
    category: php_backdoor
    pattern: '<\?(?:php)?\s+include\s*\([''"]blocker\.php[''"]\)\s*\;\s*\$DIR\s*\=\s*md5\s*\(\s*rand\s*\(\s*\d+\s*\,\s*\d+\)\s*\)\s*\;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1320"
    name: "PHP-REX-1320"
    description: "Malware detection signature PHP-REX-1320"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+c99shexit\(\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1321"
    name: "PHP-REX-1321"
    description: "Malware detection signature PHP-REX-1321"
    severity: critical
    category: php_backdoor
    pattern: '<title>Uploader\s+By\s+IndoXploit'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1323"
    name: "PHP-REX-1323"
    description: "Malware detection signature PHP-REX-1323"
    severity: critical
    category: php_backdoor
    pattern: '\$tofile=''[^'']{1,50}'';\s*\s*\$\w{1,40}\s*=\s*base64_decode\(strtr\(\$_POST\[[^)]+\)\);\s*\$\w{1,40}=''<\?php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1324"
    name: "PHP-REX-1324"
    description: "Malware detection signature PHP-REX-1324"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(sha1\(md5\(\$_POST\["\w{1,40}"\]\)\)==="\w{40}"\)\s*move_uploaded_file\(\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1325"
    name: "PHP-REX-1325"
    description: "Malware detection signature PHP-REX-1325"
    severity: critical
    category: php_backdoor
    pattern: 'DirContents\(\$rest\);\}else\{getDirContents'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1327"
    name: "PHP-REX-1327"
    description: "Malware detection signature PHP-REX-1327"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s{1000,}\$\w{1,40}\s*=\s*\$_POST\s*;\s*\$\w{1,40}\s*=\s*\$\w{1,40}\[\w{1,40}\]\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1328"
    name: "PHP-REX-1328"
    description: "Malware detection signature PHP-REX-1328"
    severity: critical
    category: php_backdoor
    pattern: 'sin\(\$\w{1,40}\?\);syslog\(LOG_ERR,\$err\);\}\$\w{1,40}='''';if\(in_array'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1329"
    name: "PHP-REX-1329"
    description: "Malware detection signature PHP-REX-1329"
    severity: critical
    category: php_backdoor
    pattern: '\$VERSION\s*=\s*''Gamma\s+Web\s+Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1330"
    name: "PHP-REX-1330"
    description: "Malware detection signature PHP-REX-1330"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*::\s+AventGrup\s+::\.\.'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1331"
    name: "PHP-REX-1331"
    description: "Malware detection signature PHP-REX-1331"
    severity: critical
    category: php_backdoor
    pattern: '\$title="NetworkFileManagerPHP";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1332"
    name: "PHP-REX-1332"
    description: "Malware detection signature PHP-REX-1332"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(gzinflate\(base64_decode\(str_rot13\(strrev\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1333"
    name: "PHP-REX-1333"
    description: "Malware detection signature PHP-REX-1333"
    severity: critical
    category: php_backdoor
    pattern: '=\s*remove_tags\(\s*_dl\s*\(\s*\$_(GET|POST|COOKIE)\s*\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1334"
    name: "PHP-REX-1334"
    description: "Malware detection signature PHP-REX-1334"
    severity: critical
    category: php_backdoor
    pattern: 'srand\(seed\(\)\);\s*\$additional=array\("%1meta name=\\"description\\"\s*content=\\"\$description\\"%3","%1meta'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1335"
    name: "PHP-REX-1335"
    description: "Malware detection signature PHP-REX-1335"
    severity: critical
    category: php_backdoor
    pattern: '@symlink\(''/home/'' \. \$user \. ''/public_html/wp-config\.php'', \$user'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1337"
    name: "PHP-REX-1337"
    description: "Malware detection signature PHP-REX-1337"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+GetPayload\(\$payload\)\s*\{\s*\$current_payload\s+=\s+base64_decode\(\$payload'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1339"
    name: "PHP-REX-1339"
    description: "Malware detection signature PHP-REX-1339"
    severity: critical
    category: php_backdoor
    pattern: '\)\)\s*\{\s*echo\s+''<b>Shell\s+Uploaded'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1340"
    name: "PHP-REX-1340"
    description: "Malware detection signature PHP-REX-1340"
    severity: critical
    category: php_backdoor
    pattern: '<title>Vuln!!\s+patch\s+it\s+Now'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1342"
    name: "PHP-REX-1342"
    description: "Malware detection signature PHP-REX-1342"
    severity: critical
    category: php_backdoor
    pattern: 'exec\(\$_(?:GET|POST|COOKIE)\["\w+"\],\$\w{1,40}\);print_r\(\$\w{1,40}\);\}\}if\(\$_(?:GET|POST|COOKIE|REQUEST)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1343"
    name: "PHP-REX-1343"
    description: "Malware detection signature PHP-REX-1343"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*''[^'']+''\s*\^\s*''[^'']+''\s*;\s*\$\w{1,40}\(""\s*,\s*"};"\s*\.\s*\$\w{1,40}\(\s*preg_match\(\s*"[^"]+"\s*,\s*\$\w{1,40}\(\s*""\s*,\s*file\(\s*__FILE__\s*\)\s*\)\s*,\s*\$match\)\s*\?\s*\(\s*\$match\[1\]\s*\)\s*:\s*""\s*\)\s*\.\s*"//"\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1344"
    name: "PHP-REX-1344"
    description: "Malware detection signature PHP-REX-1344"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\d\^\d\)&&strtoupper\(\$_\d+,\$_SERVER,\$_SERVER,\$_\d+\)\)cosh'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1346"
    name: "PHP-REX-1346"
    description: "Malware detection signature PHP-REX-1346"
    severity: critical
    category: php_backdoor
    pattern: ';\}\s*echo\s+''[^'']{1,100}'';\s*preg_replace\("\\x2F\\x2E\\x2A\\x2F\\x65","\\x65\\x76\\x61\\x6C\\x28'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1347"
    name: "PHP-REX-1347"
    description: "Malware detection signature PHP-REX-1347"
    severity: critical
    category: php_backdoor
    pattern: '<head>\s*<title>Xsender</title>\s*</head>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1348"
    name: "PHP-REX-1348"
    description: "Malware detection signature PHP-REX-1348"
    severity: critical
    category: php_backdoor
    pattern: 'setcookie\(''f_wp''\s*,\s*\$_POST'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1349"
    name: "PHP-REX-1349"
    description: "Malware detection signature PHP-REX-1349"
    severity: critical
    category: php_backdoor
    pattern: '\]\}=pre_term_name\(\$\{\$\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1350"
    name: "PHP-REX-1350"
    description: "Malware detection signature PHP-REX-1350"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+initFunctions\(\)\s*\{\s*if\s*\(!function_exists\(''myfuncgood''\)\)\s*\{\s*function\s+myfuncgood\(\$in'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1352"
    name: "PHP-REX-1352"
    description: "Malware detection signature PHP-REX-1352"
    severity: critical
    category: php_backdoor
    pattern: ';\$\w{1,40}\^\$\w{1,40};\$\w{1,40}=\$\w{1,40}\^'''
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1353"
    name: "PHP-REX-1353"
    description: "Malware detection signature PHP-REX-1353"
    severity: critical
    category: php_backdoor
    pattern: 'if\s+!\s+pgrep\s+-f\s+"minmon'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1354"
    name: "PHP-REX-1354"
    description: "Malware detection signature PHP-REX-1354"
    severity: critical
    category: php_backdoor
    pattern: '@fsockopen\(\$\w{1,40}\[[^\]]{1,100}\],\s*80\s*,\s*\$\w{1,40},\s*\$\w{1,40}\s*,\s*5\)\)\s*\{\s*goto\s*\w{1,40};\s*\}\s*goto'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1355"
    name: "PHP-REX-1355"
    description: "Malware detection signature PHP-REX-1355"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,40}\s*=\s*\\''[^'']{1,100}''\^\\''[^'']+'';\s*){3,}\$\w{1,40}\s*=\s*\$\w{1,40}\(\\''\\''\s*,\s*\$\w{1,40}\(\$\w{1,40}\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1356"
    name: "PHP-REX-1356"
    description: "Malware detection signature PHP-REX-1356"
    severity: critical
    category: php_backdoor
    pattern: '</head>\s*<body>.+function\s+\w{1,40}\(\)\s*\{\s*\w{1,40}\s*=\s*\w{1,40}\(\);\s*\w{1,40}\s*=\s*\[(?:\d+,){20,100}\d+\];\s*return\s*\w{1,40}\(\w{1,40},\w{1,40}\);\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1357"
    name: "PHP-REX-1357"
    description: "Malware detection signature PHP-REX-1357"
    severity: critical
    category: php_backdoor
    pattern: 'content="0;data:text/html;base64,DQo8IURPQ1RZUEUgaHRtbD48aHRtbCB4bWxucz'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1358"
    name: "PHP-REX-1358"
    description: "Malware detection signature PHP-REX-1358"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$GLOBALS\[''\w{1,40}''\]\s*=\s*sha1\(md5\("\w+"\)\);\s*//\s*sha1\(md5\(pass\)\)\s*\$func='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1360"
    name: "PHP-REX-1360"
    description: "Malware detection signature PHP-REX-1360"
    severity: critical
    category: php_backdoor
    pattern: '\$userful\s*=\s*array\(''gcc'',''lcc'',''cc'',''ld'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1362"
    name: "PHP-REX-1362"
    description: "Malware detection signature PHP-REX-1362"
    severity: critical
    category: php_backdoor
    pattern: ';\s*eval\(\s*""\s*\);\s*if\(\s*\(\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1363"
    name: "PHP-REX-1363"
    description: "Malware detection signature PHP-REX-1363"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(!\(!\$_COOKIE\["\\x[0-9A-Fa-f]+"\]\s*\|\| !\$_COOKIE\["\\x[0-9A-Fa-f]+"\]\)\)\s*\{\s*goto\s*\w{1,40};\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1364"
    name: "PHP-REX-1364"
    description: "Malware detection signature PHP-REX-1364"
    severity: critical
    category: php_backdoor
    pattern: 'else\s*if\("shell"\s*==\s*substr\(\$action\s*,\s*0\s*,\s*5\)\)\{\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1365"
    name: "PHP-REX-1365"
    description: "Malware detection signature PHP-REX-1365"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(base64_decode\(\$_REQUEST\[''\w{1,40}''\]\)\);\s*else\s*eval\(\$_REQUEST\[''\w{1,40}''\]\);\s*break;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1366"
    name: "PHP-REX-1366"
    description: "Malware detection signature PHP-REX-1366"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*javascript_in\(\$p,\$c\)\s*\{\s*\$result\s*=\s*shell_exec\(\$p\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1367"
    name: "PHP-REX-1367"
    description: "Malware detection signature PHP-REX-1367"
    severity: critical
    category: php_backdoor
    pattern: 'U7TiM4T3_H4x0R\s*Mini\s*Shell\s*</'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1368"
    name: "PHP-REX-1368"
    description: "Malware detection signature PHP-REX-1368"
    severity: critical
    category: php_backdoor
    pattern: 'function __\w{1,40}\(\$\w{1,40}\)\{\$\w{1,40}=[base64_decode.'']+;return\s*\$\w\(\$\w{1,40}\);\}\}\$\w+=[create_function.'']+;\$_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1369"
    name: "PHP-REX-1369"
    description: "Malware detection signature PHP-REX-1369"
    severity: critical
    category: php_backdoor
    pattern: 'flush\(\);\s*@mail\(\$_GET\[''\w+''\]\s*,\s*\$subject\s*,\s*\$message\s*,\s*\$header\);\s*sleep\(\$_GET\[''\w+''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1370"
    name: "PHP-REX-1370"
    description: "Malware detection signature PHP-REX-1370"
    severity: critical
    category: php_backdoor
    pattern: ';\$\{\$\{"[^"]{1,100}"\}\[[^\]]{1,100}\]\}=system_custom\(\$\{\$\w{1,40}\}\);echo\$\{\$\{"[^"]{1,100}"\}\["[^"]{1,100}"\]\};print'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1371"
    name: "PHP-REX-1371"
    description: "Malware detection signature PHP-REX-1371"
    severity: critical
    category: php_backdoor
    pattern: 'conf\s*=\s*@file_get_contents\(\s*\$isSecureProtocol\s*\.\s*\$this->normalizedTag\s*\.\s*\$configNormalize\s*\.\s*\$this->normalizeTagPattern'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1372"
    name: "PHP-REX-1372"
    description: "Malware detection signature PHP-REX-1372"
    severity: critical
    category: php_backdoor
    pattern: '<<YeMeNi\s*HaCkeR>>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1373"
    name: "PHP-REX-1373"
    description: "Malware detection signature PHP-REX-1373"
    severity: critical
    category: php_backdoor
    pattern: '@mkdir\("wp-admin"\);\s*\$path_shell\s*=\s*fopen'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1374"
    name: "PHP-REX-1374"
    description: "Malware detection signature PHP-REX-1374"
    severity: critical
    category: php_backdoor
    pattern: 'elseif\s*\(\s*has_passthru\s*\)\{\s*x_passthru'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1376"
    name: "PHP-REX-1376"
    description: "Malware detection signature PHP-REX-1376"
    severity: critical
    category: php_backdoor
    pattern: '\$message\s*\.=\s*"-+Vict!m Info-+\\n";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1377"
    name: "PHP-REX-1377"
    description: "Malware detection signature PHP-REX-1377"
    severity: critical
    category: php_backdoor
    pattern: '\A.{0,10}GIF8[79a]+<\?php\s*eval\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1378"
    name: "PHP-REX-1378"
    description: "Malware detection signature PHP-REX-1378"
    severity: critical
    category: php_backdoor
    pattern: 'color=.FFF5EE>"\.shell_exec\(''ls -la''\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1380"
    name: "PHP-REX-1380"
    description: "Malware detection signature PHP-REX-1380"
    severity: critical
    category: php_backdoor
    pattern: '\$msg\s*\.=\s*"P\s*:\s*"\s*\.\s*\$_POST\[''psw''\]\s*\.\s*"\\n";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1381"
    name: "PHP-REX-1381"
    description: "Malware detection signature PHP-REX-1381"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\s*echo\s*"AnonymousFox'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1382"
    name: "PHP-REX-1382"
    description: "Malware detection signature PHP-REX-1382"
    severity: critical
    category: php_backdoor
    pattern: '\$path_mailer\s*=\s*fopen\("wp-content/\$rxMailer\.php"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1383"
    name: "PHP-REX-1383"
    description: "Malware detection signature PHP-REX-1383"
    severity: critical
    category: php_backdoor
    pattern: 'id\s*=\s*system\s*\(\s*base64_decode\(\s*"cGlkb2YgY25yaWc='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1384"
    name: "PHP-REX-1384"
    description: "Malware detection signature PHP-REX-1384"
    severity: critical
    category: php_backdoor
    pattern: '<code>\s*Trying\s*\$ServerName\.\.\.<br>\s*Connected\s*to\s*\$ServerName'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1385"
    name: "PHP-REX-1385"
    description: "Malware detection signature PHP-REX-1385"
    severity: critical
    category: php_backdoor
    pattern: 'sendraw\(\$IRC_cur_socket\s*,\s*"PRIVMSG'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1386"
    name: "PHP-REX-1386"
    description: "Malware detection signature PHP-REX-1386"
    severity: critical
    category: php_backdoor
    pattern: '<title>KID\s*-\s*Dr\.JEeNTeL\s*SheLL'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1387"
    name: "PHP-REX-1387"
    description: "Malware detection signature PHP-REX-1387"
    severity: critical
    category: php_backdoor
    pattern: '@ob_end_clean\(\);\s*\}\s*elseif\(@is_resource\(\$f\s*=\s*@popen\(\$cfe\s*,\s*"r"\s*\)\)\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1388"
    name: "PHP-REX-1388"
    description: "Malware detection signature PHP-REX-1388"
    severity: critical
    category: php_backdoor
    pattern: '\{private static\$_[^;]{1,30};static function _[^(]{1,30}\(\$[^)]{1,30}\)\{if\(!self::\$_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1390"
    name: "PHP-REX-1390"
    description: "Malware detection signature PHP-REX-1390"
    severity: critical
    category: php_backdoor
    pattern: ';exit;endif;endif;@iNI_sET\("error_log",null\);@iNi_SEt\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1392"
    name: "PHP-REX-1392"
    description: "Malware detection signature PHP-REX-1392"
    severity: critical
    category: php_backdoor
    pattern: 'if\(strpos\(''\w{1,40}'',''\w{1,40}''\)!==false\)mssql_query\(\$_\d+,\$_\d+\);\s*curl_setopt\(\$_\d+,\d+,\$_\d+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1393"
    name: "PHP-REX-1393"
    description: "Malware detection signature PHP-REX-1393"
    severity: critical
    category: php_backdoor
    pattern: '\)\s*&&\s*mktime\(\$_\d+,\$_\d+,\$_\d+,\$_\d+\)\)socket_create_pair\(\$_SERVER,\$_\d+\);\s*function l_\w{1,40}\(\$_\d+,\$_\d+='''',\$_\d+=true\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1394"
    name: "PHP-REX-1394"
    description: "Malware detection signature PHP-REX-1394"
    severity: critical
    category: php_backdoor
    pattern: 'if\(strpos\(''\w{1,60}'',''\w{1,60}''\)!==false\)imagefilter\(\$_\d,\$_\d,\$_SERVER\);\s*\$_\d=curl_getinfo\(\$_\d,\d+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1395"
    name: "PHP-REX-1395"
    description: "Malware detection signature PHP-REX-1395"
    severity: critical
    category: php_backdoor
    pattern: '\$_\d=\$_(?:REQUEST|GET|POST)\[''id''\];\s*\$_\d=curl_init\(\);\s*\$_\d=''http'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1396"
    name: "PHP-REX-1396"
    description: "Malware detection signature PHP-REX-1396"
    severity: critical
    category: php_backdoor
    pattern: 'time\(\)-@filemtime\(\$_\d\)\)>0\)\{\$_\d=base64_decode\(@file_get_contents\(''http'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1397"
    name: "PHP-REX-1397"
    description: "Malware detection signature PHP-REX-1397"
    severity: critical
    category: php_backdoor
    pattern: 'if\(strpos\(''\w+'',''\w+''\)!==false\)socket_create_listen\(\$_\d,\$_\d,\$_\d,\$_\d\);\s*\$_\d="text/html;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1398"
    name: "PHP-REX-1398"
    description: "Malware detection signature PHP-REX-1398"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_POST\s*\[\s*''comment''\s*\]\s*\)\s*\)\s*\{\s*if\s*\(\s*md5\s*\(\s*\$_POST\s*\[\s*''comment''\s*\]\s*\)\s*==\s*"[^"]*"\s*\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1399"
    name: "PHP-REX-1399"
    description: "Malware detection signature PHP-REX-1399"
    severity: critical
    category: php_backdoor
    pattern: '@eval\(\s*\$unzip\(\s*\$_SESSION\[\s*''PhpCode''\s*\]\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1401"
    name: "PHP-REX-1401"
    description: "Malware detection signature PHP-REX-1401"
    severity: critical
    category: php_backdoor
    pattern: 'url\s*=\s*https://bank\.westpac\.co\.nz/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1403"
    name: "PHP-REX-1403"
    description: "Malware detection signature PHP-REX-1403"
    severity: critical
    category: php_backdoor
    pattern: ',\s*function\s*\(\s*\)\s*{\s*add_object_page\s*\(\s*"UBH"\s*,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1404"
    name: "PHP-REX-1404"
    description: "Malware detection signature PHP-REX-1404"
    severity: critical
    category: php_backdoor
    pattern: '<%\s*eval\s*request\([^)]{1,30}\)\s*%>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1405"
    name: "PHP-REX-1405"
    description: "Malware detection signature PHP-REX-1405"
    severity: critical
    category: php_backdoor
    pattern: '<H1>\s*<center>\s*mini\s*File\s*Manager'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1406"
    name: "PHP-REX-1406"
    description: "Malware detection signature PHP-REX-1406"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$act\s*==\s*''down''\)\s*\{\s*if\s*\(is_file\(\$p1\)\s*&&\s*is_readable\(\$p1\)\)\s*\{\s*@ob_end_clean'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1407"
    name: "PHP-REX-1407"
    description: "Malware detection signature PHP-REX-1407"
    severity: critical
    category: php_backdoor
    pattern: 'Community\s*priv8\s*WebShell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1408"
    name: "PHP-REX-1408"
    description: "Malware detection signature PHP-REX-1408"
    severity: critical
    category: php_backdoor
    pattern: 'copy\(\s*\$_REQUEST\[''path''\]\s*,\s*\$p\s*\.''/''\s*\.\s*time\(\)\s*\.\s*''\.''\s*\.\s*\$f\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1409"
    name: "PHP-REX-1409"
    description: "Malware detection signature PHP-REX-1409"
    severity: critical
    category: php_backdoor
    pattern: ';if\(\$_POST\[''\w{1,40}''\]=="Upload"\){if\(@copy\(\$_FILES\[''file''\]\[''tmp_name''\],\$_FILES\[''file''\]\[''name''\]\)\)\{echo'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1410"
    name: "PHP-REX-1410"
    description: "Malware detection signature PHP-REX-1410"
    severity: critical
    category: php_backdoor
    pattern: '_BLANK\s*>\{\$_FILES\["userfile"\]\["name"\]\}</a><br><br>"\s*;\s*echo\s*getcwd\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1411"
    name: "PHP-REX-1411"
    description: "Malware detection signature PHP-REX-1411"
    severity: critical
    category: php_backdoor
    pattern: 'ioctl\s*\(\s*\$listen_socket\s*,\s*0x8004667e'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1412"
    name: "PHP-REX-1412"
    description: "Malware detection signature PHP-REX-1412"
    severity: critical
    category: php_backdoor
    pattern: '\$file_content\s*=\s*httpget3\(REMOTE_FILE\s*,\s*\$context\);\s*\$file_name_array\s*=\s*explode'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1413"
    name: "PHP-REX-1413"
    description: "Malware detection signature PHP-REX-1413"
    severity: critical
    category: php_backdoor
    pattern: 'basename\(\$file\)\s*==\s*"configuration\.php"\s*\|\|\s*basename\(\$file\)\s*==\s*"wp-config\.php"\s*\)\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1414"
    name: "PHP-REX-1414"
    description: "Malware detection signature PHP-REX-1414"
    severity: critical
    category: php_backdoor
    pattern: '<title>PEREBA_r0x'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1416"
    name: "PHP-REX-1416"
    description: "Malware detection signature PHP-REX-1416"
    severity: critical
    category: php_backdoor
    pattern: 'description"\s+content="Hacked\s+By'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1417"
    name: "PHP-REX-1417"
    description: "Malware detection signature PHP-REX-1417"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*eval\(''\?>''\s*\.\s*join\(\s*""\s*,\s*file\(\s*"\$c/\$p\.html'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1418"
    name: "PHP-REX-1418"
    description: "Malware detection signature PHP-REX-1418"
    severity: critical
    category: php_backdoor
    pattern: '@pcntl_exec\s*\(\s*"/bin/sh"\s*,\s*Array\("-c",\$arg\)\);\s*\}\s*else\s*\{@pcntl_waitpid\(\$p,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1419"
    name: "PHP-REX-1419"
    description: "Malware detection signature PHP-REX-1419"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(gzinflate\(str_rot13\(base64_decode\(\$backdoor'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1420"
    name: "PHP-REX-1420"
    description: "Malware detection signature PHP-REX-1420"
    severity: critical
    category: php_backdoor
    pattern: '<title>-\$\$Ar\s*ab_money\$\$-</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1421"
    name: "PHP-REX-1421"
    description: "Malware detection signature PHP-REX-1421"
    severity: critical
    category: php_backdoor
    pattern: '<title>Leaf\s+PHPMailer</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1422"
    name: "PHP-REX-1422"
    description: "Malware detection signature PHP-REX-1422"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\s*=\s*\$_SERVER\[''REMOTE_ADDR''\];\s*\}\s*\$referrer = urlencode\(@\$_SERVER\[''HTTP_REFERER''\]\);\s*\$url = "http://\d+\.\d+\.\d+\.\d+/api\.php\?is_api=1&action=get&api_key'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1423"
    name: "PHP-REX-1423"
    description: "Malware detection signature PHP-REX-1423"
    severity: critical
    category: php_backdoor
    pattern: 'curl_init\("file:///"\.\$m\."\\x00/\.\.'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1424"
    name: "PHP-REX-1424"
    description: "Malware detection signature PHP-REX-1424"
    severity: critical
    category: php_backdoor
    pattern: '<title>Tryag\s+File\s+Manager</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1426"
    name: "PHP-REX-1426"
    description: "Malware detection signature PHP-REX-1426"
    severity: critical
    category: php_backdoor
    pattern: '>\s*<title>Hacked\s+by\s*[^<]+</title>\s*<style'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1428"
    name: "PHP-REX-1428"
    description: "Malware detection signature PHP-REX-1428"
    severity: critical
    category: php_backdoor
    pattern: ';\$_\s*=\s*create_function\(\s*""\s*,\s*@gzuncompress\(\$_+\)\);\$_+\(\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1429"
    name: "PHP-REX-1429"
    description: "Malware detection signature PHP-REX-1429"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*''None''\s*\.\s*''<br>''\s*\.\s*''Uname:''\s*\.\s*php_uname'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1430"
    name: "PHP-REX-1430"
    description: "Malware detection signature PHP-REX-1430"
    severity: critical
    category: php_backdoor
    pattern: ';\$_\w{1,40}=.\$_\w{1,40}\("[^"]+",''\w{1,40}''\);@\$_\w{1,40}\("[^"]+",.\$_\w{1,40}\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1431"
    name: "PHP-REX-1431"
    description: "Malware detection signature PHP-REX-1431"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+"<h1><a href=''\$fullpath''>OK-Click here!</a>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1432"
    name: "PHP-REX-1432"
    description: "Malware detection signature PHP-REX-1432"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite\(\$f,file_get_contents\(\$s\.''s-''\.\$_GET'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1433"
    name: "PHP-REX-1433"
    description: "Malware detection signature PHP-REX-1433"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*eval\(base64_decode\((str_replace\(\s*''.''\s*,\s*''.''\s*,\s*){3,6}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1435"
    name: "PHP-REX-1435"
    description: "Malware detection signature PHP-REX-1435"
    severity: critical
    category: php_backdoor
    pattern: '\$_+\s*=\s*"[^;]+;\s*eval\(\$_+\(\$_+\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1436"
    name: "PHP-REX-1436"
    description: "Malware detection signature PHP-REX-1436"
    severity: critical
    category: php_backdoor
    pattern: '\A<!DOCTYPE[^>]{0,100}>\s*<html>\s*<head>\s*<title>Hacked\s+By'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1437"
    name: "PHP-REX-1437"
    description: "Malware detection signature PHP-REX-1437"
    severity: critical
    category: php_backdoor
    pattern: '\$passwd\s*=\s*fopen\(\s*''/etc/passwd''\s*,\s*''r''\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1438"
    name: "PHP-REX-1438"
    description: "Malware detection signature PHP-REX-1438"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,30}\s*=\s*file\(''/etc/passwd''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1439"
    name: "PHP-REX-1439"
    description: "Malware detection signature PHP-REX-1439"
    severity: critical
    category: php_backdoor
    pattern: '\$pwdump2\s*=\s*"TVqQAAMAAAAEAAAA'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1440"
    name: "PHP-REX-1440"
    description: "Malware detection signature PHP-REX-1440"
    severity: critical
    category: php_backdoor
    pattern: 'URI\.encode\("/user/register\?element_parents=account/mail/\#valu'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1441"
    name: "PHP-REX-1441"
    description: "Malware detection signature PHP-REX-1441"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*\$USER\s*->\s*Update\s*\(\s*\d+,\s*array\(\s*"PASSWORD"\s*=>\s*''[^'']+''\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1442"
    name: "PHP-REX-1442"
    description: "Malware detection signature PHP-REX-1442"
    severity: critical
    category: php_backdoor
    pattern: '\$content\s*=\s*remove_tags\s*\(\s*_dl\s*\(\$_(COOKIE|GET|POST|REQUEST)\[''key''\]\)\)\s*;\s*\$func\s*=\s*"[create_function"\.\s*]+";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1443"
    name: "PHP-REX-1443"
    description: "Malware detection signature PHP-REX-1443"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*''<title>Upload\s*Files\s*xSecurity'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1444"
    name: "PHP-REX-1444"
    description: "Malware detection signature PHP-REX-1444"
    severity: critical
    category: php_backdoor
    pattern: '<b>Upload\s*Complate\s*!!!'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1445"
    name: "PHP-REX-1445"
    description: "Malware detection signature PHP-REX-1445"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(0\);\s*echo\s*file_get_contents\(\$_GET\[''filename''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1447"
    name: "PHP-REX-1447"
    description: "Malware detection signature PHP-REX-1447"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*="[^"]*"\s*;\s*if\s*\(\s*\$\w{1,40}\s*=''[^'']*''\|''[^'']*''\s*\)\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\|''[^'']*''\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1449"
    name: "PHP-REX-1449"
    description: "Malware detection signature PHP-REX-1449"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\s*\$sd\s*\)\s*\{\s*echo\s*1;\s*exit\(\);\s*\}\s*else\s*\{\s*echo\s*2;\s*exit\(\);\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1450"
    name: "PHP-REX-1450"
    description: "Malware detection signature PHP-REX-1450"
    severity: critical
    category: php_backdoor
    pattern: 'copy\(\$link,\$path\.\$name\);\s*if\(shell_exec\(''echo\s*index''\)\s*==\s*''index''\s*\)\s*\{\s*shell_exec\(\s*''touch'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1451"
    name: "PHP-REX-1451"
    description: "Malware detection signature PHP-REX-1451"
    severity: critical
    category: php_backdoor
    pattern: 'false\)\s*\{\s*if\(is_mobile2\(\)\)\s*exit\(''<script[^<]{1,500}</script>''\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1452"
    name: "PHP-REX-1452"
    description: "Malware detection signature PHP-REX-1452"
    severity: critical
    category: php_backdoor
    pattern: '\$USER\s*-\s*>Authorize\s*\(\s*\$\w{1,40}\[\s*"ID"\s*\]\s*\);\s*LocalRedirect\s*\("/bitrix/[^"]{1,40}"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1453"
    name: "PHP-REX-1453"
    description: "Malware detection signature PHP-REX-1453"
    severity: critical
    category: php_backdoor
    pattern: '\$shell_name\s*=\s*"devilzShell";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1454"
    name: "PHP-REX-1454"
    description: "Malware detection signature PHP-REX-1454"
    severity: critical
    category: php_backdoor
    pattern: '\$ID\s*=\s*\$USER->Add\(\s*\$\w{1,40}\s*\);\s*if\s*\(\s*intval\(\s*\$ID\s*\)\s*>\s*0\)\s*echo\s*"Yes";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1455"
    name: "PHP-REX-1455"
    description: "Malware detection signature PHP-REX-1455"
    severity: critical
    category: php_backdoor
    pattern: '}\s*}\s*eval\s*\(\s*gzuncompress\(\s*_\w{1,40}::\w{1,40}\(''[^'']{1,100}''\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1456"
    name: "PHP-REX-1456"
    description: "Malware detection signature PHP-REX-1456"
    severity: critical
    category: php_backdoor
    pattern: '=''\);return\s*base64_decode\(\$a\[\$i\]\);\s*}\s*\?>Wordpress\s*<\?php\s*\$_0'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1457"
    name: "PHP-REX-1457"
    description: "Malware detection signature PHP-REX-1457"
    severity: critical
    category: php_backdoor
    pattern: '\}\s*list\(\$\w{1,40},\$\w{1,40}\)=\w{1,40}::\w{1,40}\("\\r\\n\\r\\n",\$\w{1,40},\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1458"
    name: "PHP-REX-1458"
    description: "Malware detection signature PHP-REX-1458"
    severity: critical
    category: php_backdoor
    pattern: '\$text\d+\s*=\s*http_get\(''https://ghostbin\.com/paste/\w+/raw'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1459"
    name: "PHP-REX-1459"
    description: "Malware detection signature PHP-REX-1459"
    severity: critical
    category: php_backdoor
    pattern: '<title>Mass\s*Defacer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1460"
    name: "PHP-REX-1460"
    description: "Malware detection signature PHP-REX-1460"
    severity: critical
    category: php_backdoor
    pattern: '\A<\?php\s*\$user_agent_to_filter\s*=\s*array\(\s*"\#Ask\\s\*Jeeves\#i"\s*,\s*"\#'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1461"
    name: "PHP-REX-1461"
    description: "Malware detection signature PHP-REX-1461"
    severity: critical
    category: php_backdoor
    pattern: '\$extention\s*==\s*''js''\s*\)\s*\)\s*\{\s*\$content\s*=\s*@file_get_contents\(\$dirname\s*\.\s*\$sobs'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1462"
    name: "PHP-REX-1462"
    description: "Malware detection signature PHP-REX-1462"
    severity: critical
    category: php_backdoor
    pattern: 'pl\(\$s_cwd\)\."&x=upload"\."''>upl'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1463"
    name: "PHP-REX-1463"
    description: "Malware detection signature PHP-REX-1463"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*\("<<OK>>"\s*\.\s*join\s*\("\\n"\s*,\s*\$injected\s*\)\s*\.\s*"<</OK>>"\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1464"
    name: "PHP-REX-1464"
    description: "Malware detection signature PHP-REX-1464"
    severity: critical
    category: php_backdoor
    pattern: 'return\s*@file_get_contents\(\w{1,40}\s*::\s*\$\w{1,40}\s*\.\s*\$\w{1,40}\s*\[array_rand\(\$\w{1,40}\)\]\);\s*\}\s*static'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1465"
    name: "PHP-REX-1465"
    description: "Malware detection signature PHP-REX-1465"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*file_get_contents\(\$our_site\.\$page\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1466"
    name: "PHP-REX-1466"
    description: "Malware detection signature PHP-REX-1466"
    severity: critical
    category: php_backdoor
    pattern: '\$html\s*=\s*curl_exec\s*\(\$ch\);\s*curl_close\(\$ch\);\s*if\s*\(strstr\(\$id\s*,\s*"\.css"\s*\)\s*\)\{\s*header\(''Content'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1467"
    name: "PHP-REX-1467"
    description: "Malware detection signature PHP-REX-1467"
    severity: critical
    category: php_backdoor
    pattern: 'empty\(\s*\$_COOKIE\["client_check"\]\s*\)\s*\)\s*die\(\s*\$_COOKIE\["client_check"\]\s*\)\s*;\s*if\s*\(\s*preg_match\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1468"
    name: "PHP-REX-1468"
    description: "Malware detection signature PHP-REX-1468"
    severity: critical
    category: php_backdoor
    pattern: '";@file_put_contents\("\$GLOBALS\[web_root\]temp/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1469"
    name: "PHP-REX-1469"
    description: "Malware detection signature PHP-REX-1469"
    severity: critical
    category: php_backdoor
    pattern: ';\s*function\s*\w{1,40}\(\$\w{1,40}\)\s*\{\s*return\s*\(substr\(\$\w{1,40}\s*,\s*\d+\s*,\s*\d+\s*\)\s*==\s*\w{1,40}\(array\([^)]{1,100}\)\s*\)\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1470"
    name: "PHP-REX-1470"
    description: "Malware detection signature PHP-REX-1470"
    severity: critical
    category: php_backdoor
    pattern: 'include\s*''antibots\.php'';\s*\$mail\s*=\s*\$_SESSION\[''mail''\]\s*=\s*\$_POST\[''mail''\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1471"
    name: "PHP-REX-1471"
    description: "Malware detection signature PHP-REX-1471"
    severity: critical
    category: php_backdoor
    pattern: 'Try\s+a\s+different\s+payment\s+method\s+this\s+time\s+\-\s+PayPal</title>\s*<meta'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1472"
    name: "PHP-REX-1472"
    description: "Malware detection signature PHP-REX-1472"
    severity: critical
    category: php_backdoor
    pattern: '</form>";\s*move_uploaded_file\(\$saw1,\$saw2\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1473"
    name: "PHP-REX-1473"
    description: "Malware detection signature PHP-REX-1473"
    severity: critical
    category: php_backdoor
    pattern: '<h2>Verified\s+Your\s+Personal\s+Bank/Add Bank</h2>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1476"
    name: "PHP-REX-1476"
    description: "Malware detection signature PHP-REX-1476"
    severity: critical
    category: php_backdoor
    pattern: 'server\s+d3ifff'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1477"
    name: "PHP-REX-1477"
    description: "Malware detection signature PHP-REX-1477"
    severity: critical
    category: php_backdoor
    pattern: '\$subject\s*=\s*"PayPal\s+Billing\s+Info'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1478"
    name: "PHP-REX-1478"
    description: "Malware detection signature PHP-REX-1478"
    severity: critical
    category: php_backdoor
    pattern: '\$subject\s*=\s*"PayPal\s+Bank\s+Info'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1479"
    name: "PHP-REX-1479"
    description: "Malware detection signature PHP-REX-1479"
    severity: critical
    category: php_backdoor
    pattern: '\$subject\s*=\s*"PayPal\s+PP\s+LOGIN\s+FROM'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1480"
    name: "PHP-REX-1480"
    description: "Malware detection signature PHP-REX-1480"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(!Anon_true\(\s*\$em\s*,\s*\$ps\s*,\s*\$_SERVER\[\s*''HTTP_USER_AGENT''\s*\]\s*\)\s*\)\s*{\s*die\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1481"
    name: "PHP-REX-1481"
    description: "Malware detection signature PHP-REX-1481"
    severity: critical
    category: php_backdoor
    pattern: '\$subject\s*=\s*"AOL\s*Login\s*\|\s*\$ip'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1482"
    name: "PHP-REX-1482"
    description: "Malware detection signature PHP-REX-1482"
    severity: critical
    category: php_backdoor
    pattern: '\$ssn\s*=\s*\$_SESSION\[''ssn''\]\s*=\s*\$_POST\[''ssn''\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1483"
    name: "PHP-REX-1483"
    description: "Malware detection signature PHP-REX-1483"
    severity: critical
    category: php_backdoor
    pattern: '==\[BY\s+P!RA17DZ\]=='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1484"
    name: "PHP-REX-1484"
    description: "Malware detection signature PHP-REX-1484"
    severity: critical
    category: php_backdoor
    pattern: '/\#s"\s*,\s*\$\w{1,40}\(\s*""\s*,\s*\$\w{1,40}\(__FILE__\s*\)\s*\)\s*,\s*\$match\s*\)\s*\?\s*\(\s*\$match\[\s*\d+\s*\]\s*\)\s*:\s*""\s*\)\s*\.\s*"//"\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1485"
    name: "PHP-REX-1485"
    description: "Malware detection signature PHP-REX-1485"
    severity: critical
    category: php_backdoor
    pattern: ';@\$__\(\$__\d+\(@\$_\[\d+\]\.@\$_\[\d+\]\.'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1486"
    name: "PHP-REX-1486"
    description: "Malware detection signature PHP-REX-1486"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite\(\$\w{1,40}\s*,\s*file_get_contents\(\$\w{1,40}\.''\w-''\.\$_GET\[''\w{1,40}''\]\)\);\s*fclose\(\$\w{1,40}\);\s*}\s*echo\s*''<!DOCTYPE html!>'';\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1487"
    name: "PHP-REX-1487"
    description: "Malware detection signature PHP-REX-1487"
    severity: critical
    category: php_backdoor
    pattern: '\$SandyKey=\$_POST\[''SandyKey''\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1488"
    name: "PHP-REX-1488"
    description: "Malware detection signature PHP-REX-1488"
    severity: critical
    category: php_backdoor
    pattern: '@mail\(\s*\$_POST\[''emailfinal''\]\s*,\s*\$_SERVER\[''HTTP_HOST'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1489"
    name: "PHP-REX-1489"
    description: "Malware detection signature PHP-REX-1489"
    severity: critical
    category: php_backdoor
    pattern: 'DRIV3R\s+KR\s+PRIV8\s+MAILER</title'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1490"
    name: "PHP-REX-1490"
    description: "Malware detection signature PHP-REX-1490"
    severity: critical
    category: php_backdoor
    pattern: '\$double\s*=\s*1;\s*}\s*\$email\s*=\s*urlencode\(\$email\);\s*if\s*\(!empty\(\$_SERVER\["HTTP_CF_CONNECTING_IP'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1491"
    name: "PHP-REX-1491"
    description: "Malware detection signature PHP-REX-1491"
    severity: critical
    category: php_backdoor
    pattern: '\$domains_dir\s*=\s*estimate_current_path\(\s*\);\s*process\s*\(\s*\$domain\s*,\s*\$domains_dir\s*\);\s*foreach\s*\(get_valid_dirs'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1492"
    name: "PHP-REX-1492"
    description: "Malware detection signature PHP-REX-1492"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*http_get\s*\(''https://pastebin\.com/raw'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1493"
    name: "PHP-REX-1493"
    description: "Malware detection signature PHP-REX-1493"
    severity: critical
    category: php_backdoor
    pattern: 'Dr\.\s*Nova\s+Login\s+To\s+Shell</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1494"
    name: "PHP-REX-1494"
    description: "Malware detection signature PHP-REX-1494"
    severity: critical
    category: php_backdoor
    pattern: 'Coded\s*by\s*:\s*</font><font\s*color="red">\s*TrenggalekTeam'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1495"
    name: "PHP-REX-1495"
    description: "Malware detection signature PHP-REX-1495"
    severity: critical
    category: php_backdoor
    pattern: 'ACCOUNT\s+PAYPAL\s+FULLZ</font'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1496"
    name: "PHP-REX-1496"
    description: "Malware detection signature PHP-REX-1496"
    severity: critical
    category: php_backdoor
    pattern: '\$asu="move_";\s*\$asu\.="uploaded_";\s*\$asu\.="file";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1497"
    name: "PHP-REX-1497"
    description: "Malware detection signature PHP-REX-1497"
    severity: critical
    category: php_backdoor
    pattern: 'private\s*\$\w{1,40}\s*=\s*''[^'']{10,200}''\s*;\s*private\s*\$\w{1,40}\s*=\s*''application/msword''\s*;\s*public\s*function\s*execute\s*\(\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1498"
    name: "PHP-REX-1498"
    description: "Malware detection signature PHP-REX-1498"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\$_GET\s*\[\s*''ch''\s*\]\s*\)\s*{\s*echo\s*"OK"\s*;\s*exit\s*\(\s*\)\s*;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1500"
    name: "PHP-REX-1500"
    description: "Malware detection signature PHP-REX-1500"
    severity: critical
    category: php_backdoor
    pattern: '<title>Propaganda\s+Mail!\s+v\d+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1501"
    name: "PHP-REX-1501"
    description: "Malware detection signature PHP-REX-1501"
    severity: critical
    category: php_backdoor
    pattern: 'href="https://www\.bancosantander\.es'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1502"
    name: "PHP-REX-1502"
    description: "Malware detection signature PHP-REX-1502"
    severity: critical
    category: php_backdoor
    pattern: 'chdir\(\$lastdir\);\s*capriv8exit\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1503"
    name: "PHP-REX-1503"
    description: "Malware detection signature PHP-REX-1503"
    severity: critical
    category: php_backdoor
    pattern: '^\w{1,40}\s*<\?php\s*echo\s*php_uname\(\);\s*if\s*\(isset\(\$_POST\[''\w+''\]\)\)\s*{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1504"
    name: "PHP-REX-1504"
    description: "Malware detection signature PHP-REX-1504"
    severity: critical
    category: php_backdoor
    pattern: '\$License\s*=\s*\$_POST\s*\[\s*''[^'']*''\s*\]\s*\(\s*''''\s*,\s*\$_POST.+?;\s*\$License\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1505"
    name: "PHP-REX-1505"
    description: "Malware detection signature PHP-REX-1505"
    severity: critical
    category: php_backdoor
    pattern: '\$message\s*\.=\s*"cvv\s*:\s*"\s*\.\s*\$_POST\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1506"
    name: "PHP-REX-1506"
    description: "Malware detection signature PHP-REX-1506"
    severity: critical
    category: php_backdoor
    pattern: 'substr\(\$__lp,\s*0x\w+-0x\w+\)\)\);break;\}\}\}eval\(\$__ln\);return 0;\}\s*else\s*\{die\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1507"
    name: "PHP-REX-1507"
    description: "Malware detection signature PHP-REX-1507"
    severity: critical
    category: php_backdoor
    pattern: '\$log_file_name\s*=\s*GetDocRoot\(\)\s*\.\s*"/\s*"\s*\.\s*"\w+\.log"\s*;\s*if\s*\(\s*isset\(\s*\$_POST\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1510"
    name: "PHP-REX-1510"
    description: "Malware detection signature PHP-REX-1510"
    severity: critical
    category: php_backdoor
    pattern: 'Coded\s+By\s+<font color="red">Little\s+Wei'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1511"
    name: "PHP-REX-1511"
    description: "Malware detection signature PHP-REX-1511"
    severity: critical
    category: php_backdoor
    pattern: '\$JSubMenuHelper\s*=\s*create_function\('''',\s*\$JSubMenu\);\s*unset\(\$\w+,\s*\$JSubMenu\);\s*\$JSubMenuHelper\(\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1512"
    name: "PHP-REX-1512"
    description: "Malware detection signature PHP-REX-1512"
    severity: critical
    category: php_backdoor
    pattern: '<h2>Developer\s+By\s+KymLjnk</h2>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1513"
    name: "PHP-REX-1513"
    description: "Malware detection signature PHP-REX-1513"
    severity: critical
    category: php_backdoor
    pattern: 'chdir\(''bypassbin''\);\s*@exec\(''curl http://dl\.dropbox\.com'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1514"
    name: "PHP-REX-1514"
    description: "Malware detection signature PHP-REX-1514"
    severity: critical
    category: php_backdoor
    pattern: 'yetkiKontrol\(\$\w{1,40},\$\w{1,40}\);\s*\}\s*\?>\s*<\?php\s*preg_replace\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1515"
    name: "PHP-REX-1515"
    description: "Malware detection signature PHP-REX-1515"
    severity: critical
    category: php_backdoor
    pattern: '\]\}="";class\s+BaseJsonRpcServer\{const\s+ParseError'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1516"
    name: "PHP-REX-1516"
    description: "Malware detection signature PHP-REX-1516"
    severity: critical
    category: php_backdoor
    pattern: 'javascript:Goto\(''shell''\);>shell</a>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1517"
    name: "PHP-REX-1517"
    description: "Malware detection signature PHP-REX-1517"
    severity: critical
    category: php_backdoor
    pattern: '\)\)\)\)\s*{\s*echo\s*''query''\s*;\s*}\s*else\s*{echo\s*''bad request''\s*;\s*}\s*}\s*else\s*{echo\s*''not found'';\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1518"
    name: "PHP-REX-1518"
    description: "Malware detection signature PHP-REX-1518"
    severity: critical
    category: php_backdoor
    pattern: 'if\(strpos\(\s*\$\w{1,40}\s*,\s*''@''\)\s*!==\s*false\)\s*{\s*\$\w{1,40}\s*=\s*CUser::GetByLogin\(\$\w{1,40}\);\s*\$\w{1,40}\s*=\s*\$\w{1,40}->Fetch\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1519"
    name: "PHP-REX-1519"
    description: "Malware detection signature PHP-REX-1519"
    severity: critical
    category: php_backdoor
    pattern: 'define\("USER_AGENT", "Mining Cacher'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1520"
    name: "PHP-REX-1520"
    description: "Malware detection signature PHP-REX-1520"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,40}\s*="[^"]*"\s*;(?:\s*\$\w{1,40}\s*=\s*str_replace\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\)\s*;){2,}\s*){3,}\$__\w+\('''',"};"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1521"
    name: "PHP-REX-1521"
    description: "Malware detection signature PHP-REX-1521"
    severity: critical
    category: php_backdoor
    pattern: '<h2>Developer\s+By\s+KymLjnk</h2>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1522"
    name: "PHP-REX-1522"
    description: "Malware detection signature PHP-REX-1522"
    severity: critical
    category: php_backdoor
    pattern: '@mkdir\("ByPassSym"\);\s*@chdir\("ByPassSym"\);\s*@exec'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1523"
    name: "PHP-REX-1523"
    description: "Malware detection signature PHP-REX-1523"
    severity: critical
    category: php_backdoor
    pattern: '\}=new WebConsoleRPCServer\(\);\$rpc_server->Execute\(\);\}else\s*if\(!\$\{\$\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1524"
    name: "PHP-REX-1524"
    description: "Malware detection signature PHP-REX-1524"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*\[\s*D912\s*Browser\s*\]\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1525"
    name: "PHP-REX-1525"
    description: "Malware detection signature PHP-REX-1525"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*explode\s*\(\s*''\|''\s*,\s*\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*mail\s*\(\s*stripslashes\s*\(\s*base64_decode\s*\(\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*\)\s*\)\s*,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1526"
    name: "PHP-REX-1526"
    description: "Malware detection signature PHP-REX-1526"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$archive_path\s*=\s*''\./id\.zip'';\s*\$extract_path\s*=\s*''\./'';'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1527"
    name: "PHP-REX-1527"
    description: "Malware detection signature PHP-REX-1527"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(\s*''error_reporting\(E_ERROR\);\$out'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1528"
    name: "PHP-REX-1528"
    description: "Malware detection signature PHP-REX-1528"
    severity: critical
    category: php_backdoor
    pattern: '\(\s*\$_\d+,\d+\s*,\s*array\s*\("IP:\s*{\$_SERVER\[_\d+\(\d+\)\s*]\s*}"\s*\)\s*\)\s*;\s*\$GLOBALS'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1530"
    name: "PHP-REX-1530"
    description: "Malware detection signature PHP-REX-1530"
    severity: critical
    category: php_backdoor
    pattern: ']\}\)==\d+\s*\)\s*echo\s*@serialize\(\$\{\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1532"
    name: "PHP-REX-1532"
    description: "Malware detection signature PHP-REX-1532"
    severity: critical
    category: php_backdoor
    pattern: '\$run_ioncubetesterplus\s*=\s*create_function'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1533"
    name: "PHP-REX-1533"
    description: "Malware detection signature PHP-REX-1533"
    severity: critical
    category: php_backdoor
    pattern: '@set_time_limit\(0\);array_walk\(\$_COOKIE,"[^"]{1,100}"\);array_walk\(\$_POST,"[^"]{1,100}"\);function\s*enumerator'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1534"
    name: "PHP-REX-1534"
    description: "Malware detection signature PHP-REX-1534"
    severity: critical
    category: php_backdoor
    pattern: '\#!/bin/bash\s*while\s*true\s*;\s*do\s*\{\s*if\s*\[\s*"\$\(pidof \w{1,100}\)"\s*\]\s*then\s*sleep\s*60\s*else\s*\.\s*/kswd\s*&\s*fi\s*\}\s*done'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1535"
    name: "PHP-REX-1535"
    description: "Malware detection signature PHP-REX-1535"
    severity: critical
    category: php_backdoor
    pattern: 'return\s*true;\s*\?><\?php\s*function\s*\w{1,40}\(\$\w{1,40}\){\$\w{1,40}="";if\(isset\(\$_GET\["v1"\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1536"
    name: "PHP-REX-1536"
    description: "Malware detection signature PHP-REX-1536"
    severity: critical
    category: php_backdoor
    pattern: 'ignore_user_abort\(true\);\s*set_time_limit\(0\);\s*@ini_set\(''error_log'',NULL\);\s*@ini_set\(''log_errors'',0\);\s*class\s*MCurl'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1537"
    name: "PHP-REX-1537"
    description: "Malware detection signature PHP-REX-1537"
    severity: critical
    category: php_backdoor
    pattern: '\$finish_result\s*=\s*array_unique\(\$finish_result\);\s*foreach\s*\(\$finish_result'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1538"
    name: "PHP-REX-1538"
    description: "Malware detection signature PHP-REX-1538"
    severity: critical
    category: php_backdoor
    pattern: 'arr_php_file\s*=\s*findshells\s*\(\s*\$_SERVER'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1539"
    name: "PHP-REX-1539"
    description: "Malware detection signature PHP-REX-1539"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(str_rot13\(gzinflate\(str_rot13\(base64_decode\(\(\$astra'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1540"
    name: "PHP-REX-1540"
    description: "Malware detection signature PHP-REX-1540"
    severity: critical
    category: php_backdoor
    pattern: '\(\s*\$google_n=0;\s*\$google_n<\d+;\s*\$google_n=\$google_n\+\d+\)\s*{\s*\$ch\s*=\s*curl_init\(\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1541"
    name: "PHP-REX-1541"
    description: "Malware detection signature PHP-REX-1541"
    severity: critical
    category: php_backdoor
    pattern: '}\s*echo\s*\w{1,40}\s*\(\s*"[^"]{1,80}"\s*\)\s*;\s*sleep\s*\(\s*\d+\s*\)\s*;\s*\$\w{1,40}\s*=\s*str_ireplace\s*\(\s*"[^"]+"\s*,\s*""\s*,\s*"[^"]*"\s*\)\s*;\s*unlink\s*\(\s*str_replace\s*\(\s*""'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1542"
    name: "PHP-REX-1542"
    description: "Malware detection signature PHP-REX-1542"
    severity: critical
    category: php_backdoor
    pattern: 'for\s*\(\$i\s*=\s*2\s*;\s*\(\s*\$i\s*<=\s*20\s*\)\s*;\s*\$i\+\+\)\s*{\s*\$newfile\s*=\s*"\$i\.php";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1543"
    name: "PHP-REX-1543"
    description: "Malware detection signature PHP-REX-1543"
    severity: critical
    category: php_backdoor
    pattern: '\$Salesforce_Desk_1\s*=\s*stristr\(\$finish_result'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1544"
    name: "PHP-REX-1544"
    description: "Malware detection signature PHP-REX-1544"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\(\$rfn,file_get_contents\(''pid\.php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1545"
    name: "PHP-REX-1545"
    description: "Malware detection signature PHP-REX-1545"
    severity: critical
    category: php_backdoor
    pattern: '=unserialize\(string_cpt\(base64_decode\(\$\w{1,40}\),\$\w{1,40}\)\);\$\w{1,40}=\$_REQUEST'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1546"
    name: "PHP-REX-1546"
    description: "Malware detection signature PHP-REX-1546"
    severity: critical
    category: php_backdoor
    pattern: '<title>MINI\s+SHELL</title>\s*<style>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1547"
    name: "PHP-REX-1547"
    description: "Malware detection signature PHP-REX-1547"
    severity: critical
    category: php_backdoor
    pattern: '\$_POST\["pwd"\]="Weak\s*Liver'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1549"
    name: "PHP-REX-1549"
    description: "Malware detection signature PHP-REX-1549"
    severity: critical
    category: php_backdoor
    pattern: 'Exec_Run\("rm\s*-rf\s*"\.\$filename\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1551"
    name: "PHP-REX-1551"
    description: "Malware detection signature PHP-REX-1551"
    severity: critical
    category: php_backdoor
    pattern: 'app->getMenu\(\);\s*if\s*\(\$jemenu->getActive\(\)\s*==\s*\$jemenu->getDefault\(\)\)\s*\{\s*\$rand\s*=\s*rand'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1552"
    name: "PHP-REX-1552"
    description: "Malware detection signature PHP-REX-1552"
    severity: critical
    category: php_backdoor
    pattern: '\]\}=mail_utf8_html_attch\(\$\{\$\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1553"
    name: "PHP-REX-1553"
    description: "Malware detection signature PHP-REX-1553"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=(?:\s*(\s*''.{77}''\.$)){3,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1554"
    name: "PHP-REX-1554"
    description: "Malware detection signature PHP-REX-1554"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s+gethttpcnt\(\$url\s*,\s*\$timeout\s*='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1555"
    name: "PHP-REX-1555"
    description: "Malware detection signature PHP-REX-1555"
    severity: critical
    category: php_backdoor
    pattern: 'stratum\+tcp://pool\.minexmr\.com:'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1556"
    name: "PHP-REX-1556"
    description: "Malware detection signature PHP-REX-1556"
    severity: critical
    category: php_backdoor
    pattern: 'x@xmr\.crypto-pool\.fr:80/xmr'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1557"
    name: "PHP-REX-1557"
    description: "Malware detection signature PHP-REX-1557"
    severity: critical
    category: php_backdoor
    pattern: '@eval\(gzinflate\(str_rot13\(base64_decode\(\$code\)\)\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1558"
    name: "PHP-REX-1558"
    description: "Malware detection signature PHP-REX-1558"
    severity: critical
    category: php_backdoor
    pattern: 'magicboom\(\$_GET\["y"\]\);\$f\s*=\s*\$_GET'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1559"
    name: "PHP-REX-1559"
    description: "Malware detection signature PHP-REX-1559"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\s*=\s*getenv\(\s*"REMOTE_ADDR"\s*\);\s*\$\w+\s*=\s*date\("D M d, Y g:i a"\);\s*\$file\s*=\s*basename\(\s*__FILE__\s*\)\s*;\s*\$user\s*=\s*\$_POST\[\s*"user"\s*\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1560"
    name: "PHP-REX-1560"
    description: "Malware detection signature PHP-REX-1560"
    severity: critical
    category: php_backdoor
    pattern: '@move_uploaded_file\(\$userfile_tmp\s*,\s*\$qx\);\s*@chmod\s*\(\$qx\s*,\s*octdec\(\s*\$mode\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1561"
    name: "PHP-REX-1561"
    description: "Malware detection signature PHP-REX-1561"
    severity: critical
    category: php_backdoor
    pattern: 'public\s+function\s+setLinksToDbJm\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1562"
    name: "PHP-REX-1562"
    description: "Malware detection signature PHP-REX-1562"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*rmhtmltag2\(\$tagname='''',\$str=''''\s*\)\s*{\s*\$rulers\s*=\s*''\#<''\.\$tagname'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1563"
    name: "PHP-REX-1563"
    description: "Malware detection signature PHP-REX-1563"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*astripslashes\(\$array\)\s*{\s*return\s*is_array\(\$array\)\s*\?\s*array_map\(''WSOstripslashes''\s*,\s*\$array\)\s*:\s*stripslashes\(\$array\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1564"
    name: "PHP-REX-1564"
    description: "Malware detection signature PHP-REX-1564"
    severity: critical
    category: php_backdoor
    pattern: '\$_COOKIE\[''j_submenu''\]\s*:\s*NULL\);\s*\$JSubMenu\s*=\s*addFilter\(getEntries\(_JEXEC\), \$action\);\s*if\s*\(\s*isset\(\s*\$JSubMenu\s*\)\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1565"
    name: "PHP-REX-1565"
    description: "Malware detection signature PHP-REX-1565"
    severity: critical
    category: php_backdoor
    pattern: '\$content\s*=\s*http_request\(\s*"http://"\.\$_SERVER\[''SERVER_NAME''\]\s*\.\s*"/\w+"\);\s*\$content\s*=\s*str_replace\(\s*"/\w+"\s*,\s*\$uri\s*, \$content\s*\);\s*exit\(\s*\$content\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1566"
    name: "PHP-REX-1566"
    description: "Malware detection signature PHP-REX-1566"
    severity: critical
    category: php_backdoor
    pattern: '@set_time_limit\(\s*0\s*\)\s*;\s*if\(\s*\$lim\s*>\s*100\s*\)\s*break\s*;\s*\$d\s*=\s*\$startDir\s*\.\s*\$one_dir;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1567"
    name: "PHP-REX-1567"
    description: "Malware detection signature PHP-REX-1567"
    severity: critical
    category: php_backdoor
    pattern: ';return\${\$\w{1,20}};}public function getRules\(\){if\(\$this->detectionType==self::DETECTION_TYPE_EXTENDED\){return self::getMobileDetectionRulesExtended\(\);}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1568"
    name: "PHP-REX-1568"
    description: "Malware detection signature PHP-REX-1568"
    severity: critical
    category: php_backdoor
    pattern: '<h2>Confirm\s+Your\s+Paypal\s+Debit/Credit\s+Card\s*</h2>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1569"
    name: "PHP-REX-1569"
    description: "Malware detection signature PHP-REX-1569"
    severity: critical
    category: php_backdoor
    pattern: '}\["[^"]+"\]}=mail_utf8_html_attch\(\${\$\w{1,20}},\${\${'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1570"
    name: "PHP-REX-1570"
    description: "Malware detection signature PHP-REX-1570"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''ch''\s*\]\s*\)\s*\{\s*echo\s*"OK"\s*;\s*exit\s*\(\s*\)\s*;\s*\}\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''to''\s*\]\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1571"
    name: "PHP-REX-1571"
    description: "Malware detection signature PHP-REX-1571"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\$_GET\[''mod''\]\s*==\s*''X0X''\s*OR\s*\$_GET\[''mod''\]\s*==\s*''00X''\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1572"
    name: "PHP-REX-1572"
    description: "Malware detection signature PHP-REX-1572"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\(\s*''err_class/sape\.php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1573"
    name: "PHP-REX-1573"
    description: "Malware detection signature PHP-REX-1573"
    severity: critical
    category: php_backdoor
    pattern: '\$dl=urldecode\(\$_COOKIE\[''dl''\]\);\$cp=urldecode\(\$_COOKIE\[''cp''\]\);\$cd=urldecode\(\$_COOKIE\[''cd''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1574"
    name: "PHP-REX-1574"
    description: "Malware detection signature PHP-REX-1574"
    severity: critical
    category: php_backdoor
    pattern: 'unzip\("archive\.zip"\);\s*@unlink\(''archive\.zip''\);\s*@unlink\(''\w+\.php''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1575"
    name: "PHP-REX-1575"
    description: "Malware detection signature PHP-REX-1575"
    severity: critical
    category: php_backdoor
    pattern: '\$data\s*=\s*file_get_contents\(''php://input''\);\s*if\s*\(strlen\(\$data\)\s*<=\s*4\)\s*d\(''e0''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1576"
    name: "PHP-REX-1576"
    description: "Malware detection signature PHP-REX-1576"
    severity: critical
    category: php_backdoor
    pattern: '\$message\s*\.=\s*"CVV:\s*"\s*\.\s*\$_POST\[''cvv''\]\s*\.\s*"\\n";\s*\$message\s*\.=\s*"PIN:\s*"\s*\.\s*\$_POST\[''cvv0''\]\s*\.\s*"\\n";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1578"
    name: "PHP-REX-1578"
    description: "Malware detection signature PHP-REX-1578"
    severity: critical
    category: php_backdoor
    pattern: '\$tags=array\("p","div","span"\);\$tags=\$tags\[rand\(0,count\(\$tags\)-1\)];\s*array_push\(\$body,"%1\$tags%3",\$text,"%2\$tags%3"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1579"
    name: "PHP-REX-1579"
    description: "Malware detection signature PHP-REX-1579"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(strlen\(strval\(key\(\$_GET\)\)\)\)\s*\$m\s*=\s*''sub_id_1=''\s*\.\s*strval\s*\(\s*key\(\s*\$_GET\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1580"
    name: "PHP-REX-1580"
    description: "Malware detection signature PHP-REX-1580"
    severity: critical
    category: php_backdoor
    pattern: '@file_get_contents\("\$chain/csbx\.php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1581"
    name: "PHP-REX-1581"
    description: "Malware detection signature PHP-REX-1581"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(base64_decode\("JGF1dGhfcGFzcyA9ICIyYTF'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1582"
    name: "PHP-REX-1582"
    description: "Malware detection signature PHP-REX-1582"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$\w{1,40}\s*\)\s*&&\s*\$act\s*==\s*''redate''\s*&&\s*isset\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*if\s*\(\s*file_exists\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*echo\s*rdFile\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1583"
    name: "PHP-REX-1583"
    description: "Malware detection signature PHP-REX-1583"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*clear_htaccess\(\$file_name\)\s*{\s*\$path_htaccess\s*=\s*\$_SERVER\[''DOCUMENT_ROOT'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1584"
    name: "PHP-REX-1584"
    description: "Malware detection signature PHP-REX-1584"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*strrev\s*\(\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\s*strrev\s*\(\s*"[^"]*"\s*\)\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*\)\s*\)\s*;\s*eval'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1585"
    name: "PHP-REX-1585"
    description: "Malware detection signature PHP-REX-1585"
    severity: critical
    category: php_backdoor
    pattern: ';\s*\b\w{1,20}\(\$\w{1,10}\s*=\s*\$\w{1,10}\.\$\w{1,10}\[\d+\]\);\s*hebrevc\(\$\w{1,10}\s*=\s*\$\w{1,10}\.\$\w{1,10}\[\d+\]\);\s*\w{1,10}\(\$\w{1,10}\s*=\s*\$\w{1,10}\.\$\w{1,10}\[\d+\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1586"
    name: "PHP-REX-1586"
    description: "Malware detection signature PHP-REX-1586"
    severity: critical
    category: php_backdoor
    pattern: '<center>config\s*root\s*man</center>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1587"
    name: "PHP-REX-1587"
    description: "Malware detection signature PHP-REX-1587"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[''\w+'']=Array\(\);\s*\?><\?\s*function\s*_\w+\(\$i\){\s*\$a=Array\(\);\s*return base64_decode\(\$a\[\$i]\)\s*;\s*}\s*preg_replace\(\s*"/\.\*/e","'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1588"
    name: "PHP-REX-1588"
    description: "Malware detection signature PHP-REX-1588"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\(\s*\$\w{1,10}\s*\.\s*["'']/\w+\.(png|gif)["'']\s*,\s*["'']<\?php\s*["'']\s*\.\s*get\(\s*\$\w{1,10}\(\$\w{1,10}\)\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1589"
    name: "PHP-REX-1589"
    description: "Malware detection signature PHP-REX-1589"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\s*\("\?>"\s*\.\s*gzuncompress\(base64_decode\("eJysvV'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1590"
    name: "PHP-REX-1590"
    description: "Malware detection signature PHP-REX-1590"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function\s+file_to_include_unknown_cms'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1591"
    name: "PHP-REX-1591"
    description: "Malware detection signature PHP-REX-1591"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\s*\(\s*base64_decode\s*\(\s*''[^'']*''\s*\)\s*\)\s*;\s*\?><\?php\s*eval\s*\(\s*base64_decode\s*\(\s*''[^'']*''\s*\)\s*\)\s*;\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==\s*"[^"]*"\s*\)\s*\{\s*@unlink\s*\(\s*''[^'']*''\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1592"
    name: "PHP-REX-1592"
    description: "Malware detection signature PHP-REX-1592"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(base64_decode\(''IGVycm9yX3JlcG9ydGluZygw'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1593"
    name: "PHP-REX-1593"
    description: "Malware detection signature PHP-REX-1593"
    severity: critical
    category: php_backdoor
    pattern: '{\s*echo\s+"Files\s+Extracted\s+MbroOk'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1594"
    name: "PHP-REX-1594"
    description: "Malware detection signature PHP-REX-1594"
    severity: critical
    category: php_backdoor
    pattern: '\$_F=__FILE__;\$_X=''P2lCPz5NY2VXKDxlbk1bVV85TTJPOU0oJzhDcjA5Qy5'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1595"
    name: "PHP-REX-1595"
    description: "Malware detection signature PHP-REX-1595"
    severity: critical
    category: php_backdoor
    pattern: ';\s*symlink\(''/''\.\$home\.''/''\.\$user\.''/public_html/client\-area/configuration\.php'',\$user\.''WHMCS\.txt''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1596"
    name: "PHP-REX-1596"
    description: "Malware detection signature PHP-REX-1596"
    severity: critical
    category: php_backdoor
    pattern: '\$f\s*=\s*\$a\(\s*"",\s*\$array_name\(\s*\$string\s*\)\s*\);\s*//\s*MALWARE\s*\$f\(\s*\);\s*exit\(\s*\);\s*}\s*\${"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1597"
    name: "PHP-REX-1597"
    description: "Malware detection signature PHP-REX-1597"
    severity: critical
    category: php_backdoor
    pattern: '\$exploitURL\s*=\s*\$\w{1,40}\s*\.\s*"[^"]*"\s*\.\s*REDIRECTION_FOLDER\s*\.\s*"[^"]*"\s*;\s*\}\s*return\s*\$\w{1,40}\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1598"
    name: "PHP-REX-1598"
    description: "Malware detection signature PHP-REX-1598"
    severity: critical
    category: php_backdoor
    pattern: '\$ff\s*=\s*\$f1\s*\.\s*\$f2\s*\.\s*\$f3;\s*if\s*\(file_exists\(\$ff\)\)\s*chmod\s*\(\$ff\s*,\s*0777\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1599"
    name: "PHP-REX-1599"
    description: "Malware detection signature PHP-REX-1599"
    severity: critical
    category: php_backdoor
    pattern: 'PRIVATE\s+SCAM\s+APPLE.+?\$bannedIP\s*=\s*array'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1600"
    name: "PHP-REX-1600"
    description: "Malware detection signature PHP-REX-1600"
    severity: critical
    category: php_backdoor
    pattern: '<title>\|\#\|\s*BW\s*Inbox\s*Mailer\s*\|\#\|\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1601"
    name: "PHP-REX-1601"
    description: "Malware detection signature PHP-REX-1601"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*md5\s*\(\s*"[^"]*"\s*\)\s*;\s*\?><\?php\s*eval\s*\(\s*gzuncompress\s*\(\s*base64_decode\s*\(\s*"[^"]*"\s*\)\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1602"
    name: "PHP-REX-1602"
    description: "Malware detection signature PHP-REX-1602"
    severity: critical
    category: php_backdoor
    pattern: 'print\s*"Sending\s*Mail\s*To\s*\$to\.\.\.\.";\s*flush\(\);\s*\$header\s*=\s*"From:\s*\$realnamenew'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1603"
    name: "PHP-REX-1603"
    description: "Malware detection signature PHP-REX-1603"
    severity: critical
    category: php_backdoor
    pattern: ':\${\$\w+}=php_uname\(preg_replace\("/\^-/","",\${\${'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1604"
    name: "PHP-REX-1604"
    description: "Malware detection signature PHP-REX-1604"
    severity: critical
    category: php_backdoor
    pattern: 'hide\s+-s\s+"/usr/sbin/httpd"\s+-d\s+-p\s+ax\.pid'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1605"
    name: "PHP-REX-1605"
    description: "Malware detection signature PHP-REX-1605"
    severity: critical
    category: php_backdoor
    pattern: 'Rez\s+by\s+\[\s+bajatax\s+--\s+Sniper'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1606"
    name: "PHP-REX-1606"
    description: "Malware detection signature PHP-REX-1606"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*session_start\(\s*\);\s*\$mail\s*=\s*\$_SESSION\[''mail''\]\s*=\s*\$_POST\[''mail''\];\s*\$pass\s*=\s*\$_SESSION\[''pass''\]\s*=\s*\$_POST\[''\w+''\];\s*\$IP\s*=\s*\$_SERVER\[''REMOTE_ADDR''\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1607"
    name: "PHP-REX-1607"
    description: "Malware detection signature PHP-REX-1607"
    severity: critical
    category: php_backdoor
    pattern: 'Wahib\s+Mkadmi\s+Priv8\s+Mail3R'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1608"
    name: "PHP-REX-1608"
    description: "Malware detection signature PHP-REX-1608"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(gzuncompress\(base64_decode\(''eNqs/fuPK9tWH47'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1609"
    name: "PHP-REX-1609"
    description: "Malware detection signature PHP-REX-1609"
    severity: critical
    category: php_backdoor
    pattern: 'WritePayload\(\s*\$local_payload_path\s*,\s*\$payload_file\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1610"
    name: "PHP-REX-1610"
    description: "Malware detection signature PHP-REX-1610"
    severity: critical
    category: php_backdoor
    pattern: ';\$\{\$\w{1,40}\}\s*=\s*get_option\(EWPT_PLUGIN_SLUG\);echo"[^"]+"\s*\.\s*esc_attr\(\$\{\$\{"[^"]+"\}\s*\["'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1611"
    name: "PHP-REX-1611"
    description: "Malware detection signature PHP-REX-1611"
    severity: critical
    category: php_backdoor
    pattern: 'define\(''SHELL_PASSWORD''\s*,\s*\$hashed_password\)\s*;\s*define\(''MAX_UP_LEVELS'',\s*\d+\)\s*;\s*if\(empty\(\$_COOKIE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1612"
    name: "PHP-REX-1612"
    description: "Malware detection signature PHP-REX-1612"
    severity: critical
    category: php_backdoor
    pattern: 'my\s*@ps\s*=\s*-c\s*1\s*-x\s*-x"\s*,\s*"/usr/sbin/acpid"\s*,\s*"/usr/sbin/cron'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1613"
    name: "PHP-REX-1613"
    description: "Malware detection signature PHP-REX-1613"
    severity: critical
    category: php_backdoor
    pattern: '<title>Navicat HTTP Tunnel Tester</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1614"
    name: "PHP-REX-1614"
    description: "Malware detection signature PHP-REX-1614"
    severity: critical
    category: php_backdoor
    pattern: 'stripos\(\$path\s*,\s*''/httpdocs/''\s*\)\s*\+\s*strlen\(\s*''/httpdocs/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1615"
    name: "PHP-REX-1615"
    description: "Malware detection signature PHP-REX-1615"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\)\s*&&\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==\s*''[^'']*''\s*\)\s*\{\s*echo\s*(copy|move_uploaded_file)\s*\(\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*\[\s*''[^'']*''\s*\]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*exit\s*;\s*\}\s*\?>\s*<\s*form'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1616"
    name: "PHP-REX-1616"
    description: "Malware detection signature PHP-REX-1616"
    severity: critical
    category: php_backdoor
    pattern: '@system\("killall\s+-9\s+"\.basename\("/usr/bin/host"\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1617"
    name: "PHP-REX-1617"
    description: "Malware detection signature PHP-REX-1617"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!function_exists\(\s*''jquery_GetAllWritableDirs''\s*\)\s*\)\s*{\s*function\s*jquery_GetAllWritableDirs\(\s*\$params\s*\)\s*{\s*global\s*\$jquery_dr\s*,\s*\$dirList'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1618"
    name: "PHP-REX-1618"
    description: "Malware detection signature PHP-REX-1618"
    severity: critical
    category: php_backdoor
    pattern: 'webadmin\.php</h1>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1619"
    name: "PHP-REX-1619"
    description: "Malware detection signature PHP-REX-1619"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*fopen\(\s*"temp1-1\.php"\s*,\s*"w"\s*\);\s*fputs\(\$\w+\s*,\s*"<\?php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1620"
    name: "PHP-REX-1620"
    description: "Malware detection signature PHP-REX-1620"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*xcalendarBufferEnd\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*xcalendarWPBase::getInstance\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1621"
    name: "PHP-REX-1621"
    description: "Malware detection signature PHP-REX-1621"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*intval\s*\(\s*\$_GET\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\$\w{1,40}\s*=\s*octdec\s*\(\s*intval\s*\(\s*\$_GET\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*else\s*\$\w{1,40}\s*=\s*\d+\s*;\s*if\s*\(\s*chmod_R\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\)\s*echo\s*"[^"]*"\s*\.\s*\$\w{1,40}\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1622"
    name: "PHP-REX-1622"
    description: "Malware detection signature PHP-REX-1622"
    severity: critical
    category: php_backdoor
    pattern: 'Web\s+Shell\s+By.+?preg_replace\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1623"
    name: "PHP-REX-1623"
    description: "Malware detection signature PHP-REX-1623"
    severity: critical
    category: php_backdoor
    pattern: '}\s*else\s*{\s*syswrite\(\$client\s*,\s*"\\x05\\xFF"\s*,\s*2\s*\);\s*}\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1624"
    name: "PHP-REX-1624"
    description: "Malware detection signature PHP-REX-1624"
    severity: critical
    category: php_backdoor
    pattern: 'Mister\s+Spy\s+&\s+Souheyl\s+Bypass\s+Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1625"
    name: "PHP-REX-1625"
    description: "Malware detection signature PHP-REX-1625"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*[^)]+?\s*\)\s*;\s*){4,}\$\w+\s*=\s*\$\w+\(\s*\$\w+\(\s*\$\w+\s*\)\s*,\s*\d+\s*\);\s*\$\w+\s*=\$\w+\(\s*\$\w+\s*\);\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1626"
    name: "PHP-REX-1626"
    description: "Malware detection signature PHP-REX-1626"
    severity: critical
    category: php_backdoor
    pattern: '{keyword}\s*</h1>\s*</big>\s*</h1>\s*{manytext_bing}\s*</div>\s*</div>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1627"
    name: "PHP-REX-1627"
    description: "Malware detection signature PHP-REX-1627"
    severity: critical
    category: php_backdoor
    pattern: '<\s*\?\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*AND\s*!isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\{\s*setcookie\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*time\s*\(\s*\)\s*\+\d+\s*,\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\s*array\s*\([^)]+\)\s*;\s*for\s*\(\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*<\s*count\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\+\+\s*\)\s*if\s*\(\s*strpos\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*!==\s*false\s*\)\s*\{\s*if\s*\(\s*is_mobile\s*\(\s*\)\s*\)\s*exit\s*\(\s*''[^'']*''\s*\)\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1628"
    name: "PHP-REX-1628"
    description: "Malware detection signature PHP-REX-1628"
    severity: critical
    category: php_backdoor
    pattern: '<title>v\d+\.0\s*\-\s*Mass\s*Mailer\s*by\s*Kobra-Crew'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1629"
    name: "PHP-REX-1629"
    description: "Malware detection signature PHP-REX-1629"
    severity: critical
    category: php_backdoor
    pattern: '<title>INDRAJITH\s+SHELL.+filemanager_bg'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1630"
    name: "PHP-REX-1630"
    description: "Malware detection signature PHP-REX-1630"
    severity: critical
    category: php_backdoor
    pattern: '/\*\s*Turbo\s+Force\s+By\s+TrYaG\.CC\s+\-\s+TrYaG\s+AcaDemY\s*\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1631"
    name: "PHP-REX-1631"
    description: "Malware detection signature PHP-REX-1631"
    severity: critical
    category: php_backdoor
    pattern: ']}\)\);}echo\${\$\w+};exit\(\);function get_ip\(\){\${\${".+uniqid\(\)\.uniqid\(\);\${\${'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1632"
    name: "PHP-REX-1632"
    description: "Malware detection signature PHP-REX-1632"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\s*=\s*getenv\(\s*"REMOTE_ADDR"\s*\);\s*\$browser\s*=\s*getenv\s*\(\s*"HTTP_USER_AGENT"\s*\);\s*\$message\s*\.=\s*"-+\|\s*Full\s*Infos'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1633"
    name: "PHP-REX-1633"
    description: "Malware detection signature PHP-REX-1633"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*HOTMAIL\s*\(W33\.INFO\)\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1634"
    name: "PHP-REX-1634"
    description: "Malware detection signature PHP-REX-1634"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*\$random=rand\(0,100000000000\);\s*\$md5=md5\("\$random"\);\s*\$base=base64_encode\(\$md5\);\s*\$dst=md5\("\$base"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1635"
    name: "PHP-REX-1635"
    description: "Malware detection signature PHP-REX-1635"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\s*=\s*getenv\(\s*"REMOTE_ADDR"\s*\);\s*\$browser\s*=\s*getenv\s*\(\s*"HTTP_USER_AGENT"\s*\);\s*\$message\s*\.=\s*"\s*-+\|\s*CC\s*Infos'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1636"
    name: "PHP-REX-1636"
    description: "Malware detection signature PHP-REX-1636"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Impots\.gouv\.fr\s*-\s*Accueil\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1637"
    name: "PHP-REX-1637"
    description: "Malware detection signature PHP-REX-1637"
    severity: critical
    category: php_backdoor
    pattern: '<title>Navicat\s*HTTP\s*Tunnel\s*Tester</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1638"
    name: "PHP-REX-1638"
    description: "Malware detection signature PHP-REX-1638"
    severity: critical
    category: php_backdoor
    pattern: 'Sign\s+on\s+to\s+Scotia\s+OnLine'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1639"
    name: "PHP-REX-1639"
    description: "Malware detection signature PHP-REX-1639"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*require\s*''call\.php'';\s*\$md5\s*=\s*md5\(\s*uniqid\(\s*time\(\s*\)\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1640"
    name: "PHP-REX-1640"
    description: "Malware detection signature PHP-REX-1640"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*function botcheck\(\s*\)\s*{\s*\$spiders\s*=\s*array\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1641"
    name: "PHP-REX-1641"
    description: "Malware detection signature PHP-REX-1641"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*require\s*''call\.php'';\s*\$user\s*=\s*\$_POST\[''user''\];\s*\$pass\s*=\s*\$_POST\[''pass(word)?''\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1642"
    name: "PHP-REX-1642"
    description: "Malware detection signature PHP-REX-1642"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*LimitDownloadSize\(\s*\$resource\s*,\s*\$DownloadSize\s*,\s*\$Downloaded\s*,\s*\$UploadSize\s*,\s*\$Uploaded\s*=\s*null\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1643"
    name: "PHP-REX-1643"
    description: "Malware detection signature PHP-REX-1643"
    severity: critical
    category: php_backdoor
    pattern: 'my\s*\$fakeproc\s*=\s*"/usr/local/apache/bin/httpd\s*-KKD"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1644"
    name: "PHP-REX-1644"
    description: "Malware detection signature PHP-REX-1644"
    severity: critical
    category: php_backdoor
    pattern: 'PlgSystemXcalendarHelper::getInstance\(\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1645"
    name: "PHP-REX-1645"
    description: "Malware detection signature PHP-REX-1645"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*start_work\(\s*\$off\s*,\s*\$unto\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1646"
    name: "PHP-REX-1646"
    description: "Malware detection signature PHP-REX-1646"
    severity: critical
    category: php_backdoor
    pattern: 'touch\s*\(\s*dirname\s*\(\s*__FILE__\s*\)\s*,\s*\$\w{1,40}\s*\)\s*;\s*touch\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*substr\s*\(\s*PHP_OS\s*,\s*0\s*,\s*3\s*\)\s*===\s*''[^'']*''\s*\|\|\s*substr\s*\(\s*PHP_OS\s*,\s*0\s*,\s*3\s*\)\s*===\s*''[^'']*''\s*\)\s*\{\s*chmod\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*0444\s*\)\s*;\s*chmod\s*\(\s*dirname\s*\(\s*__FILE__\s*\)\s*,\s*0555\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1647"
    name: "PHP-REX-1647"
    description: "Malware detection signature PHP-REX-1647"
    severity: critical
    category: php_backdoor
    pattern: 'die\(''ERROR-400-BAD-REQUEST''\);\s*if\s*\(isset\(\$_FILES\[''\w+''\]\)\){\s*if\s*\(isset\(\$_REQUEST\[''\w+'']\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1648"
    name: "PHP-REX-1648"
    description: "Malware detection signature PHP-REX-1648"
    severity: critical
    category: php_backdoor
    pattern: 'echo"<center>.+?</center>\s*";\s*echo\s*''uname:''\.php_uname'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1649"
    name: "PHP-REX-1649"
    description: "Malware detection signature PHP-REX-1649"
    severity: critical
    category: php_backdoor
    pattern: '<!--\#include\s*file="/etc/passwd"\s*-->'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1650"
    name: "PHP-REX-1650"
    description: "Malware detection signature PHP-REX-1650"
    severity: critical
    category: php_backdoor
    pattern: '\$default_action\s*=\s*[''"]FilesMan[''"];\s*\$default_use_ajax\s*=\s*true;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1651"
    name: "PHP-REX-1651"
    description: "Malware detection signature PHP-REX-1651"
    severity: critical
    category: php_backdoor
    pattern: '<title>GaLers\s+xh3LL\s+Backd00r</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1652"
    name: "PHP-REX-1652"
    description: "Malware detection signature PHP-REX-1652"
    severity: critical
    category: php_backdoor
    pattern: ';class\s*Smarty3\s*{\s*private\s*static\s*\$file_with_ip'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1653"
    name: "PHP-REX-1653"
    description: "Malware detection signature PHP-REX-1653"
    severity: critical
    category: php_backdoor
    pattern: 'exec\("cat /etc/passwd'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1654"
    name: "PHP-REX-1654"
    description: "Malware detection signature PHP-REX-1654"
    severity: critical
    category: php_backdoor
    pattern: '\.\s*/sss\s*\.\s*pl\s*<\s*local_host\s*>\s*<\s*local_port\s*>\s*\[\s*auth_login\s*\(\s*:auth_pass\s*\)\s*\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1655"
    name: "PHP-REX-1655"
    description: "Malware detection signature PHP-REX-1655"
    severity: critical
    category: php_backdoor
    pattern: '<title>Navicat HTTP Tunnel Tester</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1656"
    name: "PHP-REX-1656"
    description: "Malware detection signature PHP-REX-1656"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*\)\s*\$mailTo\s*=\s*base64_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*;.+if\(mail\(\$MailTo\s*,\s*\$MessageSubject\s*,\s*\$MessageBody\s*,\s*\$MessageHeader\s*\)\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1657"
    name: "PHP-REX-1657"
    description: "Malware detection signature PHP-REX-1657"
    severity: critical
    category: php_backdoor
    pattern: 'Upload\s*is\s*<b>\s*<color>\s*WORKING'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1658"
    name: "PHP-REX-1658"
    description: "Malware detection signature PHP-REX-1658"
    severity: critical
    category: php_backdoor
    pattern: 'Sindbad\s*File\s*Manager\s*Version'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1659"
    name: "PHP-REX-1659"
    description: "Malware detection signature PHP-REX-1659"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*file_exists\(\s*"config/settings\.inc\.php"\s*\)\s*or\s*\(\s*"\.\./config/settings\.inc\.php"\s*\)\s*or\s*\(\s*"\.\./\.\./config/settings\.inc\.php"\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1660"
    name: "PHP-REX-1660"
    description: "Malware detection signature PHP-REX-1660"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@set_time_limit\s*\(\s*\d+\s*\)\s*;\s*@ignore_user_abort\s*\(\s*\d+\s*\)\s*;\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*\w+\s*\(\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}\s*==''[^'']*''\s*\)\s*\{\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*\}\s*\$\w{1,40}\s*=\s*base64_encode\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*function\s*\w+\s*\(\s*\)\s*\{\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\}\s*else\s*\{\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\.\s*''[^'']*''\s*\.\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\[\s*\d+\s*\]\s*;\s*\}\s*else\s*\{\s*\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\.\s*''[^'']*''\s*\.\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*\}\s*\}\s*return\s*\$\w{1,40}\s*;\s*\}\s*\$\w{1,40}\s*=\s*urldecode\s*\(\s*"[^"]*"\s*\)\s*;\s*.+?\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1661"
    name: "PHP-REX-1661"
    description: "Malware detection signature PHP-REX-1661"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(gzuncompress\(base64_decode\(''eNp1VW1r21YU/it3JjA7mMSSLCmyyYqXOJ4zj5R4rEl2h7iWrl4aWfKk60YmjFFox'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1662"
    name: "PHP-REX-1662"
    description: "Malware detection signature PHP-REX-1662"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*strrev\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*substr\s*\(\s*md5\s*\(\s*\$\w{1,40}\s*\)\s*,\s*0\s*,\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;\s*\$\w{1,40}\s*=\s*md5\s*\(\s*\$\w{1,40}\s*\)\s*\.\s*\$\w{1,40}\s*;\s*\$\w{1,40}\s*=\s*''gzinflate''\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1663"
    name: "PHP-REX-1663"
    description: "Malware detection signature PHP-REX-1663"
    severity: critical
    category: php_backdoor
    pattern: '<title>Cardiman\s+Asooooh'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1664"
    name: "PHP-REX-1664"
    description: "Malware detection signature PHP-REX-1664"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*file_get_contents\(\$\w+\);\s*}\s*elseif\(!in_array\([''"]exec[''"]\s*,\s*explode\(\s*[''"],[''"]\s*,\s*ini_get\(\s*[''"]disable_functions[''"]\s*\)\s*\)\s*\)\s*\)\s*{\s*exec\(\s*"wget\s*-O\s*-\s*''"\s*\.\s*\$\w+\s*\.\s*"''"\s*,\s*\$\w+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1665"
    name: "PHP-REX-1665"
    description: "Malware detection signature PHP-REX-1665"
    severity: critical
    category: php_backdoor
    pattern: '\$headers\s*=\s*"From:\s*MafioZo0'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1666"
    name: "PHP-REX-1666"
    description: "Malware detection signature PHP-REX-1666"
    severity: critical
    category: php_backdoor
    pattern: '\$ADconn\s*=\s*new\s*adLDAP;\s*if\(\$ADconn->existingUser\(\$user\[''username''\]\)\){\s*section\("Active\s*Directory",2\);\s*content\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1667"
    name: "PHP-REX-1667"
    description: "Malware detection signature PHP-REX-1667"
    severity: critical
    category: php_backdoor
    pattern: 'makehide\(''action'', ''backconnect''\);\s*p\(''<p>''\);\s*p\(''Your IP:''\);\s*makeinput\(array\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1668"
    name: "PHP-REX-1668"
    description: "Malware detection signature PHP-REX-1668"
    severity: critical
    category: php_backdoor
    pattern: '<title>\w+</title><form\s+enctype=multipart/form-data\s+method=post><input\s+name=\w+\s+type=file><input\s+type=submit\s+name=\w+>\s*<br><br><input\s+name=path\s+type=text\s+value=<\?php\s+echo\s+@getcwd\(\);\s*\?>/>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1669"
    name: "PHP-REX-1669"
    description: "Malware detection signature PHP-REX-1669"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\(\s*htmlentities\(\s*\$_GET\[\s*''symlinktarget''\s*\]\s*\)\s*\);\s*\?>\s*</b>\s*<br>\s*<input\s*type="checkbox"\s*name="relative"\s*value="yes"\s*id="checkbox_relative'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1670"
    name: "PHP-REX-1670"
    description: "Malware detection signature PHP-REX-1670"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$pass\s*==\s*''\w{32}''\s*\)\s*\{\s*if\s*\(\s*!\$\w{1,40}\s*=\s*fopen\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*\)\s*\{\s*exit\s*;\s*\}\s*if\s*\(\s*fwrite\s*\(\s*\$\w{1,40}\s*,\s*"[^"]*"\s*\)\s*==\s*FALSE\s*\)\s*\{\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1671"
    name: "PHP-REX-1671"
    description: "Malware detection signature PHP-REX-1671"
    severity: critical
    category: php_backdoor
    pattern: 'PhpFileAdmin.+?<a\s*href="index\.php\?dir=<\?=\$_GET\[''dir'']\?>">'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1672"
    name: "PHP-REX-1672"
    description: "Malware detection signature PHP-REX-1672"
    severity: critical
    category: php_backdoor
    pattern: 'elseif\s*\(\s*isset\(\s*\$_COOKIE\[\s*''\w+''\s*\]\s*\)\s*&&\s*!empty\(\s*\$_COOKIE\[\s*''\w+''\s*\]\s*\)\s*\)\s*{\s*echo\s*htmlentities\(\s*\(\s*string\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1673"
    name: "PHP-REX-1673"
    description: "Malware detection signature PHP-REX-1673"
    severity: critical
    category: php_backdoor
    pattern: 'list\(\s*\$tobuf\s*,\s*\$from\s*,\s*\$subject\s*,\s*\$messagefile\s*\)=\s*explode\s*\(\s*'':::''\s*,\s*\$conar\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1674"
    name: "PHP-REX-1674"
    description: "Malware detection signature PHP-REX-1674"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@''\$\s*\w+=\d+\s*\w+='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1675"
    name: "PHP-REX-1675"
    description: "Malware detection signature PHP-REX-1675"
    severity: critical
    category: php_backdoor
    pattern: ';\s*\$[O0_]+="[^"]*"\s*;\s*\$\w{1,40}="[^"]*"\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*;\s*\$\w{1,40}\s*=\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\.\s*\$\w{1,40}\s*\.\s*\$\w{1,40}\s*\.\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\)\s*;\s*echo\s*\$\w{1,40}\s*\.\s*"[^"]*"\s*;\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1676"
    name: "PHP-REX-1676"
    description: "Malware detection signature PHP-REX-1676"
    severity: critical
    category: php_backdoor
    pattern: 'else\s*\{\s*echo\s*"indata_error"\s*;\s*exit\s*;\s*\}\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1677"
    name: "PHP-REX-1677"
    description: "Malware detection signature PHP-REX-1677"
    severity: critical
    category: php_backdoor
    pattern: '<title>D\.R\.S\s+Dz</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1678"
    name: "PHP-REX-1678"
    description: "Malware detection signature PHP-REX-1678"
    severity: critical
    category: php_backdoor
    pattern: 'list\(\$tobuf,\$from,\$frompwd,\$fromname,\$subject,\$message\)= split \('':::'',\s*\$conar\);\s*\$toar = split\(''\\\|\\\|'',\$tobuf\);\s*foreach \(\$toar\s*as\s*\$to\)\s*{\s*list\(\$fromlogin,\$fromhost\)=split\(''@'',\$from\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1679"
    name: "PHP-REX-1679"
    description: "Malware detection signature PHP-REX-1679"
    severity: critical
    category: php_backdoor
    pattern: 'base64_decode(''UHJvcGVydHkgb2YgUmV2aXNpdW0uY29t'')'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1680"
    name: "PHP-REX-1680"
    description: "Malware detection signature PHP-REX-1680"
    severity: critical
    category: php_backdoor
    pattern: 'static\s*public\s*function\s*\w+\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\w+\s*\(\s*["''][^"'']*=["'']\s*\)\s*;\s*return\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1681"
    name: "PHP-REX-1681"
    description: "Malware detection signature PHP-REX-1681"
    severity: critical
    category: php_backdoor
    pattern: '}\s*if\(\w+::\w+\(\w+\("[a-zA-Z0=9/]+=="\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1682"
    name: "PHP-REX-1682"
    description: "Malware detection signature PHP-REX-1682"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@''\$\s*\w+=\d+\s*\w+=\d+\s*x3='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1683"
    name: "PHP-REX-1683"
    description: "Malware detection signature PHP-REX-1683"
    severity: critical
    category: php_backdoor
    pattern: 'OK\s*COK\s*SUKSESS'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1684"
    name: "PHP-REX-1684"
    description: "Malware detection signature PHP-REX-1684"
    severity: critical
    category: php_backdoor
    pattern: 'fopen\s*\(\s*["''][^''"]*["'']\s*,\s*[''"][^"'']*[''"]\s*\)\s*;\s*\}\s*fwrite\s*\(\s*\$\w{1,40}\s*,\s*rawurldecode\s*\(\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*\)\s*\)\s*;\s*fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*@?include\s*\(\s*"[^"]*"\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1685"
    name: "PHP-REX-1685"
    description: "Malware detection signature PHP-REX-1685"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}-\s*>\s*\w+\s*=@file_get_contents\s*\(\s*\$\w{1,40}-\s*>\s*\w+\s*,\s*false\s*,\s*\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}-\s*>\s*\w+\s*===\s*false\s*\)\s*\{\s*\$\w{1,40}\s*=\s*[^;]+\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1686"
    name: "PHP-REX-1686"
    description: "Malware detection signature PHP-REX-1686"
    severity: critical
    category: php_backdoor
    pattern: '\{\s*\$\w{1,40}\s*=\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\(\s*1\s*,\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*\w+\s*\(\s*array\s*\(\s*\$\w{1,40}\s*\[\s*\d+\s*\]\s*,\s*\$\w{1,40}\s*,\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*,\s*\$\w{1,40}\s*,\s*1\s*\)\s*;\s*\$\w{1,40}\s*\.\s*=\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\(\s*\$\w{1,40}\s*\[\s*"[^"]*"\s*\]\s*\.\s*"[^"]*"\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1687"
    name: "PHP-REX-1687"
    description: "Malware detection signature PHP-REX-1687"
    severity: critical
    category: php_backdoor
    pattern: 'basename\s*\(\s*\$\w{1,40}\s*,\s*"[^"]*"\s*\)\s*==\s*"[^"]*"\s*\)\s*&&\s*in_array\s*\(\s*strtok\s*\(\s*"[^"]*"\s*\)\s*,\s*array\s*\(\s*"[^"]*"\s*,\s*"[^"]*"\s*,\s*"[^"]*"\s*\)\s*\)\s*&&\s*\(\s*empty\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1688"
    name: "PHP-REX-1688"
    description: "Malware detection signature PHP-REX-1688"
    severity: critical
    category: php_backdoor
    pattern: '\}\s*else\s*if\s*\(\s*\$\w{1,40}\s*==\s*"php"\s*\)\s*\{\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*\}\s*else\s*if\s*\(\s*\$\w{1,40}\s*==\s*"aspx"\s*\)\s*\{\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*\}\s*else\s*\{\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1689"
    name: "PHP-REX-1689"
    description: "Malware detection signature PHP-REX-1689"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*header\s*\(\s*''[^'']*''\s*\)\s*;\s*@set_time_limit\s*\(\s*\d+\s*\)\s*;\s*define\s*\(\s*''[^'']*''\s*,\s*\d+\s*\.\s*0\s*\)\s*;\s*define\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*;\s*if\s*\(\s*file_exists\s*\(\s*PASSWORD_FILE\s*\)\s*\)\s*\{\s*@unlink\s*\(\s*PASSWORD_FILE\s*\)\s*;\s*\}\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1690"
    name: "PHP-REX-1690"
    description: "Malware detection signature PHP-REX-1690"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!class_exists\s*\(\s*''[^'']*''\s*,\s*false\s*\)\s*\)\s*:\s*class\s+\w+\s*{.+?const\s*SCRIPT_SRC\s*=\s*''data:text/javascript;base64,.+?MRT_ALL_TRAFFIC'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1691"
    name: "PHP-REX-1691"
    description: "Malware detection signature PHP-REX-1691"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*//=+//\s*//=+\+\+\+Dhanush\+\+\+=+//\s*//=+//\s*//=+\+\+\+Coded\s*By\s*Arjun\+\+\+===//\s*//=+//\s*//=+\+\+\+An\s*Indian\s*Hacker\+\+\+=====//\s*//=+//\s*//====\s*Ashvin-2069/Oct-2012\s*====//\s*//\s*Set\s*Username\s*&\s*Password\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*//\s*Malware\s*Site\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*//\s*"[^"]*"\s*Base64\s*encoded\s*"[^"]*"\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*eval\s*\(\s*"[^"]*"\s*\.\s*gzuncompress\s*\(\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1692"
    name: "PHP-REX-1692"
    description: "Malware detection signature PHP-REX-1692"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*/\*\s*PHP\s*Encode\s*by\s*http://Www\s*\.\s*PHPJiaMi\s*\.\s*Com/\s*\*/error_reporting\s*\(\s*\d+\s*\)\s*;\s*ini_set\s*\(\s*"[^"]*"\s*,\s*0\s*\)\s*;\s*if\s*\(\s*!defined\s*\(\s*''[^'']*''\s*\)\s*\)\s*\{\s*define\s*\(\s*''[^'']*''\s*,\s*__FILE__\s*\)\s*;\s*if\s*\(\s*!function_exists\s*\(.+?\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1693"
    name: "PHP-REX-1693"
    description: "Malware detection signature PHP-REX-1693"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*file_exists\s*\(\s*"[^"]*"\s*\)\s*\)\s*\{\s*if\s*\(\s*file_exists\s*\(\s*"[^"]*"\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*scandir\s*\(\s*"[^"]*"\s*\)\s*;\s*foreach\s*\(\s*\$\w{1,40}\s*as\s*\$\w{1,40}\s*\)\s*\{\s*if\s*\(\s*\(\s*is_dir\s*\(\s*"[^"]*"\s*\)\s*\)\s*AND\s*\(\s*\$\w{1,40}\s*!==\s*"[^"]*"\s*\)\s*AND\s*\(\s*\$\w{1,40}\s*!==\s*"[^"]*"\s*\)\s*\)\s*\{\s*if\s*\(\s*file_exists\s*\(\s*"[^"]*"\s*\)\s*\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1694"
    name: "PHP-REX-1694"
    description: "Malware detection signature PHP-REX-1694"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\w+::\w+\s*\(\s*\w+\s*\(\s*[''"][^''"]*["'']\s*\)\s*\)\s*\|\|\w+::\w+\s*\(\s*\w+\s*\(\s*["''][^''"]*["'']\s*\)\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=[''"][^"'']*[''"]\s*;\s*\$\w{1,40}\s*=\s*\(\s*[^(]+\)\s*;\s*\$\w{1,40}\s*=\s*\(\s*[^(]+\)\s*;\s*\$\w{1,40}\s*=[''"][^"'']*[''"]\s*;\s*return\s*\$\w{1,40}-\s*>\s*\w+\s*\(\s*\)\s*;\s*\}\s*return\s*\$\w{1,40}-\s*>\s*\w+\s*\(\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1695"
    name: "PHP-REX-1695"
    description: "Malware detection signature PHP-REX-1695"
    severity: critical
    category: php_backdoor
    pattern: '\{\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*=\s*md5\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\}\s*if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*==\s*\$\w{1,40}\s*\)\s*\{\s*setcookie\s*\(\s*\$\w{1,40}\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*time\s*\(\s*\)\s*\+\s*3600\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1696"
    name: "PHP-REX-1696"
    description: "Malware detection signature PHP-REX-1696"
    severity: critical
    category: php_backdoor
    pattern: 'require\s*__DIR__\s*\.\s*''[^'']*''\s*;\s*\$\w{1,40}\s*=\s*new\s*Clue\\Psocksd\\App\s*\(\s*\)\s*;\s*\$\w{1,40}-\s*>\s*run\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1697"
    name: "PHP-REX-1697"
    description: "Malware detection signature PHP-REX-1697"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*<\s*<\s*<\s*S\s*\#\s*BEGIN\s*W0RDPRESS\s*\#\s*<\s*IfModule\s*mod_rewrite\s*\.\s*c\s*>\s*\#RewriteEngine\s*On\s*\#RewriteBase\s*/\s*\#RewriteCond\s*%\s*\{\s*REQUEST_FILENAME\s*\}\s*!-f\s*\#RewriteCond\s*%\s*\{\s*REQUEST_FILENAME\s*\}\s*!-d\s*\#RewriteRule\s*\.\s*/index\s*\.\s*php\s*\[\s*L\s*\]\s*\#\s*<\s*/IfModule\s*>\s*\#\s*END\s*WordPress'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1698"
    name: "PHP-REX-1698"
    description: "Malware detection signature PHP-REX-1698"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$query\s*===\s*''checker-page''\)\s*{\s*if \(\s*_fetch_url\(\s*_get_rev\(\s*\)\s*\)\s*>\s*0\)\s*{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1699"
    name: "PHP-REX-1699"
    description: "Malware detection signature PHP-REX-1699"
    severity: critical
    category: php_backdoor
    pattern: 'by_rEpErOk</font>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1700"
    name: "PHP-REX-1700"
    description: "Malware detection signature PHP-REX-1700"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{10,40}\s*=\s*\d+;\s*){10,}.+?array_push\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*,\s*\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*count\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*>\s*tV12hsJy_\s*\(\s*''[^'']*''\s*,\s*\d+\s*\)\s*\)\s*array_shift\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*;\s*\}\s*\}\s*else\s*\{\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*=\s*microtime\s*\(\s*true\s*\)\s*;\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1701"
    name: "PHP-REX-1701"
    description: "Malware detection signature PHP-REX-1701"
    severity: critical
    category: php_backdoor
    pattern: 'Configs\s+Grabber\s+By\s+AnonCoders\s+Team'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1702"
    name: "PHP-REX-1702"
    description: "Malware detection signature PHP-REX-1702"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+sessionStart\(\$session\)\s*{\s*if\(!empty\(\$session\)\)\s*return\s*eval\(\$session\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1703"
    name: "PHP-REX-1703"
    description: "Malware detection signature PHP-REX-1703"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*me_file_put_contents\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*@chmod\s*\(\s*\$\w{1,40}\s*,\s*0444\s*\)\s*;\s*echo\s*"[^"]*"\s*;\s*\}\s*;\s*\}\s*\}\s*else\s*if\s*\(\s*\$\w{1,40}\s*==\s*''[^'']*''\s*\)\s*\{\s*if\s*\(\s*file_exists\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*echo\s*me_file_get_contents\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\}\s*else\s*\{\s*echo\s*"[^"]*"\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1704"
    name: "PHP-REX-1704"
    description: "Malware detection signature PHP-REX-1704"
    severity: critical
    category: php_backdoor
    pattern: 'md5\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*_\d+\s*\(\s*\d+\s*\)\s*\]\s*\)\s*===\s*__PASSWORD__\s*\)\s*\{\s*\$\w{1,40}\s*=\s*array\s*\(\s*filemtime\s*\(\s*__FILE__\s*\)\s*,\s*filemtime\s*\(\s*dirname\s*\(\s*__FILE__\s*\)\s*\)\s*\)\s*;\s*\$\w{1,40}\s*=\s*basename\s*\(\s*\$\w{1,40}\s*\[\s*_\d+\s*\(\s*\d+\s*\)\s*\]\s*\[\s*_\d+\s*\(\s*\d+\s*\)\s*\]\s*\)\s*;\s*if\s*\(\s*move_uploaded_file'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1705"
    name: "PHP-REX-1705"
    description: "Malware detection signature PHP-REX-1705"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!empty\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*=\s*array\s*\(\s*\)\s*;\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*if\s*\(\s*!empty\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*\.\s*=\s*" AND \#__content\.title LIKE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1706"
    name: "PHP-REX-1706"
    description: "Malware detection signature PHP-REX-1706"
    severity: critical
    category: php_backdoor
    pattern: 'fp\s*=\s*@fsockopen\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\d+\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}\s*\)\s*\{\s*@fclose\s*\(\s*\$\w{1,40}\s*\)\s*;\s*connect3\s*\(\s*\$\w{1,40}\s*\.\s*''[^'']*''\s*\.\s*urlencode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*;\s*\}\s*exit\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1707"
    name: "PHP-REX-1707"
    description: "Malware detection signature PHP-REX-1707"
    severity: critical
    category: php_backdoor
    pattern: '\$_SESSION\[''_ip_''\];\s*//+\s*\$LOGS\s*=\s*"\["\s*\.\s*date\(\s*''Y-m-d[^;]+;\s*file_put_contents\(\s*''[^'']+''\s*,\s*\$LOGS\s*\.\s*PHP_EOL\s*,\s*FILE_APPEND\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1708"
    name: "PHP-REX-1708"
    description: "Malware detection signature PHP-REX-1708"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*=="[^"]*"\s*\|\|\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*=="[^"]*"\s*\)\s*print\s*json_encode\s*\(\s*selfTest\s*\(\s*\)\s*\)\s*;\s*elseif\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*=="[^"]*"\s*\)\s*\{\s*\$\w{1,40}\s*=\s*json_decode\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*,\s*true\s*\)\s*;\s*print\s*json_encode\s*\(\s*alexusMailer\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*;\s*\}\s*else\s*\{\s*print\s*json_encode\s*\(\s*array\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1709"
    name: "PHP-REX-1709"
    description: "Malware detection signature PHP-REX-1709"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$dir\.DIRECTORY_SEPARATOR;\s*chmod\(\$\w+\.DIRECTORY_SEPARATOR\.''index\.php'', 0644\);\s*\$\w+\s*=\s*fopen\(\$\w+\.DIRECTORY_SEPARATOR\.''index\.php''\s*,\s*"r"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1710"
    name: "PHP-REX-1710"
    description: "Malware detection signature PHP-REX-1710"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\s*\(\s*\d+\s*\)\s*;\s*\$\w{1,40}\s*=\s*[''"]jquery[''"]\s*;\s*\$\w{1,40}\s*=\s*[''"]var'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1711"
    name: "PHP-REX-1711"
    description: "Malware detection signature PHP-REX-1711"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$\w{1,40}\s*\(\s*@\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*\)\s*\)\s*\)\s*\)\s*;\s*\$\w{1,40}\s*=\s*@\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\(\s*\$\w{1,40}\s*\)\s*,\s*''[^'']*''\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1712"
    name: "PHP-REX-1712"
    description: "Malware detection signature PHP-REX-1712"
    severity: critical
    category: php_backdoor
    pattern: '\*/\s*(\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*){3,}\$\w+\s*=\s*"(\\\d+){3,}";\s*((\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*){3,}|/\*)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1713"
    name: "PHP-REX-1713"
    description: "Malware detection signature PHP-REX-1713"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*explode\(\s*''\|'',(\s*base64_decode\(){3,}\s*\$\w+\s*(\)\s*)+;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1714"
    name: "PHP-REX-1714"
    description: "Malware detection signature PHP-REX-1714"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*new\s*PclZip\s*\(\s*\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}-\s*>\s*extract\s*\(\s*\)\s*==\s*\d+\s*\)\s*\{\s*die\s*\(\s*"[^"]*"\s*\.\s*\$\w{1,40}-\s*>\s*errorInfo\s*\(\s*true\s*\)\s*\)\s*;\s*\}\s*else\s*\{\s*die\s*\(\s*"[^"]*"\s*\)\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1715"
    name: "PHP-REX-1715"
    description: "Malware detection signature PHP-REX-1715"
    severity: critical
    category: php_backdoor
    pattern: '<\s*title\s*>\s*<\s*\?\s*=\$Z118_title\s*\.\s*"[^"]*"\s*\.\s*\$\w{1,40}\s*\[\s*''[^'']*''\s*\]\s*;\s*\?><\s*/title\s*>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1716"
    name: "PHP-REX-1716"
    description: "Malware detection signature PHP-REX-1716"
    severity: critical
    category: php_backdoor
    pattern: 'wget\s+https?://[^/]+/xmrig_lin64\s+-o\s+/tmp/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1717"
    name: "PHP-REX-1717"
    description: "Malware detection signature PHP-REX-1717"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+"Uploader\s+By\s+Psyco'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1718"
    name: "PHP-REX-1718"
    description: "Malware detection signature PHP-REX-1718"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+//\s+HacKerD\s+By\s+aDriv4'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1719"
    name: "PHP-REX-1719"
    description: "Malware detection signature PHP-REX-1719"
    severity: critical
    category: php_backdoor
    pattern: 'register_shutdown_function\(array\(''\w+'',''\w+''\)\);\$\w{1,40}=\$\w{1,40}\?;\}if\(!file_exists\(\$\w{1,40}\?\)\)\{@assert\(str_replace'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1720"
    name: "PHP-REX-1720"
    description: "Malware detection signature PHP-REX-1720"
    severity: critical
    category: php_backdoor
    pattern: '<title>Mister\s+Spy</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1721"
    name: "PHP-REX-1721"
    description: "Malware detection signature PHP-REX-1721"
    severity: critical
    category: php_backdoor
    pattern: 'LOGIN''\s*=>\s*\$_POST\[''login''\]\s*,\s*''ACTIVE''\s*=>\s*''Y'',\s*''GROUP_ID''\s*=>\s*array\([^)]+\),\s*''PASSWORD''\s*=>\s*\$_POST\[''pwd1''\],'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1722"
    name: "PHP-REX-1722"
    description: "Malware detection signature PHP-REX-1722"
    severity: critical
    category: php_backdoor
    pattern: 'bad_list\.txt"\s*,\s*"a"\s*\);\s*fwrite\(\$\w+,\s*\$check\."\\n"\);\s*\$\w+\s*=\s*fopen\s*\(\s*"good_list\.txt'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1723"
    name: "PHP-REX-1723"
    description: "Malware detection signature PHP-REX-1723"
    severity: critical
    category: php_backdoor
    pattern: '(\$func\d\s*=\s*strrev\(str_replace\(''[^'']+'','''',''[^'']+''\)\);\s*){3,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1724"
    name: "PHP-REX-1724"
    description: "Malware detection signature PHP-REX-1724"
    severity: critical
    category: php_backdoor
    pattern: 'user\.''/etc/''\.\$t\.''/shadow'',''ab'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1725"
    name: "PHP-REX-1725"
    description: "Malware detection signature PHP-REX-1725"
    severity: critical
    category: php_backdoor
    pattern: '\$htaccess\s*=\s*"https://pastebin\.com/raw/\w+";\s*\$file\s*=\s*file_get_contents\(\$htaccess'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1726"
    name: "PHP-REX-1726"
    description: "Malware detection signature PHP-REX-1726"
    severity: critical
    category: php_backdoor
    pattern: '<br>\[\+\]\s*Uname:''\.php_uname\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1727"
    name: "PHP-REX-1727"
    description: "Malware detection signature PHP-REX-1727"
    severity: critical
    category: php_backdoor
    pattern: 'urltoredirect\s*=\s*\$new_request->request\("http://"\s*\.\s*\$servurl\s*\.\s*"\?clientid="\.urlencode\(\$clientid\)\."&ineednewurltoredirect'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1728"
    name: "PHP-REX-1728"
    description: "Malware detection signature PHP-REX-1728"
    severity: critical
    category: php_backdoor
    pattern: '\$cachetime\s*=\s*\d+;\s*if\s*\(\(file_exists\(\$target\)\)\s*&&\s*\(time\(\)\s*-\s*\$cachetime\)\s*>\s*filemtime\(\$target\)\)\s*\{\s*\$string\s*=\s*file_get_contents'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1729"
    name: "PHP-REX-1729"
    description: "Malware detection signature PHP-REX-1729"
    severity: critical
    category: php_backdoor
    pattern: '\$engines\)\s*\{\s*if\s*\(preg_match\(\s*"/\$engines/"\s*,\s*\$_SERVER\[\s*''HTTP_USER_AGENT''\s*\]\s*\)\s*\)\s*echo\s*file_get_contents\(\$target'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1730"
    name: "PHP-REX-1730"
    description: "Malware detection signature PHP-REX-1730"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*is_bitch\(\s*\$_SERVER'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1731"
    name: "PHP-REX-1731"
    description: "Malware detection signature PHP-REX-1731"
    severity: critical
    category: php_backdoor
    pattern: 'SCAM\s+PAYPAL\s+V.{10,100}SHADOW\s+Z118'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1733"
    name: "PHP-REX-1733"
    description: "Malware detection signature PHP-REX-1733"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo\s*''RxR\s+HaCkEr'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1734"
    name: "PHP-REX-1734"
    description: "Malware detection signature PHP-REX-1734"
    severity: critical
    category: php_backdoor
    pattern: '\$file\s*=\s*\$exec_path\.\$drop_name;\s*drop_file\(\$file\s*,\s*\$\w{1,40}\);\s*\}\s*@chmod\(\$file\s*,\s*0777\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1735"
    name: "PHP-REX-1735"
    description: "Malware detection signature PHP-REX-1735"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\(\$path\s*,\s*\$this->get_backdoor_code'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1736"
    name: "PHP-REX-1736"
    description: "Malware detection signature PHP-REX-1736"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$auth_pass=''.{32}'';preg_replace\("/\.\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1737"
    name: "PHP-REX-1737"
    description: "Malware detection signature PHP-REX-1737"
    severity: critical
    category: php_backdoor
    pattern: 'ccc=str_rot13\(gzinflate\(base64_decode\(\$code_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1738"
    name: "PHP-REX-1738"
    description: "Malware detection signature PHP-REX-1738"
    severity: critical
    category: php_backdoor
    pattern: 'HacKerD By aDriv4'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1739"
    name: "PHP-REX-1739"
    description: "Malware detection signature PHP-REX-1739"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\$c_=''[^'']+'';\$c0=''[^'']+'';\$c1=''[^'']+'';\$c2='''
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1740"
    name: "PHP-REX-1740"
    description: "Malware detection signature PHP-REX-1740"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\$_POST\[''success''\]\s*==\s*\$msg\[''delScript''\]\)\s*@unlink\(__FILE__\);\s*LocalRedirect'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1741"
    name: "PHP-REX-1741"
    description: "Malware detection signature PHP-REX-1741"
    severity: critical
    category: php_backdoor
    pattern: 'else{file_put_contents\(\$c9\.''/\.htaccess'',file_get_contents'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1742"
    name: "PHP-REX-1742"
    description: "Malware detection signature PHP-REX-1742"
    severity: critical
    category: php_backdoor
    pattern: '<TITLE>Backdoor shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1743"
    name: "PHP-REX-1743"
    description: "Malware detection signature PHP-REX-1743"
    severity: critical
    category: php_backdoor
    pattern: 'sh\s+-c\s+\./cnrig\s+-a\s+cryptonight\s+-o'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1745"
    name: "PHP-REX-1745"
    description: "Malware detection signature PHP-REX-1745"
    severity: critical
    category: php_backdoor
    pattern: '\Amy \$\w{1,40};\$\w{1,40}.=\$_\s*while\(<DATA>\);\s*eval\(unpack\(''u\*''\s*,\s*\$\w{1,40}\)\);\s*__DATA__'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1746"
    name: "PHP-REX-1746"
    description: "Malware detection signature PHP-REX-1746"
    severity: critical
    category: php_backdoor
    pattern: 'port_c="I2luY2x1ZGUgPHN0ZGlvLm'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1747"
    name: "PHP-REX-1747"
    description: "Malware detection signature PHP-REX-1747"
    severity: critical
    category: php_backdoor
    pattern: 'HTTP_HOST"\)\.'' - FaTaL Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1749"
    name: "PHP-REX-1749"
    description: "Malware detection signature PHP-REX-1749"
    severity: critical
    category: php_backdoor
    pattern: '<title>ex0shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1750"
    name: "PHP-REX-1750"
    description: "Malware detection signature PHP-REX-1750"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+DxFiles_UploadHere'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1751"
    name: "PHP-REX-1751"
    description: "Malware detection signature PHP-REX-1751"
    severity: critical
    category: php_backdoor
    pattern: 'feshow="shell_exec"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1752"
    name: "PHP-REX-1752"
    description: "Malware detection signature PHP-REX-1752"
    severity: critical
    category: php_backdoor
    pattern: '<title>Dive\s+Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1753"
    name: "PHP-REX-1753"
    description: "Malware detection signature PHP-REX-1753"
    severity: critical
    category: php_backdoor
    pattern: 'made_by="Bl0od3r";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1754"
    name: "PHP-REX-1754"
    description: "Malware detection signature PHP-REX-1754"
    severity: critical
    category: php_backdoor
    pattern: '<center>\.:Cyber Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1755"
    name: "PHP-REX-1755"
    description: "Malware detection signature PHP-REX-1755"
    severity: critical
    category: php_backdoor
    pattern: 'array\("find all suid files'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1756"
    name: "PHP-REX-1756"
    description: "Malware detection signature PHP-REX-1756"
    severity: critical
    category: php_backdoor
    pattern: ':: 3FEShell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1757"
    name: "PHP-REX-1757"
    description: "Malware detection signature PHP-REX-1757"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*getenv\("REMOTE_ADDR"\);\s*include\s*''antibots\.php'';\s*\$message\s*\.=\s*"--'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1758"
    name: "PHP-REX-1758"
    description: "Malware detection signature PHP-REX-1758"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*\$adddate=date\("D M d, Y g:i a"\);\s*\$ip\s*=\s*getenv\("REMOTE_ADDR"\);\s*\$country\s*=\s*visitor_country\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1759"
    name: "PHP-REX-1759"
    description: "Malware detection signature PHP-REX-1759"
    severity: critical
    category: php_backdoor
    pattern: '\$login\s*=\s*\$_SESSION\[''clientemail''\];\s*\$passwd\s*=\s*\$_POST\[''passwd''\];\s*\$own\s*='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1761"
    name: "PHP-REX-1761"
    description: "Malware detection signature PHP-REX-1761"
    severity: critical
    category: php_backdoor
    pattern: '<option value="cat /etc/passwd">'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1762"
    name: "PHP-REX-1762"
    description: "Malware detection signature PHP-REX-1762"
    severity: critical
    category: php_backdoor
    pattern: 'mailto:''>P0Uy@_\$3r\/3R'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1763"
    name: "PHP-REX-1763"
    description: "Malware detection signature PHP-REX-1763"
    severity: critical
    category: php_backdoor
    pattern: 'mydir->close\(\);\s*@chmod\("\$deldir",0777\);\s*echo\s+@rmdir\(\$deldir\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1764"
    name: "PHP-REX-1764"
    description: "Malware detection signature PHP-REX-1764"
    severity: critical
    category: php_backdoor
    pattern: '<b>\.::\[Shell functions\]::\.</b>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1765"
    name: "PHP-REX-1765"
    description: "Malware detection signature PHP-REX-1765"
    severity: critical
    category: php_backdoor
    pattern: 'create_symlink'':\s*if\s*\(!empty\(\$_POST\[''destination''\]\)\)\s*\{\s*\$dest\s*=\s*relative2absolute\(\$_POST'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1766"
    name: "PHP-REX-1766"
    description: "Malware detection signature PHP-REX-1766"
    severity: critical
    category: php_backdoor
    pattern: '\$file\s*=\s*"N-Cool-\$date\.sql\.gz";\s*\$gzip\s*=\s*TRUE;\s*\$silent\s*=\s*TRUE;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1767"
    name: "PHP-REX-1767"
    description: "Malware detection signature PHP-REX-1767"
    severity: critical
    category: php_backdoor
    pattern: '\$s_pass\s*=\s*"\w{32}";\s*//\s*password\s*\(.{1,100}\)\s*eval\("\?>"\.gzinflate\(base64_decode\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1769"
    name: "PHP-REX-1769"
    description: "Malware detection signature PHP-REX-1769"
    severity: critical
    category: php_backdoor
    pattern: '<head>\s*<title>azrail\s+1\.'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1770"
    name: "PHP-REX-1770"
    description: "Malware detection signature PHP-REX-1770"
    severity: critical
    category: php_backdoor
    pattern: 'fold in folder\.SubFolders ''-->FOLDERz'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1771"
    name: "PHP-REX-1771"
    description: "Malware detection signature PHP-REX-1771"
    severity: critical
    category: php_backdoor
    pattern: '\.Visible=true;\s*Bin_H2_Title\.InnerText="File Manager'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1772"
    name: "PHP-REX-1772"
    description: "Malware detection signature PHP-REX-1772"
    severity: critical
    category: php_backdoor
    pattern: 'HTTP_HOST"\)\.''\s*-\s*Antichat\s*Shell</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1773"
    name: "PHP-REX-1773"
    description: "Malware detection signature PHP-REX-1773"
    severity: critical
    category: php_backdoor
    pattern: 'case\s*''exesys'':\s*\$content\s*\.=\s*\$shell->exesysform\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1774"
    name: "PHP-REX-1774"
    description: "Malware detection signature PHP-REX-1774"
    severity: critical
    category: php_backdoor
    pattern: 'elseif\(strtolower\(\$cmd\)\s*==\s*"etcpasswdfile"\)\s*\{\s*\$pw\s*=\s*file\(''/etc/passwd/''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1775"
    name: "PHP-REX-1775"
    description: "Malware detection signature PHP-REX-1775"
    severity: critical
    category: php_backdoor
    pattern: 'curl_setopt\(\$ch\s*,\s*CURLOPT_URL\s*,\s*"file:file:///'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1776"
    name: "PHP-REX-1776"
    description: "Malware detection signature PHP-REX-1776"
    severity: critical
    category: php_backdoor
    pattern: 'fm_redirect\(\s*FM_SELF_URL\s*\.\s*''\?p=''\s*\.\s*urlencode\(FM_PATH\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1777"
    name: "PHP-REX-1777"
    description: "Malware detection signature PHP-REX-1777"
    severity: critical
    category: php_backdoor
    pattern: 'RxR\s+HaCkEr\s*<\?\s*\$cwd'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1779"
    name: "PHP-REX-1779"
    description: "Malware detection signature PHP-REX-1779"
    severity: critical
    category: php_backdoor
    pattern: 'div\s+id="content"><textarea\s+rows="20%"\s+cols="50%">\\''\.\$[O0_]{5,20}\.\\''</textarea'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1780"
    name: "PHP-REX-1780"
    description: "Malware detection signature PHP-REX-1780"
    severity: critical
    category: php_backdoor
    pattern: ';set_time_limit\(0\);array_walk\(\$_COOKIE,"enumerator"\);array_walk\(\$_POST,"enumerator"\);function enumerator\(\$value,\$key\)\{\$\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1781"
    name: "PHP-REX-1781"
    description: "Malware detection signature PHP-REX-1781"
    severity: critical
    category: php_backdoor
    pattern: ',CURLOPT_USERAGENT,\''WHR\''\);\$\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1782"
    name: "PHP-REX-1782"
    description: "Malware detection signature PHP-REX-1782"
    severity: critical
    category: php_backdoor
    pattern: 'putincache\(\$urlhash\."::::"\.codedata'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1783"
    name: "PHP-REX-1783"
    description: "Malware detection signature PHP-REX-1783"
    severity: critical
    category: php_backdoor
    pattern: ';\$\w{1,40}=''[^'']+''\^''[^'']+'';\w{1,40};'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1784"
    name: "PHP-REX-1784"
    description: "Malware detection signature PHP-REX-1784"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$\w{1,40}\(\s*null\s*\.\s*\$\w{1,40}\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1785"
    name: "PHP-REX-1785"
    description: "Malware detection signature PHP-REX-1785"
    severity: critical
    category: php_backdoor
    pattern: 'function check_commands\s*\(\)\s*\{\s*if\s*\(\s*array_key_exists\s*\(\s*''delete''\s*,\s*\$_REQUEST\s*\)\s*\)\s*\{\s*unlink\(\s*__FILE__\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1787"
    name: "PHP-REX-1787"
    description: "Malware detection signature PHP-REX-1787"
    severity: critical
    category: php_backdoor
    pattern: '<title>W3LL\s+M!N!\s+SH3LL</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1788"
    name: "PHP-REX-1788"
    description: "Malware detection signature PHP-REX-1788"
    severity: critical
    category: php_backdoor
    pattern: '<\s*meta\s*http-equiv\s*="[^"]*"\s*content\s*="[^"]*"\s*/\s*>\s*<\s*title\s*>\s*\#[a-z]+\#\s*<\s*/title\s*>\s*<\s*meta\s*name\s*="keywords"\s*content\s*="\#[a-z]+\#"\s*/\s*>\s*<\s*meta\s*name\s*="description"\s*content\s*="\#[a-z]+\#"\s*/\s*>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1789"
    name: "PHP-REX-1789"
    description: "Malware detection signature PHP-REX-1789"
    severity: critical
    category: php_backdoor
    pattern: 'chdir\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=\s*get_rand_touch\s*\(\s*\)\s*;\s*writeTo\s*\(\s*\$\w{1,40}\s*,\s*base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*,\s*false\s*\)\s*;\s*touch\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1790"
    name: "PHP-REX-1790"
    description: "Malware detection signature PHP-REX-1790"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*;\s*if\s*\(\s*in_array\s*\(\s*"wp-config\.php"\s*,\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*file_put_contents\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1791"
    name: "PHP-REX-1791"
    description: "Malware detection signature PHP-REX-1791"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s/\*\s*--\s*enphp.+}\{\d+\}\(E_ALL\^E_NOTICE\);\$_SERVER{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1792"
    name: "PHP-REX-1792"
    description: "Malware detection signature PHP-REX-1792"
    severity: critical
    category: php_backdoor
    pattern: 'global\s*\$\w{1,40}\s*;\s*if\s*\(\s*!isset\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\$\w{1,40}\s*=\s*new\s*dolly_plugin\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1793"
    name: "PHP-REX-1793"
    description: "Malware detection signature PHP-REX-1793"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+mail\(\$to,\$them,\$mss,\$head\)\?_\d+\(\d+\):_\d+\(\d+\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1794"
    name: "PHP-REX-1794"
    description: "Malware detection signature PHP-REX-1794"
    severity: critical
    category: php_backdoor
    pattern: '}\s*=\s*@unserialize\(\s*sh_decrypt\(\s*@base64_decode\(\s*\${\s*\$\w+\s*}\)\s*,\s*\${\s*\${\s*"[^"]+"\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1795"
    name: "PHP-REX-1795"
    description: "Malware detection signature PHP-REX-1795"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!class_exists\s*\(\s*''[^'']*''\s*,\s*false\s*\)\s*\)\s*:\s*class\s*bb_pres\d+\s*\{\s*public\s*static\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*public\s*static\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;.+data:text/javascript;base64'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1796"
    name: "PHP-REX-1796"
    description: "Malware detection signature PHP-REX-1796"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*Array\(\s*[^;]+;\s*\$\w+\[chr\(\s*\d+\s*\)\s*]\(bd\(\s*[''"][^''"]+[''"]\s*\)\s*\);\s*\$\w+\[\s*chr\(\s*\d+\s*\)\s*\]\(\s*\w+\(\s*[''"][^''"]+[''"]\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1797"
    name: "PHP-REX-1797"
    description: "Malware detection signature PHP-REX-1797"
    severity: critical
    category: php_backdoor
    pattern: 'class\s+bb_press2.+?const\s*SCRIPT_SRC\s*=\s*''data:text/javascript;base64,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1798"
    name: "PHP-REX-1798"
    description: "Malware detection signature PHP-REX-1798"
    severity: critical
    category: php_backdoor
    pattern: '<\?(php)?\s*\$auth_pass\s*=\s*"[^"]*";\s*\$GLOBALS\[''_\d+_''\]=Array\(base64_decode\([''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1799"
    name: "PHP-REX-1799"
    description: "Malware detection signature PHP-REX-1799"
    severity: critical
    category: php_backdoor
    pattern: '\#!/usr/bin/perl\s+-w\s*my\s+\$Password="\w+";\s*\$\w+\s*=\s*[''"](\d+;)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1800"
    name: "PHP-REX-1800"
    description: "Malware detection signature PHP-REX-1800"
    severity: critical
    category: php_backdoor
    pattern: '<title>(cPanel\s+)?Turbo\s+Force'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1801"
    name: "PHP-REX-1801"
    description: "Malware detection signature PHP-REX-1801"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*@?getcwd\s*\(\s*\)\s*;\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*@chdir\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*\$\w{1,40}\s*=\s*@?getcwd\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1802"
    name: "PHP-REX-1802"
    description: "Malware detection signature PHP-REX-1802"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*===\s*true\s*\)\s*\{\s*Check\s*\(\s*\)\s*;\s*exit\s*;\s*\}\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*===\s*true\s*\)\s*\{\s*Send\s*\(\s*\)\s*;\s*exit\s*;\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1803"
    name: "PHP-REX-1803"
    description: "Malware detection signature PHP-REX-1803"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*="[^"]*"\s*;\s*echo\s*\$\w{1,40}\s*;\s*exit\s*\(\s*\)\s*;\s*\}\s*\$\w{1,40}\s*=\$\w{1,40}\s*;\s*\$\w{1,40}\s*=\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*"[^"]*"\s*\]\s*\)\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1804"
    name: "PHP-REX-1804"
    description: "Malware detection signature PHP-REX-1804"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[''Alfa_Protect_Shell''\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1805"
    name: "PHP-REX-1805"
    description: "Malware detection signature PHP-REX-1805"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*/\*\s*WSO\s*\[\s*2\s*\.\s*\d+\s*\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1806"
    name: "PHP-REX-1806"
    description: "Malware detection signature PHP-REX-1806"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,20}\s*=\s*\$\w{1,20}\s*\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\s*\[\s*\$\w{1,20}\s*\]\s*\)\s*;\s*@?eval\s*\(\s*\$\w{1,20}\s*\)\s*;\s*\}\s*else\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1807"
    name: "PHP-REX-1807"
    description: "Malware detection signature PHP-REX-1807"
    severity: critical
    category: php_backdoor
    pattern: 'preg_split\("//",\$\w+,-1,PREG_SPLIT_NO_EMPTY\);\$\w+=implode\("",array_reverse\(\$\w+\)\);};\$\w+=__FILE__;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1809"
    name: "PHP-REX-1809"
    description: "Malware detection signature PHP-REX-1809"
    severity: critical
    category: php_backdoor
    pattern: '\$code\s*=\s*''\s*<\?php\s*\$user_agent_to_filter = array\( \\''\#Ask\\s\*Jeeves'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1810"
    name: "PHP-REX-1810"
    description: "Malware detection signature PHP-REX-1810"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*[''"]\w{32}[''"];\s*\$\w+\s*=\s*[''"]\#df5[''"];\s*\$\w+\s*=\s*[''"]FilesMan[''"];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1811"
    name: "PHP-REX-1811"
    description: "Malware detection signature PHP-REX-1811"
    severity: critical
    category: php_backdoor
    pattern: 'chr\(\d+\)[^/]+?@\$\w{1,30}\(\s*@\$\w{1,30}\(\s*[''"][^\)]{1000,}\)\)\)?;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1812"
    name: "PHP-REX-1812"
    description: "Malware detection signature PHP-REX-1812"
    severity: critical
    category: php_backdoor
    pattern: '\$wpautop\s*=\s*pre_term_name\(\s*\$wp_kses_data\s*,\s*\$wp_nonce\s*\);.*\$shortcode_unautop\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1813"
    name: "PHP-REX-1813"
    description: "Malware detection signature PHP-REX-1813"
    severity: critical
    category: php_backdoor
    pattern: 'function arr2html\(\$array,\s*&\$arr\s*=\s*''\s*'',\$ztabhtml='''',\$zheaderarray=''''\)\s*{\s*\$array\s*=\s*"as"\s*\.\s*\$_REQUEST\[''array''\];\s*\$sort\s*=\s*array\(\$_REQUEST\[''sort''\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1815"
    name: "PHP-REX-1815"
    description: "Malware detection signature PHP-REX-1815"
    severity: critical
    category: php_backdoor
    pattern: '";\s*eval\s*/\*[^*]+\*/\s*\(\w{1,30}\s*\(\s*\$\w{1,30}\s*,\s*\$\w{1,30}\s*\)\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1816"
    name: "PHP-REX-1816"
    description: "Malware detection signature PHP-REX-1816"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,30}\s*=\s*str_ireplace\(\s*"\w{1,30}"\s*,\s*""\s*,\s*"[^"]+"\s*\);\s*\$\w{1,30}\s*=\s*"[^"]+"\s*;\s*function\s+\w{1,30}\(\s*\$errno\s*,\s*\$errstr\s*,\s*\$errfile\s*,\s*\$errline\s*\)\s*{\s*array_map\(\s*create_function\s*\(\s*''''\s*,\s*\$errstr\)\s*,\s*array\s*\(\s*''''\s*\)\s*\);\s*}\s*set_error_handler\(\s*''\w{1,30}''\s*\);\s*\$\w{1,30}\s*=\s*\$\w{1,30}\(\s*\$\w{1,30}\s*\)\s*;\s*(user|trigger)_error\(\s*\$\w{1,30}\s*,\s*E_USER_ERROR\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1817"
    name: "PHP-REX-1817"
    description: "Malware detection signature PHP-REX-1817"
    severity: critical
    category: php_backdoor
    pattern: 'case\s*["'']update["'']\s*:\s*if\s*\(\s*file_put_contents\s*\(\s*__FILE__\s*,\s* base64_decode\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*[''"]\w+[''"]\s*\]\s*\)\s*\)\s*\)\s*echo\s*[''"]OK[''"];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1818"
    name: "PHP-REX-1818"
    description: "Malware detection signature PHP-REX-1818"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\(\$\w+\(\$\w+\(\$\w+\(\$\w+\)\)\)\);\s*/\*\s*GNU\s+GENERAL\s+PUBLIC\s+LICENSE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1819"
    name: "PHP-REX-1819"
    description: "Malware detection signature PHP-REX-1819"
    severity: critical
    category: php_backdoor
    pattern: 'mail\(\$_POST\[''email''\]\s*,\s*\$_POST\[''subject''\]\s*,\s*\$_POST\[''content''\]\s*,\s*\$headers\);\s*}\s*\?>\s*<title>BOOM</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1820"
    name: "PHP-REX-1820"
    description: "Malware detection signature PHP-REX-1820"
    severity: critical
    category: php_backdoor
    pattern: 'if\(mail\(\$_POST\[''email''\], \$_POST\[''subject''\], \$_POST\[''content''\], \$headers\)\) {\s*echo "Bravo!";\s*}\s*else\s*{\s*echo "Failed to send email\.";\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1821"
    name: "PHP-REX-1821"
    description: "Malware detection signature PHP-REX-1821"
    severity: critical
    category: php_backdoor
    pattern: 'mail\(\$_POST\[''email''\]\s*,\s*\$_POST\[''subject''\]\s*,\s*\$_POST\[''content''\]\s*,\s*\$headers\);\s*echo "Bravo!";\s*}\s*\?>\s*<title>BOOM</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1822"
    name: "PHP-REX-1822"
    description: "Malware detection signature PHP-REX-1822"
    severity: critical
    category: php_backdoor
    pattern: '\$leaf\[''version''\]="2\.7";\s*\$leaf\[''website''\]="leafmailer\.pw";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1823"
    name: "PHP-REX-1823"
    description: "Malware detection signature PHP-REX-1823"
    severity: critical
    category: php_backdoor
    pattern: 'if\(PLATFORM\s*==\s*WORDPRESS\)\s*{\s*if\(strpos\(\$file\s*,\s*''wp-content''\)\s*===\s*false\s*&&\s*strpos\(\$file\s*,\s*''wp-admin''\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1824"
    name: "PHP-REX-1824"
    description: "Malware detection signature PHP-REX-1824"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[''_\d+_''\]=Array\(base64_decode\(.+?\[-\] SOCKET ERROR\[fsock\]: {\$_\d+\[path\]} \[\{\$_\d+\}\] {\$_\d+}";}\$_\d+=FALSE;}}if\(\$_\d+===FALSE\){if\(\$_\d+\){print _\d+\(\d+\);}\$_\d+=FALSE;}return \$_\d+;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1825"
    name: "PHP-REX-1825"
    description: "Malware detection signature PHP-REX-1825"
    severity: critical
    category: php_backdoor
    pattern: '\$req_uri\s*=\s*''http://''\.\$req_uri\."\?req="\.urlencode\(\$full_uri\)\."&gzip="\.\$is_gzip\."&host=\$host&ip=\$ip&rip=\$reverse_ip&ua=\$ua&ref=\$ref";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1826"
    name: "PHP-REX-1826"
    description: "Malware detection signature PHP-REX-1826"
    severity: critical
    category: php_backdoor
    pattern: '<title>PHP-FILES\.ME</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1827"
    name: "PHP-REX-1827"
    description: "Malware detection signature PHP-REX-1827"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}=gzinflate\(base64_decode\(\$\w+\)\);\s*for\(\$i=0;\$i<strlen\(\$\w+\);\$i\+\+\)\s*{\s*\$\w+\[\$i\]\s*=\s*chr\(\s*ord\(\$\w+\[\$i]\)\s*-1\s*\);\s*}\s*return\s*\$\w+;\s*}\s*eval\(\w+\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1828"
    name: "PHP-REX-1828"
    description: "Malware detection signature PHP-REX-1828"
    severity: critical
    category: php_backdoor
    pattern: 'path_throwgh_files.+burlywood'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1829"
    name: "PHP-REX-1829"
    description: "Malware detection signature PHP-REX-1829"
    severity: critical
    category: php_backdoor
    pattern: '\$strFileBody=GetFileContent\(\$strUrl\);\s*\$strFileBody=str_replace'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1830"
    name: "PHP-REX-1830"
    description: "Malware detection signature PHP-REX-1830"
    severity: critical
    category: php_backdoor
    pattern: 'checksuexec\s+"\.escapeshellarg\(\$_SERVER\[''DOCUMENT_ROOT''\]\.\$_SERVER\[''REQUEST_URI''\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1831"
    name: "PHP-REX-1831"
    description: "Malware detection signature PHP-REX-1831"
    severity: critical
    category: php_backdoor
    pattern: '\$auth_pass\s*=.+;eval\("\\x65'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1832"
    name: "PHP-REX-1832"
    description: "Malware detection signature PHP-REX-1832"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\(\s*\$_(GET|POST|REQUEST|COOIE|SERVER)\[\s*"test_url"\s*\]\s*\)\s*\)\s*{\s*echo\s+"file test okay";\s*}\s*\$\w{1,10}="\w+";\s*\$\w{1,10}=''\w+'';\s*\$\w{1,10}="\w+";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1833"
    name: "PHP-REX-1833"
    description: "Malware detection signature PHP-REX-1833"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|REQUEST|SERVER)\[\s*"test_url"\s*\]\s*\)\s*\)\s*{\s*echo\s*"[^"]+";\s*}.+PCLZIP_READ_BLOCK_SIZE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1834"
    name: "PHP-REX-1834"
    description: "Malware detection signature PHP-REX-1834"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*refercheck\(\$refer\s*=\s*""\)\s*{\s*return\s*preg_match\("/\(google\.co\.jp\|yahoo\.co\.jp\|bing\)/si", \$refer\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1835"
    name: "PHP-REX-1835"
    description: "Malware detection signature PHP-REX-1835"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+WSOstripslashes\(\$array\)\s*{\s*return is_array\(\$array\)\s*\?\s*array_map\([''"]WSOstripslashes[''"]\s*,\s*\$array\)\s*:\s*stripslashes\(\$array\);\s*}\s*\$_POST\s*=\s*WSOstripslashes\(\$_POST\);\s*\$_COOKIE\s*=\s*WSOstripslashes\(\$_COOKIE\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1836"
    name: "PHP-REX-1836"
    description: "Malware detection signature PHP-REX-1836"
    severity: critical
    category: php_backdoor
    pattern: ';\s*\$default_use_ajax\s*=\s*false;\s*\$default_charset\s*=.+print\s*eval\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1837"
    name: "PHP-REX-1837"
    description: "Malware detection signature PHP-REX-1837"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+pushUploaders\(\)\s*{\s*global\s*\$uploaderStatusHandle;\s*\$data\s*=\s*readFileOpt\(CACHE_UPLOADER_DB\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1838"
    name: "PHP-REX-1838"
    description: "Malware detection signature PHP-REX-1838"
    severity: critical
    category: php_backdoor
    pattern: '<h1>"\.ucfirst\(\$key\)\."</h1><br>\s*<br>"\.\$templateimage\."<br><br>\s*"\.\$mapinpages\."\s*"\.\$pageparse\."<br>\s*"\.\$links1\."'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1839"
    name: "PHP-REX-1839"
    description: "Malware detection signature PHP-REX-1839"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+evalEndClean\(&\s*\$p\) {\s*\$t = gzuncompress\(base64_decode\(\$p\)\);\s*\$t = str_replace\(array\("<\?php",''\?>''\),'''',\$t\);\s*eval\(\$t\);\s*unset\(\$p\);unset\(\$t\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1840"
    name: "PHP-REX-1840"
    description: "Malware detection signature PHP-REX-1840"
    severity: critical
    category: php_backdoor
    pattern: '//\w{3,20}\s*function\s+request_url_data\(\$url\)\s*{\s*\$site_url\s*=.+?print\s+\$decoded;\s*}\s*}//\w{3,20}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1841"
    name: "PHP-REX-1841"
    description: "Malware detection signature PHP-REX-1841"
    severity: critical
    category: php_backdoor
    pattern: ']}=Array\("\w+"=>@phpversion\(\),"\\x\d+\\x\d+"=>"\\x\d+\.\\x\d+-1",\);echo\s*@serialize\(\${\$\w+\}\);}elseif\(\${\${'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1842"
    name: "PHP-REX-1842"
    description: "Malware detection signature PHP-REX-1842"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+__get_template\(\)\s*{\s*\$root_path\s*=\s*__get_root\(\);\s*\$tpl_path\s*=\s*\$root_path\."/SESS_\w{32}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1843"
    name: "PHP-REX-1843"
    description: "Malware detection signature PHP-REX-1843"
    severity: critical
    category: php_backdoor
    pattern: '\$map_index_sitemap_uri\s*=\s*sprintf\(''%s%ssitemap_%d\.xml''\s*,\s*\$currentUrl\s*,\s*"\$dir/"\s*,\s*\$sini\);\s*\$map_sitemap_genuri_href\s*=\s*sprintf\(\s*\$map_sitemap_genuri_link_format\s*,\s*\$currentUrl'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1844"
    name: "PHP-REX-1844"
    description: "Malware detection signature PHP-REX-1844"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(file_exists\(\s*"(\.\./)+\w+\.php\.suspected"\s*\)\s*\)\s*rename\(\s*"(\.\./)+\w+\.php\.suspected"\s*,\s*"(\.\./)+\w+\.php"\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1845"
    name: "PHP-REX-1845"
    description: "Malware detection signature PHP-REX-1845"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*is_from_search\(\$http_referer\)\s*{\s*\$flag\s*=\s*false;\s*\$http_referer_str\s*=\s*''google\.co\.jp\|yahoo\.co\.jp\|bing'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1846"
    name: "PHP-REX-1846"
    description: "Malware detection signature PHP-REX-1846"
    severity: critical
    category: php_backdoor
    pattern: '__create_initial_settings[^\#]+\#google.+?__obfuscate_write'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1847"
    name: "PHP-REX-1847"
    description: "Malware detection signature PHP-REX-1847"
    severity: critical
    category: php_backdoor
    pattern: ';eurt\s*=\s*xaja_esu_tluafed\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1848"
    name: "PHP-REX-1848"
    description: "Malware detection signature PHP-REX-1848"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*"\w+";\s*\$\w+\s*\s*\.=\s*"\w+";\s*@\$\w+\(\$\w+\(\''[a-zA-Z0-9/=+]{100,200}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1849"
    name: "PHP-REX-1849"
    description: "Malware detection signature PHP-REX-1849"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(isset\s*\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\)\s*{\s*\$\w+="Fil.+?\s*\$default_use_ajax\s*=\s*true'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1850"
    name: "PHP-REX-1850"
    description: "Malware detection signature PHP-REX-1850"
    severity: critical
    category: php_backdoor
    pattern: 'proftpd.+?eval\(\$_[GET|POST|COOKIE|REQUEST|SERVER]+\[[''"]\w+[''"]\]\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1851"
    name: "PHP-REX-1851"
    description: "Malware detection signature PHP-REX-1851"
    severity: critical
    category: php_backdoor
    pattern: 'FakeSender\s*by\s*POCT'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1852"
    name: "PHP-REX-1852"
    description: "Malware detection signature PHP-REX-1852"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}=''[^'']+''\^''[^'']+'';\s*\$\w+=''[^'']+'';\s*(\$\w+=''[^'']+''|\$\w+=\d+);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1853"
    name: "PHP-REX-1853"
    description: "Malware detection signature PHP-REX-1853"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}=@gzinflate\(\$\w+\)\){\$\w+=create_function\('''',\$\w+\);unset\(\$\w+,\$\w+\);\$\w+\(\);}}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1854"
    name: "PHP-REX-1854"
    description: "Malware detection signature PHP-REX-1854"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\$\w+=@gzinflate\(\$\w+\)\)\{if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\)@setcookie\(''\w+'', \$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);\$\w+=create_function'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1855"
    name: "PHP-REX-1855"
    description: "Malware detection signature PHP-REX-1855"
    severity: critical
    category: php_backdoor
    pattern: '}}}}if\(\$q=="this-is-the-test-of-door"\){\$page="DOORWAYISWORKTITLE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1857"
    name: "PHP-REX-1857"
    description: "Malware detection signature PHP-REX-1857"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\$_FILES\[''\w+''\]\[''name''\]\)\)\s*{\s*\$abod\s*=\s*\$filedir\.\$userfile_name;\s*@move_uploaded_file\(\$userfile_tmp,\s*\$abod\);\s*echo"<center><b>Done\s*==>\s*\$userfile_name</b></center>";\s*}\s*}\s*else{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1858"
    name: "PHP-REX-1858"
    description: "Malware detection signature PHP-REX-1858"
    severity: critical
    category: php_backdoor
    pattern: '}}else{\$\w+=@\$_SERVER\[((""|chr\(\d+\)|"\w")\.?){10,}];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1859"
    name: "PHP-REX-1859"
    description: "Malware detection signature PHP-REX-1859"
    severity: critical
    category: php_backdoor
    pattern: '\$__=hex2ascii\(\$_+\);\s*\$.="\$_+";\s*\$.=[eval\."''\s]+\(\$.\)'';\s*assert\(\$.\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1860"
    name: "PHP-REX-1860"
    description: "Malware detection signature PHP-REX-1860"
    severity: critical
    category: php_backdoor
    pattern: ''';\$\w+=str_rot13\(''fge_ebg13''\);\$\w+=\$\w+\(''onfr64_qrpbqr''\);\$\w+=\$\w+\(''[^'']+''\);eval\(\$\w+\(\$\w+\(\$\w+\(\$\w+\)\)\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1861"
    name: "PHP-REX-1861"
    description: "Malware detection signature PHP-REX-1861"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+=strrev\("edoced_46esab"\);\$\w+="[^"]+";eval\(\$\w+\(\$\w+\)\);\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1862"
    name: "PHP-REX-1862"
    description: "Malware detection signature PHP-REX-1862"
    severity: critical
    category: php_backdoor
    pattern: '<\?error_reporting\(0\);(\$\w+=(urldecode\()?\$_COOKIE\[''\w+''\]\)?;\s*){10,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1863"
    name: "PHP-REX-1863"
    description: "Malware detection signature PHP-REX-1863"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*''[assert\''\.\s]+'';\s*\$\w+\s*=\s*sprintf\(''[\!\(\)evalbase64_decode\s\.\'']+\("%s"\)\)''\s*,\s*\$\w+\);\s*\$\w+\(stripslashes\(\$\w+\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1864"
    name: "PHP-REX-1864"
    description: "Malware detection signature PHP-REX-1864"
    severity: critical
    category: php_backdoor
    pattern: '\$default_action=[FilesMan''\.]+;\s*\$color=[''\#df5\.]+;\s*\$default_use_ajax=true;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1865"
    name: "PHP-REX-1865"
    description: "Malware detection signature PHP-REX-1865"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$\w+\(\s*""\s*,\s*\$\w+\(\s*\$\w+\(\s*array\(\$\w+\{\d+\}\s*,\s*"\\n"\s*\),\s*"",\s*"[^"]+"\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1866"
    name: "PHP-REX-1866"
    description: "Malware detection signature PHP-REX-1866"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*''[\.preg_replace\'']+'';\s*\$call_user_func_array\(\s*\$\w+\s*,\s*array\(''/\[\w+\]/\w+''\s*,\s*\$_REQUEST\["\w+"\]\s*,\s*"[^"]+"\s*\)\);@\w+\(\s*\$_REQUEST\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1867"
    name: "PHP-REX-1867"
    description: "Malware detection signature PHP-REX-1867"
    severity: critical
    category: php_backdoor
    pattern: '(/\*[^\*]+\*/\$\w+=''[^'']+'';){30,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1868"
    name: "PHP-REX-1868"
    description: "Malware detection signature PHP-REX-1868"
    severity: critical
    category: php_backdoor
    pattern: '\$login="\w+";\s*\$\w+=str_rot13\("\w+"\);\s*\$\w+\s*=\s*str_rot13\(''\w+''\);\s*\$\w+="\w{32}";\s*eval\(\$mdh\(\$md\(strrev\('''
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1869"
    name: "PHP-REX-1869"
    description: "Malware detection signature PHP-REX-1869"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(0\);\s*\$\w+\s*=\s*"\w{32}";\s*\$\w+\s*=\s*basename\(__FILE__\);\s*\$\w+\s*=\s*"\w{32}";\s*if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\)\s*{if\(strlen\(\$\w+\)\s*==\s*32\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1870"
    name: "PHP-REX-1870"
    description: "Malware detection signature PHP-REX-1870"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(0\);\s*if \(!isset\(\$_COOKIE\[''\w+''\]\)\)\s*deny\(\);\s*\$cookieData'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1871"
    name: "PHP-REX-1871"
    description: "Malware detection signature PHP-REX-1871"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*Array\(\s*(''\w''\s*=>\s*''\w''\s*,?\s*){26,80}\);\s*eval(/\*[^\*]{0,40}\*)?/\(\s*\w{1,40}\(\$\w{1,40}\s*,\s*\$\w{1,40}\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1872"
    name: "PHP-REX-1872"
    description: "Malware detection signature PHP-REX-1872"
    severity: critical
    category: php_backdoor
    pattern: 'assert_options\(ASSERT_WARNING,0\);\s*\$\w+=''[0-9a-fA-F]+'';.*?chr\(hexdec.*?\$\w+=''eval\(\$\w+\)'';\s*assert\(\$\w+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1873"
    name: "PHP-REX-1873"
    description: "Malware detection signature PHP-REX-1873"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(stripslashes\(array_pop\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\)\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1874"
    name: "PHP-REX-1874"
    description: "Malware detection signature PHP-REX-1874"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w+\d+\{\d+\}\s*\.?\s*){10,}.+?\$\w+\s*=\s*\$\w+\(\s*""\s*,\s*\$\w+\(\$\w+\s*\(\s*array\(\$\w+\d+\{\d+\}\s*,\s*"\\n"\),\s*"",\s*".+?\)\s*\)\s*\);\s*\$\w+\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1875"
    name: "PHP-REX-1875"
    description: "Malware detection signature PHP-REX-1875"
    severity: critical
    category: php_backdoor
    pattern: 'php_uname()\(\)\.''<br></b>'';\s*echo\s*''<form action="" method="post" enctype="multipart/form-data" name="uploader" id="uploader">''.*?if\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''_upl''\]\s*==\s*"Upload"\s*\)\s*\{\s*if\(\@copy\(\$_FILES\[''file''\]\[''tmp_name''\],\s*\$_FILES\[''file''\]\[''name''\]\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1876"
    name: "PHP-REX-1876"
    description: "Malware detection signature PHP-REX-1876"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*\w+\(\$\w+,\$\w+,\$\w+\)\{\$\w+="base64_decode.*?curl_init.*?"/wp\\-login\\\.php.*?/\\/administrator\\//".*?phpmyadmin/i".*?define\("___NOTSELF___'',1\);.*?include_once.*?\*/\}\}\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1878"
    name: "PHP-REX-1878"
    description: "Malware detection signature PHP-REX-1878"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*1;\s*\$\w+\s*=\s*get_userdata\(\$\w+\);\s*\$\w+\s*=\s*\$\w+->\w+;\s*wp_set_current_user\(\$\w+\s*,\s*\$\w+\);\s*wp_set_auth_cookie\(\$\w+\);\s*do_action\(''wp_login''\s*,\s*\$\w+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1879"
    name: "PHP-REX-1879"
    description: "Malware detection signature PHP-REX-1879"
    severity: critical
    category: php_backdoor
    pattern: ',\$\w+\s*,\$\w+\s*\);\$\w+\s*=\$\w+\s*\(["''].+?["''],\$\w+\s*,\$\w+\s*\);\$\w+\s*=\$\w+\s*\(\$\w+\s*,\$\w+\s*\);\$\w+\s*\(\$\w+\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1880"
    name: "PHP-REX-1880"
    description: "Malware detection signature PHP-REX-1880"
    severity: critical
    category: php_backdoor
    pattern: '<font color="red">pwn pwnd owned hacked</font>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1881"
    name: "PHP-REX-1881"
    description: "Malware detection signature PHP-REX-1881"
    severity: critical
    category: php_backdoor
    pattern: 'error_reporting\(round\(\d+\)\);mb_internal_encoding\(_\w+\(\d+\)\);mb_regex_encoding\(_\w+\(\d+\)\);mb_http_output\(_\d+\(\d+\)\);mb_http_input'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1882"
    name: "PHP-REX-1882"
    description: "Malware detection signature PHP-REX-1882"
    severity: critical
    category: php_backdoor
    pattern: ';\s*eval\(\$GLOBALS\[''\w+''\]\[\d+\]\(\$GLOBALS\[''\w+''\]\[\d+\]\(\$\w+\)\)\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1883"
    name: "PHP-REX-1883"
    description: "Malware detection signature PHP-REX-1883"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(gzinflate\(base64_decode\("DZZH'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1884"
    name: "PHP-REX-1884"
    description: "Malware detection signature PHP-REX-1884"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$upload\s*&&\s*\$user\s*&&\s*wp_check_password\(\$passwd,\s*\$user->data->user_pass,\s*\$user->ID\)\s*&&\s*is_super_admin'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1885"
    name: "PHP-REX-1885"
    description: "Malware detection signature PHP-REX-1885"
    severity: critical
    category: php_backdoor
    pattern: 'touch\(dirname\(__FILE__\),\s*\$time\);\s*touch\(\$_SERVER\[''SCRIPT_FILENAME''\],\s*\$time\);\s*chmod\(\$_SERVER\[''SCRIPT_FILENAME''\],\s*0\d+\);\s*eval\(base64_decode\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1886"
    name: "PHP-REX-1886"
    description: "Malware detection signature PHP-REX-1886"
    severity: critical
    category: php_backdoor
    pattern: 'Array\((''.''=>''.''\s*,?\s*)+\);\s*eval/(\*\w+\*/)?\(\s*\w+\s*\(\s*\$\w+\s*,\s*\$\w+\s*\)\s*\);\s*\?>\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1887"
    name: "PHP-REX-1887"
    description: "Malware detection signature PHP-REX-1887"
    severity: critical
    category: php_backdoor
    pattern: '<title>Pro\s*Mailer\s*V2</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1888"
    name: "PHP-REX-1888"
    description: "Malware detection signature PHP-REX-1888"
    severity: critical
    category: php_backdoor
    pattern: '\$fullurl\s*=\s*""\s*\.\s*\$\w+\s*\.\s*"<br><p>Emails:<br><TEXTAREA.*?>"\s*\.\s*\$\w+\s*.\s*"</TEXTAREA></p><p>Engenharia:<br><TEXTAREA.*?>"\s*\.\s*\$mensagem\[\d+\]."</TEXTAREA>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1889"
    name: "PHP-REX-1889"
    description: "Malware detection signature PHP-REX-1889"
    severity: critical
    category: php_backdoor
    pattern: '<title>Hacked by NG689Skw</title><center>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1890"
    name: "PHP-REX-1890"
    description: "Malware detection signature PHP-REX-1890"
    severity: critical
    category: php_backdoor
    pattern: '\$result\s*=\s*dns_get_record\(\s*\$domain\s*\.\s*"\.multi\.uribl\.com"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1892"
    name: "PHP-REX-1892"
    description: "Malware detection signature PHP-REX-1892"
    severity: critical
    category: php_backdoor
    pattern: 'if\(smtp_mail\(\$email,\s*\$subject,\s*\$message,\s*\$Header,\s*\$from_email\)\)\s*{\s*echo\s*"good";\s*}\s*else\s*{\s*echo\s*"Some error occured";\s*}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1893"
    name: "PHP-REX-1893"
    description: "Malware detection signature PHP-REX-1893"
    severity: critical
    category: php_backdoor
    pattern: '(mail\((\$\w+,\s*\$\w+,\s*\$\w+(,\s*\$header)?\))|(stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\)\));(\s*})?)\s*if\(\$\w+\)\s*{\s*echo\s*''\w+'';\s*}\s*else\s*{\s*(echo)?\s*''\w+\s*:\s*'''
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1894"
    name: "PHP-REX-1894"
    description: "Malware detection signature PHP-REX-1894"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+\s*=\s*stripslashes\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);\s*\$\w+\s*=\s*stripslashes\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);\s*\$\w+\s*=\s*stripslashes\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\);\s*\$\w+\s*=\s*mail\(stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\)\);\s*if\(\$\w+\){echo\s*(trim\()?''\w+''\)?;}\s*else\s*{echo\s*''\w+\s*:\s*''\.\$\w+;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1895"
    name: "PHP-REX-1895"
    description: "Malware detection signature PHP-REX-1895"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$\w+\(''[^'']+''\);\s*\$\w+=\$\w+\(\$\w+\(\)\);\$\w+\(\);\s*\$\w+\(\$\w+,"\$\w+\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1896"
    name: "PHP-REX-1896"
    description: "Malware detection signature PHP-REX-1896"
    severity: critical
    category: php_backdoor
    pattern: '@move_uploaded_file.+?echo"<center><b>Done ==> \$userfile_name</b></center>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1897"
    name: "PHP-REX-1897"
    description: "Malware detection signature PHP-REX-1897"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"\]\)\)\s*\$to = \$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"\];\s*else\s*{\s*echo "404 error";\s*exit;\s*}\s*if\(\s*\$curl\s*=\s*curl_init\(\)\s*\)\s*{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1898"
    name: "PHP-REX-1898"
    description: "Malware detection signature PHP-REX-1898"
    severity: critical
    category: php_backdoor
    pattern: 'if \(!empty \(\$hostname\) \) {\s*\$output = "";\s*@exec \("nslookup\.exe -type=MX \$hostname\.", \$output\);\s*\$imx=-1;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1899"
    name: "PHP-REX-1899"
    description: "Malware detection signature PHP-REX-1899"
    severity: critical
    category: php_backdoor
    pattern: '<?php\s*(\$\w+\s*=\s*stripslashes\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["\w+"\]\);\s*){3,}\$result\s+=\s+mail\(stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\)\);\s*if\(\$result\){echo ''thank you'';}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1900"
    name: "PHP-REX-1900"
    description: "Malware detection signature PHP-REX-1900"
    severity: critical
    category: php_backdoor
    pattern: '\$result\s*=\s*mail\(stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\)\);\s*if\(\$result\){\s*echo\s*''\w+'';\s*}else{\s*echo\s*''\w+\s*:\s*''\s*\.\s*\$result;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1901"
    name: "PHP-REX-1901"
    description: "Malware detection signature PHP-REX-1901"
    severity: critical
    category: php_backdoor
    pattern: '\$message\s*=\s*stripslashes\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["body"\]\);\s*set_time_limit\s*\(\d+\);\s*@ignore_user_abort\s*\(true\);\s*\$to_ar = explode\('','',\s*\$to\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1902"
    name: "PHP-REX-1902"
    description: "Malware detection signature PHP-REX-1902"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\$vas\){echo\s*''lessloss'';}else{echo\s*''cramdam\s*:\s*''.\$v'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1903"
    name: "PHP-REX-1903"
    description: "Malware detection signature PHP-REX-1903"
    severity: critical
    category: php_backdoor
    pattern: 'else\s*{\s*\$result\s*=\s*mail\(stripslashes\(\$to\)\s*,\s*stripslashes\(\$subject\)\s*,\s*stripslashes\(\$message\)\);\s*}\s*if\(\$result\){echo\s*''good'';}else{echo\s*''error\s*:\s*''\.\$result;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1904"
    name: "PHP-REX-1904"
    description: "Malware detection signature PHP-REX-1904"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+mb_http_input\("iso-8859-1"\);.*?B L E S S E D S I N N E R .*?<\/DIV>.+<\/div>.+?<\/form>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1905"
    name: "PHP-REX-1905"
    description: "Malware detection signature PHP-REX-1905"
    severity: critical
    category: php_backdoor
    pattern: 'echo "<html><head>.*?Safe mode:</span>.*?\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\''\w+\''\]\s*===\s*\''uploadFile\''\).*?echo \"</body><\/html>\";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1906"
    name: "PHP-REX-1906"
    description: "Malware detection signature PHP-REX-1906"
    severity: critical
    category: php_backdoor
    pattern: '//PING.*?sav.php\?p=\w+&url=.*?\@ob_start\(\''obCacheStart\''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1907"
    name: "PHP-REX-1907"
    description: "Malware detection signature PHP-REX-1907"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[''\w+''\]=Array\((base64_decode\((\''[A-Za-z0-9\/\=]*\''\s*\.*)+\)\,*)+.*?\[\d+\]\(\$_\w+\),\$GLOBALS\[''\w+''\]\[\d+\]\(\$\w+\)\);}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1908"
    name: "PHP-REX-1908"
    description: "Malware detection signature PHP-REX-1908"
    severity: critical
    category: php_backdoor
    pattern: 'class PluginJoomla.+\$\w+\s*=\s*@?\$_COOKIE\[\''\w+\''\]\;\s*.*\$\w+\s*=\$\w+\(@?\$_COOKIE\[\''\w+\'']\)\;.+\$\w+\s*=\s*new\s*PluginJoomla;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1909"
    name: "PHP-REX-1909"
    description: "Malware detection signature PHP-REX-1909"
    severity: critical
    category: php_backdoor
    pattern: '\$mcdata=array\(\);\$mcdata\[0\]=base64_decode\(''[.a-zA-Z0-9_/=]+''\);array_filter\(\$mcdata, base64_decode\(''[.a-zA-Z0-9_/=]+''\)\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1910"
    name: "PHP-REX-1910"
    description: "Malware detection signature PHP-REX-1910"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\(''\w+'',''<\?php ''\.\$m\);include\(''\w+''\);\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1912"
    name: "PHP-REX-1912"
    description: "Malware detection signature PHP-REX-1912"
    severity: critical
    category: php_backdoor
    pattern: '\.(chr\(\d+\)\."[a-zA-Z0-9/\\ ]*?"\.){5,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1913"
    name: "PHP-REX-1913"
    description: "Malware detection signature PHP-REX-1913"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\${\$s\d+}\[''\w+''\]\)\)\s*{\s*eval\(\${\$s\d+}\[''\w+''\]\);\s*}\s*}elseif\(isset'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1914"
    name: "PHP-REX-1914"
    description: "Malware detection signature PHP-REX-1914"
    severity: critical
    category: php_backdoor
    pattern: 'if \(\$whattime\s*==\s*"goodtime" \|\|\s*empty\(\$settings\)\) {'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1915"
    name: "PHP-REX-1915"
    description: "Malware detection signature PHP-REX-1915"
    severity: critical
    category: php_backdoor
    pattern: '<title>Bypass\s*shell</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1916"
    name: "PHP-REX-1916"
    description: "Malware detection signature PHP-REX-1916"
    severity: critical
    category: php_backdoor
    pattern: 'if \(md5\(\$_COOKIE\[''i''\]\) == ''.{32}''\)\s*{\s*function file_download\(\$filename, \$mimetype=''application/octet-stream''\) {'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1917"
    name: "PHP-REX-1917"
    description: "Malware detection signature PHP-REX-1917"
    severity: critical
    category: php_backdoor
    pattern: '<\?php if\(md5\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["ms\-load"\]\)==".{32}"\){\s*\$p=\$_SERVER\["DOCUMENT_ROOT"\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1918"
    name: "PHP-REX-1918"
    description: "Malware detection signature PHP-REX-1918"
    severity: critical
    category: php_backdoor
    pattern: '\$a\s*=\s*[\.\sbase64decode_"]+;\s*assert\(\$a\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1919"
    name: "PHP-REX-1919"
    description: "Malware detection signature PHP-REX-1919"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[''\w+''\]\(\$\w+\[(\$\w\d+\[\d+\]\.)+\$\w\d+\[\d+\]\]\);\s*\$\w+\+\+\)\s*{\s*\$\w+\s*=\s*array\(\s*(\$\w\d+\[\d+\]\.?)+\s*=>\s*\$\w+,\s*(\$\w\d+\[\d+\]\.?)+\s*=>\s*"",'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1920"
    name: "PHP-REX-1920"
    description: "Malware detection signature PHP-REX-1920"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\){echo\s*''\w+'';\s*}\s*else\s*{\s*\(\s*\$www=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\s*&&\s*@preg_replace\(\s*''/ad/e''\s*,\s*''@''\s*\.\s*str_rot13\(\s*''riny''\s*\)\s*\.\s*''\(\s*\$www\s*\)''\s*,\s*''add''\s*\);\s*}\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1921"
    name: "PHP-REX-1921"
    description: "Malware detection signature PHP-REX-1921"
    severity: critical
    category: php_backdoor
    pattern: '"User-Agent:\s*\$template"\s*\."\|\$pathToDor"\s*\."\|\$pathOnMyHost"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1922"
    name: "PHP-REX-1922"
    description: "Malware detection signature PHP-REX-1922"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w+=([.]?chr\(\d+\)[.;])+\s*eval\(\$\w+\(\$_REQUEST\[\w+\]\)\);\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1923"
    name: "PHP-REX-1923"
    description: "Malware detection signature PHP-REX-1923"
    severity: critical
    category: php_backdoor
    pattern: '}elseif\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''eval''\]\){\s*\$qV\s*=\s*"stop_";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1924"
    name: "PHP-REX-1924"
    description: "Malware detection signature PHP-REX-1924"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\.=\$\w+\(\$\w+\(\$\w+\)&0xFF\);}eval\(\$\w+\);exit\(\);\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1925"
    name: "PHP-REX-1925"
    description: "Malware detection signature PHP-REX-1925"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w+ = (\d+|"\w+"|""|true|false);){5}\$\w+ = "base64_decode";(\$\w+ = (\d+|"\w+"|""|true|false);){5}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1926"
    name: "PHP-REX-1926"
    description: "Malware detection signature PHP-REX-1926"
    severity: critical
    category: php_backdoor
    pattern: '}exit;if\(\$GLOBALS\[''_\d+_''\]\[\d+\]\(_\d+\(\d+\),_\d+\(\d+\)\)!==false\)\$GLOBALS\[''_\d+_''\]\[\d+\]\(\$_\d+,\$_\d+\);}else{\$GLOBALS\[''_\d+_''\]\[\d+\]\(_\d+\(\d+\)\);echo _\d+\(\d+\);}exit;}\s*\?>\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1928"
    name: "PHP-REX-1928"
    description: "Malware detection signature PHP-REX-1928"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''check''\]\)\) {\s*echo "ok";\s*}\s*else\s*{\s*if\(\s*\$curl\s*=\s*curl_init\(\)\s*\)\s*{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1929"
    name: "PHP-REX-1929"
    description: "Malware detection signature PHP-REX-1929"
    severity: critical
    category: php_backdoor
    pattern: '<html>.+?<title>utf</title>.+?echo "<h1>Welcome</h1>\\n";.+touch\(\$newfile,\s*\$time\);.+</html>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1930"
    name: "PHP-REX-1930"
    description: "Malware detection signature PHP-REX-1930"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\(str_rot13\("[^"]+"\), file_get_contents\(str_rot13\("uggc://[^"]+"\)\)\);.+@\$strings\(str_rot13\(file_get_contents'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1931"
    name: "PHP-REX-1931"
    description: "Malware detection signature PHP-REX-1931"
    severity: critical
    category: php_backdoor
    pattern: '\$folder = str_replace\(\$_SERVER.+ http_build_query.+function http_parse_headers.+\$s \.= \$m\[2\]\.\$m\[3\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1932"
    name: "PHP-REX-1932"
    description: "Malware detection signature PHP-REX-1932"
    severity: critical
    category: php_backdoor
    pattern: 'GLOBALS\[''_\d+_''\]\[1\]\(\$_REQUEST,\$_1\);\$_1=\$GLOBALS\[''_\d+_''\]\[\d+\]\(\);while\(round\([^\)]+\)-round\([^\)]+\)\)\$GLOBALS\[''_\d+_''\]\[\d+]\(\$_REQUEST,\$_REQUEST\);.+echo \$_\d+;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1933"
    name: "PHP-REX-1933"
    description: "Malware detection signature PHP-REX-1933"
    severity: critical
    category: php_backdoor
    pattern: 'riny\(tmhapbzcerff\(onfr64_qrpbqr\('''
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1934"
    name: "PHP-REX-1934"
    description: "Malware detection signature PHP-REX-1934"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(0\);\s*ignore_user_abort\(true\);\s*set_time_limit\(0\);\s*function str_1replace\(\$needle'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1935"
    name: "PHP-REX-1935"
    description: "Malware detection signature PHP-REX-1935"
    severity: critical
    category: php_backdoor
    pattern: 'if \(strpos\(\$check_result,''BLOCK''\) !== false \|\| strpos\(\$check_result,''FOUND''\) !== false \|\| strpos'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1936"
    name: "PHP-REX-1936"
    description: "Malware detection signature PHP-REX-1936"
    severity: critical
    category: php_backdoor
    pattern: '\$wp_enc_file\s*=\s*''<\?php eval\("\?>"\s*\.\s*base64_decode\("''\.\$wp_code\.''"\)\);\s*\?>'';'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1937"
    name: "PHP-REX-1937"
    description: "Malware detection signature PHP-REX-1937"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*\$lin=\$_(GET|POST|COOKIE|SERVER|REQUEST)\["link"\];\s*switch \(\$lin\) {'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1938"
    name: "PHP-REX-1938"
    description: "Malware detection signature PHP-REX-1938"
    severity: critical
    category: php_backdoor
    pattern: '\$return = smtpmail\(\$smtp_host, \$smtp_port, \$smtp_login, \$smtp_passw, \$email_polucha, \$telo_pisma, \$headers\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1939"
    name: "PHP-REX-1939"
    description: "Malware detection signature PHP-REX-1939"
    severity: critical
    category: php_backdoor
    pattern: '\$file_path = dirname\(__FILE__\) \. ''/'' \. basename\(\$_FILES\["file"\]\["name"\]\);\s*move_uploaded_file\(\$_FILES\["file"\]\["tmp_name"\], \$file_path\);\s*\$file_name = basename\(\$file_path\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1940"
    name: "PHP-REX-1940"
    description: "Malware detection signature PHP-REX-1940"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(\s*empty\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*''ineedthispage''\s*\]\s*\)\s*\)\s*{\s*ini_set\(\s*''display_errors''\s*,\s*"Off"\s*\)\s*;\s*ignore_user_abort\(1\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1941"
    name: "PHP-REX-1941"
    description: "Malware detection signature PHP-REX-1941"
    severity: critical
    category: php_backdoor
    pattern: 'return\s*\$c0\[\$c_\];}\$GLOBALS\[''_\d+_''\]\[0\]\(a_\(0\),a_\(1\),a_\(2\)\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1942"
    name: "PHP-REX-1942"
    description: "Malware detection signature PHP-REX-1942"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*echo md5\(\d+\)\."<form\s*method=post\s+enctype=multipart/form-data><input type=file name=filename>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1943"
    name: "PHP-REX-1943"
    description: "Malware detection signature PHP-REX-1943"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*(\$\w+\s*=\s*stripslashes\(base64_decode\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\)\);\s*)+\$\w+\s*=\s*mail\(stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\),\s*stripslashes\(\$\w+\)\);\s*if.+?{echo\s*''\w+ :\s*''\s*\.\s*\$ejfkqexizs;}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1944"
    name: "PHP-REX-1944"
    description: "Malware detection signature PHP-REX-1944"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[''_\d+_''\]\[\d+\]\(\$default_charset,\$auth_pass,\$color,\$default_charset\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1945"
    name: "PHP-REX-1945"
    description: "Malware detection signature PHP-REX-1945"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$\w+=''base.+?\(\s*str_replace\(.+@?setcookie\s*\([''"]\w+[''"]\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST).+</form>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1946"
    name: "PHP-REX-1946"
    description: "Malware detection signature PHP-REX-1946"
    severity: critical
    category: php_backdoor
    pattern: '\$sess\s*=\s*md5\(\s*@\$_COOKIE\[ssid\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1947"
    name: "PHP-REX-1947"
    description: "Malware detection signature PHP-REX-1947"
    severity: critical
    category: php_backdoor
    pattern: 'class\s+PlgSystemXcalendarJoomlaBase'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1948"
    name: "PHP-REX-1948"
    description: "Malware detection signature PHP-REX-1948"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*function _\d+\(\$i\){\$\w+=Array\(.+?wso_version.+eval\(gzuncompress\(base64_decode\(.+==''\)\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1949"
    name: "PHP-REX-1949"
    description: "Malware detection signature PHP-REX-1949"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*function _\d+\(\$i\){\$\w+=Array\((''[a-zA-Z0-9/\+=]+'',?)+\);.+\$default_action=.+\)\)\)\); \?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1950"
    name: "PHP-REX-1950"
    description: "Malware detection signature PHP-REX-1950"
    severity: critical
    category: php_backdoor
    pattern: 'print\s*"<h1>\w+</h1>\\n";\s*echo "Your IP: ";\s*echo \$_SERVER\[''REMOTE_ADDR''\];.+move_uploaded_file.+touch.+</html>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1951"
    name: "PHP-REX-1951"
    description: "Malware detection signature PHP-REX-1951"
    severity: critical
    category: php_backdoor
    pattern: '<title>Sender Anonym Email :: FLoodeR :: SpameR</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1952"
    name: "PHP-REX-1952"
    description: "Malware detection signature PHP-REX-1952"
    severity: critical
    category: php_backdoor
    pattern: '\$i=strpos\(\$im,''\[UPD_CONTENT-''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1953"
    name: "PHP-REX-1953"
    description: "Malware detection signature PHP-REX-1953"
    severity: critical
    category: php_backdoor
    pattern: 'global \$\w+; \$\w+=array\(''\$\w+\[0\]=array_pop\(\$\w+\);\$\w+=\w+\(\d+,\d+\);.+create_'';if\(function_exists.+?\)\);};unset\(\$\w+\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1954"
    name: "PHP-REX-1954"
    description: "Malware detection signature PHP-REX-1954"
    severity: critical
    category: php_backdoor
    pattern: '\[3ran\]\s*\*/\s*if\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["mailto"\]\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1955"
    name: "PHP-REX-1955"
    description: "Malware detection signature PHP-REX-1955"
    severity: critical
    category: php_backdoor
    pattern: '\$sh_name = base64_decode\(\$sh_id\)\.\$sh_ver;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1956"
    name: "PHP-REX-1956"
    description: "Malware detection signature PHP-REX-1956"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$r6\s*=\s*pow\(2,6\);\s*\$stringus\s*='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1957"
    name: "PHP-REX-1957"
    description: "Malware detection signature PHP-REX-1957"
    severity: critical
    category: php_backdoor
    pattern: '@\$\w+\(''\#\#e''\s*,\s*"\\x[^"]+"\s*,\s*''''\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1958"
    name: "PHP-REX-1958"
    description: "Malware detection signature PHP-REX-1958"
    severity: critical
    category: php_backdoor
    pattern: 'charCode\(\$\w+\);\s*function charCode\(\$\w+\){\s*\$\w+\s*=\s*array\(.+?\$\w+\[\d+\];return\s+EvAl\(\$\w+\);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1960"
    name: "PHP-REX-1960"
    description: "Malware detection signature PHP-REX-1960"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\(gzinflate\(base64_decode\("DZ.+\)\)\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1961"
    name: "PHP-REX-1961"
    description: "Malware detection signature PHP-REX-1961"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(isset\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[str_rot13\(pack\("H\*",\s*"\w+"\)\)]\)\)\s*{\$_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1962"
    name: "PHP-REX-1962"
    description: "Malware detection signature PHP-REX-1962"
    severity: critical
    category: php_backdoor
    pattern: 'else\s*{\s*ClosingDelicateHolesButton\s*(\s*);\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1963"
    name: "PHP-REX-1963"
    description: "Malware detection signature PHP-REX-1963"
    severity: critical
    category: php_backdoor
    pattern: '}\s*function [a-z0-9]{10,}\(\){}\sfunction [a-z0-9]{10,}\(\){\$.+?array\(\d+,\d+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1964"
    name: "PHP-REX-1964"
    description: "Malware detection signature PHP-REX-1964"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$a\s*=\s*".+?";\s*assert\(\$a\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1965"
    name: "PHP-REX-1965"
    description: "Malware detection signature PHP-REX-1965"
    severity: critical
    category: php_backdoor
    pattern: '=Array\(".+?"=>@phpversion\(\),"sv"=>".+?",\);echo\s*@serialize\(\${\${'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1966"
    name: "PHP-REX-1966"
    description: "Malware detection signature PHP-REX-1966"
    severity: critical
    category: php_backdoor
    pattern: '=\s*\$\w+\("",\s*\$\w+\(\$\w+\("\w+",\s*"",\s*\$\w+\.\$\w+\.\$\w+\.\$\w+\)\)\);\s*\$\w+\(\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1967"
    name: "PHP-REX-1967"
    description: "Malware detection signature PHP-REX-1967"
    severity: critical
    category: php_backdoor
    pattern: '==\s*FALSE\)\s*{\s*break;\s*}\s*if\s*\(\$\w+\s*==\s*\d+ \|\|\s*\$\w+\s*===\s*\d+\s*\|\|\s*\$\w+\s*===\s*\d+\s*\)\s*{\s*\$\w+\[\$\w+\]\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1968"
    name: "PHP-REX-1968"
    description: "Malware detection signature PHP-REX-1968"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$target_urls\s*=\s*array.+?\$n\s*=\s*mt_rand\(0,count\(\$target_urls\)-1\);.+?\$rand_url;\?>\s*">\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1969"
    name: "PHP-REX-1969"
    description: "Malware detection signature PHP-REX-1969"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+Check25Port\(\)\s*{\s*\$res\s*=\s*TRUE;\s*\$s\s*=\s*socket_create\(AF_INET,\s*SOCK_STREAM,\s*SOL_TCP\);\s*if\(@socket_connect\(\$s,\s*''gmail-smtp-in'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1970"
    name: "PHP-REX-1970"
    description: "Malware detection signature PHP-REX-1970"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\w+;\$\w+\s*=\s*"\w+";\$\w+\s*=\s*true;\$\w+\s*=\s*\d+;\$\w+\s*=\s*true;\$\w+\s*=\s*false;\$\w+\s*=\s*implode'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1971"
    name: "PHP-REX-1971"
    description: "Malware detection signature PHP-REX-1971"
    severity: critical
    category: php_backdoor
    pattern: 'code'';\$vvv=\$vvv\(str_replace\("\\n"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1972"
    name: "PHP-REX-1972"
    description: "Malware detection signature PHP-REX-1972"
    severity: critical
    category: php_backdoor
    pattern: '\$imgData\s*=\s*@\$p2\(@\$p1\(\$imgData\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1973"
    name: "PHP-REX-1973"
    description: "Malware detection signature PHP-REX-1973"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*system\("wget\s+http:.+?;chmod\s+\d+\s+\w+;\./\w+"\);\s*echo\s+\$\w+;\s*system\("rm\s+\w+"\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1974"
    name: "PHP-REX-1974"
    description: "Malware detection signature PHP-REX-1974"
    severity: critical
    category: php_backdoor
    pattern: 'if \(md5\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''multipart''\]\)==\$multipart\.\$part\){'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1975"
    name: "PHP-REX-1975"
    description: "Malware detection signature PHP-REX-1975"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+eval/\*\*/\("eval\(gzinflate\(base64_decode\(.+?\)\)\);"\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1976"
    name: "PHP-REX-1976"
    description: "Malware detection signature PHP-REX-1976"
    severity: critical
    category: php_backdoor
    pattern: ';file_put_contents\(\$_7\[''.''\]\[''\w+''\],\$_\d+,FILE_APPEND\|LOCK_EX\);}if'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1977"
    name: "PHP-REX-1977"
    description: "Malware detection signature PHP-REX-1977"
    severity: critical
    category: php_backdoor
    pattern: 'define\(''ALREADY_RUN_\w*'',\s1\);.*eval'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1978"
    name: "PHP-REX-1978"
    description: "Malware detection signature PHP-REX-1978"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\(\"\\043\\056\\052\\043\\145'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1979"
    name: "PHP-REX-1979"
    description: "Malware detection signature PHP-REX-1979"
    severity: critical
    category: php_backdoor
    pattern: 'var_dump\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST),\s*\$_GET,\s*\$_COOKIE,\s*\$_FILES\);\s*\$output = ob_get_clean\(\); \$fp = fopen'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1980"
    name: "PHP-REX-1980"
    description: "Malware detection signature PHP-REX-1980"
    severity: critical
    category: php_backdoor
    pattern: 'if\(strpos\(\s*''fff''.\$file,''home''\)>0 or strpos\(''fff''\.\$file,''admin'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1981"
    name: "PHP-REX-1981"
    description: "Malware detection signature PHP-REX-1981"
    severity: critical
    category: php_backdoor
    pattern: 'chmod\(\s*dirname\(__FILE__\).+?{\$a=Array\("/\.\*/e.+?_\d+\(\d+\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1982"
    name: "PHP-REX-1982"
    description: "Malware detection signature PHP-REX-1982"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\$_FILES\[''F1l3''\]\) {move_uploaded_file.+? forbidden!''; } \?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1983"
    name: "PHP-REX-1983"
    description: "Malware detection signature PHP-REX-1983"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*check_cookie.+?android == true\)check_cookie\(\$android_redirect\);elseif \(\(\$iphone.+?\$aaa = false;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1984"
    name: "PHP-REX-1984"
    description: "Malware detection signature PHP-REX-1984"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite\(\$fp,"\\xEF\\xBB\\xBF"\.iconv\(''gbk'',''utf-8//IGNORE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1985"
    name: "PHP-REX-1985"
    description: "Malware detection signature PHP-REX-1985"
    severity: critical
    category: php_backdoor
    pattern: '<title>VaRVaRa\s*Searcher</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1986"
    name: "PHP-REX-1986"
    description: "Malware detection signature PHP-REX-1986"
    severity: critical
    category: php_backdoor
    pattern: 'if\(!empty\(\$_FILES\[''\w*''\]\[''\w*'']\)\sAND\s\(md5\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''nick''\]\)\s==\s''\w{32}''\)\)\s{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1987"
    name: "PHP-REX-1987"
    description: "Malware detection signature PHP-REX-1987"
    severity: critical
    category: php_backdoor
    pattern: '\$user_agent\s*=\s*"ConBot";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1989"
    name: "PHP-REX-1989"
    description: "Malware detection signature PHP-REX-1989"
    severity: critical
    category: php_backdoor
    pattern: 'function\s*xr\(\$text,\$key\){\$out="";for\(\$i=0;\$i'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1990"
    name: "PHP-REX-1990"
    description: "Malware detection signature PHP-REX-1990"
    severity: critical
    category: php_backdoor
    pattern: '\beval\(\s*\$_g\(\s*\$_b\(\$_r'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1991"
    name: "PHP-REX-1991"
    description: "Malware detection signature PHP-REX-1991"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+WSOsetcookie'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1992"
    name: "PHP-REX-1992"
    description: "Malware detection signature PHP-REX-1992"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+eval\(\s*eval\("\\\$_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1993"
    name: "PHP-REX-1993"
    description: "Malware detection signature PHP-REX-1993"
    severity: critical
    category: php_backdoor
    pattern: '\beval\(\s*"return\s+eval\(\\\"\$code\\\"\);"\)\s+\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1994"
    name: "PHP-REX-1994"
    description: "Malware detection signature PHP-REX-1994"
    severity: critical
    category: php_backdoor
    pattern: 'move_uploaded_file\s*/\*;\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1995"
    name: "PHP-REX-1995"
    description: "Malware detection signature PHP-REX-1995"
    severity: critical
    category: php_backdoor
    pattern: '\$k="ass"\."ert"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1996"
    name: "PHP-REX-1996"
    description: "Malware detection signature PHP-REX-1996"
    severity: critical
    category: php_backdoor
    pattern: '_POST\[\(chr\(\d+\).chr\(\d+\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1997"
    name: "PHP-REX-1997"
    description: "Malware detection signature PHP-REX-1997"
    severity: critical
    category: php_backdoor
    pattern: '\$default_charset.*=\.*\$dc\.\$dc2'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1998"
    name: "PHP-REX-1998"
    description: "Malware detection signature PHP-REX-1998"
    severity: critical
    category: php_backdoor
    pattern: 'rand_url\s*=\s*\$target_urls\[$n'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-1999"
    name: "PHP-REX-1999"
    description: "Malware detection signature PHP-REX-1999"
    severity: critical
    category: php_backdoor
    pattern: 'DIRECTORY_SEPARATOR\s*\.\s*\$[A-Za-z0-9]+;\s*if\s*\(@\$GLOBALS\[''[a-z0-9]+''\]\(\$[A-Za-z0-9]+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2000"
    name: "PHP-REX-2000"
    description: "Malware detection signature PHP-REX-2000"
    severity: critical
    category: php_backdoor
    pattern: '"\.\$[\w]{1,40}\s*;\s*\$[\w]{1,40}\((\$[\w]{1,40}\[\d+\]\s*\.?){4,}\s*,\s*\$\w{1,40}\s*,\s*"\d+"\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2001"
    name: "PHP-REX-2001"
    description: "Malware detection signature PHP-REX-2001"
    severity: critical
    category: php_backdoor
    pattern: 'disk_free_space\(\s*dirname\(__FILE__\)\) , disk_free_space'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2002"
    name: "PHP-REX-2002"
    description: "Malware detection signature PHP-REX-2002"
    severity: critical
    category: php_backdoor
    pattern: '\beval\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[pass'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2003"
    name: "PHP-REX-2003"
    description: "Malware detection signature PHP-REX-2003"
    severity: critical
    category: php_backdoor
    pattern: '\$color\s*=\s*"\#df5";'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2004"
    name: "PHP-REX-2004"
    description: "Malware detection signature PHP-REX-2004"
    severity: critical
    category: php_backdoor
    pattern: 'sprintf\s*\(\s*"%c"\s*,\s*\$\w{1,40}\s*\^\s*ord\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*\)\s*;\s*\$\w{1,40}\s*=\s*"[^"]*"\s*;\s*for'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2005"
    name: "PHP-REX-2005"
    description: "Malware detection signature PHP-REX-2005"
    severity: critical
    category: php_backdoor
    pattern: 'User-Agent: SEoDOR-Client \(pathOnMyHost-\$pathOnMyHost'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2006"
    name: "PHP-REX-2006"
    description: "Malware detection signature PHP-REX-2006"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(preg_match\("/zh-c/i", \$lang\)==false\|\|preg_match\("/zh-c/i",s\*\$lang\)==0\s*\)\s*{\s*echo\s*"<script'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2007"
    name: "PHP-REX-2007"
    description: "Malware detection signature PHP-REX-2007"
    severity: critical
    category: php_backdoor
    pattern: '<title>::\s+Priv8\s+vHost\s+Config\s+Grabber'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2008"
    name: "PHP-REX-2008"
    description: "Malware detection signature PHP-REX-2008"
    severity: critical
    category: php_backdoor
    pattern: ';lets_jump\(\$\{\$\w{1,40}},\$\{\$\w{1,40}\}\);\}\$\{\$\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2009"
    name: "PHP-REX-2009"
    description: "Malware detection signature PHP-REX-2009"
    severity: critical
    category: php_backdoor
    pattern: ';\$\{\$\w{1,40}\}\.=pack\("[^"]{1,20}?",0x00000000,0x00000000,0x00000000,strlen\(\$\{\$\{"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2010"
    name: "PHP-REX-2010"
    description: "Malware detection signature PHP-REX-2010"
    severity: critical
    category: php_backdoor
    pattern: 'register_shutdown_function\s*\(\s*''[^'']*''\s*\)\s*;\s*\}\s*\}\s*\}\s*\}\s*\$\w{1,40}\s*=\s*new\s*Ratel\s*;\s*\$\w{1,40}-\s*>\s*init\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2011"
    name: "PHP-REX-2011"
    description: "Malware detection signature PHP-REX-2011"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\(\s*mktime\s*\(\s*\)\s*-\$\w{1,40}\s*\)\s*;\s*if\s*\(\s*\$\w{1,40}\s*\|\|\s*\$\w{1,40}\s*\)\s*\{\s*return\s*array\s*\(\s*''NO''\s*,\s*\$\w{1,40}\s*,\s*implode\s*\(\s*"[^"]*"\s*,\s*\$\w{1,40}\s*\)\s*\)\s*;\s*\}\s*else\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2012"
    name: "PHP-REX-2012"
    description: "Malware detection signature PHP-REX-2012"
    severity: critical
    category: php_backdoor
    pattern: 'my\s*\$\w{1,40}\s*;\s*\$\w{1,40}\s*\.\s*=\$\w{1,40}\s*while\s*\(\s*<\s*DATA\s*>\s*\)\s*;\s*eval\s*\(\s*unpack\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2013"
    name: "PHP-REX-2013"
    description: "Malware detection signature PHP-REX-2013"
    severity: critical
    category: php_backdoor
    pattern: '\{if\(\$o\)\$o\.='';\s*'';\$o\.=\$n\.''=''\.addslashes\(\$v\);}\$h\.=''Cookie:'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2014"
    name: "PHP-REX-2014"
    description: "Malware detection signature PHP-REX-2014"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(file_exists\(\$htaccessPath\)\)\s*{\s*chmod\(\s*\$htaccessPath\s*,\s*0777\);\s*if\s*\(is_writable\(\$htaccessPath\)\)\s*{\s*\$htaccessData\s*=\s*file_get_contents\(\$htaccessPath\);\s*\$htaccessTime\s*=\s*filemtime\(\$htaccessPath\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2015"
    name: "PHP-REX-2015"
    description: "Malware detection signature PHP-REX-2015"
    severity: critical
    category: php_backdoor
    pattern: '\$expy\s*=\s*\$_POST\[''expy''\];\s*\$cvv\s*=\s*\$_POST\[''cvv''\];\s*\$ip\s*=\s*\$_SERVER\[''REMOTE_ADDR''\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2016"
    name: "PHP-REX-2016"
    description: "Malware detection signature PHP-REX-2016"
    severity: critical
    category: php_backdoor
    pattern: '\)\s*;\s*foreach\s*\(\s*\$blocked_words\s*as\s*\$word\s*\)\s*\{\s*if\s*\(\s*substr_count\s*\(\s*\$hostname\s*,\s*\$\w{1,40}\s*\)\s*>\s*0\s*\)\s*\{\s*header\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2017"
    name: "PHP-REX-2017"
    description: "Malware detection signature PHP-REX-2017"
    severity: critical
    category: php_backdoor
    pattern: '<title>Ekin0x Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2018"
    name: "PHP-REX-2018"
    description: "Malware detection signature PHP-REX-2018"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*JOkEr7\(''https://www\.paypal\.com/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2019"
    name: "PHP-REX-2019"
    description: "Malware detection signature PHP-REX-2019"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*include\s*''check_is_bot\.php''\s*;\s*if\s*\(\s*empty\s*\(\s*\$is_bot\s*\)\s*\)\s*\{\s*echo'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2020"
    name: "PHP-REX-2020"
    description: "Malware detection signature PHP-REX-2020"
    severity: critical
    category: php_backdoor
    pattern: '\$install_code\s*=\s*str_replace\s*\(\s*''{\$PASSWORD}''\s*,\s*\$install_hash\s*,\s*base64_decode\s*\(\s*\$install_code\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2021"
    name: "PHP-REX-2021"
    description: "Malware detection signature PHP-REX-2021"
    severity: critical
    category: php_backdoor
    pattern: '<title>IndoXploit</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2022"
    name: "PHP-REX-2022"
    description: "Malware detection signature PHP-REX-2022"
    severity: critical
    category: php_backdoor
    pattern: '\&nbsp\&nbsp\&nbsp\&nbsp\&nbspCant\s+Edit\s+>>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2023"
    name: "PHP-REX-2023"
    description: "Malware detection signature PHP-REX-2023"
    severity: critical
    category: php_backdoor
    pattern: '====\+\+\+Coded\s+By\s+Izladen\+\+\+==='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2024"
    name: "PHP-REX-2024"
    description: "Malware detection signature PHP-REX-2024"
    severity: critical
    category: php_backdoor
    pattern: '</script>";exit;}}}function\s+\w{1,40}\(\){\$\w{1,40}=''http://'';if\(\$_SERVER\["SERVER_PORT"\]!="80"\){\$\w{1,40}\.=\$_SERVER\["HTTP_HOST"\]\.":"\.\$_SERVER\["PHP_SELF"\];}else{\$\w{1,40}\.=\$_SERVER\["HTTP_HOST"\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2025"
    name: "PHP-REX-2025"
    description: "Malware detection signature PHP-REX-2025"
    severity: critical
    category: php_backdoor
    pattern: '}\s*if\s*\(\s*\$_POST\s*\)\s*\{\s*file_put_contents\s*\(\s*MAILER_CONFIG_FILE\s*,\s*json_encode\s*\(\s*\$\w{1,40}\s*=\s*\(\s*object\s*\)\s*\$_POST\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2027"
    name: "PHP-REX-2027"
    description: "Malware detection signature PHP-REX-2027"
    severity: critical
    category: php_backdoor
    pattern: '<b>Black\s*Space\s*Mailer\s*201'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2028"
    name: "PHP-REX-2028"
    description: "Malware detection signature PHP-REX-2028"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_GET\s*\[\s*''google''\s*\]\s*!="[^"]*"\s*\)\s*\{\s*echo\s*''[^'']*''\s*\.\s*\$_GET\s*\[\s*''google''\s*\]\s*\.\s*''[^'']*''\s*;\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2029"
    name: "PHP-REX-2029"
    description: "Malware detection signature PHP-REX-2029"
    severity: critical
    category: php_backdoor
    pattern: 'die\(file_get_contents\(\$urlSQLServerPage'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2030"
    name: "PHP-REX-2030"
    description: "Malware detection signature PHP-REX-2030"
    severity: critical
    category: php_backdoor
    pattern: '\$rcard\s*=\s*\$m->getRandcards\(\s*\$id\s*,\s*\$idsum\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2031"
    name: "PHP-REX-2031"
    description: "Malware detection signature PHP-REX-2031"
    severity: critical
    category: php_backdoor
    pattern: 'header\("\s*location:\s*ufl\.php\?id="\s*\.\s*\$first\[0\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2032"
    name: "PHP-REX-2032"
    description: "Malware detection signature PHP-REX-2032"
    severity: critical
    category: php_backdoor
    pattern: '<title>Web\s*Login\s*Service\s*-\s*University\s*of\s*Florida</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2033"
    name: "PHP-REX-2033"
    description: "Malware detection signature PHP-REX-2033"
    severity: critical
    category: php_backdoor
    pattern: '<title>Mail\s+form\s+HTML\s+v\d+[^<]+</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2034"
    name: "PHP-REX-2034"
    description: "Malware detection signature PHP-REX-2034"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*strlen\s*\(\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}\s*=''[^'']*''\s*;\s*for\s*\(\s*\$\w{1,40}\s*=\s*\d+\s*;\s*\$\w{1,40}\s*<\s*\$\w{1,40}\s*;\s*\$\w{1,40}\+\+\s*\)\s*\$\w{1,40}\s*\.\s*=\s*chr\s*\(\s*ord\s*\(\s*\$\w{1,40}\s*\[\s*\$\w{1,40}\s*\]\s*\)\s*\^\s*\$\w{1,40}\s*\)\s*;\s*eval\s*\(\s*\$\w{1,40}\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2035"
    name: "PHP-REX-2035"
    description: "Malware detection signature PHP-REX-2035"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*!isset\s*\(\s*\$_GET\s*\[\s*''.''\s*\]\s*\)\s*\)\s*exit\s*;\s*\$\w{1,40}\s*=\s*file_get_contents\s*\(\s*\$_GET\s*\[\s*''.''\s*\]\s*\)\s*;\s*echo\s*\(\s*''<pre>''\s*\)\s*;\s*echo\s*htmlspecialchars\s*\(\s*\$\w{1,40}\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2036"
    name: "PHP-REX-2036"
    description: "Malware detection signature PHP-REX-2036"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*strstr\s*\(\s*\$_SERVER\s*\[\s*''[^'']*''\s*\]\s*,\s*"[^"]*"\s*\)\s*\)\s*\{\s*echo\s*"[^"]*"\s*;\s*\}\s*foreach\s*\(\s*\$_COOKIE\s*as\s*\$\w{1,40}\s*=\s*>\s*\$\w{1,40}\s*\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2038"
    name: "PHP-REX-2038"
    description: "Malware detection signature PHP-REX-2038"
    severity: critical
    category: php_backdoor
    pattern: 'list\s*\(\s*\$tobuf\s*,\s*\$from\s*,\s*\$subject\s*,\s*\$messagefile\s*\)\s*=\s*split\s*\(\s*'':::''\s*,\s*\$conar\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2039"
    name: "PHP-REX-2039"
    description: "Malware detection signature PHP-REX-2039"
    severity: critical
    category: php_backdoor
    pattern: '\$global_version\s*=\s*array_walk\s*/\*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2040"
    name: "PHP-REX-2040"
    description: "Malware detection signature PHP-REX-2040"
    severity: critical
    category: php_backdoor
    pattern: '\\x\w\w"\]}=@?unserialize\(sh_decrypt\(@?base64_decode\(\${\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2041"
    name: "PHP-REX-2041"
    description: "Malware detection signature PHP-REX-2041"
    severity: critical
    category: php_backdoor
    pattern: '=@gzuncompress\s*\(\s*@base64_decode\s*\(\s*\$\w{1,40}\s*\)\s*\)\s*\)\s*\{\s*setcookie\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*;\s*setcookie\s*\(\s*''[^'']*''\s*,\s*\$\w{1,40}\s*\)\s*;\s*\$\w{1,40}=\s*create_function'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2042"
    name: "PHP-REX-2042"
    description: "Malware detection signature PHP-REX-2042"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*"<form\s*action\s*=\s*''"\s*\.\s*\$current\s*\.\s*"&mode=copy&src="\s*\.\s*\$src\s*\.\s*"''\s*method\s*=\s*''POST''>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2043"
    name: "PHP-REX-2043"
    description: "Malware detection signature PHP-REX-2043"
    severity: critical
    category: php_backdoor
    pattern: '\(isset\(\$_POST\[''execl''\]\)\)\s*{\s*echo\s*\$_POST\[''execl''\]\s*\.\s*''<br>''\s*;\s*echo\s*myshellexec\(\$_POST\[''execl''\]\);\s*}\s*if\s*\(isset\(\$_POST\[''pcntl_exec''\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2044"
    name: "PHP-REX-2044"
    description: "Malware detection signature PHP-REX-2044"
    severity: critical
    category: php_backdoor
    pattern: 'elseif\s*\(\s*\$current_blog\s*===\s*''active''\s*\)\s*\{\s*file_put_contents\s*\(\s*\$destination\s*,\s*\$blog_id\s*\)\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2045"
    name: "PHP-REX-2045"
    description: "Malware detection signature PHP-REX-2045"
    severity: critical
    category: php_backdoor
    pattern: ';\$this->tm_class_name_div=\$\{\$\{"\\x\w{2}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2046"
    name: "PHP-REX-2046"
    description: "Malware detection signature PHP-REX-2046"
    severity: critical
    category: php_backdoor
    pattern: '<title>Your\s*University\s*Grant\s*Information</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2047"
    name: "PHP-REX-2047"
    description: "Malware detection signature PHP-REX-2047"
    severity: critical
    category: php_backdoor
    pattern: '<HEAD><TITLE>IDBI\s*Bank\s*-'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2049"
    name: "PHP-REX-2049"
    description: "Malware detection signature PHP-REX-2049"
    severity: critical
    category: php_backdoor
    pattern: 'do_passreturn\(\$_POST\[''path''\],\$_POST\[''code''\],\$_POST\[''return''\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2050"
    name: "PHP-REX-2050"
    description: "Malware detection signature PHP-REX-2050"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*date\("D M d, Y g:i a"\);\s*\$ip\s*=\s*getenv\(\s*"REMOTE_ADDR"\s*\);\s*\$username\s*=\s*\$_POST\[\s*[''"][^"'']+[''"]\s*\];\s*\$password'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2051"
    name: "PHP-REX-2051"
    description: "Malware detection signature PHP-REX-2051"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite\(\$fp,"\\xEF\\xBB\\xBF"\.\$body'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2052"
    name: "PHP-REX-2052"
    description: "Malware detection signature PHP-REX-2052"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(\s*\$gzc\(\s*\$b64\(\s*\$r13'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2053"
    name: "PHP-REX-2053"
    description: "Malware detection signature PHP-REX-2053"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*GIF8(7|9)?\w?[^\s]{0,2}\s*[^\;]{0,80};'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2054"
    name: "PHP-REX-2054"
    description: "Malware detection signature PHP-REX-2054"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*PHP\s+Shellecho\s+offender'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2055"
    name: "PHP-REX-2055"
    description: "Malware detection signature PHP-REX-2055"
    severity: critical
    category: php_backdoor
    pattern: '\$short\s*=\s*make_bitly_url\s*\(\s*[''"]\s*https?://wps\.bank\.login\.it'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2056"
    name: "PHP-REX-2056"
    description: "Malware detection signature PHP-REX-2056"
    severity: critical
    category: php_backdoor
    pattern: 'value="<\?\s*passthru\("pwd"\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2059"
    name: "PHP-REX-2059"
    description: "Malware detection signature PHP-REX-2059"
    severity: critical
    category: php_backdoor
    pattern: '=@\$_COOKIE;\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2060"
    name: "PHP-REX-2060"
    description: "Malware detection signature PHP-REX-2060"
    severity: critical
    category: php_backdoor
    pattern: 'include(?:_once)?\s*[''"\(][^''"\(]{0,20}cssisma[^/]{0,20}/\w{1,40}\.php[''"\(];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2062"
    name: "PHP-REX-2062"
    description: "Malware detection signature PHP-REX-2062"
    severity: critical
    category: php_backdoor
    pattern: 'Popping\s*root\s*shell[^\w]{1,40}Don[^\w]t\s*forget\s*to\s*restore\s*/tmp/bak'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2064"
    name: "PHP-REX-2064"
    description: "Malware detection signature PHP-REX-2064"
    severity: critical
    category: php_backdoor
    pattern: '<meta\s+name\s*=\s*[''"]description[''"]\s*content\s*=\s*[''"]Wells\s+Fargo\s*:\s*Provider\s+of\s+banking\s*,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2065"
    name: "PHP-REX-2065"
    description: "Malware detection signature PHP-REX-2065"
    severity: critical
    category: php_backdoor
    pattern: '@ob_end_clean\(\);\s*\}\s*elseif\s*\(\s*@?is_resource\s*\(\s*\$\w{1,40}\s*=\s*@?popen\(\s*\$\w{1,40},\s*[''"]\w[^\w]?[''"]\s*\)\s*\)\s*\)\s*\{\s*\$res'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2066"
    name: "PHP-REX-2066"
    description: "Malware detection signature PHP-REX-2066"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Indoxploit'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2070"
    name: "PHP-REX-2070"
    description: "Malware detection signature PHP-REX-2070"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Andro\s*Ghost\s*69'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2071"
    name: "PHP-REX-2071"
    description: "Malware detection signature PHP-REX-2071"
    severity: critical
    category: php_backdoor
    pattern: '\$_(GET|POST|COOKIE|SERVER|REQUEST)\[.p1.\]\); else @unlink\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2073"
    name: "PHP-REX-2073"
    description: "Malware detection signature PHP-REX-2073"
    severity: critical
    category: php_backdoor
    pattern: '\beval\(\s*x\(\$x'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2074"
    name: "PHP-REX-2074"
    description: "Malware detection signature PHP-REX-2074"
    severity: critical
    category: php_backdoor
    pattern: '-\s*Process\s*Faker\s*,[^\n]{1,200}\s+Options:\s+-s\s+string\s+Fake\s+name\s+process'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2076"
    name: "PHP-REX-2076"
    description: "Malware detection signature PHP-REX-2076"
    severity: critical
    category: php_backdoor
    pattern: '/(?:\*|/)\s*PastiGanteng\s*(?:\w{1,40}\.\d+)?\s+Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2077"
    name: "PHP-REX-2077"
    description: "Malware detection signature PHP-REX-2077"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*nShell\s+\w?\d+\.\d+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2081"
    name: "PHP-REX-2081"
    description: "Malware detection signature PHP-REX-2081"
    severity: critical
    category: php_backdoor
    pattern: 'my\s+\$botshell\s*=\s*[''"][^''"]{1,60}[''"];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2083"
    name: "PHP-REX-2083"
    description: "Malware detection signature PHP-REX-2083"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*SST\s*Sheller'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2084"
    name: "PHP-REX-2084"
    description: "Malware detection signature PHP-REX-2084"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*:\s*:\s*Inbox\s*:\s*:\s*Unlimited\s*</title>\s*<\?\s*@?eval\s*\(\s*base64_decode\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2085"
    name: "PHP-REX-2085"
    description: "Malware detection signature PHP-REX-2085"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Hacked\s+by\s+(?:Dr\.SiLnT\s*HilL|your\s+HaxorsteinBD|Mo[E3]Gza|KIWIL0736|AssasinCyber)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2086"
    name: "PHP-REX-2086"
    description: "Malware detection signature PHP-REX-2086"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Blackhat\s*Code\s+Backdoor'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2087"
    name: "PHP-REX-2087"
    description: "Malware detection signature PHP-REX-2087"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\]);\s*[^\?]{200,600}Social\s*Security\s*Number\s*:\s*\$ssn'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2088"
    name: "PHP-REX-2088"
    description: "Malware detection signature PHP-REX-2088"
    severity: critical
    category: php_backdoor
    pattern: '@array_diff_ukey\(\s*@array\(\(string\)\$_REQUEST'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2089"
    name: "PHP-REX-2089"
    description: "Malware detection signature PHP-REX-2089"
    severity: critical
    category: php_backdoor
    pattern: 'return\s*RC4::Encryp'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2090"
    name: "PHP-REX-2090"
    description: "Malware detection signature PHP-REX-2090"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*GIF8\d\w?[^\s]{0,2}\s*[^\?]{0,80}\s*<\?\s*@?(?:system|exec|passthru|shell_exec|popen|eval|assert)\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2092"
    name: "PHP-REX-2092"
    description: "Malware detection signature PHP-REX-2092"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[\[]{0,1}\s*RileyWilder\s*(?:\''\s*s)?\s*Mailer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2095"
    name: "PHP-REX-2095"
    description: "Malware detection signature PHP-REX-2095"
    severity: critical
    category: php_backdoor
    pattern: '\{(\s*\$\w{1,40}\s*=\s*[''"](\.\./){1,7}[''"];){7}\s*\$\w{1,40}\s*=\s*file_get_contents\s*\(\$\w{1,40}\s*\.\s*[''"]wp-config\.php[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2096"
    name: "PHP-REX-2096"
    description: "Malware detection signature PHP-REX-2096"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*(?:Magic|MySQL|Peterson|indoxploit|CIH\.)\s*[^\?]{0,15}\s*(?:Web)?Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2099"
    name: "PHP-REX-2099"
    description: "Malware detection signature PHP-REX-2099"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*s72\s*Shell[^\w]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2100"
    name: "PHP-REX-2100"
    description: "Malware detection signature PHP-REX-2100"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Symlink(?:_|\s)\s*Sa\s+\w?\d+\.\d+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2105"
    name: "PHP-REX-2105"
    description: "Malware detection signature PHP-REX-2105"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[-:\[]{1,3}\s*GreenwooD\s*[-:\]]{1,3}\s*WinX\s+Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2107"
    name: "PHP-REX-2107"
    description: "Malware detection signature PHP-REX-2107"
    severity: critical
    category: php_backdoor
    pattern: 'copy\(\s*\$\w{1,9}\s*\.\s*\$\w{1,9}\s*,\s*\$\w{1,9}\s*\.\s*\$\w{1,9}\s*\)\s*;\s*\}\s*\}\s*function\s+system_custom\s*\(\s*\$\w{1,40}\)\s*\{\s*\$[^\\}]{1,40}\s*if\s*\([^\(]{1,40}\(\s*[''"]exec[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2108"
    name: "PHP-REX-2108"
    description: "Malware detection signature PHP-REX-2108"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*nsT\s*View'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2109"
    name: "PHP-REX-2109"
    description: "Malware detection signature PHP-REX-2109"
    severity: critical
    category: php_backdoor
    pattern: '\$shell_mode\s*\)\s*\{\s*\?>\s*[^\?]{1,99}\s*<title>\s*<\?php\s+echo\s*\(?\s*[''"]?\s*\$shell_title;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2110"
    name: "PHP-REX-2110"
    description: "Malware detection signature PHP-REX-2110"
    severity: critical
    category: php_backdoor
    pattern: 'class\s*\=\s*[''"]tit[''"]>\s*Mailer\s*Inbox'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2112"
    name: "PHP-REX-2112"
    description: "Malware detection signature PHP-REX-2112"
    severity: critical
    category: php_backdoor
    pattern: 'LD_PRELOAD=\s*\./libworker.so'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2113"
    name: "PHP-REX-2113"
    description: "Malware detection signature PHP-REX-2113"
    severity: critical
    category: php_backdoor
    pattern: '>\s*Da(?:3|s)s\s*(?:HaCkEr)?\s*File\s+Manager\s*(?:Version)?\s*<'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2114"
    name: "PHP-REX-2114"
    description: "Malware detection signature PHP-REX-2114"
    severity: critical
    category: php_backdoor
    pattern: '=num_macros\(\s*\${\s*\${'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2115"
    name: "PHP-REX-2115"
    description: "Malware detection signature PHP-REX-2115"
    severity: critical
    category: php_backdoor
    pattern: 'fopo\.com\.ar'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2116"
    name: "PHP-REX-2116"
    description: "Malware detection signature PHP-REX-2116"
    severity: critical
    category: php_backdoor
    pattern: '<\s*title\s*>\s*404-server!+\s*<\s*/title\s*>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2118"
    name: "PHP-REX-2118"
    description: "Malware detection signature PHP-REX-2118"
    severity: critical
    category: php_backdoor
    pattern: '@eval\(\$r9f35db4\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2119"
    name: "PHP-REX-2119"
    description: "Malware detection signature PHP-REX-2119"
    severity: critical
    category: php_backdoor
    pattern: 'mail\(stripslashes\(\$strr1\), stripslashes\(\$strr2\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2120"
    name: "PHP-REX-2120"
    description: "Malware detection signature PHP-REX-2120"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s+(?:\$\w{1,40}\s*=\s*[''"](?:gzinflate|base64_decode|strrev|str_rot13|gzuncompress|urldecode|rawurlencode)[''"]\s*;\s*){3,5}[^}]{200,400}header\([''"]HTTP/1\.0\s+404\s+Not\s+Found[''"]\);[^\?]{400,600}<\s*form'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2121"
    name: "PHP-REX-2121"
    description: "Malware detection signature PHP-REX-2121"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?(?:php)?\s+/\*\s*\*\s*MySQL\s+Web\s+Interface\s+By'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2122"
    name: "PHP-REX-2122"
    description: "Malware detection signature PHP-REX-2122"
    severity: critical
    category: php_backdoor
    pattern: '<td>\$\s*execute\s*a cmd</td>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2125"
    name: "PHP-REX-2125"
    description: "Malware detection signature PHP-REX-2125"
    severity: critical
    category: php_backdoor
    pattern: 'Usage:\s*\w{1,40}\s*\[\s*OPTIONS\s*\]\s*Options:\s*-a,\s*--algo\s*=\s*ALGO\s*specify\s+the\s+algorithm\s+to\s+use\s*cryptonight'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2126"
    name: "PHP-REX-2126"
    description: "Malware detection signature PHP-REX-2126"
    severity: critical
    category: php_backdoor
    pattern: ';eval\(base64_decode\(gzuncompress\(base64_decode\(\$\w+\)\)\)\);\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2127"
    name: "PHP-REX-2127"
    description: "Malware detection signature PHP-REX-2127"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$\w{1,40}\s*=\s*''[^'']*''\s*;\s*include_once\s*\(\s*"config\.php"\s*\)\s*;\s*\?>\s*<!DOCTYPE\s*html'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2128"
    name: "PHP-REX-2128"
    description: "Malware detection signature PHP-REX-2128"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<head>\s*<script>\s*window\s*\.\s*top\s*\.\s*location\s*\.\s*href\s*="[^"]*"\s*\+\s*"[^"]*"\s*;\s*</script>\s*</head>\s*<body>\s*<script>\s*document\s*\.\s*write\s*\(\s*''<img[^)]+\)\s*;\s*</script>\s*</body>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2129"
    name: "PHP-REX-2129"
    description: "Malware detection signature PHP-REX-2129"
    severity: critical
    category: php_backdoor
    pattern: '^\s*<\s*head\s*>\s*<\s*meta\s*name\s*="[^"]*"\s*content\s*="[^"]*"\s*>\s*<\s*meta\s*http-equiv\s*="[^"]*"\s*content\s*="\d+\s*;\s*URL=https?://[^"]*"/\s*>\s*<\s*/head\s*>\s*$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2130"
    name: "PHP-REX-2130"
    description: "Malware detection signature PHP-REX-2130"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*SexCrime\s*-\s*Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2131"
    name: "PHP-REX-2131"
    description: "Malware detection signature PHP-REX-2131"
    severity: critical
    category: php_backdoor
    pattern: '\$backdoor\s*=\s*base64_decode\([''"][^''"]{400,600}[''"]\);\s*\$deface\s*=\s*base64_decode\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2132"
    name: "PHP-REX-2132"
    description: "Malware detection signature PHP-REX-2132"
    severity: critical
    category: php_backdoor
    pattern: '<td>Hati\s+Mantan\s*[^''"]{1,10}[''"];\s*[^\$]{1,40}\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[[''"]?[^''"]{1,40}[''"]?\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2133"
    name: "PHP-REX-2133"
    description: "Malware detection signature PHP-REX-2133"
    severity: critical
    category: php_backdoor
    pattern: '=>\s*[''"]tools[''"],\s*\/\*\s*available:(\s*(ls|search|upload|cmd|eval|sql|mailer|encoders|tools|processes|sysinfo),?\s*){9,11}\s*\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2134"
    name: "PHP-REX-2134"
    description: "Malware detection signature PHP-REX-2134"
    severity: critical
    category: php_backdoor
    pattern: '@eval\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\[cmd\]\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2137"
    name: "PHP-REX-2137"
    description: "Malware detection signature PHP-REX-2137"
    severity: critical
    category: php_backdoor
    pattern: '\$_COOKIE\s*=\s*WSOstripslashes'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2138"
    name: "PHP-REX-2138"
    description: "Malware detection signature PHP-REX-2138"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$reqPwd\s*!==\s*vpsp_pwd\s*\)\s*\{\s*\$\w{1,40}\s*='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2140"
    name: "PHP-REX-2140"
    description: "Malware detection signature PHP-REX-2140"
    severity: critical
    category: php_backdoor
    pattern: '\]\(NULL\);\s*@\$GLOBALS\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2141"
    name: "PHP-REX-2141"
    description: "Malware detection signature PHP-REX-2141"
    severity: critical
    category: php_backdoor
    pattern: 'myUpload->uploadFile\(\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2142"
    name: "PHP-REX-2142"
    description: "Malware detection signature PHP-REX-2142"
    severity: critical
    category: php_backdoor
    pattern: 'is_readable\s*\(\s*[''"]/etc/passwd[''"]\s*\)\s*\?[^\?]{100,600}php_uname\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2143"
    name: "PHP-REX-2143"
    description: "Malware detection signature PHP-REX-2143"
    severity: critical
    category: php_backdoor
    pattern: '\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']{1,6}''\s*\]\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']{1,6}''\s*\]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2144"
    name: "PHP-REX-2144"
    description: "Malware detection signature PHP-REX-2144"
    severity: critical
    category: php_backdoor
    pattern: 'Made by SexDog Pula'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2145"
    name: "PHP-REX-2145"
    description: "Malware detection signature PHP-REX-2145"
    severity: critical
    category: php_backdoor
    pattern: 'base.\.\(32\*2\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2146"
    name: "PHP-REX-2146"
    description: "Malware detection signature PHP-REX-2146"
    severity: critical
    category: php_backdoor
    pattern: '\}\s*else\s*\{\s*\$v\s*=\s*new\s+verifier\(\);\s*print_r\(\$v->checkemails'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2147"
    name: "PHP-REX-2147"
    description: "Malware detection signature PHP-REX-2147"
    severity: critical
    category: php_backdoor
    pattern: '>Gantengers Crew<'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2148"
    name: "PHP-REX-2148"
    description: "Malware detection signature PHP-REX-2148"
    severity: critical
    category: php_backdoor
    pattern: '\+\+\$o\]\]\)\);}}eval\(\$d\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2149"
    name: "PHP-REX-2149"
    description: "Malware detection signature PHP-REX-2149"
    severity: critical
    category: php_backdoor
    pattern: 'mt_rand\(\s*0\s*,\s*count\(\s*\$not_android_urls\)-1\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2150"
    name: "PHP-REX-2150"
    description: "Malware detection signature PHP-REX-2150"
    severity: critical
    category: php_backdoor
    pattern: '\}\);\s*function\s+refreshBotsOnline\(\)\{\s*\$\(\\[''"]\#nav\\[''"]\)\.load\(\\[''"]inc/\w{1,40}\.php\\[''"]\);\s*setTimeout\(refreshBotsOnline,\s*\d+\);\s*\}\s*</script>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2151"
    name: "PHP-REX-2151"
    description: "Malware detection signature PHP-REX-2151"
    severity: critical
    category: php_backdoor
    pattern: 'Mailer\s+by\s+Sphinx</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2153"
    name: "PHP-REX-2153"
    description: "Malware detection signature PHP-REX-2153"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(\$\w{1,40}\[\$GLOBALS\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2154"
    name: "PHP-REX-2154"
    description: "Malware detection signature PHP-REX-2154"
    severity: critical
    category: php_backdoor
    pattern: '\$domain\s*=\s*\$domains\[\s*array_rand\(\s*\$domains\s*,\s*1\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2155"
    name: "PHP-REX-2155"
    description: "Malware detection signature PHP-REX-2155"
    severity: critical
    category: php_backdoor
    pattern: 'POST\s*=\s*WSOstripslashes'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2156"
    name: "PHP-REX-2156"
    description: "Malware detection signature PHP-REX-2156"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*[^\}]{1,600}\s*\}\s*\}\s*define\(\s*[''"]startTime[''"]\s*,\s*getTime\(\)\s*\);\s*if\s*\(\s*!function_exists\s*\(\s*[''"]shellexec[''"]\s*\)\s*\)\s*\{\s*function\s+shellexec\s*\(\s*\$cmd\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2159"
    name: "PHP-REX-2159"
    description: "Malware detection signature PHP-REX-2159"
    severity: critical
    category: php_backdoor
    pattern: 'sent\s*=\s*@?mail\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;(?:\s*\$\w{1,40}\s*=\s*\$\w{1,40}\s*\+\s*1\s*;)?\s*\$\w{1,10}spamm?ed\s*=\s*[''"]spamm?ed[''"]\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2161"
    name: "PHP-REX-2161"
    description: "Malware detection signature PHP-REX-2161"
    severity: critical
    category: php_backdoor
    pattern: 'stripslashes\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\["l1"\]\);\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2165"
    name: "PHP-REX-2165"
    description: "Malware detection signature PHP-REX-2165"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s+if\s*\(\s*!isset\s*\(\s*\$_SESSION\[[^\]]{1,40}\]\s*\)\s*\)\s*\{\s*[^\}]{1,99}\s*\$inj(?:e\wtor)?\s*=\s*\$_SERVER\[[^\]]{1,40}\];[^/]{150,400}\s*\$inj(?:e\wtor)?\s*=\s*gethostbyname\(\s*\$_SERVER\[[^\]]{1,40}\]\s*\);\s*@?mail\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2167"
    name: "PHP-REX-2167"
    description: "Malware detection signature PHP-REX-2167"
    severity: critical
    category: php_backdoor
    pattern: '\*\s*\*\s*arkei\s+stealer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2168"
    name: "PHP-REX-2168"
    description: "Malware detection signature PHP-REX-2168"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[^\w]{0,3}\s*BYSCRA3ZY\s*[^\w]{0,3}\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2169"
    name: "PHP-REX-2169"
    description: "Malware detection signature PHP-REX-2169"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*jahat\s*</title>[^\)]{1,499}php_uname\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2170"
    name: "PHP-REX-2170"
    description: "Malware detection signature PHP-REX-2170"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[\w\^\.\|]{0,3}\s+Private\s+Shell\s'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2171"
    name: "PHP-REX-2171"
    description: "Malware detection signature PHP-REX-2171"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Dr\s+HeX\s*</'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2172"
    name: "PHP-REX-2172"
    description: "Malware detection signature PHP-REX-2172"
    severity: critical
    category: php_backdoor
    pattern: '=\s*stripslashes\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\["user_l"\]\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2173"
    name: "PHP-REX-2173"
    description: "Malware detection signature PHP-REX-2173"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[\w-]{0,9}\s*(?:cpanel|whm)\s+[^`]{0,9}\s*(?:crac|brut)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2174"
    name: "PHP-REX-2174"
    description: "Malware detection signature PHP-REX-2174"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Bienvenido\s+a\s+BancaNet\s*[^\.]{1,600}\.banamex\.com\.mx/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2176"
    name: "PHP-REX-2176"
    description: "Malware detection signature PHP-REX-2176"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*["'']\s*Hacked\s+by\s+Moroccanwolf\s*["'']\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2178"
    name: "PHP-REX-2178"
    description: "Malware detection signature PHP-REX-2178"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[^/]{1,49}\s+Edited\s+By\s+KingDefacer\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2179"
    name: "PHP-REX-2179"
    description: "Malware detection signature PHP-REX-2179"
    severity: critical
    category: php_backdoor
    pattern: ']}=trim\(\s*array_pop\(\${\${"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2180"
    name: "PHP-REX-2180"
    description: "Malware detection signature PHP-REX-2180"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*fsockopen\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*30\s*\)\s*;\s*if\s*\(\s*!\$\w{1,40}\s*\)\s*\{\s*print(?:it|r)?\s*\(\s*[''"][^''"]{1,40}[''"]\s*\)\s*;\s*exit\s*\(\s*\d?\s*\)\s*;\s*\}\s*//\s*Spawn\s+shell\s+process'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2182"
    name: "PHP-REX-2182"
    description: "Malware detection signature PHP-REX-2182"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*\#!/usr/bin/perl\s*[^;]{1,200}use\s+strict;\s*undef\s+\$modules::Module::var;\s*my\s+\(\$Password,[^\)]{1,200}\$WinNT,\$NTCmdSep,\$UnixCmdSep'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2183"
    name: "PHP-REX-2183"
    description: "Malware detection signature PHP-REX-2183"
    severity: critical
    category: php_backdoor
    pattern: '\$p=strpos\(\s*\$tx,''{\#'',\$p2\+2'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2185"
    name: "PHP-REX-2185"
    description: "Malware detection signature PHP-REX-2185"
    severity: critical
    category: php_backdoor
    pattern: '\$headers\s*\.?=\s*\$_POST\[[''"](?:username|passwd|password|pass|user)[''"]\]\.[''"]\\n[''"];\s*if\s*\(mail\(\$recipient,\$subject,\$message,\$headers\)\)\s*\{\s*header\("Location:\s*[^\)]{1,40}\);\s*\}\s*else\s*\{\s*echo\s*[''"][^''"]{1,40}[''"];\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2186"
    name: "PHP-REX-2186"
    description: "Malware detection signature PHP-REX-2186"
    severity: critical
    category: php_backdoor
    pattern: '\$ip\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\]);\s*\$from\s*=\s*[''"]From:\s*\w{0,39}\s*<?hacker@'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2187"
    name: "PHP-REX-2187"
    description: "Malware detection signature PHP-REX-2187"
    severity: critical
    category: php_backdoor
    pattern: '\$ip[''"]?;\s*\$from\s*=\s*[''"]From:\s*Banco\s+Azteka'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2188"
    name: "PHP-REX-2188"
    description: "Malware detection signature PHP-REX-2188"
    severity: critical
    category: php_backdoor
    pattern: '@?fclose\s*\(\s*@?fwrite\s*\(\s*@?fopen\s*\(\s*[''"][^''"]{1,40}[''"]\s*,\s*[''"](a|w)\+?[''"]\s*\)\s*,\s*\$\w{1,40}\s*\.\s*[''"][^''"]{1,40}[''"]\s*\)\s*\)\s*;(?:\s*\$\w{1,40}\s*=\s*[''"][^''"]{1,40}[''"]\s*;){0,3}\s*mail\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$headers\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2192"
    name: "PHP-REX-2192"
    description: "Malware detection signature PHP-REX-2192"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*unzip\s*file\s*by\s*ahwak2000'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2195"
    name: "PHP-REX-2195"
    description: "Malware detection signature PHP-REX-2195"
    severity: critical
    category: php_backdoor
    pattern: '\beval\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[.pass.\]\);\s*exit\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2196"
    name: "PHP-REX-2196"
    description: "Malware detection signature PHP-REX-2196"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(\s*base64_decode\(\s*\$o\s*\)\s*\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2197"
    name: "PHP-REX-2197"
    description: "Malware detection signature PHP-REX-2197"
    severity: critical
    category: php_backdoor
    pattern: 'AddType\s+application/x-httpd-cgi\s+\.alfa'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2199"
    name: "PHP-REX-2199"
    description: "Malware detection signature PHP-REX-2199"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*@?include\(\s*[''"]\w{1,20}\.php[''"]\s*\);\s*\$ip\w?\s*=\s*(?:getenv\(|\$_SERVER\[)[''"]REMOTE_ADDR[''"](?:\)|\]);(\s*\$\w{1,40}\s*=\s*\$_POST\[[''"]CARD(?:TYPE|NUMBER|CVV2?)?\w{1,10}[''"]\];){2}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2200"
    name: "PHP-REX-2200"
    description: "Malware detection signature PHP-REX-2200"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$else_dot\)\s*\{\s*\$new_v_f=fopen\([''"]\$f_creat_name\.\$else_dot[''"],[''"](?:w|a)\+?[''"]\);\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2201"
    name: "PHP-REX-2201"
    description: "Malware detection signature PHP-REX-2201"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*@?eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*str_rot13\s*\(\s*[''"]iIugH9gTRC5pMitCT9HmWj9tXHNmuAuhvHzNANRz9[^''"]+[''"](?:\s*\)\s*){1,6};\s*\?>\s*<\?php\s*@?eval\s*\(\s*gzinflate\s*\(\s*base64_decode\s*\(\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2202"
    name: "PHP-REX-2202"
    description: "Malware detection signature PHP-REX-2202"
    severity: critical
    category: php_backdoor
    pattern: 'html_footer\s*\(\)\s*\{\s*[^>]{1,99}<h\d*>\s*Coded\s*by\s*MizoZ'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2203"
    name: "PHP-REX-2203"
    description: "Malware detection signature PHP-REX-2203"
    severity: critical
    category: php_backdoor
    pattern: '\{\s*\$\w\s*=\s*Array\s*\((\s*[''"][^''"]{1,40}[''"],?\s*){4}[''"]aHR0cDovL2M4Ni50cnVlYmFia2EucnUv[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2204"
    name: "PHP-REX-2204"
    description: "Malware detection signature PHP-REX-2204"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Facebook\s*</title>\s*<\?php\s*include(?:_once)?\s*\(?[''"][^\.]{1,99}\.php[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2206"
    name: "PHP-REX-2206"
    description: "Malware detection signature PHP-REX-2206"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s+system\([''"]pwd[''"]\)[^\(]{1,40}system\([''"]cat\s+/etc/passwd[^\?]{1,600}define\([''"][^''"]{1,40}[''"]\s*,\s*[''"]https?://pastebin\.com/(?:raw|download)(?:\.php\?i=|/)\w{1,40}[''"]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2207"
    name: "PHP-REX-2207"
    description: "Malware detection signature PHP-REX-2207"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,10}\s*=\s*\$\w{1,10}\s*\+\s*1;\s*\$txtspamed\s*=\s*[''"]\w{1,40}[''"];\s*if\s*\(\s*!\$\w{1,40}\s*\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2209"
    name: "PHP-REX-2209"
    description: "Malware detection signature PHP-REX-2209"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*HTTP\s+404\s+Not\s+Found\s*</title>[^`]{1,600}\$\w{1,40}\s*=\s*file_get_contents\(\s*[''"](?:\.\./){5,9}?wp-config\.php[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2210"
    name: "PHP-REX-2210"
    description: "Malware detection signature PHP-REX-2210"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\[\w{1,40}\]\s*==\s*[''"]stop[''"]\s*\)\s*\{\s*(?:@|\#)?shell_exec\s*\(\s*[''"]killall\s*bot\.pl[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2211"
    name: "PHP-REX-2211"
    description: "Malware detection signature PHP-REX-2211"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[^\w]{1,3}\s*Trenggalek\s+Mafia'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2215"
    name: "PHP-REX-2215"
    description: "Malware detection signature PHP-REX-2215"
    severity: critical
    category: php_backdoor
    pattern: '\#!/usr/bin/(?:ba|z|t)?sh\s*DIR=\$1\s*IFS=\$[^\&]{199,399}\s*permnum=[''"]0777[''"]\s*permhuman=[''"]drwxrwxrw[''"][^\?]{500,}\$permcolor\\[''"]\},\s*done\s*echo\s*[''"]\{\}\][''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2216"
    name: "PHP-REX-2216"
    description: "Malware detection signature PHP-REX-2216"
    severity: critical
    category: php_backdoor
    pattern: '\#!/usr/bin/perl\s*[^\?]{450,600};\s*system\(\s*decode_base64\s*\(\s*\$\w{1,40}\s*\{\s*[''"]cmd[''"]\s*\}\s*\)\s*\)\s*;\s*print\s*[''"]</pre>[''"]\s*\}\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2217"
    name: "PHP-REX-2217"
    description: "Malware detection signature PHP-REX-2217"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*\$(?:auth)?_?pass\s*=\s*[''"]\w{0,40}[''"];\s*[^\$]{0,99}\s*(?:\$\w{1,40}\s*=\s*[''"][^''"]{1,40}[''"];)?\s*\$\w{1,40}\s*=\s*[''"]FilesMan[''"];[^\}]{1,200}header\([''"]HTTP/1\.0\s+404\s+Not\s+Found[''"]\);\s*exit'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2218"
    name: "PHP-REX-2218"
    description: "Malware detection signature PHP-REX-2218"
    severity: critical
    category: php_backdoor
    pattern: ';\s*(passthru|exec|shell_exec|popen|system|eval)\(\s*[''"]\./findsock[^\$]{1,40}\$_SERVER\[[''"]REMOTE_ADDR[''"]\][^\$]{1,40}\$_SERVER\[[''"]REMOTE_PORT[''"]\]\s*\)\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2219"
    name: "PHP-REX-2219"
    description: "Malware detection signature PHP-REX-2219"
    severity: critical
    category: php_backdoor
    pattern: '<(?:h\d|title)>\s*Moshkela\s+Hacker'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2220"
    name: "PHP-REX-2220"
    description: "Malware detection signature PHP-REX-2220"
    severity: critical
    category: php_backdoor
    pattern: 'cover\(\s*[''"]IndoXploit[''"]\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2222"
    name: "PHP-REX-2222"
    description: "Malware detection signature PHP-REX-2222"
    severity: critical
    category: php_backdoor
    pattern: 'printf\("Usage: findsock ip port'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2223"
    name: "PHP-REX-2223"
    description: "Malware detection signature PHP-REX-2223"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*PHP\s*.\s*Mailer\s*by\s*iskorpitx'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2224"
    name: "PHP-REX-2224"
    description: "Malware detection signature PHP-REX-2224"
    severity: critical
    category: php_backdoor
    pattern: 'IndoXploit\s*\$\w{1,40}\s*=\s*[''"][^''"]{0,40}(?:aHR0cHM6Ly9wYXN0ZWJpbi5jb20vcmF3|aHR0cDovL3Bhc3RlYmluLmNvbS9yYXc)[^''"]{0,40}[''"]\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2225"
    name: "PHP-REX-2225"
    description: "Malware detection signature PHP-REX-2225"
    severity: critical
    category: php_backdoor
    pattern: '(?:\$(?:message|spam|bilsmg)\s*\.?=\s*[''"]\s*(?:Password|Pass|PWD?)[^\n]{1,60}([''"]?\\n[''"]|[''"]/[''"]);)[^\?]{1,600}\$headers\s*\.=\s*\$_POST\[[''"]eMailAdd[''"]\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2226"
    name: "PHP-REX-2226"
    description: "Malware detection signature PHP-REX-2226"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Don\s+Cordoba\s+Mailer'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2227"
    name: "PHP-REX-2227"
    description: "Malware detection signature PHP-REX-2227"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*mail\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*\)\s*\{(?:\s*\s*mail\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;){2,4}\s*header\(\s*[''"]Location:'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2229"
    name: "PHP-REX-2229"
    description: "Malware detection signature PHP-REX-2229"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s+/\*\*\s*\*\s*Smtp\s*Auto\s*Change\s*Password\s*By\s*VvebOs'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2230"
    name: "PHP-REX-2230"
    description: "Malware detection signature PHP-REX-2230"
    severity: critical
    category: php_backdoor
    pattern: '\$subject\s*=\s*[''"][^\$]{1,40}[''"]\.\$ip\.[""]\\n[''"];\s*\{?\s*@?mail\([^\;]{1,200}\)\s*;\s*\}?\s*\s*header\s*\(\s*[''"]Location\s*:[^\)]{1,100}\);\s*(?:exit\(\);)?\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2231"
    name: "PHP-REX-2231"
    description: "Malware detection signature PHP-REX-2231"
    severity: critical
    category: php_backdoor
    pattern: '@gzinflate\(\s*@base64_decode\(\s*@str_replac'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2232"
    name: "PHP-REX-2232"
    description: "Malware detection signature PHP-REX-2232"
    severity: critical
    category: php_backdoor
    pattern: ';\s*\$\{[''"](?:G|\\x47)(?:L|\\x4c)(?:O|\\x4f)(?:B|\\x42)(?:A|\\x41)(?:L|\\x4c)(?:S|\\x53)[''"]\}\[[''"](?:z|r|_|\\x7a|\\x5f|\\x72){1,40}[''"]\]\(\$[zr_]{1,40},CURLOPT_USERAGENT,\\[''"]WHR\\[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2233"
    name: "PHP-REX-2233"
    description: "Malware detection signature PHP-REX-2233"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*[''"]<pre>[''"];\s*system\(\$_REQUEST\[''c''\]\);\s*die;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2235"
    name: "PHP-REX-2235"
    description: "Malware detection signature PHP-REX-2235"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*\$\w{1,9}pass\s*=\s*[''"][^''"]{1,40}[''"];[^\<]{1,600}function\s+masuk\(\)\s*\{\s*die\([''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2236"
    name: "PHP-REX-2236"
    description: "Malware detection signature PHP-REX-2236"
    severity: critical
    category: php_backdoor
    pattern: '<html>\s*<title>\s*Symlink\s*Bypass\s*\d+\s*by\s+hAxOr'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2238"
    name: "PHP-REX-2238"
    description: "Malware detection signature PHP-REX-2238"
    severity: critical
    category: php_backdoor
    pattern: ';\s*print\s+"Flooded:\s*\$ip\s*on\s*port\s*\$rand'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2239"
    name: "PHP-REX-2239"
    description: "Malware detection signature PHP-REX-2239"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Fastest\s+Zone-H\s*Mass\s+Deface\s+Poster'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2240"
    name: "PHP-REX-2240"
    description: "Malware detection signature PHP-REX-2240"
    severity: critical
    category: php_backdoor
    pattern: '\)\s*\)\s*;\s*\}\s*\$\w{1,40}\s*=\s*fopen\s*\(\s*[''"]block-mail\.txt[''"],\s*[''"]r[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2244"
    name: "PHP-REX-2244"
    description: "Malware detection signature PHP-REX-2244"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Dark Shell\s*</title>.*fsockopen'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2245"
    name: "PHP-REX-2245"
    description: "Malware detection signature PHP-REX-2245"
    severity: critical
    category: php_backdoor
    pattern: '\$su\s*=\s*str_replace\(''\$name''\s*,\s*\$n\s*,\s*stripslashes\(\s*base64_decode\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*''z2''\s*\]\s*\)\s*\)\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2246"
    name: "PHP-REX-2246"
    description: "Malware detection signature PHP-REX-2246"
    severity: critical
    category: php_backdoor
    pattern: '\$data = curl_get_from_webpage_one_time\(\$url'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2247"
    name: "PHP-REX-2247"
    description: "Malware detection signature PHP-REX-2247"
    severity: critical
    category: php_backdoor
    pattern: '\$weff_client\s*=\s*new\s+TWeffClient\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2248"
    name: "PHP-REX-2248"
    description: "Malware detection signature PHP-REX-2248"
    severity: critical
    category: php_backdoor
    pattern: '\$Content_mb=getHTTPPage\(\$Remote_server\."/index\.(html|php)\?host'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2249"
    name: "PHP-REX-2249"
    description: "Malware detection signature PHP-REX-2249"
    severity: critical
    category: php_backdoor
    pattern: 'str_replace\(''define\("PRENAME","\d+"\);''\s*,\s*''define\("PRENAME"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2250"
    name: "PHP-REX-2250"
    description: "Malware detection signature PHP-REX-2250"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Dark Shell\s*</title>.+clearstatcache'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2251"
    name: "PHP-REX-2251"
    description: "Malware detection signature PHP-REX-2251"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$arrId\s*=\s*array\((''\d+-\d+''\s*,\s*)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2252"
    name: "PHP-REX-2252"
    description: "Malware detection signature PHP-REX-2252"
    severity: critical
    category: php_backdoor
    pattern: '\$array\s*=\s*base64_decode\(\$array\);\s*@assert\(\$array\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2253"
    name: "PHP-REX-2253"
    description: "Malware detection signature PHP-REX-2253"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*"[^"]+";\$\w+\s*=(\s*\$\w{1,40}\[\d+\]\s*\.?){5,};\$\w+\s*=\s*[^;]+;\$\w+\s*=\s*"[^"]+";\$\w+\s*=\s*\$\w+\s*\.\s*"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2255"
    name: "PHP-REX-2255"
    description: "Malware detection signature PHP-REX-2255"
    severity: critical
    category: php_backdoor
    pattern: '\{\s*\$\w{1,4}\s*=\s*\$\w{1,4}\[\d+\]\s*;\s*\$\w{1,4}\s*=\s*[''"]moban[''"]\s*;\s*\}\s*if\s*\(\s*\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[^\]]{1,40}\s*\]\s*\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2256"
    name: "PHP-REX-2256"
    description: "Malware detection signature PHP-REX-2256"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_GET\[[''"]?cmd[''"]?]\s*[^\w]{1,2}=\s*[''"]eval[''"]\)\s*\{\s*@?eval\(\$_POST\[[''"]?exec[''"]?\]\);\s*exit;\s*\}\s*(?://[^\n]{1,80})?\s*if\s*\(\s*\$_GET\[[''"]?cmd[''"]?\]\s*==\s*[''"]GetArticleById[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2257"
    name: "PHP-REX-2257"
    description: "Malware detection signature PHP-REX-2257"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$mode_work\s*==\s*[''"]cngbot[''"]\s*\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2258"
    name: "PHP-REX-2258"
    description: "Malware detection signature PHP-REX-2258"
    severity: critical
    category: php_backdoor
    pattern: '\(\s*[''"]{0,1}DZe1r'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2259"
    name: "PHP-REX-2259"
    description: "Malware detection signature PHP-REX-2259"
    severity: critical
    category: php_backdoor
    pattern: 'fopen\(\$s1\.''accesson\.php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2260"
    name: "PHP-REX-2260"
    description: "Malware detection signature PHP-REX-2260"
    severity: critical
    category: php_backdoor
    pattern: '\./\*-/\*-\*/"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2261"
    name: "PHP-REX-2261"
    description: "Malware detection signature PHP-REX-2261"
    severity: critical
    category: php_backdoor
    pattern: 'code\.google\.com/p/b374k-shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2262"
    name: "PHP-REX-2262"
    description: "Malware detection signature PHP-REX-2262"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\s*=\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[''\w+''\]\s*\(\s*''''\s*,\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*''\w+''\s*\]\s*\(\s*\$_POST\[\s*''\w+''\s*\]\s*\)\s*\)\s*;[^`]+?iterator_apply\s*\(\s*\$\w+\s*,\s*\$\w+,\s*array\s*\(\s*\$\w+\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2263"
    name: "PHP-REX-2263"
    description: "Malware detection signature PHP-REX-2263"
    severity: critical
    category: php_backdoor
    pattern: '\$MESSAGE\s*=\s*wordwrap\(\$MESSAGE,\d+\)\s*;\s*[\#]{50,80}\s*\$SUBJECT\s*=\s*["'']\(\$\w{1,40}\)\((?:BILLING|LOGIN)\)\(\$IP\)\(\$(?:nama_negara|country)\)[''"];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2264"
    name: "PHP-REX-2264"
    description: "Malware detection signature PHP-REX-2264"
    severity: critical
    category: php_backdoor
    pattern: 'echo\swelcome\sto\sr57\sshell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2265"
    name: "PHP-REX-2265"
    description: "Malware detection signature PHP-REX-2265"
    severity: critical
    category: php_backdoor
    pattern: '[\#]{2}\s*ReCoded\s*By\s*Syechrul\s*Imam'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2269"
    name: "PHP-REX-2269"
    description: "Malware detection signature PHP-REX-2269"
    severity: critical
    category: php_backdoor
    pattern: 'phpversion\s*\(\s*\)\s*;\s*@?mail\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*@?mail\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*\)\s*;\s*header\s*\(\s*[''"]Location:[^''"]{1,40}[''"]\s*\)\s*;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2270"
    name: "PHP-REX-2270"
    description: "Malware detection signature PHP-REX-2270"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*\$\w{1,40}\s*=\s*[''"]find\s[^;]{1,99}<head[''"]{1,3};\s*\$\w{1,40}\s*=\s*[''"]<script\s+src\s*=\s*[''"]https?://[^\?]{1,40}\.js\?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2271"
    name: "PHP-REX-2271"
    description: "Malware detection signature PHP-REX-2271"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*To0?olz\s+\d+\s*-\s*Cyb3r-dz'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2272"
    name: "PHP-REX-2272"
    description: "Malware detection signature PHP-REX-2272"
    severity: critical
    category: php_backdoor
    pattern: '\$emailusr\s*\.?=\s*[''"][^@]{1,40}@protonmail\.com[''"]\s*;\s*\{?\s*@?mail\([^\;]{1,200}\)\s*;\s*\}?\s*\s*header\s*\(\s*[''"]Location\s*:[^\)]{1,100}\);\s*(?:exit\(\);)?\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2273"
    name: "PHP-REX-2273"
    description: "Malware detection signature PHP-REX-2273"
    severity: critical
    category: php_backdoor
    pattern: 'mail\s*\(\s*\$\w{1,40}\s*,\s*\$\w{1,40}\s*,\s*[''"][^''"]{0,40}[''"]\s*,\s*\$\w{1,40}\s*\)\s*;\s*print\s*[''"]OK(?:\s*By\s*King)?<br>[''"]\s*;\s*flush\s*\(\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2274"
    name: "PHP-REX-2274"
    description: "Malware detection signature PHP-REX-2274"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Mailer\s+By\s+ME'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2276"
    name: "PHP-REX-2276"
    description: "Malware detection signature PHP-REX-2276"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[^\w\s]{0,3}\s*T\.C\.T\s*[^\w\s]{0,3}\s*</'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2277"
    name: "PHP-REX-2277"
    description: "Malware detection signature PHP-REX-2277"
    severity: critical
    category: php_backdoor
    pattern: '\#\#\s+\w{1,40}\s+(Priv8|Private)\s+Webshell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2278"
    name: "PHP-REX-2278"
    description: "Malware detection signature PHP-REX-2278"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*/\*[^\*]{0,99}Mini\s+Shell\.?\s+(?:@\s+c[o0]ded\s+)?by\s+:\s+shutdown57'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2280"
    name: "PHP-REX-2280"
    description: "Malware detection signature PHP-REX-2280"
    severity: critical
    category: php_backdoor
    pattern: '\#\s*Jakarta-Blackhat\s*Hacker(?:`|''|")s'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2282"
    name: "PHP-REX-2282"
    description: "Malware detection signature PHP-REX-2282"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$GLOBALS\[[''"]\w{1,40}[''"]\]=Array\([''"][^\)]{200,600}[''"]\);function\s*\w{1,40}\(\$\w{1,40}\)\{\$\w{1,40}=Array\((?:[''"][^''"]{1,40}[''"]\s*,){0,5}\s*[''"]https?://stoligowo\.ru/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2283"
    name: "PHP-REX-2283"
    description: "Malware detection signature PHP-REX-2283"
    severity: critical
    category: php_backdoor
    pattern: ';@\$fun\(\s*str_rot13\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2284"
    name: "PHP-REX-2284"
    description: "Malware detection signature PHP-REX-2284"
    severity: critical
    category: php_backdoor
    pattern: '\}\s*Wordpress\s*\$\w{1,40}\s*=\s*fopen\([''"]4O4\.php[''"],[''"](a|w)\+?[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2285"
    name: "PHP-REX-2285"
    description: "Malware detection signature PHP-REX-2285"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*@?\$_GET\[[^\]]{1,40}\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=\s*DirFilesR\s*\(\s*@?\$_SERVER\[[''"]DOCUMENT_ROOT[''"]]\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2289"
    name: "PHP-REX-2289"
    description: "Malware detection signature PHP-REX-2289"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\(\);\s*\}\s*\}\s*\?>\s*<html>\s*<head><title>404\s+Not\s+Found'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2290"
    name: "PHP-REX-2290"
    description: "Malware detection signature PHP-REX-2290"
    severity: critical
    category: php_backdoor
    pattern: 'implode\(".r.n",array\("%1html%3","%1head%3",head\(\),"%2head%3","%1body%3'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2291"
    name: "PHP-REX-2291"
    description: "Malware detection signature PHP-REX-2291"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$Class_WP_Index\s*=\s*"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2292"
    name: "PHP-REX-2292"
    description: "Malware detection signature PHP-REX-2292"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Bypass\s*Root\s*Path\s*by\s*Mauritania\s*Attacker'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2293"
    name: "PHP-REX-2293"
    description: "Malware detection signature PHP-REX-2293"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?(?:php)?\s+[^\{]{1,400}\s*class\s+pBot\s*\{\s*var\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2294"
    name: "PHP-REX-2294"
    description: "Malware detection signature PHP-REX-2294"
    severity: critical
    category: php_backdoor
    pattern: '<br>\s*(?:\[info\])?\s*Gaza\s+HaCKeR\s+Team\s*<'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2295"
    name: "PHP-REX-2295"
    description: "Malware detection signature PHP-REX-2295"
    severity: critical
    category: php_backdoor
    pattern: ',\s*[''"]index\.html\.bak\.bak[^\?]{1,600}\$is_(?:wp|wordpress)\s*=\s*(?:false|0);\s*\$is_(?:jm|joomla)\s*=\s*(?:false|0);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2297"
    name: "PHP-REX-2297"
    description: "Malware detection signature PHP-REX-2297"
    severity: critical
    category: php_backdoor
    pattern: '<TITLE>\s*cgi-shell\.py'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2298"
    name: "PHP-REX-2298"
    description: "Malware detection signature PHP-REX-2298"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*if\s*\(\s*\!\s*class_exists\s*\([^@]{250,600}const\s*\w{1,40}\s*=\s*[''"][ ]{200,}\s*@?(?:eval|assert|system|shell_exec|exec|popen|passthru)\s*\(\$_(?:GET|POST|COOKIE|SERVER|REQUEST)\s*\[[^\]]{1,40}\]\s*\)\s*;\s*[''"]\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2300"
    name: "PHP-REX-2300"
    description: "Malware detection signature PHP-REX-2300"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Small\s*Web\s*Shell\s*by'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2302"
    name: "PHP-REX-2302"
    description: "Malware detection signature PHP-REX-2302"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Ani\s*-\s*Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2303"
    name: "PHP-REX-2303"
    description: "Malware detection signature PHP-REX-2303"
    severity: critical
    category: php_backdoor
    pattern: ';\s*[\#]{5,200}\s*\$SUBJECT\s*=\s*[''"]\s*\((AMAZON|ADOBE|AZURE)\)\s*\((BILLING|LOGIN)\)\s*\(\s*\$IP\s*\)\s*\(\s*\$COUNTRYNAME\s*\)\s*[''"]\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2304"
    name: "PHP-REX-2304"
    description: "Malware detection signature PHP-REX-2304"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Katrina\s+v\d+\.\d+\s*-\s*Welcome\s*Master'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2306"
    name: "PHP-REX-2306"
    description: "Malware detection signature PHP-REX-2306"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Handanovix\s*X_Shell\s*GTA'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2307"
    name: "PHP-REX-2307"
    description: "Malware detection signature PHP-REX-2307"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*C99\s*(?:mad)?\s*shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2308"
    name: "PHP-REX-2308"
    description: "Malware detection signature PHP-REX-2308"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Security007\s+webshell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2311"
    name: "PHP-REX-2311"
    description: "Malware detection signature PHP-REX-2311"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*AnonymousFox'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2312"
    name: "PHP-REX-2312"
    description: "Malware detection signature PHP-REX-2312"
    severity: critical
    category: php_backdoor
    pattern: '\}\s*else\s*\{\s*if\s*\(\$_POST\[[''"]?[^''"]{1,40}[''"]?\]\)\s*\{\s*@?eval\(\$_POST\[[''"][^''"]{1,40}[''"]\]\);\s*\}\s*\}\s*\}\s*\}\s*add_filter\(\s*[''"]init[''"],\s*[''"]wp_is_plugin_load[''"]\);\s*\}\s*add_action\(\s*[''"]init[''"],\s*array\(\s*[''"]Akismet[''"],'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2313"
    name: "PHP-REX-2313"
    description: "Malware detection signature PHP-REX-2313"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*EgY_SpIdEr\s+ShElL'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2316"
    name: "PHP-REX-2316"
    description: "Malware detection signature PHP-REX-2316"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Sim\s*Shell\s*-?\s*Simorgh'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2317"
    name: "PHP-REX-2317"
    description: "Malware detection signature PHP-REX-2317"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,40}\[\w{1,40}\]\s*=\s*[''"][^''"]{1,40}[''"];(\s*(system|shell_exec|exec|popen|passthru)\s*\(\)\s*;){3,5}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2318"
    name: "PHP-REX-2318"
    description: "Malware detection signature PHP-REX-2318"
    severity: critical
    category: php_backdoor
    pattern: '\};@?eval\(\$[O0]{4,24}\([''"]QHNldF90aW1lX2xpbWl0KDM2MDApOw0KQGlnbm9yZV91c2VyX2Fib3'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2320"
    name: "PHP-REX-2320"
    description: "Malware detection signature PHP-REX-2320"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*<\?php\s*\$\w{0,9}_pass\s*=\s*[''"]\w{20,40}[''"]\s*;(?:\s*\$\w{1,40}\s*=\s*\s*[''"][^''"]{1,40}[''"]\s*;)\s*\$\w{0,9}title\s*=\s*[''"]\s*b374k'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2321"
    name: "PHP-REX-2321"
    description: "Malware detection signature PHP-REX-2321"
    severity: critical
    category: php_backdoor
    pattern: '\]\(""\s*,\s*@\$_COOKIE\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2322"
    name: "PHP-REX-2322"
    description: "Malware detection signature PHP-REX-2322"
    severity: critical
    category: php_backdoor
    pattern: '\A\s*(<\?php\s+)function\s+\w{1,40}\(\s*\$\w{1,40}\s*\)\s*\{\s*[^/]{200,300};\s*@?eval\s*\(\s*\$\w{1,40}\s*\.\s*[''"]fZDdbtQwEIVfZS6q2pESlC3lZ4Ny1QYK6qp[^\)]{500,600}\);\s*/\*[^\*]{20,48}\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2323"
    name: "PHP-REX-2323"
    description: "Malware detection signature PHP-REX-2323"
    severity: critical
    category: php_backdoor
    pattern: '(,\s*[''"]\^[^''"]+[''"]\s*,\s*){1,}["'']\^[^''"]+["'']\s*,\s*"[^"]*"\s*\)\s*;\s*if\s*\(\s*in_array\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*[''"][^''"]+[''"]\s*\]\s*,\s*\$\w{1,40}\s*\)\s*\)\s*\{\s*header\s*\(\s*''HTTP/1\.0 404 Not Found''\s*\)\s*;\s*exit\s*\(\s*\)\s*;\s*\}\s*else\s*\{\s*foreach\s*\(\s*\$\w{1,40}\s*as\s*\$\w{1,40}\s*\)\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2324"
    name: "PHP-REX-2324"
    description: "Malware detection signature PHP-REX-2324"
    severity: critical
    category: php_backdoor
    pattern: '\$g___g_\s*=\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2325"
    name: "PHP-REX-2325"
    description: "Malware detection signature PHP-REX-2325"
    severity: critical
    category: php_backdoor
    pattern: '\)\s*eval\(gzuncompress\(base64_decode\(\$_(GET|POST|COOKIE|SERVER|REQUEST)\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2326"
    name: "PHP-REX-2326"
    description: "Malware detection signature PHP-REX-2326"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*\[?Mister\]?\s*\[?Spy\]?\s*Masse\s*-\s*S3ND3R'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2328"
    name: "PHP-REX-2328"
    description: "Malware detection signature PHP-REX-2328"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*[^\<]{0,19}\s*r57c99\.com'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2329"
    name: "PHP-REX-2329"
    description: "Malware detection signature PHP-REX-2329"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_POST\s*\[\s*[''"]phoneNumber[''"]\s*\]\s*!=[''"]\s*[''"]\s*\|\|\s*\$_POST\s*\[\s*[''"]recEmail[''"]\s*\]\s*!=[''"]\s*[''"]\s*\)\s*\{\s*\$\w{1,40}\s*=\s*mail\s*\(\s*[^\)]{1,40}\s*\$message\s*,\s*\$headers\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2333"
    name: "PHP-REX-2333"
    description: "Malware detection signature PHP-REX-2333"
    severity: critical
    category: php_backdoor
    pattern: 'else\{print "preg_fail";\}\}else\{print "preg_empty"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2335"
    name: "PHP-REX-2335"
    description: "Malware detection signature PHP-REX-2335"
    severity: critical
    category: php_backdoor
    pattern: '\$_\w{1,40}\s*=\s*basename\s*\(\s*trim\s*\(\s*preg_replace\s*\(\s*rawurldecode\s*\(\s*"[^"]{1,200}"\s*\)\s*,\s*''''\s*,\s*__FILE__\s*\)\s*\)\s*\)\s*;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2336"
    name: "PHP-REX-2336"
    description: "Malware detection signature PHP-REX-2336"
    severity: critical
    category: php_backdoor
    pattern: 'base64_decode\(''ZXJyb3JfcmVwb3J0aW5n''\),base64_decode\(''Y3Vyb'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2339"
    name: "PHP-REX-2339"
    description: "Malware detection signature PHP-REX-2339"
    severity: critical
    category: php_backdoor
    pattern: '\);\$\w+=\$\w+\('''',\$\w+\(\$\w+\("\w+","",\$\w+\.\$\w+\.\$\w+\.\$\w+\)\)\);\$\w+\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2342"
    name: "PHP-REX-2342"
    description: "Malware detection signature PHP-REX-2342"
    severity: critical
    category: php_backdoor
    pattern: '\]\[\d+\]\(\$_\d+\);include\("\{\$_\d+\}\w{1,40}\.php"\);\$GLOBALS\[''_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2343"
    name: "PHP-REX-2343"
    description: "Malware detection signature PHP-REX-2343"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\s*\(\s*isset\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*\)\s*\{\s*(eval|assert)\s*\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\s*\[\s*''[^'']*''\s*\]\s*\)\s*;\s*exit\s*;\s*\}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2344"
    name: "PHP-REX-2344"
    description: "Malware detection signature PHP-REX-2344"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*isset\s*\(\s*\$\s*\{\s*["''][^''"]*["'']\s*\}\s*\[\s*[''"][^"'']*[''"]\s*\]\s*\)\s*\)\s*\{\s*\$\w{1,40}\s*=["''][^"'']*["'']\s*;\s*\$\w{1,40}\s*\(\s*''[^'']*''\s*,\s*\$\s*\{\s*["''][^"'']*["'']\s*\}\s*\[\s*''[^'']*''\s*\]\s*,\s*[''"][^'']*[''"]\s*\)\s*;\s*exit\s*;\s*\}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2346"
    name: "PHP-REX-2346"
    description: "Malware detection signature PHP-REX-2346"
    severity: critical
    category: php_backdoor
    pattern: 'extract\(\$_(?:GET|POST|REQUEST|COOKIE)\)&&\$shall\(stripslashes\(\$\w{1,40}\)\s*\)&&exit;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2348"
    name: "PHP-REX-2348"
    description: "Malware detection signature PHP-REX-2348"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,20}(\[[''"].[''"]\])?\s*\.\s*){10,20}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2349"
    name: "PHP-REX-2349"
    description: "Malware detection signature PHP-REX-2349"
    severity: critical
    category: php_backdoor
    pattern: '\$\s*(?:\{[^{}]+\}\s*)+\([^()]*\$\s*\{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2350"
    name: "PHP-REX-2350"
    description: "Malware detection signature PHP-REX-2350"
    severity: critical
    category: php_backdoor
    pattern: 'array_filter\(\s*(/\*.+?\*/)?\s*@{0,}array\(\s*(/\*.+?\*/)?@{0,}\${"_(GET|POST|COOKIE|REQUEST|SERVER)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2351"
    name: "PHP-REX-2351"
    description: "Malware detection signature PHP-REX-2351"
    severity: critical
    category: php_backdoor
    pattern: '\$\w+\s*=\s*\$\w+\s*\(\s*\$\w+\s*,\s*\$\w+\s*,\s*''''\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2352"
    name: "PHP-REX-2352"
    description: "Malware detection signature PHP-REX-2352"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w+\s*=\s*([''"]\w*[''"]|\d+);\s*){2,}\$\w+\s*=\s*array\s*\((["''][a-zA-Z0-9/+=_]{2,}["'']\s*(,\s*)?){10,}?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2353"
    name: "PHP-REX-2353"
    description: "Malware detection signature PHP-REX-2353"
    severity: critical
    category: php_backdoor
    pattern: '\${\s*\w+\s*\(\s*["'':][^'':"]+["'']\)\s*}\s*\(\w+\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2354"
    name: "PHP-REX-2354"
    description: "Malware detection signature PHP-REX-2354"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*file_put_contents\s*\(\s*__FILE__\s*,\s*base64_decode\(\s*\$_(GET|POST|COOKIE|SERVER|REQUEST)\[\s*[''"]\w+[''"]\s*\]\s*\)\s*\)\s*\)\s*echo\s*''OK'';'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2355"
    name: "PHP-REX-2355"
    description: "Malware detection signature PHP-REX-2355"
    severity: critical
    category: php_backdoor
    pattern: '<iframe src="https?://[^"]+"\s*frameborder="0%?"\s*width="0%?"\s*height="0%?"'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2356"
    name: "PHP-REX-2356"
    description: "Malware detection signature PHP-REX-2356"
    severity: critical
    category: php_backdoor
    pattern: '(\$\w{1,20}\s*=\s*(("[^"]+"|''[^'']+''|\w{1,20})\s*\.?\s*)+(\^|\&|\|)\s*(("[^"]+"|''[^'']+''|\w{1,20})\s*\.?\s*)+;\s*){5,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2357"
    name: "PHP-REX-2357"
    description: "Malware detection signature PHP-REX-2357"
    severity: critical
    category: php_backdoor
    pattern: '\b((pics|hot|online)|(cumshot|blowjob|uncensored|viagra|cialis|levitra|tramadol|nude|celebrity|porno?|gay|teens?|squirt|sexiest|sex|fuck|tits?|lesbian)\b[\s\-]+){2,}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2358"
    name: "PHP-REX-2358"
    description: "Malware detection signature PHP-REX-2358"
    severity: critical
    category: php_backdoor
    pattern: 'new\s*CoinHive\.Anonymous'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2359"
    name: "PHP-REX-2359"
    description: "Malware detection signature PHP-REX-2359"
    severity: critical
    category: php_backdoor
    pattern: '<title>\s*Navicat\s*HTTP\s*Tunnel\s*Tester\s*</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2360"
    name: "PHP-REX-2360"
    description: "Malware detection signature PHP-REX-2360"
    severity: critical
    category: php_backdoor
    pattern: 'default_action\s*=\s*\\[''"]FilesMan'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2361"
    name: "PHP-REX-2361"
    description: "Malware detection signature PHP-REX-2361"
    severity: critical
    category: php_backdoor
    pattern: 'default_action\s*=\s*[''"]FilesMan'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2362"
    name: "PHP-REX-2362"
    description: "Malware detection signature PHP-REX-2362"
    severity: critical
    category: php_backdoor
    pattern: 'IO::Socket::INET->new\(Proto\s*=>\s*"tcp"\s*,\s*LocalPort\s*=>\s*36000\s*,\s*Listen\s*=>\s*SOMAXCONN'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2363"
    name: "PHP-REX-2363"
    description: "Malware detection signature PHP-REX-2363"
    severity: critical
    category: php_backdoor
    pattern: '\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[\s*[''"]{0,1}p2[''"]{0,1}\s*\]\s*==\s*[''"]{0,1}chmod[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2364"
    name: "PHP-REX-2364"
    description: "Malware detection signature PHP-REX-2364"
    severity: critical
    category: php_backdoor
    pattern: 'Captain\s+Crunch\s+Team'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2365"
    name: "PHP-REX-2365"
    description: "Malware detection signature PHP-REX-2365"
    severity: critical
    category: php_backdoor
    pattern: 'by\s+Grinay'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2366"
    name: "PHP-REX-2366"
    description: "Malware detection signature PHP-REX-2366"
    severity: critical
    category: php_backdoor
    pattern: 'hacked\s+by\s+Hmei7'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2367"
    name: "PHP-REX-2367"
    description: "Malware detection signature PHP-REX-2367"
    severity: critical
    category: php_backdoor
    pattern: 'system\s+file\s+do\s+not\s+delete'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2368"
    name: "PHP-REX-2368"
    description: "Malware detection signature PHP-REX-2368"
    severity: critical
    category: php_backdoor
    pattern: '\$info \.= \(\(\$perms\s*&\s*0x0040\)\s*\?\(\(\$perms\s*&\s*0x0800\)\s*\?\s*\\[''"]s\\[''"]\s*:\s*\\[''"]x\\[''"]\s*\)\s*:\(\(\$perms\s*&\s*0x0800\)\s*\?\s*''S''\s*:\s*''-''\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2369"
    name: "PHP-REX-2369"
    description: "Malware detection signature PHP-REX-2369"
    severity: critical
    category: php_backdoor
    pattern: 'WSOsetcookie\s*\(\s*md5\s*\(\s*@?\$_SERVER\[\s*\\[''"]HTTP_HOST\\[''"]\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2370"
    name: "PHP-REX-2370"
    description: "Malware detection signature PHP-REX-2370"
    severity: critical
    category: php_backdoor
    pattern: 'WSOsetcookie\s*\(\s*md5\s*\(\s*@?\$_SERVER\[\s*[''"]HTTP_HOST[''"]\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2371"
    name: "PHP-REX-2371"
    description: "Malware detection signature PHP-REX-2371"
    severity: critical
    category: php_backdoor
    pattern: 'wsoEx\s*\(\s*\\[''"]\s*tar\s*cfzv\s*\\[''"]\s*\.\s*escapeshellarg\s*\(\s*\$_POST\[\s*\\[''"]p2\\[''"]\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2372"
    name: "PHP-REX-2372"
    description: "Malware detection signature PHP-REX-2372"
    severity: critical
    category: php_backdoor
    pattern: 'eval\s*\(?\s*base64_decode\s*\(?\s*@?\$_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2373"
    name: "PHP-REX-2373"
    description: "Malware detection signature PHP-REX-2373"
    severity: critical
    category: php_backdoor
    pattern: 'filepath\s*=\s*@?realpath\s*\(\s*\$_POST\s*\[\s*\\[''"]filepath\\[''"]\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2374"
    name: "PHP-REX-2374"
    description: "Malware detection signature PHP-REX-2374"
    severity: critical
    category: php_backdoor
    pattern: 'filepath\s*=\s*@?realpath\s*\(\s*\$_POST\s*\[\s*[''"]filepath[''"]\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2375"
    name: "PHP-REX-2375"
    description: "Malware detection signature PHP-REX-2375"
    severity: critical
    category: php_backdoor
    pattern: 'rename\s*\(\s*\s*[''"]{0,1}wso\.php[''"]{0,1}\s*,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2376"
    name: "PHP-REX-2376"
    description: "Malware detection signature PHP-REX-2376"
    severity: critical
    category: php_backdoor
    pattern: '\$MessageSubject\s*=\s*base64_decode\s*\(\s*\$_POST\s*\[\s*[''"]{0,1}msgsubject[''"]{0,1}\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2377"
    name: "PHP-REX-2377"
    description: "Malware detection signature PHP-REX-2377"
    severity: critical
    category: php_backdoor
    pattern: 'SELECT\s+1\s+FROM\s+mysql\.user\s+WHERE\s+concat\(\s*`user`\s*,\s*''@''\s*,\s*`host`\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2378"
    name: "PHP-REX-2378"
    description: "Malware detection signature PHP-REX-2378"
    severity: critical
    category: php_backdoor
    pattern: 'passthru\s*\(?\s*getenv\s*\(?\s*[''"]HTTP_ACCEPT_LANGUAGE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2379"
    name: "PHP-REX-2379"
    description: "Malware detection signature PHP-REX-2379"
    severity: critical
    category: php_backdoor
    pattern: 'passthru\s*\(?\s*getenv\s*\(?\s*\\[''"]HTTP_ACCEPT_LANGUAGE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2380"
    name: "PHP-REX-2380"
    description: "Malware detection signature PHP-REX-2380"
    severity: critical
    category: php_backdoor
    pattern: '{\s*\$\s*{\s*passthru\s*\(?\s*\$cmd\s*\)\s*}\s*}\s*<br>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2381"
    name: "PHP-REX-2381"
    description: "Malware detection signature PHP-REX-2381"
    severity: critical
    category: php_backdoor
    pattern: 'runcommand\s*\(\s*[''"]shellhelp[''"]\s*,\s*[''"](GET|POST|SERVER|COOKIE|REQUEST|FILES)[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2382"
    name: "PHP-REX-2382"
    description: "Malware detection signature PHP-REX-2382"
    severity: critical
    category: php_backdoor
    pattern: 'ncftpput\s*-u\s*\$ftp_user_name'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2383"
    name: "PHP-REX-2383"
    description: "Malware detection signature PHP-REX-2383"
    severity: critical
    category: php_backdoor
    pattern: '\$login\s*=\s*@?posix_getuid\(?\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2384"
    name: "PHP-REX-2384"
    description: "Malware detection signature PHP-REX-2384"
    severity: critical
    category: php_backdoor
    pattern: '!@?\$_REQUEST\s*\[\s*[''"]c99sh_surl[''"]\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2385"
    name: "PHP-REX-2385"
    description: "Malware detection signature PHP-REX-2385"
    severity: critical
    category: php_backdoor
    pattern: 'setcookie\(?\s*[''"]mysql_web_admin_username[''"]\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2386"
    name: "PHP-REX-2386"
    description: "Malware detection signature PHP-REX-2386"
    severity: critical
    category: php_backdoor
    pattern: '\b(ftp_exec|system|shell_exec|passthru|popen|proc_open)\([''"]\$cmd\s+1>\s*/tmp/cmdtemp\s+2>&1;\s*cat\s+/tmp/cmdtemp;\s*rm\s+/tmp/cmdtemp[''"]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2387"
    name: "PHP-REX-2387"
    description: "Malware detection signature PHP-REX-2387"
    severity: critical
    category: php_backdoor
    pattern: '\$fe\([''"]\$cmd\s+2>&1[''"]\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2388"
    name: "PHP-REX-2388"
    description: "Malware detection signature PHP-REX-2388"
    severity: critical
    category: php_backdoor
    pattern: '\$function\s*\(?\s*@?\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\s*\[\s*[''"]{0,1}cmd[''"]{0,1}\s*\]\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2389"
    name: "PHP-REX-2389"
    description: "Malware detection signature PHP-REX-2389"
    severity: critical
    category: php_backdoor
    pattern: '\$cmd\s*=\s*\(\s*@?\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\s*\[\s*[''"]{0,1}.+?[''"]{0,1}\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2390"
    name: "PHP-REX-2390"
    description: "Malware detection signature PHP-REX-2390"
    severity: critical
    category: php_backdoor
    pattern: 'eva1[a-zA-Z0-9_]+Sir'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2391"
    name: "PHP-REX-2391"
    description: "Malware detection signature PHP-REX-2391"
    severity: critical
    category: php_backdoor
    pattern: '\$ini\s*\[\s*[''"]{0,1}users[''"]{0,1}\s*\]\s*=\s*array\s*\(\s*[''"]{0,1}root[''"]{0,1}\s*=>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2392"
    name: "PHP-REX-2392"
    description: "Malware detection signature PHP-REX-2392"
    severity: critical
    category: php_backdoor
    pattern: 'proc_open\s*\(\s*[''"]{0,1}IHSteam'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2393"
    name: "PHP-REX-2393"
    description: "Malware detection signature PHP-REX-2393"
    severity: critical
    category: php_backdoor
    pattern: '[''"]{0,1}httpd\.conf[''"]{0,1}\s*,\s*[''"]{0,1}vhosts\.conf[''"]{0,1}\s*,\s*[''"]{0,1}cfg\.php[''"]{0,1}\s*,\s*[''"]{0,1}config\.php[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2394"
    name: "PHP-REX-2394"
    description: "Malware detection signature PHP-REX-2394"
    severity: critical
    category: php_backdoor
    pattern: '\s*{\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\s*\[\s*[''"]{0,1}root[''"]{0,1}\s*\]\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2395"
    name: "PHP-REX-2395"
    description: "Malware detection signature PHP-REX-2395"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\s*\(?\s*[''"]{0,1}/\.\*/e[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2396"
    name: "PHP-REX-2396"
    description: "Malware detection signature PHP-REX-2396"
    severity: critical
    category: php_backdoor
    pattern: 'eval\s*\(?\s*file_get_contents\s*\(?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2397"
    name: "PHP-REX-2397"
    description: "Malware detection signature PHP-REX-2397"
    severity: critical
    category: php_backdoor
    pattern: '@?setcookie\s*\(?\s*[''"]{0,1}hit[''"]{0,1},\s*1\s*,\s*time\s*\(?\s*\)?\s*\+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2398"
    name: "PHP-REX-2398"
    description: "Malware detection signature PHP-REX-2398"
    severity: critical
    category: php_backdoor
    pattern: 'eval\s*\(?@?\s*stripslashes\s*\(?\s*@?\$_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2399"
    name: "PHP-REX-2399"
    description: "Malware detection signature PHP-REX-2399"
    severity: critical
    category: php_backdoor
    pattern: 'eval\s*\(?@?\s*stripslashes\s*\(?\s*array_pop\s*\(?\s*@?\$_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2400"
    name: "PHP-REX-2400"
    description: "Malware detection signature PHP-REX-2400"
    severity: critical
    category: php_backdoor
    pattern: 'fopen\s*\(?\s*[''"]{0,1}/etc/passwd[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2401"
    name: "PHP-REX-2401"
    description: "Malware detection signature PHP-REX-2401"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[[''"]{0,1}____'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2402"
    name: "PHP-REX-2402"
    description: "Malware detection signature PHP-REX-2402"
    severity: critical
    category: php_backdoor
    pattern: 'is_callable\s*\(?\s*[''"]{0,1}\b(ftp_exec|system|shell_exec|passthru|popen|proc_open)[''"]{0,1}\)?\s+and\s+!in_array\s*\(?\s*[''"]{0,1}\b(ftp_exec|system|shell_exec|passthru|popen|proc_open)[''"]{0,1}\s*,\s*\$disablefuncs'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2403"
    name: "PHP-REX-2403"
    description: "Malware detection signature PHP-REX-2403"
    severity: critical
    category: php_backdoor
    pattern: 'file_get_contents\s*\(?\s*trim\s*\(\s*\$.+?\[\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[[''"]{0,1}.+?[''"]{0,1}\]\]\)\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2404"
    name: "PHP-REX-2404"
    description: "Malware detection signature PHP-REX-2404"
    severity: critical
    category: php_backdoor
    pattern: 'wp_posts\s+WHERE\s+post_type\s*=\s*[''"]{0,1}post[''"]{0,1}\s+AND\s+post_status\s*=\s*[''"]{0,1}publish[''"]{0,1}\s+ORDER\s+BY\s+`ID`\s+DESC'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2405"
    name: "PHP-REX-2405"
    description: "Malware detection signature PHP-REX-2405"
    severity: critical
    category: php_backdoor
    pattern: 'exec\s*\(\s*[''"]ipfw'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2406"
    name: "PHP-REX-2406"
    description: "Malware detection signature PHP-REX-2406"
    severity: critical
    category: php_backdoor
    pattern: 'strrev\(?\s*[''"]{0,1}tressa[''"]{0,1}\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2407"
    name: "PHP-REX-2407"
    description: "Malware detection signature PHP-REX-2407"
    severity: critical
    category: php_backdoor
    pattern: 'strrev\(?\s*[''"]{0,1}edoced_46esab[''"]{0,1}\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2408"
    name: "PHP-REX-2408"
    description: "Malware detection signature PHP-REX-2408"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+urlGetContents\s*\(?\s*\$url\s*,\s*\$timeout\s*=\s*\d+\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2409"
    name: "PHP-REX-2409"
    description: "Malware detection signature PHP-REX-2409"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite\s*\(?\s*\$fpsetv\s*,\s*getenv\s*\(\s*[''"]HTTP_COOKIE[''"]\s*\)\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2410"
    name: "PHP-REX-2410"
    description: "Malware detection signature PHP-REX-2410"
    severity: critical
    category: php_backdoor
    pattern: 'isset\s*\(?\s*\$_POST\s*\[\s*[''"]{0,1}execgate[''"]{0,1}\s*\]\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2411"
    name: "PHP-REX-2411"
    description: "Malware detection signature PHP-REX-2411"
    severity: critical
    category: php_backdoor
    pattern: 'UNION\s+SELECT\s+[''"]{0,1}0[''"]{0,1}\s*,\s*[''"]{0,1}<\? system\(\\\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[cpc\]\);exit;\s*\?>[''"]{0,1}\s*,\s*0\s*,0\s*,\s*0\s*,\s*0\s+INTO\s+OUTFILE\s+[''"]{0,1}\$[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2412"
    name: "PHP-REX-2412"
    description: "Malware detection signature PHP-REX-2412"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[[''"]{0,1}.+?[''"]{0,1}\]=Array\s*\(\s*base64_decode\s*\(\s*[''"]{0,1}.+?[''"]{0,1}\s*\)\s*,\s*base64_decode\s*\(\s*[''"]{0,1}.+?[''"]{0,1}\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2413"
    name: "PHP-REX-2413"
    description: "Malware detection signature PHP-REX-2413"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\s*\(?\s*[''"]{0,1}/\.\*\[.+?\]\?/e[''"]{0,1}\s*,\s*str_replace'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2414"
    name: "PHP-REX-2414"
    description: "Malware detection signature PHP-REX-2414"
    severity: critical
    category: php_backdoor
    pattern: '\$GLOBALS\[\s*[''"]{0,1}.+?[''"]{0,1}\s*\]\[\s*\d+\s*\]\(\s*\$_\d+\s*,\s*_\d+\s*\(\s*\d+\s*\)\s*\)\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2415"
    name: "PHP-REX-2415"
    description: "Malware detection signature PHP-REX-2415"
    severity: critical
    category: php_backdoor
    pattern: '\$beecode\s*=@?file_get_contents\s*\(?[''"]{0,1}\s*\$urlpurs\s*[''"]{0,1}\)?\s*;\s*echo\s+[''"]{0,1}\$beecode[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2416"
    name: "PHP-REX-2416"
    description: "Malware detection signature PHP-REX-2416"
    severity: critical
    category: php_backdoor
    pattern: '\$x\d+\s*=\s*[''"].+?[''"]\s*;\s*\$x\d+\s*=\s*[''"].+?[''"]\s*;\s*\$x\d+\s*=\s*[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2417"
    name: "PHP-REX-2417"
    description: "Malware detection signature PHP-REX-2417"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+\$_F\s*=\s*__FILE__\s*;\s*\$_X\s*='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2418"
    name: "PHP-REX-2418"
    description: "Malware detection signature PHP-REX-2418"
    severity: critical
    category: php_backdoor
    pattern: 'if\s+\(?\s*mail\s*\(\s*\$recp\s*,\s*\$subj\s*,\s*\$stunt\s*,\s*\$frm'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2419"
    name: "PHP-REX-2419"
    description: "Malware detection signature PHP-REX-2419"
    severity: critical
    category: php_backdoor
    pattern: 'if\s+\(\s*strpos\s*\(\s*\$url\s*,\s*[''"]js/mootools\.js[''"]\s*\)\s*===\s*false\s+&&\s+strpos\s*\(\s*\$url\s*,\s*[''"]js/caption\.js[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2420"
    name: "PHP-REX-2420"
    description: "Malware detection signature PHP-REX-2420"
    severity: critical
    category: php_backdoor
    pattern: 'eval\s*\(?\s*stripslashes\s*\(?\s*array_pop\(?\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2421"
    name: "PHP-REX-2421"
    description: "Malware detection signature PHP-REX-2421"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(?\s*isset\s*\(?\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\s*\[\s*[''"]{0,1}\w+[''"]{0,1}\s*\]\s*\)?\s*\)\s*{\s*\$\w+\s*=\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\s*\[\s*[''"]{0,1}\w+[''"]{0,1}\s*\];\s*eval\s*\(?\s*\$\w+\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2422"
    name: "PHP-REX-2422"
    description: "Malware detection signature PHP-REX-2422"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\s*\(\s*[''"]/\^\(www\|ftp\)\\\./i[''"]\s*,\s*[''"][''"],\s*@\$_SERVER\s*\[\s*[''"]{0,1}HTTP_HOST[''"]{0,1}\s*\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2423"
    name: "PHP-REX-2423"
    description: "Malware detection signature PHP-REX-2423"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(!function_exists\s*\(\s*[''"]posix_getpwuid[''"]\s*\)\s*&&\s*!in_array\s*\(\s*[''"]posix_getpwuid'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2424"
    name: "PHP-REX-2424"
    description: "Malware detection signature PHP-REX-2424"
    severity: critical
    category: php_backdoor
    pattern: '=\s*preg_split\s*\(\s*[''"]/\\,\(\\ \+\)\?/[''"],\s*@?ini_get\s*\(\s*[''"]disable_functions'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2425"
    name: "PHP-REX-2425"
    description: "Malware detection signature PHP-REX-2425"
    severity: critical
    category: php_backdoor
    pattern: '\$b\s*\.\s*\$p\s*\.\s*\$h\s*\.\s*\$k\s*\.\s*\$v'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2426"
    name: "PHP-REX-2426"
    description: "Malware detection signature PHP-REX-2426"
    severity: critical
    category: php_backdoor
    pattern: '\(\s*[''"]INSHELL[''"]\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2427"
    name: "PHP-REX-2427"
    description: "Malware detection signature PHP-REX-2427"
    severity: critical
    category: php_backdoor
    pattern: '(GET|POST|SERVER|COOKIE|REQUEST|FILES)\s*\[\s*[''"]___[''"]\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2428"
    name: "PHP-REX-2428"
    description: "Malware detection signature PHP-REX-2428"
    severity: critical
    category: php_backdoor
    pattern: 'array_pop\s*\(?\s*\$workReplace\s*,\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\s*,\s*\$countKeysNew'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2429"
    name: "PHP-REX-2429"
    description: "Malware detection signature PHP-REX-2429"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(?\s*@?preg_match\s*\(?\s*str'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2430"
    name: "PHP-REX-2430"
    description: "Malware detection signature PHP-REX-2430"
    severity: critical
    category: php_backdoor
    pattern: '@\$_COOKIE\[[''"]{0,1}statCounter[''"]{0,1}\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2431"
    name: "PHP-REX-2431"
    description: "Malware detection signature PHP-REX-2431"
    severity: critical
    category: php_backdoor
    pattern: 'fopen\s*\(?\s*[''"]http://[''"]\s*\.\s*\$check_domain\s*\.\s*[''"]:80[''"]\s*\.\s*\$check_doc\s*,\s*[''"]r[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2432"
    name: "PHP-REX-2432"
    description: "Malware detection signature PHP-REX-2432"
    severity: critical
    category: php_backdoor
    pattern: '@?gzinflate\s*\(\s*@?base64_decode\s*\(\s*@?str_replace'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2433"
    name: "PHP-REX-2433"
    description: "Malware detection signature PHP-REX-2433"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contentz\s*\(?\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2434"
    name: "PHP-REX-2434"
    description: "Malware detection signature PHP-REX-2434"
    severity: critical
    category: php_backdoor
    pattern: '&&\s*function_exists\s*\(?\s*[''"]{0,1}getmxrr[''"]{0,1}\)\s*\)\s*{\s*@getmxrr\s*\(?\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2435"
    name: "PHP-REX-2435"
    description: "Malware detection signature PHP-REX-2435"
    severity: critical
    category: php_backdoor
    pattern: '\$postResult\s*=\s*curl_exec\s*\(?\s*\$ch'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2436"
    name: "PHP-REX-2436"
    description: "Malware detection signature PHP-REX-2436"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+sql2_safe\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2437"
    name: "PHP-REX-2437"
    description: "Malware detection signature PHP-REX-2437"
    severity: critical
    category: php_backdoor
    pattern: 'exit\s*\(\s*[''"]{0,1}<script>\s*setTimeout\s*\(\s*\\[''"]{0,1}document\.location\.href'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2438"
    name: "PHP-REX-2438"
    description: "Malware detection signature PHP-REX-2438"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(\s*stripslashes\(\s*\\\$_REQUEST'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2439"
    name: "PHP-REX-2439"
    description: "Malware detection signature PHP-REX-2439"
    severity: critical
    category: php_backdoor
    pattern: '!touch\([''"]{0,1}\.\./\.\./language/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2440"
    name: "PHP-REX-2440"
    description: "Malware detection signature PHP-REX-2440"
    severity: critical
    category: php_backdoor
    pattern: 'Dc0RHa[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2441"
    name: "PHP-REX-2441"
    description: "Malware detection signature PHP-REX-2441"
    severity: critical
    category: php_backdoor
    pattern: 'header\s*\([''"]Location:\s*[''"]\s*\.\s*\$to\s*\.\s*urldecode'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2442"
    name: "PHP-REX-2442"
    description: "Malware detection signature PHP-REX-2442"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*stripos\s*\(\s*\$_SERVER\[[''"]{0,1}HTTP_USER_AGENT[''"]{0,1}\]\s*,\s*[''"]{0,1}Android[''"]{0,1}\)\s*!==false\s*&&\s*!\$_COOKIE\[[''"]{0,1}dle_user_id'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2443"
    name: "PHP-REX-2443"
    description: "Malware detection signature PHP-REX-2443"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+@file_get_contents\s*\(\s*\$get'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2444"
    name: "PHP-REX-2444"
    description: "Malware detection signature PHP-REX-2444"
    severity: critical
    category: php_backdoor
    pattern: 'default_action\s*=\s*[''"]{0,1}FilesMan[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2445"
    name: "PHP-REX-2445"
    description: "Malware detection signature PHP-REX-2445"
    severity: critical
    category: php_backdoor
    pattern: 'Mysterious\s+Wire'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2446"
    name: "PHP-REX-2446"
    description: "Malware detection signature PHP-REX-2446"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\s*\(?\s*[''"]/\.\+/esi'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2447"
    name: "PHP-REX-2447"
    description: "Malware detection signature PHP-REX-2447"
    severity: critical
    category: php_backdoor
    pattern: 'define\s*\(?\s*[''"]SBCID_REQUEST_FILE[''"]\s*,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2448"
    name: "PHP-REX-2448"
    description: "Malware detection signature PHP-REX-2448"
    severity: critical
    category: php_backdoor
    pattern: '\$tld\s*=\s*array\s*\(\s*[''"]com[''"],[''"]org[''"],[''"]net[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2449"
    name: "PHP-REX-2449"
    description: "Malware detection signature PHP-REX-2449"
    severity: critical
    category: php_backdoor
    pattern: 'Brazil\s+HackTeam'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2450"
    name: "PHP-REX-2450"
    description: "Malware detection signature PHP-REX-2450"
    severity: critical
    category: php_backdoor
    pattern: 'if\(!empty\(\$_FILES\[[''"]{0,1}message[''"]{0,1}\]\[[''"]{0,1}name[''"]{0,1}\]\)\s+AND\s+\(md5\(\$_POST\[[''"]{0,1}nick[''"]{0,1}\]\)\s*==\s*[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2451"
    name: "PHP-REX-2451"
    description: "Malware detection signature PHP-REX-2451"
    severity: critical
    category: php_backdoor
    pattern: 'time\(\)\s*\+\s*10000\s*,\s*[''"]/[''"]\);\s*echo\s+\$m_zz;\s*eval\s*\(\$m_zz'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2452"
    name: "PHP-REX-2452"
    description: "Malware detection signature PHP-REX-2452"
    severity: critical
    category: php_backdoor
    pattern: 'return\s*\(\s*strstr\s*\(\s*\$s\s*,\s*''echo''\s*\)\s*==\s*false\s*\?\s*\(\s*strstr\s*\(\s*\$s\s*,\s*''print'''
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2453"
    name: "PHP-REX-2453"
    description: "Malware detection signature PHP-REX-2453"
    severity: critical
    category: php_backdoor
    pattern: 'set_time_limit\s*\(\s*0\s*\);\s*if\s*\(!SecretPageHandler::checkKey'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2454"
    name: "PHP-REX-2454"
    description: "Malware detection signature PHP-REX-2454"
    severity: critical
    category: php_backdoor
    pattern: '@header\([''"]Location:\s*[''"]\.[''"]h[''"]\.[''"]t[''"]\.[''"]t[''"]\.[''"]p[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2455"
    name: "PHP-REX-2455"
    description: "Malware detection signature PHP-REX-2455"
    severity: critical
    category: php_backdoor
    pattern: 'IrSecTeam'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2456"
    name: "PHP-REX-2456"
    description: "Malware detection signature PHP-REX-2456"
    severity: critical
    category: php_backdoor
    pattern: '\$rBuffLen\s*=\s*ord\s*\(\s*VC_Decrypt\s*\(\s*fread\s*\(\s*\$input,\s*1\s*\)\s*\)\s*\)\s*\*\s*256'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2457"
    name: "PHP-REX-2457"
    description: "Malware detection signature PHP-REX-2457"
    severity: critical
    category: php_backdoor
    pattern: 'clearstatcache\(\s*\);\s*if\s*\(\s*!is_dir\s*\(\s*\$fld\s*\)\s*\)\s*return'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2458"
    name: "PHP-REX-2458"
    description: "Malware detection signature PHP-REX-2458"
    severity: critical
    category: php_backdoor
    pattern: 'content=[''"]{0,1}no-cache[''"]{0,1};\s*\$config\[[''"]{0,1}description[''"]{0,1}\]\s*\.=\s*[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2459"
    name: "PHP-REX-2459"
    description: "Malware detection signature PHP-REX-2459"
    severity: critical
    category: php_backdoor
    pattern: 'tmhapbzcerff'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2460"
    name: "PHP-REX-2460"
    description: "Malware detection signature PHP-REX-2460"
    severity: critical
    category: php_backdoor
    pattern: 'file_get_contents\s*\(?\s*ADMIN_REDIR_URL\s*,\s*false\s*,\s*\$ctx\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2461"
    name: "PHP-REX-2461"
    description: "Malware detection signature PHP-REX-2461"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$i\s*<\s*\(\s*count\s*\(\s*\$_POST\[\s*[''"]{0,1}q[''"]{0,1}\s*\]\s*\)\s*-\s*1'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2462"
    name: "PHP-REX-2462"
    description: "Malware detection signature PHP-REX-2462"
    severity: critical
    category: php_backdoor
    pattern: 'isset\s*\(\s*\$_FILES\[\s*[''"]{0,1}x[''"]{0,1}\s*\]\s*\)\s*\?\s*\(\s*is_uploaded_file\s*\(\s*\$_FILES\[\s*[''"]{0,1}x[''"]{0,1}\s*\]\[\s*[''"]{0,1}tmp_name[''"]{0,1}\s*\]\s*\)\s*\?\s*\(\s*copy\s*\(\s*\$_FILES\[\s*[''"]{0,1}x[''"]{0,1}\s*\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2463"
    name: "PHP-REX-2463"
    description: "Malware detection signature PHP-REX-2463"
    severity: critical
    category: php_backdoor
    pattern: '\$URL\s*=\s*\$urls\[\s*rand\(\s*0\s*,\s*count\s*\(\s*\$urls\s*\)\s*-\s*1\s*\)\s*\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2464"
    name: "PHP-REX-2464"
    description: "Malware detection signature PHP-REX-2464"
    severity: critical
    category: php_backdoor
    pattern: '@?move_uploaded_file\s*\(\s*\$_FILES\[\s*[''"]{0,1}message[''"]{0,1}\s*\]\[\s*[''"]{0,1}tmp_name[''"]{0,1}\s*\]\s*,\s*\$security_code\s*\.\s*"/"\s*\.\s*\$_FILES\[[''"]{0,1}message[''"]{0,1}\]\[[''"]{0,1}name[''"]{0,1}\]\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2465"
    name: "PHP-REX-2465"
    description: "Malware detection signature PHP-REX-2465"
    severity: critical
    category: php_backdoor
    pattern: 'eval\s*\(?\s*strrev\s*\(?\s*str_replace'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2466"
    name: "PHP-REX-2466"
    description: "Malware detection signature PHP-REX-2466"
    severity: critical
    category: php_backdoor
    pattern: '\$res=mysql_query\([''"]{0,1}SELECT\s+\*\s+FROM\s+`watchdog_old_05`\s+WHERE\s+page'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2467"
    name: "PHP-REX-2467"
    description: "Malware detection signature PHP-REX-2467"
    severity: critical
    category: php_backdoor
    pattern: '\^downloads/\(\[0-9\]\*\)/\(\[0-9\]\*\)/\$\s+downloads\.php\?c=\$1&p=\$2'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2468"
    name: "PHP-REX-2468"
    description: "Malware detection signature PHP-REX-2468"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\s*\(\s*\$exif\[\s*\\[''"]Make\\[''"]\s*\]\s*,\s*\$exif\[\s*\\[''"]Model\\[''"]\s*\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2469"
    name: "PHP-REX-2469"
    description: "Malware detection signature PHP-REX-2469"
    severity: critical
    category: php_backdoor
    pattern: 'fclose\(\$f\);\s*echo\s*[''"]o\.k\.[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2470"
    name: "PHP-REX-2470"
    description: "Malware detection signature PHP-REX-2470"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+inject\(\$file,\s*\$injection='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2471"
    name: "PHP-REX-2471"
    description: "Malware detection signature PHP-REX-2471"
    severity: critical
    category: php_backdoor
    pattern: 'execl\([''"]/bin/sh[''"]\s*,\s*[''"]/bin/sh[''"]\s*,\s*[''"]-i[''"]\s*,\s*0\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2472"
    name: "PHP-REX-2472"
    description: "Malware detection signature PHP-REX-2472"
    severity: critical
    category: php_backdoor
    pattern: 'find\s+/\s+-type\s+f\s+-perm\s+-04000\s+-ls'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2473"
    name: "PHP-REX-2473"
    description: "Malware detection signature PHP-REX-2473"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*function_exists\s*\(\s*''pcntl_fork'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2474"
    name: "PHP-REX-2474"
    description: "Malware detection signature PHP-REX-2474"
    severity: critical
    category: php_backdoor
    pattern: 'urlencode\(print_r\(array\(\),1\)\),5,1\)\.c\),\$c\);}eval\(\$d\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2475"
    name: "PHP-REX-2475"
    description: "Malware detection signature PHP-REX-2475"
    severity: critical
    category: php_backdoor
    pattern: 'array_key_exists\s*\(\s*\$fileRas\s*,\s*\$fileType\)\s*\?\s*\$fileType\[\s*\$fileRas\s*\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2476"
    name: "PHP-REX-2476"
    description: "Malware detection signature PHP-REX-2476"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*fwrite\s*\(\s*\$handle\s*,\s*file_get_contents\s*\(\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2477"
    name: "PHP-REX-2477"
    description: "Malware detection signature PHP-REX-2477"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$_POST\[\s*[''"]{0,1}path[''"]{0,1}\s*\]\s*==\s*[''"]{0,1}[''"]{0,1}\s*\)\s*{\s*\$uploadfile\s*=\s*\$_FILES\[\s*[''"]{0,1}file[''"]{0,1}\s*\]\[\s*[''"]{0,1}name[''"]{0,1}\s*\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2478"
    name: "PHP-REX-2478"
    description: "Malware detection signature PHP-REX-2478"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*\$dataSize\s*<\s*BOTCRYPT_MAX_SIZE\s*\)\s*rc4\s*\(\s*\$data,\s*\$cryptkey'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2479"
    name: "PHP-REX-2479"
    description: "Malware detection signature PHP-REX-2479"
    severity: critical
    category: php_backdoor
    pattern: ',\s*array\s*\(''\.'',''\.\.'',''Thumbs\.db''\)\s*\)\s*\)\s*{\s*continue;\s*}\s*if\s*\(\s*is_file'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2480"
    name: "PHP-REX-2480"
    description: "Malware detection signature PHP-REX-2480"
    severity: critical
    category: php_backdoor
    pattern: '\)\s*\.\s*substr\s*\(\s*md5\s*\(\s*strrev\s*\(\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2481"
    name: "PHP-REX-2481"
    description: "Malware detection signature PHP-REX-2481"
    severity: critical
    category: php_backdoor
    pattern: 'assert\s*\(\s*@?stripslashes'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2482"
    name: "PHP-REX-2482"
    description: "Malware detection signature PHP-REX-2482"
    severity: critical
    category: php_backdoor
    pattern: '[''"]e/\*\./[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2483"
    name: "PHP-REX-2483"
    description: "Malware detection signature PHP-REX-2483"
    severity: critical
    category: php_backdoor
    pattern: 'echo[''"]{0,1}<center><b>Done\s*==>\s*\$userfile_name'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2484"
    name: "PHP-REX-2484"
    description: "Malware detection signature PHP-REX-2484"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\$key\s*!=\s*[''"]{0,1}mail_to[''"]{0,1}\s*&&\s*\$key\s*!=\s*[''"]{0,1}smtp_server[''"]{0,1}\s*&&\s*\$key\s*!=\s*[''"]{0,1}smtp_port'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2485"
    name: "PHP-REX-2485"
    description: "Malware detection signature PHP-REX-2485"
    severity: critical
    category: php_backdoor
    pattern: 'strpos\(\$ua,\s*[''"]{0,1}yandexbot[''"]{0,1}\)\s*!==\s*false'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2486"
    name: "PHP-REX-2486"
    description: "Malware detection signature PHP-REX-2486"
    severity: critical
    category: php_backdoor
    pattern: 'if\(CheckIPOperator\(\)\s*&&\s*!isModem\(\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2487"
    name: "PHP-REX-2487"
    description: "Malware detection signature PHP-REX-2487"
    severity: critical
    category: php_backdoor
    pattern: 'url=<\?php\s*echo\s*\$rand_url;\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2488"
    name: "PHP-REX-2488"
    description: "Malware detection signature PHP-REX-2488"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*[''"]answer=error[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2489"
    name: "PHP-REX-2489"
    description: "Malware detection signature PHP-REX-2489"
    severity: critical
    category: php_backdoor
    pattern: '\$post\s*=\s*[''"]\\x77\\x67\\x65'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2490"
    name: "PHP-REX-2490"
    description: "Malware detection signature PHP-REX-2490"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(detect_mobile_device\(\)\)\s*{\s*header'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2491"
    name: "PHP-REX-2491"
    description: "Malware detection signature PHP-REX-2491"
    severity: critical
    category: php_backdoor
    pattern: 'IrIsT\.Ir'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2492"
    name: "PHP-REX-2492"
    description: "Malware detection signature PHP-REX-2492"
    severity: critical
    category: php_backdoor
    pattern: '\$letter\s*=\s*str_replace\s*\(\s*\$ARRAY\[0\]\[\$j\]\s*,\s*\$arr\[\$ind\]\s*,\s*\$letter'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2493"
    name: "PHP-REX-2493"
    description: "Malware detection signature PHP-REX-2493"
    severity: critical
    category: php_backdoor
    pattern: 'create_function\s*\(\s*[''"]\$m[''"]\s*,\s*[''"]if\s*\(\s*\$m\s*\[\s*0x01\s*\]\s*==\s*[''"]L[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2494"
    name: "PHP-REX-2494"
    description: "Malware detection signature PHP-REX-2494"
    severity: critical
    category: php_backdoor
    pattern: '\$p\s*=\s*strpos\(\$tx\s*,\s*[''"]{0,1}{\#[''"]{0,1}\s*,\s*\$p2\s*\+\s*2\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2495"
    name: "PHP-REX-2495"
    description: "Malware detection signature PHP-REX-2495"
    severity: critical
    category: php_backdoor
    pattern: '\$user_agent\s*=\s*preg_replace\s*\(\s*[''"]\|User\\\.Agent\\:\[\\s \]\?\|i[''"]\s*,\s*[''"][''"]\s*,\s*\$user_agent'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2496"
    name: "PHP-REX-2496"
    description: "Malware detection signature PHP-REX-2496"
    severity: critical
    category: php_backdoor
    pattern: 'print\("\#\s+info\s+OK\\n\\n"\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2497"
    name: "PHP-REX-2497"
    description: "Malware detection signature PHP-REX-2497"
    severity: critical
    category: php_backdoor
    pattern: '\]\s*}\s*=\s*trim\s*\(\s*array_pop\s*\(\s*\${\s*\${'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2498"
    name: "PHP-REX-2498"
    description: "Malware detection signature PHP-REX-2498"
    severity: critical
    category: php_backdoor
    pattern: '\]=[''"]{0,1}ip[''"]{0,1}\s*;\s*if\s*\(\s*isset\s*\(\s*\$_SERVER\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2499"
    name: "PHP-REX-2499"
    description: "Malware detection signature PHP-REX-2499"
    severity: critical
    category: php_backdoor
    pattern: 'print\s*\$sock "PRIVMSG "\.\$owner'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2500"
    name: "PHP-REX-2500"
    description: "Malware detection signature PHP-REX-2500"
    severity: critical
    category: php_backdoor
    pattern: 'if\(/\^\\:\$owner!\.\*\\@\.\*PRIVMSG\.\*:\.msgflood\(\.\*\)/\){'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2501"
    name: "PHP-REX-2501"
    description: "Malware detection signature PHP-REX-2501"
    severity: critical
    category: php_backdoor
    pattern: '\[-\]\s+Connection\s+faild'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2502"
    name: "PHP-REX-2502"
    description: "Malware detection signature PHP-REX-2502"
    severity: critical
    category: php_backdoor
    pattern: '<!--\#exec\s+cmd=[''"]{0,1}\$HTTP_ACCEPT[''"]{0,1}\s*-->'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2503"
    name: "PHP-REX-2503"
    description: "Malware detection signature PHP-REX-2503"
    severity: critical
    category: php_backdoor
    pattern: '[''"]{0,1}From:\s*[''"]{0,1}\.\$_POST\[[''"]{0,1}realname[''"]{0,1}\]\.[''"]{0,1} [''"]{0,1}\.[''"]{0,1} <[''"]{0,1}\.\$_POST\[[''"]{0,1}from[''"]{0,1}\]\.[''"]{0,1}>\\n[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2504"
    name: "PHP-REX-2504"
    description: "Malware detection signature PHP-REX-2504"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*is_dir\s*\(\s*\$FullPath\s*\)\s*\)\s*AllDir\s*\(\s*\$FullPath\s*,\s*\$Files\s*\);\s*}\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2505"
    name: "PHP-REX-2505"
    description: "Malware detection signature PHP-REX-2505"
    severity: critical
    category: php_backdoor
    pattern: '\$p\s*=\s*strpos\s*\(\s*\$tx\s*,\s*[''"]{0,1}{\#[''"]{0,1}\s*,\s*\$p2\s*\+\s*2\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2506"
    name: "PHP-REX-2506"
    description: "Malware detection signature PHP-REX-2506"
    severity: critical
    category: php_backdoor
    pattern: 'preg_match_all\([''"]{0,1}/<a href="\\/url\\\?q=\(\.\+\?\)\[&\|"\]\+/is[''"]{0,1}, \$page\[[''"]{0,1}exe[''"]{0,1}\], \$links\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2507"
    name: "PHP-REX-2507"
    description: "Malware detection signature PHP-REX-2507"
    severity: critical
    category: php_backdoor
    pattern: '\$url\s*=\s*\$url\s*\.\s*[''"]{0,1}\?[''"]{0,1}\s*\.\s*http_build_query\(\$query\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2508"
    name: "PHP-REX-2508"
    description: "Malware detection signature PHP-REX-2508"
    severity: critical
    category: php_backdoor
    pattern: 'print\s+\$sock\s+[''"]{0,1}NICK [''"]{0,1}\s+\.\s+\$nick\s+\.\s+[''"]{0,1}\\n[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2509"
    name: "PHP-REX-2509"
    description: "Malware detection signature PHP-REX-2509"
    severity: critical
    category: php_backdoor
    pattern: 'PRIVMSG\.\*:\.owner\\s\+\(\.\*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2510"
    name: "PHP-REX-2510"
    description: "Malware detection signature PHP-REX-2510"
    severity: critical
    category: php_backdoor
    pattern: '\$resultFUL\s*=\s*stripcslashes\s*\(\s*\$_POST\[[''"]{0,1}resultFUL[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2511"
    name: "PHP-REX-2511"
    description: "Malware detection signature PHP-REX-2511"
    severity: critical
    category: php_backdoor
    pattern: '\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[[''"]{0,1}[a-zA-Z0-9_]+[''"]{0,1}\]\(\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[[''"]{0,1}[a-zA-Z0-9_]+[''"]{0,1}\]\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2512"
    name: "PHP-REX-2512"
    description: "Malware detection signature PHP-REX-2512"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*@?md5\s*\(\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2513"
    name: "PHP-REX-2513"
    description: "Malware detection signature PHP-REX-2513"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+file_get_contents\s*\(\s*base64_url_decode\s*\(\s*@?\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2514"
    name: "PHP-REX-2514"
    description: "Malware detection signature PHP-REX-2514"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite\s*\(\s*\$fh\s*,\s*stripslashes\s*\(\s*@?\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2515"
    name: "PHP-REX-2515"
    description: "Malware detection signature PHP-REX-2515"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*mail\s*\(\s*\$mails\[\$i\]\s*,\s*\$tema\s*,\s*base64_encode\s*\(\s*\$text'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2516"
    name: "PHP-REX-2516"
    description: "Malware detection signature PHP-REX-2516"
    severity: critical
    category: php_backdoor
    pattern: '\$gzip\s*=\s*@?gzinflate\s*\(\s*@?substr\s*\(\s*\$gzencode_arg'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2517"
    name: "PHP-REX-2517"
    description: "Malware detection signature PHP-REX-2517"
    severity: critical
    category: php_backdoor
    pattern: 'move_uploaded_file\(\$_FILES\[[''"]{0,1}elif[''"]{0,1}\]\[[''"]{0,1}tmp_name'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2518"
    name: "PHP-REX-2518"
    description: "Malware detection signature PHP-REX-2518"
    severity: critical
    category: php_backdoor
    pattern: 'header\([''"]{0,1}s:\s*[''"]{0,1}\s*\.\s*php_uname\s*\(\s*[''"]{0,1}n[''"]{0,1}\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2519"
    name: "PHP-REX-2519"
    description: "Malware detection signature PHP-REX-2519"
    severity: critical
    category: php_backdoor
    pattern: 'By\s+WebRooT'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2520"
    name: "PHP-REX-2520"
    description: "Malware detection signature PHP-REX-2520"
    severity: critical
    category: php_backdoor
    pattern: '\$OOO0O0O00=__FILE__;\s*\$OO00O0000\s*=\s*0x1b540;\s*eval'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2521"
    name: "PHP-REX-2521"
    description: "Malware detection signature PHP-REX-2521"
    severity: critical
    category: php_backdoor
    pattern: '\$mailer\s*=\s*\$_POST\[[''"]{0,1}x_mailer[''"]{0,1}\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2522"
    name: "PHP-REX-2522"
    description: "Malware detection signature PHP-REX-2522"
    severity: critical
    category: php_backdoor
    pattern: 'preg_match\([''"]/\(yandex\|google\|bot\)/i[''"],\s*getenv\([''"]HTTP_USER_AGENT'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2523"
    name: "PHP-REX-2523"
    description: "Malware detection signature PHP-REX-2523"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+\$ifupload=[''"]{0,1}\s*ItsOk\s*[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2524"
    name: "PHP-REX-2524"
    description: "Malware detection signature PHP-REX-2524"
    severity: critical
    category: php_backdoor
    pattern: 'fsockopen\s*\(\s*\$ConnectAddress\s*,\s*25'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2525"
    name: "PHP-REX-2525"
    description: "Malware detection signature PHP-REX-2525"
    severity: critical
    category: php_backdoor
    pattern: '\$_SESSION\[[''"]{0,1}session_pin[''"]{0,1}\]\s*=\s*[''"]{0,1}\$PIN'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2526"
    name: "PHP-REX-2526"
    description: "Malware detection signature PHP-REX-2526"
    severity: critical
    category: php_backdoor
    pattern: '\$url[''"]{0,1}\s*\.\s*\$session_id\s*\.\s*[''"]{0,1}/login\.html'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2527"
    name: "PHP-REX-2527"
    description: "Malware detection signature PHP-REX-2527"
    severity: critical
    category: php_backdoor
    pattern: 'f\s*=\s*\$q\s*\.\s*\$a\s*\.\s*\$b\s*\.\s*\$x'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2528"
    name: "PHP-REX-2528"
    description: "Malware detection signature PHP-REX-2528"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(md5\(trim\(\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2529"
    name: "PHP-REX-2529"
    description: "Malware detection signature PHP-REX-2529"
    severity: critical
    category: php_backdoor
    pattern: 'die\s*\(\s*PHP_OS\s*\.\s*chr\s*\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2530"
    name: "PHP-REX-2530"
    description: "Malware detection signature PHP-REX-2530"
    severity: critical
    category: php_backdoor
    pattern: 'create_function\s*\([''"][''"]\s*,\s*\b(eval|base64_decode|strrev|preg_replace|preg_replace_callback|urldecode|strstr|gzinflate|sprintf|gzuncompress|assert|str_rot13|md5|array_walk|array_filter)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2531"
    name: "PHP-REX-2531"
    description: "Malware detection signature PHP-REX-2531"
    severity: critical
    category: php_backdoor
    pattern: '\$headers\s*=\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[[''"]{0,1}headers[''"]{0,1}\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2532"
    name: "PHP-REX-2532"
    description: "Malware detection signature PHP-REX-2532"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\s*\([''"]{0,1}1\.txt[''"]{0,1}\s*,\s*print_r\s*\(\s*\$_POST\s*,\s*true'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2533"
    name: "PHP-REX-2533"
    description: "Malware detection signature PHP-REX-2533"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite\s*\(\s*\$flw\s*,\s*\$fl\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2534"
    name: "PHP-REX-2534"
    description: "Malware detection signature PHP-REX-2534"
    severity: critical
    category: php_backdoor
    pattern: '\$sys_params\s*=\s*@?file_get_contents'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2535"
    name: "PHP-REX-2535"
    description: "Malware detection signature PHP-REX-2535"
    severity: critical
    category: php_backdoor
    pattern: '\$allemails\s*=\s*@split\("\\n"\s*,\s*\$emaillist\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2536"
    name: "PHP-REX-2536"
    description: "Malware detection signature PHP-REX-2536"
    severity: critical
    category: php_backdoor
    pattern: 'file_put_contents\(SVC_SELF\s*\.\s*[''"]/\.htaccess'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2537"
    name: "PHP-REX-2537"
    description: "Malware detection signature PHP-REX-2537"
    severity: critical
    category: php_backdoor
    pattern: 'create_function\([''"][''"],\s*\$opt\[1\]\s*\.\s*\$opt\[4\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2538"
    name: "PHP-REX-2538"
    description: "Malware detection signature PHP-REX-2538"
    severity: critical
    category: php_backdoor
    pattern: '<script\s+type=[''"]{0,1}text/javascript[''"]{0,1}\s+src=[''"]{0,1}jquery-u\.js[''"]{0,1}></script>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2539"
    name: "PHP-REX-2539"
    description: "Malware detection signature PHP-REX-2539"
    severity: critical
    category: php_backdoor
    pattern: 'URL=<\?echo\s+\$index;\s+\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2540"
    name: "PHP-REX-2540"
    description: "Malware detection signature PHP-REX-2540"
    severity: critical
    category: php_backdoor
    pattern: '\#\s*securityspace\.com'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2541"
    name: "PHP-REX-2541"
    description: "Malware detection signature PHP-REX-2541"
    severity: critical
    category: php_backdoor
    pattern: '\#\s*stealth\s*bot'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2542"
    name: "PHP-REX-2542"
    description: "Malware detection signature PHP-REX-2542"
    severity: critical
    category: php_backdoor
    pattern: 'Apple\s+SpAm\s+ReZulT'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2543"
    name: "PHP-REX-2543"
    description: "Malware detection signature PHP-REX-2543"
    severity: critical
    category: php_backdoor
    pattern: 'is_writable\(\$dir\.[''"]wp-includes/version\.php[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2544"
    name: "PHP-REX-2544"
    description: "Malware detection signature PHP-REX-2544"
    severity: critical
    category: php_backdoor
    pattern: 'if\(empty\(\$_COOKIE\[[''"]x[''"]\]\)\){echo'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2545"
    name: "PHP-REX-2545"
    description: "Malware detection signature PHP-REX-2545"
    severity: critical
    category: php_backdoor
    pattern: '\)\];}if\(isset\(\$_SERVER\[_'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2546"
    name: "PHP-REX-2546"
    description: "Malware detection signature PHP-REX-2546"
    severity: critical
    category: php_backdoor
    pattern: 'if\(@\$vars\(get_magic_quotes_gpc\(\)\s*\?\s*stripslashes\(\$uri\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2547"
    name: "PHP-REX-2547"
    description: "Malware detection signature PHP-REX-2547"
    severity: critical
    category: php_backdoor
    pattern: 'base[''"]{0,1}\.\(\d+\s*\*\s*\d+\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2548"
    name: "PHP-REX-2548"
    description: "Malware detection signature PHP-REX-2548"
    severity: critical
    category: php_backdoor
    pattern: '\$param\s*=\s*\$param\s*x\s*\$n\.substr\s*\(\$param\s*,\s*length\(\$param\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2549"
    name: "PHP-REX-2549"
    description: "Malware detection signature PHP-REX-2549"
    severity: critical
    category: php_backdoor
    pattern: 'register_shutdown_function\(\s*[''"]{0,1}read_ans_code'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2550"
    name: "PHP-REX-2550"
    description: "Malware detection signature PHP-REX-2550"
    severity: critical
    category: php_backdoor
    pattern: 'base64_decode\(\$_POST\[[''"]{0,1}_-'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2551"
    name: "PHP-REX-2551"
    description: "Malware detection signature PHP-REX-2551"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_POST\[[''"]{0,1}msgsubject[''"]{0,1}\]\)\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2552"
    name: "PHP-REX-2552"
    description: "Malware detection signature PHP-REX-2552"
    severity: critical
    category: php_backdoor
    pattern: 'mail\(\$arr\[[''"]{0,1}to[''"]{0,1}\],\$arr\[[''"]{0,1}subj[''"]{0,1}\],\$arr\[[''"]{0,1}msg[''"]{0,1}\],\$arr\[[''"]{0,1}head[''"]{0,1}\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2553"
    name: "PHP-REX-2553"
    description: "Malware detection signature PHP-REX-2553"
    severity: critical
    category: php_backdoor
    pattern: 'file_get_contents\(trim\(\$f\[\$_GET\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2554"
    name: "PHP-REX-2554"
    description: "Malware detection signature PHP-REX-2554"
    severity: critical
    category: php_backdoor
    pattern: 'ini_get\([''"]{0,1}filter\.default_flags[''"]{0,1}\)\){foreach'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2555"
    name: "PHP-REX-2555"
    description: "Malware detection signature PHP-REX-2555"
    severity: critical
    category: php_backdoor
    pattern: 'chunk_split\(base64_encode\(fread\(\${\${[''"]{0,1}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2556"
    name: "PHP-REX-2556"
    description: "Malware detection signature PHP-REX-2556"
    severity: critical
    category: php_backdoor
    pattern: '\$str=[''"]{0,1}<h1>403\s+Forbidden</h1><!--\s*token:'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2557"
    name: "PHP-REX-2557"
    description: "Malware detection signature PHP-REX-2557"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s+rename\([''"]wso\.php[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2558"
    name: "PHP-REX-2558"
    description: "Malware detection signature PHP-REX-2558"
    severity: critical
    category: php_backdoor
    pattern: '\$[a-zA-Z0-9_]+/\*.{1,10}\*/\s*\.\s*\$[a-zA-Z0-9_]+/\*.{1,10}\*/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2559"
    name: "PHP-REX-2559"
    description: "Malware detection signature PHP-REX-2559"
    severity: critical
    category: php_backdoor
    pattern: '@?mail\(\$mosConfig_mailfrom, \$mosConfig_live_site'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2560"
    name: "PHP-REX-2560"
    description: "Malware detection signature PHP-REX-2560"
    severity: critical
    category: php_backdoor
    pattern: '\$t=\$s;\s*\$o\s*=\s*[''"][''"];\s*for\(\$i=0;\$i<strlen\(\$t\);\$i\+\+\){\s*\$o\s*\.=\s*\$t{\$i}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2561"
    name: "PHP-REX-2561"
    description: "Malware detection signature PHP-REX-2561"
    severity: critical
    category: php_backdoor
    pattern: 'mmcrypt\(\$data, \$key, \$iv, \$decrypt = FALSE'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2562"
    name: "PHP-REX-2562"
    description: "Malware detection signature PHP-REX-2562"
    severity: critical
    category: php_backdoor
    pattern: 'tnega_resu_ptth'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2563"
    name: "PHP-REX-2563"
    description: "Malware detection signature PHP-REX-2563"
    severity: critical
    category: php_backdoor
    pattern: 'tsoh_ptth'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2564"
    name: "PHP-REX-2564"
    description: "Malware detection signature PHP-REX-2564"
    severity: critical
    category: php_backdoor
    pattern: 'REREFER_PTTH'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2565"
    name: "PHP-REX-2565"
    description: "Malware detection signature PHP-REX-2565"
    severity: critical
    category: php_backdoor
    pattern: 'webi\.ru/webi_files/php_libmail'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2566"
    name: "PHP-REX-2566"
    description: "Malware detection signature PHP-REX-2566"
    severity: critical
    category: php_backdoor
    pattern: 'substr_count\(getenv\(\\[''"]HTTP_REFERER'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2567"
    name: "PHP-REX-2567"
    description: "Malware detection signature PHP-REX-2567"
    severity: critical
    category: php_backdoor
    pattern: 'function reload\(\){header\("Location'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2568"
    name: "PHP-REX-2568"
    description: "Malware detection signature PHP-REX-2568"
    severity: critical
    category: php_backdoor
    pattern: 'img src=[''"]opera000\.png'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2569"
    name: "PHP-REX-2569"
    description: "Malware detection signature PHP-REX-2569"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*md5\(\$_POST\[[''"]{0,1}check[''"]{0,1}\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2570"
    name: "PHP-REX-2570"
    description: "Malware detection signature PHP-REX-2570"
    severity: critical
    category: php_backdoor
    pattern: 'eVaL\(\s*trim\(\s*baSe64_deCoDe\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2571"
    name: "PHP-REX-2571"
    description: "Malware detection signature PHP-REX-2571"
    severity: critical
    category: php_backdoor
    pattern: 'fsockopen\(\$m\[0\],\$m\[10\],\$_,\$__,\$m'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2572"
    name: "PHP-REX-2572"
    description: "Malware detection signature PHP-REX-2572"
    severity: critical
    category: php_backdoor
    pattern: '[''"]=>\${\${[''"]\\x'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2573"
    name: "PHP-REX-2573"
    description: "Malware detection signature PHP-REX-2573"
    severity: critical
    category: php_backdoor
    pattern: 'preg_replace\([''"].UTF\\-8:\(.\*\).Use'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2574"
    name: "PHP-REX-2574"
    description: "Malware detection signature PHP-REX-2574"
    severity: critical
    category: php_backdoor
    pattern: '::[''"]\.phpversion\(\)\.[''"]::'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2575"
    name: "PHP-REX-2575"
    description: "Malware detection signature PHP-REX-2575"
    severity: critical
    category: php_backdoor
    pattern: '@stream_socket_client\([''"]{0,1}tcp://\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2576"
    name: "PHP-REX-2576"
    description: "Malware detection signature PHP-REX-2576"
    severity: critical
    category: php_backdoor
    pattern: '==0\){jsonQuit\(\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2577"
    name: "PHP-REX-2577"
    description: "Malware detection signature PHP-REX-2577"
    severity: critical
    category: php_backdoor
    pattern: 'loc\s*=\s*[''"]{0,1}<\?echo\s+\$redirect;\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2578"
    name: "PHP-REX-2578"
    description: "Malware detection signature PHP-REX-2578"
    severity: critical
    category: php_backdoor
    pattern: 'array\(\$en,\$es,\$ef,\$el\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2579"
    name: "PHP-REX-2579"
    description: "Malware detection signature PHP-REX-2579"
    severity: critical
    category: php_backdoor
    pattern: '[''"]{0,1}.c.[''"]{0,1}\.substr\(\$vbg,'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2580"
    name: "PHP-REX-2580"
    description: "Malware detection signature PHP-REX-2580"
    severity: critical
    category: php_backdoor
    pattern: 'fuck\s+your\s+mama'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2581"
    name: "PHP-REX-2581"
    description: "Malware detection signature PHP-REX-2581"
    severity: critical
    category: php_backdoor
    pattern: 'call_user_func\(\s*[''"]action[''"]\s*\.\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\['
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2582"
    name: "PHP-REX-2582"
    description: "Malware detection signature PHP-REX-2582"
    severity: critical
    category: php_backdoor
    pattern: 'str_replace\(\$find\s*,\s*\$find\s*\.\s*\$html\s*,\s*\$text'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2583"
    name: "PHP-REX-2583"
    description: "Malware detection signature PHP-REX-2583"
    severity: critical
    category: php_backdoor
    pattern: 'file_exists\s*\(?\s*[''"]/var/tmp/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2584"
    name: "PHP-REX-2584"
    description: "Malware detection signature PHP-REX-2584"
    severity: critical
    category: php_backdoor
    pattern: '&&\s*!empty\(\s*\$_COOKIE\[[''"]fill[''"]\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2585"
    name: "PHP-REX-2585"
    description: "Malware detection signature PHP-REX-2585"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+inDiapason'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2586"
    name: "PHP-REX-2586"
    description: "Malware detection signature PHP-REX-2586"
    severity: critical
    category: php_backdoor
    pattern: 'make_dir_and_file\(\s*\$path_joomla'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2587"
    name: "PHP-REX-2587"
    description: "Malware detection signature PHP-REX-2587"
    severity: critical
    category: php_backdoor
    pattern: 'listing_page\(\s*notice\(\s*[''"]symlinked'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2588"
    name: "PHP-REX-2588"
    description: "Malware detection signature PHP-REX-2588"
    severity: critical
    category: php_backdoor
    pattern: 'list\s*\(\s*\$host\s*,\s*\$port\s*,\s*\$size\s*,\s*\$exec_time'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2589"
    name: "PHP-REX-2589"
    description: "Malware detection signature PHP-REX-2589"
    severity: critical
    category: php_backdoor
    pattern: 'filemtime\(\$basepath\s*\.\s*[''"]/configuration\.php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2590"
    name: "PHP-REX-2590"
    description: "Malware detection signature PHP-REX-2590"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+read_pic\(\s*\$A\s*\)\s*{\s*\$a\s*=\s*\$_SERVER'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2591"
    name: "PHP-REX-2591"
    description: "Malware detection signature PHP-REX-2591"
    severity: critical
    category: php_backdoor
    pattern: 'chr\(\s*\$table\[\s*\$string\[\s*\$i\s*\]\s*\*\s*pow\(64\s*,\s*1'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2592"
    name: "PHP-REX-2592"
    description: "Malware detection signature PHP-REX-2592"
    severity: critical
    category: php_backdoor
    pattern: '\]\s*\){eval\(\s*\$[a-zA-Z0-9_]+\[\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2593"
    name: "PHP-REX-2593"
    description: "Malware detection signature PHP-REX-2593"
    severity: critical
    category: php_backdoor
    pattern: 'Location::isFileWritable\(\s*EncodeExplorer::getConfig'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2594"
    name: "PHP-REX-2594"
    description: "Malware detection signature PHP-REX-2594"
    severity: critical
    category: php_backdoor
    pattern: 'by\s+Shunceng'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2595"
    name: "PHP-REX-2595"
    description: "Malware detection signature PHP-REX-2595"
    severity: critical
    category: php_backdoor
    pattern: '{eval\(\${\$s2'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2596"
    name: "PHP-REX-2596"
    description: "Malware detection signature PHP-REX-2596"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(\$s21\(\${\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2597"
    name: "PHP-REX-2597"
    description: "Malware detection signature PHP-REX-2597"
    severity: critical
    category: php_backdoor
    pattern: 'RamZkiE\s+-\s+exploit'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2598"
    name: "PHP-REX-2598"
    description: "Malware detection signature PHP-REX-2598"
    severity: critical
    category: php_backdoor
    pattern: '[''"]remove_scripts[''"]\s*=>\s*array\([''"]Remove'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2599"
    name: "PHP-REX-2599"
    description: "Malware detection signature PHP-REX-2599"
    severity: critical
    category: php_backdoor
    pattern: '\$back_connect_pl\s*=\s*[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2600"
    name: "PHP-REX-2600"
    description: "Malware detection signature PHP-REX-2600"
    severity: critical
    category: php_backdoor
    pattern: '\$site_root\.\$fileunp_dir\.\$fileunp_fn'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2601"
    name: "PHP-REX-2601"
    description: "Malware detection signature PHP-REX-2601"
    severity: critical
    category: php_backdoor
    pattern: '@preg_replace\([''"]/ad/e'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2602"
    name: "PHP-REX-2602"
    description: "Malware detection signature PHP-REX-2602"
    severity: critical
    category: php_backdoor
    pattern: '<b>\$uid\s*\(\$uname\)</b>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2603"
    name: "PHP-REX-2603"
    description: "Malware detection signature PHP-REX-2603"
    severity: critical
    category: php_backdoor
    pattern: 'Fx29Googler'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2604"
    name: "PHP-REX-2604"
    description: "Malware detection signature PHP-REX-2604"
    severity: critical
    category: php_backdoor
    pattern: 'envir0nn'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2605"
    name: "PHP-REX-2605"
    description: "Malware detection signature PHP-REX-2605"
    severity: critical
    category: php_backdoor
    pattern: 'array\([''"]\*/[''"],[''"]/\*[''"]\),base64_decode'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2606"
    name: "PHP-REX-2606"
    description: "Malware detection signature PHP-REX-2606"
    severity: critical
    category: php_backdoor
    pattern: '<\?=\s*@php_uname\(\);\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2607"
    name: "PHP-REX-2607"
    description: "Malware detection signature PHP-REX-2607"
    severity: critical
    category: php_backdoor
    pattern: 'sUxCrew\s+V'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2608"
    name: "PHP-REX-2608"
    description: "Malware detection signature PHP-REX-2608"
    severity: critical
    category: php_backdoor
    pattern: 'WarBot\s+sUxCrew'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2609"
    name: "PHP-REX-2609"
    description: "Malware detection signature PHP-REX-2609"
    severity: critical
    category: php_backdoor
    pattern: 'exec\([''"]cd\s+/tmp;curl\s+-O\s+[''"]\.\$url'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2610"
    name: "PHP-REX-2610"
    description: "Malware detection signature PHP-REX-2610"
    severity: critical
    category: php_backdoor
    pattern: 'Batavi4\s+Shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2611"
    name: "PHP-REX-2611"
    description: "Malware detection signature PHP-REX-2611"
    severity: critical
    category: php_backdoor
    pattern: '@extract\(\$_REQUEST\[[''"]fx29shcook'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2612"
    name: "PHP-REX-2612"
    description: "Malware detection signature PHP-REX-2612"
    severity: critical
    category: php_backdoor
    pattern: 'TuX_Shadow'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2613"
    name: "PHP-REX-2613"
    description: "Malware detection signature PHP-REX-2613"
    severity: critical
    category: php_backdoor
    pattern: '=@fopen\s*\([''"]php\.ini[''"]\s*,\s*[''"]w'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2614"
    name: "PHP-REX-2614"
    description: "Malware detection signature PHP-REX-2614"
    severity: critical
    category: php_backdoor
    pattern: 'LebayCrew'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2615"
    name: "PHP-REX-2615"
    description: "Malware detection signature PHP-REX-2615"
    severity: critical
    category: php_backdoor
    pattern: '\$headers\s*\.=\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[\s*[''"]eMailAdd[''"]\s*\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2616"
    name: "PHP-REX-2616"
    description: "Malware detection signature PHP-REX-2616"
    severity: critical
    category: php_backdoor
    pattern: 'bogel\s*-\s*exploit'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2617"
    name: "PHP-REX-2617"
    description: "Malware detection signature PHP-REX-2617"
    severity: critical
    category: php_backdoor
    pattern: '\[uname\][''"]\s*\.\s*php_uname\(\s*\)\s*\.\s*[''"]\[/uname\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2618"
    name: "PHP-REX-2618"
    description: "Malware detection signature PHP-REX-2618"
    severity: critical
    category: php_backdoor
    pattern: '\]\(\$_1,\$_1\)\);else{\$GLOBALS'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2619"
    name: "PHP-REX-2619"
    description: "Malware detection signature PHP-REX-2619"
    severity: critical
    category: php_backdoor
    pattern: 'file:file:////'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2620"
    name: "PHP-REX-2620"
    description: "Malware detection signature PHP-REX-2620"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+MCLogin\(\)\s*{\s*die'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2621"
    name: "PHP-REX-2621"
    description: "Malware detection signature PHP-REX-2621"
    severity: critical
    category: php_backdoor
    pattern: '{echo [''"]yes[''"]; exit;}else{echo [''"]no[''"]; exit;}}}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2622"
    name: "PHP-REX-2622"
    description: "Malware detection signature PHP-REX-2622"
    severity: critical
    category: php_backdoor
    pattern: ';\?><\?=\${[''"]_[''"]\.\$_}\[[''"]_[''"]\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2623"
    name: "PHP-REX-2623"
    description: "Malware detection signature PHP-REX-2623"
    severity: critical
    category: php_backdoor
    pattern: '\$a\[1\]==[''"]bypassip[''"]\);\$c=self::c1'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2624"
    name: "PHP-REX-2624"
    description: "Malware detection signature PHP-REX-2624"
    severity: critical
    category: php_backdoor
    pattern: '\$dir\.[''"]/[''"]\.\$f\.[''"]/wp-config\.php'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2625"
    name: "PHP-REX-2625"
    description: "Malware detection signature PHP-REX-2625"
    severity: critical
    category: php_backdoor
    pattern: 'eval\([''"]return\s+eval'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2626"
    name: "PHP-REX-2626"
    description: "Malware detection signature PHP-REX-2626"
    severity: critical
    category: php_backdoor
    pattern: 'fwrite\(\$[a-zA-Z0-9_]+,"\\xEF\\xBB\\xBF"\.iconv\([''"]gbk[''"],[''"]utf-8//IGNORE[''"],\$body'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2627"
    name: "PHP-REX-2627"
    description: "Malware detection signature PHP-REX-2627"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+[''"]__success__[''"]\s*\.\s*\$NowSubFolders\s*\.\s*[''"]__success__'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2628"
    name: "PHP-REX-2628"
    description: "Malware detection signature PHP-REX-2628"
    severity: critical
    category: php_backdoor
    pattern: 'ob_start\(\);\s*var_dump\(\$_POST\s*,\s*\$_GET\s*,\s*\$_COOKIE\s*,\s*\$_FILES'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2629"
    name: "PHP-REX-2629"
    description: "Malware detection signature PHP-REX-2629"
    severity: critical
    category: php_backdoor
    pattern: 'getenv\("HTTP_HOST"\)\.'' ~ Shell I'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2630"
    name: "PHP-REX-2630"
    description: "Malware detection signature PHP-REX-2630"
    severity: critical
    category: php_backdoor
    pattern: 'eval/\*\*/\("eval\(gzinflate\(base64_decode'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2631"
    name: "PHP-REX-2631"
    description: "Malware detection signature PHP-REX-2631"
    severity: critical
    category: php_backdoor
    pattern: 'assert\(\$[a-zA-Z0-9_]+\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2632"
    name: "PHP-REX-2632"
    description: "Malware detection signature PHP-REX-2632"
    severity: critical
    category: php_backdoor
    pattern: '\$defacer=''ReZK2LL'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2633"
    name: "PHP-REX-2633"
    description: "Malware detection signature PHP-REX-2633"
    severity: critical
    category: php_backdoor
    pattern: '<%\s*eval\s+request'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2634"
    name: "PHP-REX-2634"
    description: "Malware detection signature PHP-REX-2634"
    severity: critical
    category: php_backdoor
    pattern: 'new_time\(\$path2file,\$GLOBALS'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2635"
    name: "PHP-REX-2635"
    description: "Malware detection signature PHP-REX-2635"
    severity: critical
    category: php_backdoor
    pattern: '\$str=str_replace\("\[t\d+\]"\s*,\s*"<\?",\s*\$res\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2636"
    name: "PHP-REX-2636"
    description: "Malware detection signature PHP-REX-2636"
    severity: critical
    category: php_backdoor
    pattern: '\$__a="[a-zA-Z0-9_]+";\s*\$__a\s*=\s*str_replace\("[a-zA-Z0-9_]+",\s*"[a-zA-Z0-9_]+",\s*\$__a\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2637"
    name: "PHP-REX-2637"
    description: "Malware detection signature PHP-REX-2637"
    severity: critical
    category: php_backdoor
    pattern: '<!--\w{32}--><\?php\s*@ob_start\(\);@ini_set'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2638"
    name: "PHP-REX-2638"
    description: "Malware detection signature PHP-REX-2638"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_GET\[php\]\)\)\s*{\$function'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2639"
    name: "PHP-REX-2639"
    description: "Malware detection signature PHP-REX-2639"
    severity: critical
    category: php_backdoor
    pattern: '\$s\("~\[discuz\]~e",\$_POST'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2640"
    name: "PHP-REX-2640"
    description: "Malware detection signature PHP-REX-2640"
    severity: critical
    category: php_backdoor
    pattern: 'PlgSystemXcalendarHelper::getInstance\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2641"
    name: "PHP-REX-2641"
    description: "Malware detection signature PHP-REX-2641"
    severity: critical
    category: php_backdoor
    pattern: 'is_dir_empty\(\$_POST\[[''"]directory[''"]\]\)\)\s*{\s*echo\s+1;'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2642"
    name: "PHP-REX-2642"
    description: "Malware detection signature PHP-REX-2642"
    severity: critical
    category: php_backdoor
    pattern: 'if\(isset\(\$_POST\[[''"]__bscode'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2643"
    name: "PHP-REX-2643"
    description: "Malware detection signature PHP-REX-2643"
    severity: critical
    category: php_backdoor
    pattern: 'base64_encode\(clean_url\(\$_SERVER'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2644"
    name: "PHP-REX-2644"
    description: "Malware detection signature PHP-REX-2644"
    severity: critical
    category: php_backdoor
    pattern: '\$_GET\[[''"]mod[''"]\]==[''"]0XX'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2645"
    name: "PHP-REX-2645"
    description: "Malware detection signature PHP-REX-2645"
    severity: critical
    category: php_backdoor
    pattern: '\$folder\.[''"]/please_rename_UNZIPFIRST\.zip'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2646"
    name: "PHP-REX-2646"
    description: "Malware detection signature PHP-REX-2646"
    severity: critical
    category: php_backdoor
    pattern: '@\$strings\(str_rot13\(''riny\(onfr64_qrpbqr'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2647"
    name: "PHP-REX-2647"
    description: "Malware detection signature PHP-REX-2647"
    severity: critical
    category: php_backdoor
    pattern: '\$pager\s*=\s*new\s*ADODB_Pager\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2648"
    name: "PHP-REX-2648"
    description: "Malware detection signature PHP-REX-2648"
    severity: critical
    category: php_backdoor
    pattern: '\$this->server\s*=\s*[''"]http://[''"]\.\$this->server\.[''"]/img/\?q='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2649"
    name: "PHP-REX-2649"
    description: "Malware detection signature PHP-REX-2649"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s*"<center><b>Done\s*==>\s*\$userfile_name'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2650"
    name: "PHP-REX-2650"
    description: "Malware detection signature PHP-REX-2650"
    severity: critical
    category: php_backdoor
    pattern: 'file_get_contents\(\$[a-zA-Z0-9_]+\);\s*[a-zA-Z0-9_]+\([''"]https://dl\.dropboxusercontent\.com'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2651"
    name: "PHP-REX-2651"
    description: "Malware detection signature PHP-REX-2651"
    severity: critical
    category: php_backdoor
    pattern: 'if\(file_exists\(\$newPath\)\)\s*{\s*echo\s*"publish success'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2652"
    name: "PHP-REX-2652"
    description: "Malware detection signature PHP-REX-2652"
    severity: critical
    category: php_backdoor
    pattern: 'function\s+KillMe\(\)\s*{\s*unlink\(\s*MyFileName\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2653"
    name: "PHP-REX-2653"
    description: "Malware detection signature PHP-REX-2653"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*error_reporting\(E_ERROR\);\s*\$remote_path="http://'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2654"
    name: "PHP-REX-2654"
    description: "Malware detection signature PHP-REX-2654"
    severity: critical
    category: php_backdoor
    pattern: 'echo\s+php_uname\(\);\s*@unlink\(__FILE__\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2655"
    name: "PHP-REX-2655"
    description: "Malware detection signature PHP-REX-2655"
    severity: critical
    category: php_backdoor
    pattern: '<title><\?php\s+echo\s+\$shell_title;\s+\?></title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2656"
    name: "PHP-REX-2656"
    description: "Malware detection signature PHP-REX-2656"
    severity: critical
    category: php_backdoor
    pattern: 'chr\(ord\(\$str\[\$i\]\)\s*\^\s*\$key\);\s*eval\(\$ev\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2657"
    name: "PHP-REX-2657"
    description: "Malware detection signature PHP-REX-2657"
    severity: critical
    category: php_backdoor
    pattern: '\$wp__wp=\$wp__wp\(str_replace'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2658"
    name: "PHP-REX-2658"
    description: "Malware detection signature PHP-REX-2658"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*\$wp__wp='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2659"
    name: "PHP-REX-2659"
    description: "Malware detection signature PHP-REX-2659"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*eval\([''"]\\x65'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2660"
    name: "PHP-REX-2660"
    description: "Malware detection signature PHP-REX-2660"
    severity: critical
    category: php_backdoor
    pattern: '@preg_replace\([''"]/\(\.\*\)/e[''"]\s*,\s*@\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2661"
    name: "PHP-REX-2661"
    description: "Malware detection signature PHP-REX-2661"
    severity: critical
    category: php_backdoor
    pattern: '<title>W3Lcome</title>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2662"
    name: "PHP-REX-2662"
    description: "Malware detection signature PHP-REX-2662"
    severity: critical
    category: php_backdoor
    pattern: 'if\(stristr\(\$files\[\$i\],\s*[''"]php[''"]\)\)\s*{\s*\$time\s*=\s*filemtime'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2663"
    name: "PHP-REX-2663"
    description: "Malware detection signature PHP-REX-2663"
    severity: critical
    category: php_backdoor
    pattern: '\)\){\s*include\(getcwd\(\)\.[''"]/[a-zA-Z0-9_]+\.php[''"]\);\s*exit;}\s*\?>'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2664"
    name: "PHP-REX-2664"
    description: "Malware detection signature PHP-REX-2664"
    severity: critical
    category: php_backdoor
    pattern: '<title>[''"]\.ucfirst\(\$key\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2665"
    name: "PHP-REX-2665"
    description: "Malware detection signature PHP-REX-2665"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*/\*\s*WSO'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2666"
    name: "PHP-REX-2666"
    description: "Malware detection signature PHP-REX-2666"
    severity: critical
    category: php_backdoor
    pattern: 'function_exists\("c99_sess_put'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2667"
    name: "PHP-REX-2667"
    description: "Malware detection signature PHP-REX-2667"
    severity: critical
    category: php_backdoor
    pattern: '3xp1r3\s*Cyber\s*Army'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2668"
    name: "PHP-REX-2668"
    description: "Malware detection signature PHP-REX-2668"
    severity: critical
    category: php_backdoor
    pattern: 'file_get_contents\(~\s*base64_decode\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2669"
    name: "PHP-REX-2669"
    description: "Malware detection signature PHP-REX-2669"
    severity: critical
    category: php_backdoor
    pattern: 'hexdec\(substr\(md5\(\$_SERVER\[[''"]REQUEST_URI'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2670"
    name: "PHP-REX-2670"
    description: "Malware detection signature PHP-REX-2670"
    severity: critical
    category: php_backdoor
    pattern: 'root_path=substr\(\$absolutepath,0,strpos\(\$absolutepath,\$localpath\)\);include_once'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2671"
    name: "PHP-REX-2671"
    description: "Malware detection signature PHP-REX-2671"
    severity: critical
    category: php_backdoor
    pattern: '\$_SERVER\["REMOTE_ADDR"\];if\(\(preg_match\("/69\.42\.'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2672"
    name: "PHP-REX-2672"
    description: "Malware detection signature PHP-REX-2672"
    severity: critical
    category: php_backdoor
    pattern: '<\?php\s*if\(isset\(\$_GET\[php\]\)\)\s*{'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2673"
    name: "PHP-REX-2673"
    description: "Malware detection signature PHP-REX-2673"
    severity: critical
    category: php_backdoor
    pattern: '\)\){if\(isset\(\$_FILES\[[''"]im[''"]\]\)\){\$dim=getcwd\(\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2674"
    name: "PHP-REX-2674"
    description: "Malware detection signature PHP-REX-2674"
    severity: critical
    category: php_backdoor
    pattern: 'class\s+JSYSOPERATION_SetPassword'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2675"
    name: "PHP-REX-2675"
    description: "Malware detection signature PHP-REX-2675"
    severity: critical
    category: php_backdoor
    pattern: '\);array_filter\(\$mcdata\s*,\s*base64_decode\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2676"
    name: "PHP-REX-2676"
    description: "Malware detection signature PHP-REX-2676"
    severity: critical
    category: php_backdoor
    pattern: '<\?php if\(\$message\) echo "<p>\$message</p>"; \?>\s*<form'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2677"
    name: "PHP-REX-2677"
    description: "Malware detection signature PHP-REX-2677"
    severity: critical
    category: php_backdoor
    pattern: 'touch\(dirname\(__FILE__\),\s*\$time\);touch\(\$_SERVER\[[''"]SCRIPT_FILENAME[''"]\],'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2678"
    name: "PHP-REX-2678"
    description: "Malware detection signature PHP-REX-2678"
    severity: critical
    category: php_backdoor
    pattern: '<title>FakeSender'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2679"
    name: "PHP-REX-2679"
    description: "Malware detection signature PHP-REX-2679"
    severity: critical
    category: php_backdoor
    pattern: '\$Conf\s*=\s*@?file_get_contents\(\$pg\.[''"]/\?d=[''"]\s*\.\s*\$_SERVER\[[''"]HTTP_HOST[''"]\]\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2680"
    name: "PHP-REX-2680"
    description: "Malware detection signature PHP-REX-2680"
    severity: critical
    category: php_backdoor
    pattern: '<\?\s*include\([''"][''"]\.\$droot\.[''"]/bitrix/images/iblock/'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2681"
    name: "PHP-REX-2681"
    description: "Malware detection signature PHP-REX-2681"
    severity: critical
    category: php_backdoor
    pattern: '\$file\[\$key\]\s*=\s*\$ex\[0\]\.\$link\.[''"]</body>[''"]\.\$ex\[1\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2682"
    name: "PHP-REX-2682"
    description: "Malware detection signature PHP-REX-2682"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,45}\[\$\w{1,45}\]=chr\(ord\(\$\w{1,45}\[\$\w{1,45}\]\)\^ord\(\$\w{1,45}\[\$\w{1,45}%\$\w{1,45}\]\)\);return\s*\$\w{1,45};}private static function'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2683"
    name: "PHP-REX-2683"
    description: "Malware detection signature PHP-REX-2683"
    severity: critical
    category: php_backdoor
    pattern: 'if\s*\(\s*move_uploaded_file\(\s*\$nazwa_plik\s*,\s*\$uploadfile\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2684"
    name: "PHP-REX-2684"
    description: "Malware detection signature PHP-REX-2684"
    severity: critical
    category: php_backdoor
    pattern: 'if\(strstr\(\$tempStr,[''"]//file end'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2685"
    name: "PHP-REX-2685"
    description: "Malware detection signature PHP-REX-2685"
    severity: critical
    category: php_backdoor
    pattern: 'trim\(\s*removeBOM\(\s*_file_get_contents\(\s*API_URL\s*\)\s*\)\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2686"
    name: "PHP-REX-2686"
    description: "Malware detection signature PHP-REX-2686"
    severity: critical
    category: php_backdoor
    pattern: '\$\w{1,45}\s*=\s*str_replace\(\s*[''"]\[t1\][''"]\s*,\s*[''"]<.php[''"]\s*,\s*\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2687"
    name: "PHP-REX-2687"
    description: "Malware detection signature PHP-REX-2687"
    severity: critical
    category: php_backdoor
    pattern: '\*/\$\w{1,45}\s*=\s*@\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[\s*\w{1,45}\s*\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2688"
    name: "PHP-REX-2688"
    description: "Malware detection signature PHP-REX-2688"
    severity: critical
    category: php_backdoor
    pattern: 'foreach\(\s*\$RandomNum\s*as\s*\$key\)\s*{\s*\$Keys\s*\.=\s*chr'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2689"
    name: "PHP-REX-2689"
    description: "Malware detection signature PHP-REX-2689"
    severity: critical
    category: php_backdoor
    pattern: 'touch\(\$extract_path\s*\.\s*\$stat\[[''"]name[''"]\]\s*,\s*filemtime\(\s*\$archive_path'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2690"
    name: "PHP-REX-2690"
    description: "Malware detection signature PHP-REX-2690"
    severity: critical
    category: php_backdoor
    pattern: '\$Conf\s*=\s*@file_get_contents\(\s*[''"]http://'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2691"
    name: "PHP-REX-2691"
    description: "Malware detection signature PHP-REX-2691"
    severity: critical
    category: php_backdoor
    pattern: '\$zip_status\s*=\s*\$zip->open\(\s*[''"][a-zA-Z0-9_]+\.zip[''"]\s*\);\s*if\s*\(\s*\$zip_status\s*===\s*true\s*\)\s*{\s*if\s*\(\s*\$zip->setPassword'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2692"
    name: "PHP-REX-2692"
    description: "Malware detection signature PHP-REX-2692"
    severity: critical
    category: php_backdoor
    pattern: '>config\s*root\s*man<'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2693"
    name: "PHP-REX-2693"
    description: "Malware detection signature PHP-REX-2693"
    severity: critical
    category: php_backdoor
    pattern: '=\s*create_function\([''"][''"]\s*,\s*\$JSubMenu\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2694"
    name: "PHP-REX-2694"
    description: "Malware detection signature PHP-REX-2694"
    severity: critical
    category: php_backdoor
    pattern: '\$arrayRows\[count\(\$arrayRows\)\]\s*=\s*\$email\.[''"]::1[''"];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2695"
    name: "PHP-REX-2695"
    description: "Malware detection signature PHP-REX-2695"
    severity: critical
    category: php_backdoor
    pattern: 'Post\.new\(URI\.encode\("/\?q=user/password&name\[\#post_render'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2696"
    name: "PHP-REX-2696"
    description: "Malware detection signature PHP-REX-2696"
    severity: critical
    category: php_backdoor
    pattern: 'unserialize\(\s*\$this->getImageDecodedText\(\s*file_get_contents'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2697"
    name: "PHP-REX-2697"
    description: "Malware detection signature PHP-REX-2697"
    severity: critical
    category: php_backdoor
    pattern: '\b(ftp_exec|system|shell_exec|passthru|popen|proc_open)\s*\(?\s*@?\$_POST\s*\[\s*[''"].+?[''"]\s*\]\s*\.\s*"\s*2\s*>\s*&1\s*[''"]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2698"
    name: "PHP-REX-2698"
    description: "Malware detection signature PHP-REX-2698"
    severity: critical
    category: php_backdoor
    pattern: '\b(ftp_exec|system|shell_exec|passthru|popen|proc_open)\s*\(?\s*[''"]uname\s+-a[''"]\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2699"
    name: "PHP-REX-2699"
    description: "Malware detection signature PHP-REX-2699"
    severity: critical
    category: php_backdoor
    pattern: '@?assert\s*\(?\s*\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\s*\[\s*[''"]{0,1}.+?[''"]{0,1}\s*\]\s*'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2700"
    name: "PHP-REX-2700"
    description: "Malware detection signature PHP-REX-2700"
    severity: critical
    category: php_backdoor
    pattern: 'php\s+[''"]\s*\.\s*\$wso_path'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2701"
    name: "PHP-REX-2701"
    description: "Malware detection signature PHP-REX-2701"
    severity: critical
    category: php_backdoor
    pattern: 'find\s+/\s+-name\s+\.ssh\s+>\s+\$dir/sshkeys/sshkeys'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2702"
    name: "PHP-REX-2702"
    description: "Malware detection signature PHP-REX-2702"
    severity: critical
    category: php_backdoor
    pattern: 'system\s*\(?\s*[''"]{0,1}whoami[''"]{0,1}\s*\)?'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2703"
    name: "PHP-REX-2703"
    description: "Malware detection signature PHP-REX-2703"
    severity: critical
    category: php_backdoor
    pattern: 'curl_setopt\s*\(\s*\$ch\s*,\s*CURLOPT_URL\s*,\s*[''"]{0,1}http://\$host:\d+[''"]{0,1}\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2704"
    name: "PHP-REX-2704"
    description: "Malware detection signature PHP-REX-2704"
    severity: critical
    category: php_backdoor
    pattern: '\beval\(\s*\$\s*{\s*\$[a-zA-Z0-9_]+'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2705"
    name: "PHP-REX-2705"
    description: "Malware detection signature PHP-REX-2705"
    severity: critical
    category: php_backdoor
    pattern: 'if\(\s*in_array\(\s*\$_SERVER\[[''"]REMOTE_ADDR[''"]\]\s*,\s*\$[a-zA-Z0-9_]+\)\)\s*\$[a-zA-Z0-9_]+=\$[a-zA-Z0-9_]+\[rand\(0,count\(\$[a-zA-Z0-9_]+\)-1\)\];'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2706"
    name: "PHP-REX-2706"
    description: "Malware detection signature PHP-REX-2706"
    severity: critical
    category: php_backdoor
    pattern: 'arr2html\(\$_REQUEST'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2707"
    name: "PHP-REX-2707"
    description: "Malware detection signature PHP-REX-2707"
    severity: critical
    category: php_backdoor
    pattern: '\$mdetails\s*\.=\s*[''"]<!--Deregister\(\)\s*Default\s*Widgets:'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2708"
    name: "PHP-REX-2708"
    description: "Malware detection signature PHP-REX-2708"
    severity: critical
    category: php_backdoor
    pattern: 'wp_remote_retrieve_body\(\s*wp_remote_get\(\s*\$jquery'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2709"
    name: "PHP-REX-2709"
    description: "Malware detection signature PHP-REX-2709"
    severity: critical
    category: php_backdoor
    pattern: '@?\$_(GET|POST|SERVER|COOKIE|REQUEST|FILES)\[[''"][a-zA-Z0-9_]+[''"]\]\s*\)\s*\);\s*[''"]\s*\);\s*\$\w{1,45}\(\s*\)'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2710"
    name: "PHP-REX-2710"
    description: "Malware detection signature PHP-REX-2710"
    severity: critical
    category: php_backdoor
    pattern: 'js_infection\s*=\s*array_reverse\(\s*str_split'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2711"
    name: "PHP-REX-2711"
    description: "Malware detection signature PHP-REX-2711"
    severity: critical
    category: php_backdoor
    pattern: '\$host\.[''"]ui[''"]\.[''"]jquery\.org/jquery'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2712"
    name: "PHP-REX-2712"
    description: "Malware detection signature PHP-REX-2712"
    severity: critical
    category: php_backdoor
    pattern: 'handle_bot_cmd_shell'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2713"
    name: "PHP-REX-2713"
    description: "Malware detection signature PHP-REX-2713"
    severity: critical
    category: php_backdoor
    pattern: '{echo\s*[''"]200[''"]\s*;\s*exit\s*;\s*}'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2714"
    name: "PHP-REX-2714"
    description: "Malware detection signature PHP-REX-2714"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(\s*KeyRegistration\(\s*KeyGeneration'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2715"
    name: "PHP-REX-2715"
    description: "Malware detection signature PHP-REX-2715"
    severity: critical
    category: php_backdoor
    pattern: '\$to\s*=\s*base64_decode\(\$par\[1\]\);\s*redirect\(\$to\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2716"
    name: "PHP-REX-2716"
    description: "Malware detection signature PHP-REX-2716"
    severity: critical
    category: php_backdoor
    pattern: '\$pager\s*=\s*new\s*ADODB_Pager\(\);\s*\$pager->render_pagelinks\(\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2717"
    name: "PHP-REX-2717"
    description: "Malware detection signature PHP-REX-2717"
    severity: critical
    category: php_backdoor
    pattern: 'eval\(\${\$'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2718"
    name: "PHP-REX-2718"
    description: "Malware detection signature PHP-REX-2718"
    severity: critical
    category: php_backdoor
    pattern: 'password\s*=\s*str_replace\([''"]%%DOMAIN%%[''"]\s*,\s*\$first_lvl_domain'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2719"
    name: "PHP-REX-2719"
    description: "Malware detection signature PHP-REX-2719"
    severity: critical
    category: php_backdoor
    pattern: '\$_POST\[gogogo\]'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2720"
    name: "PHP-REX-2720"
    description: "Malware detection signature PHP-REX-2720"
    severity: critical
    category: php_backdoor
    pattern: 'if\(file_exists\(\$redate_file\)\){'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2721"
    name: "PHP-REX-2721"
    description: "Malware detection signature PHP-REX-2721"
    severity: critical
    category: php_backdoor
    pattern: '\$this->quit\(file_put_contents'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2722"
    name: "PHP-REX-2722"
    description: "Malware detection signature PHP-REX-2722"
    severity: critical
    category: php_backdoor
    pattern: '\$data\s*=\s*\$db->{\s*\$cmd\[[''"]m[''"]\]\s*}\s*\(\s*\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2723"
    name: "PHP-REX-2723"
    description: "Malware detection signature PHP-REX-2723"
    severity: critical
    category: php_backdoor
    pattern: '\$ncontent=gethttpcnt\('
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2724"
    name: "PHP-REX-2724"
    description: "Malware detection signature PHP-REX-2724"
    severity: critical
    category: php_backdoor
    pattern: '\$testcloack\s*=\s*cloack\(\$ip\);'
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
  - id: "PHP-REX-2725"
    name: "PHP-REX-2725"
    description: "Malware detection signature PHP-REX-2725"
    severity: critical
    category: php_backdoor
    pattern: '\$2\.php\?rewrite_params=\$1&page_url='
    is_regex: true
    extensions: [php, php3, php4, php5, php7, phtml, pht, inc]
    level: 1
