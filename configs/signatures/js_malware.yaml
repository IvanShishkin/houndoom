# Extended malware signatures
# Note: Patterns with backreferences (\1, \2) are skipped (Go RE2 limitation)

signatures:
  - id: "JS-0003"
    name: "JS-0003"
    description: "Malware detection signature JS-0003"
    severity: high
    category: js_malware
    pattern: '<!--codes_iframe-->\s*<script\s+type="text/javascript">.{1,800}</script>\s*<!--/codes_iframe-->'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0005"
    name: "JS-0005"
    description: "Malware detection signature JS-0005"
    severity: high
    category: js_malware
    pattern: '<script\s*type="text/javascript"\s*src="https?://[^/]{5,50}/\w{5,10}\?frm=script&se_referrer=<\?php\s*echo\s*\$_SERVER\[''HTTP_HOST''\];\s*\?>&default_keyword=<\?php\s*echo\s*\$_SERVER\[''REQUEST_URI''\];\s*\?>"></script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0011"
    name: "JS-0011"
    description: "Malware detection signature JS-0011"
    severity: high
    category: js_malware
    pattern: 'if\(window\.document\)if\(parseInt\([^)]+\)===\d+\)try\{Boolean\(\)\.prototype\.\w\}catch\(\w{1,40}\)\{\w=\[[^]]+\]\[0\].+?\);}if\(\w\)\w=\w;\w\(\w\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0013"
    name: "JS-0013"
    description: "Malware detection signature JS-0013"
    severity: high
    category: js_malware
    pattern: 'new\s+CoinHive\.Anonymous'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0014"
    name: "JS-0014"
    description: "Malware detection signature JS-0014"
    severity: high
    category: js_malware
    pattern: 'function\s*include\s*\(\s*url\s*\)\s*\{\s*var\s*script\s*=\s*document\s*\.\s*createElement\s*\(\s*''[^'']*''\s*\)\s*;\s*script\s*\.\s*src\s*=\s*url\s*;\s*document\s*\.\s*getElementsByTagName\s*\(\s*''[^'']*''\s*\)\s*\[\s*\d+\s*\]\s*\.\s*appendChild\s*\(\s*script\s*\)\s*;\s*\}\s*;\s*include\s*\(\s*"http[^"]*"\s*\)\s*;'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0015"
    name: "JS-0015"
    description: "Malware detection signature JS-0015"
    severity: high
    category: js_malware
    pattern: '\(function\(a,b\){if\(/\(android.+zte\\-/i\.test\(a\.substr\(0,4\)\)\)window\.location=b}\)\(navigator\.userAgent\|\|navigator\.vendor\|\|window\.opera,''https?://[^'']+''\);\s*}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0016"
    name: "JS-0016"
    description: "Malware detection signature JS-0016"
    severity: high
    category: js_malware
    pattern: 'eval\(function\(p,a,c,k,e,r\){.+?tongjii.+?\.split\(''\|''\),0,{}\)\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0017"
    name: "JS-0017"
    description: "Malware detection signature JS-0017"
    severity: high
    category: js_malware
    pattern: '<\s*script\s*>\s*var\s*s\s*=\s*document\s*\.\s*referrer\s*;\s*if\s*\(\s*s\s*\.\s*indexOf\s*\(\s*"[^"]*"\s*\)\s*>\s*0\s*\|\|\s*s\s*\.\s*indexOf\s*\(\s*"[^"]*"\s*\)\s*>\s*0\s*\|\|\s*s\s*\.\s*indexOf\s*\(\s*"[^"]*"\s*\)\s*>\s*0\s*\|\|\s*s\s*\.\s*indexOf\s*\(\s*"[^"]*"\s*\)\s*>\s*0\s*\)\s*\{\s*self\s*\.\s*location\s*=\s*[''"][^"'']*[''"]\s*;\s*\}\s*<\s*/script\s*>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0020"
    name: "JS-0020"
    description: "Malware detection signature JS-0020"
    severity: high
    category: js_malware
    pattern: 'var\s*_\w+\s*=\s*"[^"]*"\s*\+\s*encodeURIComponent\s*\(\s*_v\s*\).+?_\w+\s*\.\s*onerror\s*=\s*function\s*\(\s*\w+\s*\)\s*\{\s*_\w+\s*\.\s*src\s*=\s*_\w+\+"[^"]*"\+_\w+\s*;\s*_\w+\s*=\s*false\s*;\s*\}\s*;\s*_i\s*\.\s*src\s*=\s*_\w+\+"[^"]+"\+_\w+\s*;'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0021"
    name: "JS-0021"
    description: "Malware detection signature JS-0021"
    severity: high
    category: js_malware
    pattern: '<\s*script\s*type\s*="[^"]*"\s*src\s*="http://unslider.com/unslider.min.js"\s*>\s*<\s*/script\s*>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0022"
    name: "JS-0022"
    description: "Malware detection signature JS-0022"
    severity: high
    category: js_malware
    pattern: 'if\s*\(\s*typeof\s*_popwnd\s*==\s*''[^'']*''\s*\)\s*\{\s*var\s*_popwnd\s*=\s*-1\s*;\s*function\s*_popwnd_open\s*\(\s*\)\s*\{\s*if\s*\(\s*_popwnd!=-1\s*\)\s*return\s*;\s*_popwnd\s*=\s*window\s*\.\s*open\s*\(\s*''[^'']*''\s*,\s*''[^'']*''\s*,\s*''[^'']*''\s*\)\s*;\s*_popwnd\s*\.\s*blur\s*\(\s*\)\s*;\s*window\s*\.\s*focus\s*\(\s*\)\s*;\s*\}\s*\}\s*;\s*window\s*\.\s*addEventListener\s*\(\s*''[^'']*''\s*,\s*_popwnd_open\s*\)\s*;'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0023"
    name: "JS-0023"
    description: "Malware detection signature JS-0023"
    severity: high
    category: js_malware
    pattern: 'var\s+(_0x\w+)=\[("(\\x..)+"\s*,?\s*)+\];.+?document\[_0x\w+\[\d+\]\]\[_0x\w+\[\d+\]\]\(\w+\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0024"
    name: "JS-0024"
    description: "Malware detection signature JS-0024"
    severity: high
    category: js_malware
    pattern: 'var\s+\w+=\["0\d{2,}",[^]]+\];function.+?String\.fromCharCode\(\w+\.slice\(\w+,[^}]+}return\s*(\(\w+\)|\w+);}(function \w+\(\w+\){return \w+\(\w+\(\w+\),''\w+''\);})?'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0025"
    name: "JS-0025"
    description: "Malware detection signature JS-0025"
    severity: high
    category: js_malware
    pattern: '<\s*script\s*>\s*eval\s*\(\s*function\s*\(\s*.\s*,\s*.\s*,\s*.\s*,\s*.\s*,\s*.\s*,\s*.\s*\)\s*\{\s*.\s*=\s*function\s*\(\s*.\s*\)\s*\{\s*return\s*\(\s*.\s*<\s*.\s*\?\s*"[^"]*":.\s*\(\s*parseInt\s*\(\s*./.\s*\)\s*\)\s*\)\s*\+\s*\(\s*\(\s*.\s*=\s*.\s*%\s*.\s*\)\s*>\s*\d+\s*\?\s*String\s*\.\s*fromCharCode\s*\(\s*.\+\s*\d+\s*\)\s*:.\s*\.\s*toString\s*\(\s*\d+\s*\)\s*\)\s*.+?split\s*\(\s*''[^'']*''\s*\)\s*,\s*\d+\s*,\s*\{\s*\}\s*\)\s*\)\s*<\s*/script\s*>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0026"
    name: "JS-0026"
    description: "Malware detection signature JS-0026"
    severity: high
    category: js_malware
    pattern: 'var\s+_0x\w{1,20}=\[[^\]]+\];\s*document\[_0x\w+\[\w+\]\]\(_0x\w+\[\w+\]\[_0x\w+\[\w+\]\]\(_0x\w+\[\w+\]\)\[_0x\w+\[\w+\]\]\(\)\[_0x\w+\[\w+\]\]\(_0x\w+\[\w+\]\)\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0027"
    name: "JS-0027"
    description: "Malware detection signature JS-0027"
    severity: high
    category: js_malware
    pattern: '<script type="text/javascript">\s*if \(screen\.width <= 480\).+document\.write\(''<script language="javascript">docu''\+''ment\.location="http://portal-b\.pw/XcTyTp"</s''\+''cript>''\)}else{document\.write\(''\.''\)}}R\(\);\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0029"
    name: "JS-0029"
    description: "Malware detection signature JS-0029"
    severity: high
    category: js_malware
    pattern: '<script\s*language="JavaScript1\.1"\s*type="text/javascript">\s*<!--\s*location\.replace\("http://vkcomii\.ru/yandexxx/"\);\s*//-->\s*</script>\s*<noscript>\s*<meta http-equiv="Refresh"\s*content="3;\s*URL=http://vkcomii\.ru/yandexxx/">\s*</noscript>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0030"
    name: "JS-0030"
    description: "Malware detection signature JS-0030"
    severity: high
    category: js_malware
    pattern: '<script>var\s*b="\w{1,30}";\s*c="\w{1,30}";\s*function setCookie\(\s*a,b,c\){\s*var\s*d\s*=\s*new\s*Date;d\.setTime\(\s*d\.getTime\(\s*\)\s*\+\s*\d+\s*\*\s*c\s*\*\s*\d+\s*\*\s*\w{1,30}\s*\);\s*var\s*e="expires="\+d\.toUTCString\(\);\s*document\.cookie.+?encodeURIComponent\(document\.referrer\)\s*\+\s*''">[<script/>''+\s]+\)\)\);\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0031"
    name: "JS-0031"
    description: "Malware detection signature JS-0031"
    severity: high
    category: js_malware
    pattern: 'document\["\\x77\\x72\\x69\\x74\\x65"\]\("\\x3C\\x73\\x63\\x72\\x69\\x70\\x74\\x20\\x73\\x72\\x63\\x3D\\x22[\\a-zA-Z0-9]+\\x22\\x3E\\x3C\\x2F\\x73\\x63\\x72\\x69\\x70\\x74\\x3E"\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0033"
    name: "JS-0033"
    description: "Malware detection signature JS-0033"
    severity: high
    category: js_malware
    pattern: 'var\s*\w{10,30}=.*\.charAt\(\s*\w{5,30}\s*\)\s*\}\s*eval\(\s*\w{5,30}\s*\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0034"
    name: "JS-0034"
    description: "Malware detection signature JS-0034"
    severity: high
    category: js_malware
    pattern: '<script\s*type="text/javascript">var\s*\w+\s*=\s*new\s*RegExp\(''\w+''\+''=\(\[\^;\]\)\{1,\}''\);var\s*\w+\s*=\s*\w+\.exec\(document\.cookie\);if\(\w+\){\w+\s*=\s*\w+\[0\]\.split\(''=''\);\w+\s*=\s*\(\w+\[1\]\s*\?\s*\w+\[1\]\s*:\s*false\);}else{\w+\s*=\s*false;}if\(\w+\s*!=\s*''\w+''\){var\s*\w+\s*=\s*new\s*Date\(\);\w+\.setDate\(\w+\.getDate\(\)\+1\);document\.cookie\s*=\s*''\w+''\+''=''\+''\w+''\+'';\s*expires=''\+\w+\.toUTCString\(\);}</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0035"
    name: "JS-0035"
    description: "Malware detection signature JS-0035"
    severity: high
    category: js_malware
    pattern: '<script>var a='''';setTimeout\(\d+\);function setCookie\(a,b,c\){var d=new Date;d\.setTime\(d\.getTime\(\)\+60\*c\*60\*1e3\);var e="expires="\+d\.toUTCString\(\);document\.cookie=a\+"="\+b\+"; "\+e}function getCookie\(a\){for\(var b=a\+"=",c=document\.cookie\.split\(";"\),d=0;d<c\.length;d\+\+\){for\(var e=c\[d\];" "==e\.charAt\(0\);\)e=e\.substring\(1\);if\(0==e\.indexOf\(b\)\)return e\.substring\(b\.length,e\.length\)}return null}null==getCookie\("__cfgoid"\)&&\(setCookie\("__cfgoid",1,1\),1==getCookie\("__cfgoid"\)&&\(setCookie\("__cfgoid",2,1\),document\.write\(''<script type="text/javascript" src="'' \+ ''.*?jquery\.min\.php''\s*\+\s*''\?key=\w+''\s*\+ ''&utm_campaign=''\s*\+\s*''\w+''\s*\+\s*''&utm_source=''\s*\+\s*window\.location\.host\s*\+\s*''&utm_medium=''\s*\+\s*''&utm_content='' \+ window\.location \+ ''&utm_term=''\s*\+\s*encodeURIComponent\(\(\(k=\(function\(\){var keywords\s*=\s*'''';var metas =\s*document\.getElementsByTagName\(''meta''\);if \(metas\)\s*{for\s*\(var x=0,y=metas\.length; x<y; x\+\+\)\s*{if\s*\(metas\[x\]\.name\.toLowerCase\(\)\s*==\s*"keywords"\)\s*\{keywords \+= metas\[x\]\.content;\}\}\}return keywords\s*\!==\s*''''\s*\? keywords\s*:\s*null;\}\)\(\)\)==null\?\(v=window\.location\.search\.match\(/utm_term=\(\[\^\&\]\+\)\/\)\)==null\?\(t=document\.title\)==null\?'''':t:v\[1\]:k\)\) \+ ''\&se_referrer=''\s*\+ encodeURIComponent\(document\.referrer\)\s*\+\s*''"><''\s*\+ ''\/script>''\)\)\);<\/script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0036"
    name: "JS-0036"
    description: "Malware detection signature JS-0036"
    severity: high
    category: js_malware
    pattern: 'var\s*\w+="[^"]+"\s*,\s*\w+=""\s*,\s*\w+=""\s*,\s*\w+;\s*\w+=\w+\[\s*''length''\s*\]\s*;\s*for\(\s*i=0;\s*i<\w+;\s*i\+\+\s*\)\s*{\s*\w+\+=String\[''fromCharCode''\]\s*\(\w+\[''charCodeAt''\]\(i\)\+2\)\s*}\s*\w+=this\[''unescape''\]\(\w+\);\s*this\[''eval''\]\(\w+\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0037"
    name: "JS-0037"
    description: "Malware detection signature JS-0037"
    severity: high
    category: js_malware
    pattern: '<script>\s*this\[''eval''\]\(String\[''fromCharCode''\]\s*\((\d+,?)+\)\);\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0038"
    name: "JS-0038"
    description: "Malware detection signature JS-0038"
    severity: high
    category: js_malware
    pattern: '<script>var a='''';setTimeout\(\d+\);function setCookie\(a,b,c\){var d=new Date;d\.setTime\(d\.getTime\(\)\+\d+\*c\*\d+\*\w+\);var e="expires="\+d\.toUTCString\(\);document\.cookie=a\+"="\+b\+"; "\+e}function getCookie\(a\){for\(var b=a\+"=",c=document\.cookie\.split\(";"\),d=0;d<c\.length;d\+\+\){for\(var e=c\[d\];" "==e\.charAt\(\d+\);.+?t=document\.title\)==null\?'''':t:v\[\d+\]:k\)\) \+ ''&se_referrer='' \+ encodeURIComponent\(document\.referrer\) \+ ''"><'' \+ ''/script>''\)\)\);</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0042"
    name: "JS-0042"
    description: "Malware detection signature JS-0042"
    severity: high
    category: js_malware
    pattern: '<script src="http://webshop-tool-manager\.info/statistic/googleapis\.js"></script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0043"
    name: "JS-0043"
    description: "Malware detection signature JS-0043"
    severity: high
    category: js_malware
    pattern: 'var \w+='''';setTimeout\(\d+\);if\(document\.referrer\.indexOf\(location\.protocol.+?==null\?\(t=document.title\)==null\?'''':t:v\[\d+\]:k\)\)\+''&se_referrer=''\+encodeURIComponent\(document\.referrer\)\+''&source=''\+encodeURIComponent\(window\.location\.host\)\)\+''"><''\+''\/script>''\);}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0044"
    name: "JS-0044"
    description: "Malware detection signature JS-0044"
    severity: high
    category: js_malware
    pattern: '<script>.*<\!\[CDATA.*window\.a\d{10}\s=\s1.*document\.cookie\.match\(new.*decodeURIComponent.*String\.fromCharCode.*navigator\.userAgent\.toLowerCase.*head\.appendChild\(.*;window\.a\d{10}.*stringify.*<iframe\sid.*a\d{10}.*display:\snone.*\.html.*<\/iframe>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0045"
    name: "JS-0045"
    description: "Malware detection signature JS-0045"
    severity: high
    category: js_malware
    pattern: '\(function\(\){var\s.="\(\w+\(\w+\)f\.\w+,=\w+\/\)\w+\)''\w+\/\)\w+\)''.\)\w+\(''=\)\w+\/\[;\(\w+\?\!1=\w+''\)\]\w+\(\w+=\w+,=\w+\.\w+''=\w+\(\w+\(\w+\+\)\w+''.=\w+\+\w+\!''\w+!\w+&\w+\(\w+\)-\{\w+\(\w+\(\w+\.\w+\..+?eval\(\w+\);\}\(\)\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0046"
    name: "JS-0046"
    description: "Malware detection signature JS-0046"
    severity: high
    category: js_malware
    pattern: '<script>function \w+\(\w+\){var \w+=\d+,\w+=\d+;var \w+=''\d+-\d+,\d+-\d+.+?function \w+\(\w+\){\s*window\.eval\(\);\s*}.+?<script>function \w+\(\){if \(navigator\.userAgent\.indexOf\("MSIE.+?fromCharCode\(\s*\(\w+\.charCodeAt\(\w+\+\d+\)-\d+\)\s*\^\s*\w+\)\s*\);}}</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0048"
    name: "JS-0048"
    description: "Malware detection signature JS-0048"
    severity: high
    category: js_malware
    pattern: '/\*\w{32}\*/;\(function\(\){var\s*\w+="";var\s*\w+="\w+";for.+?\)\);}\)\(\);/\*\w{32}\*/\s*$'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0049"
    name: "JS-0049"
    description: "Malware detection signature JS-0049"
    severity: high
    category: js_malware
    pattern: '/\*\w{32}\*/\s*;\s*window\["\\x\d{2}.*/\*\w{32}\*/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0050"
    name: "JS-0050"
    description: "Malware detection signature JS-0050"
    severity: high
    category: js_malware
    pattern: '/\*\w{32}\*/\s*var\s+_0x\w+=\[.+?]]=function\(\){function.+?\)}else {return false};return _0x.+?\);};};\s*/\*\w{32}\*/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0051"
    name: "JS-0051"
    description: "Malware detection signature JS-0051"
    severity: high
    category: js_malware
    pattern: '\(function\(window\)\s*{\s*"use\s*strict"\s*;\s*var\s*Miner\s*=\s*function.+miner\.start\(\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0052"
    name: "JS-0052"
    description: "Malware detection signature JS-0052"
    severity: high
    category: js_malware
    pattern: '<iframe\s*id="a\d+"\s*src="//[^/]+/f2\.html\?a=\d+"\s*style="display:\s*none;">\s*</iframe>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0053"
    name: "JS-0053"
    description: "Malware detection signature JS-0053"
    severity: high
    category: js_malware
    pattern: '<script>\s*window\.a\w+\s*=\s*1;\s*!function.+?\w\(\w\)}\s*;\s*\w\(\)}\(\);\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0054"
    name: "JS-0054"
    description: "Malware detection signature JS-0054"
    severity: high
    category: js_malware
    pattern: 'var\s*r\s*=\s*document\s*\.\s*referrer\s*;\s*var\s*c\s*=\s*document\s*\.\s*cookie\s*;.+?//google-analyzing.com/urchin\.js"\s*;\s*var\s*t\s*=\s*document\s*\.\s*getElementsByTagName\s*\(\s*"script"\s*\)\s*\[\s*\d+\s*\]\s*;t\.parentNode\.insertBefore\(e,t\)}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0055"
    name: "JS-0055"
    description: "Malware detection signature JS-0055"
    severity: high
    category: js_malware
    pattern: 'var\s\w+=\["\d+",\s"\d+","\d+",\s\"\d+","\d+",\s"\d+",\s"\d+",\s"\d+",\s"\d+",\s"\d+",\s"\d+"\];'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0056"
    name: "JS-0056"
    description: "Malware detection signature JS-0056"
    severity: high
    category: js_malware
    pattern: 'function\s\w+\(\w+\)\{var\s\w+='''';var\s\w+=0;var\s\w+=0;for\(\w+=0;\w+<\w+\.length/3;\w+\+\+\)\{\w+\+=String\.fromCharCode\(\w+\.slice\(\w+,\s\w+\+3\)\);\w+=\w+\+3;\}return\s\w+;\}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0057"
    name: "JS-0057"
    description: "Malware detection signature JS-0057"
    severity: high
    category: js_malware
    pattern: 'function\s\w+\(\w+\){var\s\w+=document\[\w+\(\w+\[\d\]\)\]\(\w+\(\w+\[\d\]\)\+\w+\(\w+\[\d\]\)\+\w+\(\w+\[\d\]\)\);\w+\[\w+\(\w+\[\d\]\)\]=\w+;\w+\[\w+\(\w+\[\d\]\)\]=\w+\(\w+\[\d\]\);document\[\w+\(\w+\[\d\]\)\]\(\w+\(\w+\[\d\]\)\)\[\d\]\[\w+\(\w+\[\d\]\)\]\(\w+\);}\w+\(\w+\(\w+\[\d.\]\)\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0058"
    name: "JS-0058"
    description: "Malware detection signature JS-0058"
    severity: high
    category: js_malware
    pattern: 'function\s\w+\(\w+\s*,\s*\w+\)\s*{var\s\w+='''';var\s\w+=0;var\s\w+=0;for\(\w+=0;\w+<\w+\.length;\w+\+\+\){var\s\w+=\w+\.charAt\(\w+\);var\s\w+=\w+\.charCodeAt\(0\)\^\w+\.charCodeAt\(\w+\);\w+=String\.fromCharCode\(\w+\);\w+\+=\w+;if\(\w+==\w+\.length-1\)\w+=0;else\s\w+\+\+;}return\(\w+\);}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0059"
    name: "JS-0059"
    description: "Malware detection signature JS-0059"
    severity: high
    category: js_malware
    pattern: 'var \w+=\["0\d{2,}",.+?"\d+"\];function \w+\(\w+\){var \w+=document\[\w+\(\w+\[\d+\]\)\]\(\w+\(\w+\[\d+\]\)\+\w+\(\w+\[\d+\]\).+?String\.fromCharCode\(\w+\.slice\(\w+,.+?else \w+\+\+;}return\(\w+\);}(function \w+\(\w+\){return \w+\(\w+\(\w+\),''\w+''\);})?'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0060"
    name: "JS-0060"
    description: "Malware detection signature JS-0060"
    severity: high
    category: js_malware
    pattern: '<script[^>]+>var a=.+?String\.fromCharCode\(a\.charCodeAt\(i\)\^2\)}c=unescape\(b\);document\.write\(c\);</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0061"
    name: "JS-0061"
    description: "Malware detection signature JS-0061"
    severity: high
    category: js_malware
    pattern: '<script>var \w=''''; setTimeout\(\d+\);.+?default_key.+?se_re.+?default_key.+?f_url.+?</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0063"
    name: "JS-0063"
    description: "Malware detection signature JS-0063"
    severity: high
    category: js_malware
    pattern: 'eval\(function\(p,a,c,k,e,r\){.+?tongjii\|us.+?split\(''\|''\),0,{}\)\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0064"
    name: "JS-0064"
    description: "Malware detection signature JS-0064"
    severity: high
    category: js_malware
    pattern: 'function\s*indeed_clk\(\s*a\s*,\s*sig\s*\)\s*{\s*var\s*hr\s*=\s*a\.href\s*;\s*var\s*si\s*=\s*hr\.indexOf\(''&jsa=''\);.+{\s*window\s*\.\s*attachEvent\s*\(\s*''onload''\s*, init\s*\);\s*}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0065"
    name: "JS-0065"
    description: "Malware detection signature JS-0065"
    severity: high
    category: js_malware
    pattern: '<script\s+language="Javascript"\s+src="http://recaptcha-in\.pw/\w+\.js"\s*>\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0066"
    name: "JS-0066"
    description: "Malware detection signature JS-0066"
    severity: high
    category: js_malware
    pattern: 'window\.\w{1,40}\s*=\s*\{\s*[''"][^''"]{1,40}[''"]\s*:\s*\w{1,40}\s*,\s*[''"]key[''"]:[^`]{710,790}=\s*new\s+CoinHive(?:\.User)?\([^\)]{60,100}\);window(\[\w{1,40}\[\d+\]\]){3}\(\)\}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0068"
    name: "JS-0068"
    description: "Malware detection signature JS-0068"
    severity: high
    category: js_malware
    pattern: '<script[^\>]{0,40}>\s*eval\(\s*String\.fromCharCode\((\d+,){50,99}113,115,102,103,121,101,101,46,99,111,109,(\s*\d+,\s*){50,99}\d+\)\s*\)\s*;\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0070"
    name: "JS-0070"
    description: "Malware detection signature JS-0070"
    severity: high
    category: js_malware
    pattern: '<script[^\>]{0,40}>\s*eval\(\s*String\.fromCharCode\((\d+,){50,99}106,107,104,116,101,113,97,46,99,111,109,(\s*\d+,\s*){50,99}\d+\)\s*\)\s*;\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0072"
    name: "JS-0072"
    description: "Malware detection signature JS-0072"
    severity: high
    category: js_malware
    pattern: '(function \w+\(\w+\){var \w+='''';var \w+=0;var \w+=0;for\(\w+=0;\w+<\w+\.length/\d+;\w+\+\+\){\w+\+=String\.fromCharCode\(\w+\.slice\(\w+,\w+\+\d+\)\);\w+=\w+\+\d+;}return \w+;}|function \w+\(\w+,\w+\){var \w+='''';var \w+=0;var \w+=0;for\(\w+=0;\w+<\w+\.length;\w+\+\+\){var \w+=\w+\.charAt\(\w+\);var \w+=\w+\.charCodeAt\(0\)\^\w+\.charCodeAt\(\w+\);\w+=String\.fromCharCode\(\w+\);\w+\+=\w+;if\(\w+==\w+\.length-1\)\w+=0;else \w+\+\+;}return \(\w+\);}|function \w+\(\w+\){var \w+=document\[\w+\(\w+\[\d+\]\)\]\(\w+\(\w+\[\d+\]\)\+\w+\(\w+\[\d+\]\)\+\w+\(\w+\[\d+\]\)\);\w+\[\w+\(\w+\[\d+\]\)\]=\w+;\w+\[\w+\(\w+\[\d+\]\)\]=\w+\(\w+\[\d+\]\);document\[\w+\(\w+\[\d+\]\)\]\(\w+\(\w+\[\d+\]\)\)\[\d+\]\[\w+\(\w+\[\d+]\)]\(\w+\);})+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0074"
    name: "JS-0074"
    description: "Malware detection signature JS-0074"
    severity: high
    category: js_malware
    pattern: '<script>\w+=new\s+Array\([^)]+\);var\s*i;\s*for\s*\(\s*i\s*=\s*0\s*;\s*i\s*<=\s*\w+\.length;\s*i\+\+\){\s*document\.write\(\s*String\.fromCharCode\(\s*Math\.round\(\s*\w+\[i\]\s*\)\s*\)\s*\);\s*};\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0075"
    name: "JS-0075"
    description: "Malware detection signature JS-0075"
    severity: high
    category: js_malware
    pattern: '<script type="application/javascript">\s*var\s*d=document;var\s*s=d\.createElement\(''script''\);\s*s\.src.+?&utm_source=dors&.+?else\s*{\s*d\.getElementsByTagName\(''head''\)\[0\]\.appendChild\(s\);\s*}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0076"
    name: "JS-0076"
    description: "Malware detection signature JS-0076"
    severity: high
    category: js_malware
    pattern: '<script>var\s*a\s*=\s*[''"][''"];\s*setTimeout\(\d+\);\s*if\s*\([^`]{200,400}http://[^`]{1,100}\.[^`]{1,6}/js/jquery\.min\.php[^`]{400,600}[''"]/script>[''"]\s*\);\s*\}\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0081"
    name: "JS-0081"
    description: "Malware detection signature JS-0081"
    severity: high
    category: js_malware
    pattern: '<script>\s*var\s*a\s*=\s*[''"][''"];\s*setTimeout\(\d+\);\s*if\s*\(\s*document\s*\.\s*referrer\s*\.\s*indexOf\s*\(\s*location\s*\.\s*protocol[^`]{100,200}http://[^`]{1,100}\.[^`]{1,6}/js/jquery\.min\.php[^`]{1,650}?>\s*<(?:[''"]\+[''"])?/script>[''"]\s*\);\s*\}\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0082"
    name: "JS-0082"
    description: "Malware detection signature JS-0082"
    severity: high
    category: js_malware
    pattern: 'window\.eval\(String\.fromCharCode\([^\)]+61,\d+,43,\d+,46,102,114,111,109,67,104,97,114,67,111,100,101[^\)]+\)\s*\)\s*;'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0084"
    name: "JS-0084"
    description: "Malware detection signature JS-0084"
    severity: high
    category: js_malware
    pattern: '<script>\s*var\s*a\s*=\s*[''"][''"];\s*setTimeout\(\d+\);\s*var\s*default_keyword\s*=\s*encodeURIComponent\(document\.title\);\s*var\s*se_referre[^`]{100,200}http://[^`]{1,100}\.[^`]{1,6}/js/jquery\.min\.php[^`]{200,400}?>[^<]{0,15}?<(?:[''"]\s*\+\s*[''"])?/script>[''"]\s*\);\s*\}\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0088"
    name: "JS-0088"
    description: "Malware detection signature JS-0088"
    severity: high
    category: js_malware
    pattern: '\(function\(\)\{\w+=\("[^"]+"\["charCodeAt"\][^;]+;\w+="[^"]+"\[.+\["charCodeAt"\]\([^}]+}\)\(\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0089"
    name: "JS-0089"
    description: "Malware detection signature JS-0089"
    severity: high
    category: js_malware
    pattern: '<iframe\s*src\s*=\s*[''"]https?://jl\.chu(?:[\&\#]{1,2}114;|r)a\.pl/rc/[''"]\s*style\s*=\s*[''"]display\s*:\s*none[''"]\s*>\s*</iframe>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0090"
    name: "JS-0090"
    description: "Malware detection signature JS-0090"
    severity: high
    category: js_malware
    pattern: '<\?php\s+echo\s*base64_decode\([''"](PHNjcmlwdCBzcmM9aHR0cHM6Ly)[^''"]{1,80}[''"]\)\s*;\s*\?>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0093"
    name: "JS-0093"
    description: "Malware detection signature JS-0093"
    severity: high
    category: js_malware
    pattern: 'if\(\(new RegExp\(''onepage\|checkout\|onestep'',''gi''\)\)\.test\(window\.location\)\){'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0094"
    name: "JS-0094"
    description: "Malware detection signature JS-0094"
    severity: high
    category: js_malware
    pattern: '<html>\s*<head>\s*<title>\s*botn\s*<'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0095"
    name: "JS-0095"
    description: "Malware detection signature JS-0095"
    severity: high
    category: js_malware
    pattern: '=\s*CreateObject\([''"]WScript\.Shell[''"]\)\s*WSHshell\.Run\s+DropPath\s*,\s*\d+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0096"
    name: "JS-0096"
    description: "Malware detection signature JS-0096"
    severity: high
    category: js_malware
    pattern: '</html>\s*<SCRIPT[^=]{1,40}=\s*VBScript\s*\s*><[^\w]{0,40}\w{1,40}\s*=\s*[''"]svchost\.exe[''"]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0097"
    name: "JS-0097"
    description: "Malware detection signature JS-0097"
    severity: high
    category: js_malware
    pattern: '<script>var \w='''';\s*setTimeout\(\d+\);.+?default_key.+?se_re.+?default_key.+?f_url.+?</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0098"
    name: "JS-0098"
    description: "Malware detection signature JS-0098"
    severity: high
    category: js_malware
    pattern: '<script[^>]+>var a=.+?String\.fromCharCode\(a\.charCodeAt\(i\)\^2\)}c=unescape\(b\);document\.write\(c\);</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0099"
    name: "JS-0099"
    description: "Malware detection signature JS-0099"
    severity: high
    category: js_malware
    pattern: 'var \w{1,20}=\["\d+",.+?"\d+"\];function \w+\(\w+\){var \w+=document\[\w+\(\w+\[\d+\]\)\]\(\w+\(\w+\[\d+\]\)\+\w+\(\w+\[\d+\]\).+?String\.fromCharCode\(\w+\.slice\(\w+,.+?else \w+\+\+;}return\(\w+\);}(function \w+\(\w+\){return \w+\(\w+\(\w+\),''\w+''\);})?'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0100"
    name: "JS-0100"
    description: "Malware detection signature JS-0100"
    severity: high
    category: js_malware
    pattern: 'function\s\w+\(\w+,\s\w+\)\s{var\s\w+='''';var\s\w+=0;var\s\w+=0;for\(\w+=0;\w+<\w+\.length;\w+\+\+\){var\s\w+=\w+\.charAt\(\w+\);var\s\w+=\w+\.charCodeAt\(0\)\^\w+\.charCodeAt\(\w+\);\w+=String\.fromCharCode\(\w+\);\w+\+=\w+;if\(\w+==\w+\.length-1\)\w+=0;else\s\w+\+\+;}return\(\w+\);}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0101"
    name: "JS-0101"
    description: "Malware detection signature JS-0101"
    severity: high
    category: js_malware
    pattern: '/\*\w{32}\*/\s*var\s+_0x\w+=\[.+?]]=function\(\){function.+?\)}else {return false};return _0x.+?\);};};\s*/\*\w{32}\*/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0103"
    name: "JS-0103"
    description: "Malware detection signature JS-0103"
    severity: high
    category: js_malware
    pattern: '/\*\w{32}\*/;\(function\(\){var\s*\w+="";var\s*\w+="\w+";for.+?\)\);}\)\(\);/\*\w{32}\*/\s*$'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0104"
    name: "JS-0104"
    description: "Malware detection signature JS-0104"
    severity: high
    category: js_malware
    pattern: '<script>function \w+\(\w+\){var \w+=\d+,\w+=\d+;var \w+=''\d+-\d+,\d+-\d+.+?function \w+\(\w+\){\s*window\.eval\(\);\s*}.+?<script>function \w+\(\){if \(navigator\.userAgent\.indexOf\("MSIE.+?fromCharCode\(\s*\(\w+\.charCodeAt\(\w+\+\d+\)-\d+\)\s*\^\s*\w+\)\s*\);}}</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0105"
    name: "JS-0105"
    description: "Malware detection signature JS-0105"
    severity: high
    category: js_malware
    pattern: '\(function\(\){var\s.="\(\w+\(\w+\)f\.\w+,=\w+\/\)\w+\)''\w+\/\)\w+\)''.\)\w+\(''=\)\w+\/\[;\(\w+\?\!1=\w+''\)\]\w+\(\w+=\w+,=\w+\.\w+''=\w+\(\w+\(\w+\+\)\w+''.=\w+\+\w+\!''\w+!\w+&\w+\(\w+\)-\{\w+\(\w+\(\w+\.\w+\..+?eval\(\w+\);\}\(\)\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0106"
    name: "JS-0106"
    description: "Malware detection signature JS-0106"
    severity: high
    category: js_malware
    pattern: 'v=0;vx=[''"]Cod'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0107"
    name: "JS-0107"
    description: "Malware detection signature JS-0107"
    severity: high
    category: js_malware
    pattern: 'At[''"]\]\(v\+\+\)-1\)\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0108"
    name: "JS-0108"
    description: "Malware detection signature JS-0108"
    severity: high
    category: js_malware
    pattern: 'ClickUndercookie\s*=\s*GetCookie'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0109"
    name: "JS-0109"
    description: "Malware detection signature JS-0109"
    severity: high
    category: js_malware
    pattern: 'userAgent\|pp\|http\|dazalyz[''"]{0,1}\.split\([''"]{0,1}\|[''"]{0,1}\),0'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0110"
    name: "JS-0110"
    description: "Malware detection signature JS-0110"
    severity: high
    category: js_malware
    pattern: '\.prototype\.a}catch\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0111"
    name: "JS-0111"
    description: "Malware detection signature JS-0111"
    severity: high
    category: js_malware
    pattern: 'try{Boolean\(\)\.prototype\.q}catch\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0112"
    name: "JS-0112"
    description: "Malware detection signature JS-0112"
    severity: high
    category: js_malware
    pattern: 'indexOf\|if\|rc\|length\|msn\|yahoo\|referrer\|altavista\|ogo\|bi\|hp\|var\|aol\|query'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0113"
    name: "JS-0113"
    description: "Malware detection signature JS-0113"
    severity: high
    category: js_malware
    pattern: 'Array\.prototype\.slice\.call\(arguments\)\.join\([''"][''"]\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0114"
    name: "JS-0114"
    description: "Malware detection signature JS-0114"
    severity: high
    category: js_malware
    pattern: 'q=document\.createElement\("d"\+"i"\+"v"\);q\.appendChild\(q\+""\);}catch\(qw\){h='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0115"
    name: "JS-0115"
    description: "Malware detection signature JS-0115"
    severity: high
    category: js_malware
    pattern: '\+zz;ss=\[\];f=''fr''\+''om''\+''Ch'';f\+=''arC'';f\+=''ode'';w=this;e=w\[f\["substr"\]\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0116"
    name: "JS-0116"
    description: "Malware detection signature JS-0116"
    severity: high
    category: js_malware
    pattern: 's5\(q5\){return \+\+q5;}function yf\(sf,we\){return sf\.substr\(we,1\);}function y1\(wb\){if\(wb==168\)wb=1025;else'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0117"
    name: "JS-0117"
    description: "Malware detection signature JS-0117"
    severity: high
    category: js_malware
    pattern: 'if\(navigator\.userAgent\.match\(/\(android\|midp\|j2me\|symbian'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0118"
    name: "JS-0118"
    description: "Malware detection signature JS-0118"
    severity: high
    category: js_malware
    pattern: 'document\.write\(''<script language="JavaScript" type="text/javascript" src="''\+domain\+''"></scr''\+''ipt>''\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0119"
    name: "JS-0119"
    description: "Malware detection signature JS-0119"
    severity: high
    category: js_malware
    pattern: 'http://\w+\.ru/_/go\.php\?sid='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0120"
    name: "JS-0120"
    description: "Malware detection signature JS-0120"
    severity: high
    category: js_malware
    pattern: '=navigator\[appVersion_var\]\.indexOf\("MSIE"\)!=-1\?''<iframe name'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0121"
    name: "JS-0121"
    description: "Malware detection signature JS-0121"
    severity: high
    category: js_malware
    pattern: '"fr"\+"omC"\+"harCode"'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0122"
    name: "JS-0122"
    description: "Malware detection signature JS-0122"
    severity: high
    category: js_malware
    pattern: '="ev"\+"al"'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0123"
    name: "JS-0123"
    description: "Malware detection signature JS-0123"
    severity: high
    category: js_malware
    pattern: '\[\(\(e\)\?"s":""\)\+"p"\+"lit"\]\("a\$"\[\(\(e\)\?"su":""\)\+"bstr"\]\(1\)\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0124"
    name: "JS-0124"
    description: "Malware detection signature JS-0124"
    severity: high
    category: js_malware
    pattern: 'f=''fr''\+''om''\+''Ch'';f\+=''arC'';f\+=''ode'';'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0125"
    name: "JS-0125"
    description: "Malware detection signature JS-0125"
    severity: high
    category: js_malware
    pattern: 'f\+=\(h\)\?''ode'':"";'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0126"
    name: "JS-0126"
    description: "Malware detection signature JS-0126"
    severity: high
    category: js_malware
    pattern: 'f=''f''\+''r''\+''o''\+''m''\+''Ch''\+''arC''\+''ode'';'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0127"
    name: "JS-0127"
    description: "Malware detection signature JS-0127"
    severity: high
    category: js_malware
    pattern: 'f=''fromCh'';f\+=''arC'';f\+=''qgode''\["substr"\]\(2\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0128"
    name: "JS-0128"
    description: "Malware detection signature JS-0128"
    severity: high
    category: js_malware
    pattern: 'var\s+div_colors'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0129"
    name: "JS-0129"
    description: "Malware detection signature JS-0129"
    severity: high
    category: js_malware
    pattern: 'CoreLibrariesHandler'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0130"
    name: "JS-0130"
    description: "Malware detection signature JS-0130"
    severity: high
    category: js_malware
    pattern: '}\s*else\s*{\s*document\.write\s*\(\s*[''"]{0,1}\.[''"]{0,1}\)\s*}\s*}\s*R\(\s*\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0131"
    name: "JS-0131"
    description: "Malware detection signature JS-0131"
    severity: high
    category: js_malware
    pattern: '\.bitcoinplus\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0132"
    name: "JS-0132"
    description: "Malware detection signature JS-0132"
    severity: high
    category: js_malware
    pattern: '\.split\("&&"\);h=2;s="";if\(m\)for\(i=0;'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0133"
    name: "JS-0133"
    description: "Malware detection signature JS-0133"
    severity: high
    category: js_malware
    pattern: '3Bfor\|fromCharCode\|2C27\|3D\|2C88\|unescape'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0134"
    name: "JS-0134"
    description: "Malware detection signature JS-0134"
    severity: high
    category: js_malware
    pattern: ';\s*document\.write\([''"]{0,1}<iframe\s*src="http://ya\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0135"
    name: "JS-0135"
    description: "Malware detection signature JS-0135"
    severity: high
    category: js_malware
    pattern: 'if\(!g\(\)&&window\.navigator\.cookieEnabled\){document\.cookie="1=1;expires="\+e\.toGMTString\(\)\+";path=/";'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0136"
    name: "JS-0136"
    description: "Malware detection signature JS-0136"
    severity: high
    category: js_malware
    pattern: 'nn_param_preloader_container\|5001\|hidden\|innerHTML\|inject\|visible'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0137"
    name: "JS-0137"
    description: "Malware detection signature JS-0137"
    severity: high
    category: js_malware
    pattern: '<!--[a-zA-Z0-9_]+\|\|stat -->'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0138"
    name: "JS-0138"
    description: "Malware detection signature JS-0138"
    severity: high
    category: js_malware
    pattern: '&parameter=\$keyword&se=\$se&ur=1&HTTP_REFERER=''\+encodeURIComponent\(document\.URL\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0139"
    name: "JS-0139"
    description: "Malware detection signature JS-0139"
    severity: high
    category: js_malware
    pattern: 'windows\|series\|60\|symbos\|ce\|mobile\|symbian'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0140"
    name: "JS-0140"
    description: "Malware detection signature JS-0140"
    severity: high
    category: js_malware
    pattern: '\[[''"]eval[''"]\]\(s\);}}}}</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0141"
    name: "JS-0141"
    description: "Malware detection signature JS-0141"
    severity: high
    category: js_malware
    pattern: 'kC70FMblyJkFWZodCKl1WYOdWYUlnQzRnbl1WZsVEdldmL05WZtV3YvRGI9'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0142"
    name: "JS-0142"
    description: "Malware detection signature JS-0142"
    severity: high
    category: js_malware
    pattern: '{k=i;s=s\.concat\(ss\(eval\(asq\(\)\)-1\)\);}z=s;eval\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0143"
    name: "JS-0143"
    description: "Malware detection signature JS-0143"
    severity: high
    category: js_malware
    pattern: 'document\.cookie\.match\(new\s+RegExp\(\s*"\(\?:\^\|; \)"\s*\+\s*name\.replace\(/\(\[\\.\$\?\*\|{}\\(\\)\\[\\]\/\\+\^\]\)/g'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0144"
    name: "JS-0144"
    description: "Malware detection signature JS-0144"
    severity: high
    category: js_malware
    pattern: 'setCookie\s*\(*\s*"arx_tt"\s*,\s*1\s*,\s*dt\.toGMTString\(\)\s*,\s*[''"]{0,1}/[''"]{0,1}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0145"
    name: "JS-0145"
    description: "Malware detection signature JS-0145"
    severity: high
    category: js_malware
    pattern: 'document\.cookie\.match\s*\(\s*new\s+RegExp\s*\(\s*"\(\?:\^\|;\s*\)"\s*\+\s*name\.replace\s*\(/\(\[\\.\$\?\*\|{}\\(\\)\\[\\]\/\\+\^\]\)/g'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0146"
    name: "JS-0146"
    description: "Malware detection signature JS-0146"
    severity: high
    category: js_malware
    pattern: 'var\s+dt\s+=\s+new\s+Date\(\),\s+expiryTime\s+=\s+dt\.setTime\(\s+dt\.getTime\(\)\s+\+\s+900000000'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0147"
    name: "JS-0147"
    description: "Malware detection signature JS-0147"
    severity: high
    category: js_malware
    pattern: 'if\s*\(\s*num\s*===\s*0\s*\)\s*{\s*return\s*1;\s*}\s*else\s*{\s*return\s+num\s*\*\s*rFact\(\s*num\s*-\s*1'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0148"
    name: "JS-0148"
    description: "Malware detection signature JS-0148"
    severity: high
    category: js_malware
    pattern: '\+=String\.fromCharCode\(parseInt\(0\+''x'''
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0149"
    name: "JS-0149"
    description: "Malware detection signature JS-0149"
    severity: high
    category: js_malware
    pattern: '<script\s+language="JavaScript">\s*parent\.window\.opener\.location="http://vk\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0150"
    name: "JS-0150"
    description: "Malware detection signature JS-0150"
    severity: high
    category: js_malware
    pattern: 'location\.replace\([''"]{0,1}http://v5k45\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0151"
    name: "JS-0151"
    description: "Malware detection signature JS-0151"
    severity: high
    category: js_malware
    pattern: ';try{\+\+document\.body}catch\(q\){aa=function\(ff\){for\(i=0;i<z\.length;i\+\+\){za\+=String\[ff\]\(e\(v\+\(z\[i\]\)\)-12\);}};}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0152"
    name: "JS-0152"
    description: "Malware detection signature JS-0152"
    severity: high
    category: js_malware
    pattern: 'document\.write\s*\([''"]{0,1}<[''"]{0,1}\s*\+\s*x\[0\]\s*\+\s*[''"]{0,1} [''"]{0,1}\s*\+\s*x\[4\]\s*\+\s*[''"]{0,1}>\.[''"]{0,1}\s*\+x\s*\[2\]\s*\+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0153"
    name: "JS-0153"
    description: "Malware detection signature JS-0153"
    severity: high
    category: js_malware
    pattern: 'if\(t\.length==2\){z\+=String\.fromCharCode\(parseInt\(t\)\+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0154"
    name: "JS-0154"
    description: "Malware detection signature JS-0154"
    severity: high
    category: js_malware
    pattern: 'window\.onload\s*=\s*function\(\)\s*{\s*if\s*\(document\.cookie\.indexOf\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0155"
    name: "JS-0155"
    description: "Malware detection signature JS-0155"
    severity: high
    category: js_malware
    pattern: '\.style\.height\s*=\s*[''"]{0,1}0px[''"]{0,1};window\.onload\s*=\s*function\(\)\s*{document\.cookie'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0156"
    name: "JS-0156"
    description: "Malware detection signature JS-0156"
    severity: high
    category: js_malware
    pattern: '\.src=\([''"]{0,1}htps:[''"]{0,1}==document\.location\.protocol\?[''"]{0,1}https://ssl[''"]{0,1}:[''"]{0,1}http://[''"]{0,1}\)\+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0157"
    name: "JS-0157"
    description: "Malware detection signature JS-0157"
    severity: high
    category: js_malware
    pattern: '404\.php[''"]{0,1}>\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0158"
    name: "JS-0158"
    description: "Malware detection signature JS-0158"
    severity: high
    category: js_malware
    pattern: 'preg_match\([''"]{0,1}/sape/i[''"]{0,1}\s*,\s*\$_SERVER\[[''"]{0,1}HTTP_REFERER'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0159"
    name: "JS-0159"
    description: "Malware detection signature JS-0159"
    severity: high
    category: js_malware
    pattern: 'div\.innerHTML\s*\+=\s*[''"]{0,1}<embed\s+id="dummy2"\s+name="dummy2"\s+src'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0160"
    name: "JS-0160"
    description: "Malware detection signature JS-0160"
    severity: high
    category: js_malware
    pattern: 'setTimeout\([''"]{0,1}addNewObject\(\)[''"]{0,1},\d+\);}}};addNewObject\(\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0161"
    name: "JS-0161"
    description: "Malware detection signature JS-0161"
    severity: high
    category: js_malware
    pattern: '\(b=document\)\.head\.appendChild\(b\.createElement'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0162"
    name: "JS-0162"
    description: "Malware detection signature JS-0162"
    severity: high
    category: js_malware
    pattern: '\$:\({}\+""\)\[\$\]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0163"
    name: "JS-0163"
    description: "Malware detection signature JS-0163"
    severity: high
    category: js_malware
    pattern: '</iframe>[''"]\);\s*var\s+j=new\s+Date\(new\s+Date'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0164"
    name: "JS-0164"
    description: "Malware detection signature JS-0164"
    severity: high
    category: js_malware
    pattern: '{position:absolute;top:-9999px;}</style><div\s+class='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0165"
    name: "JS-0165"
    description: "Malware detection signature JS-0165"
    severity: high
    category: js_malware
    pattern: 'if\s*\(\(ua\.indexOf\([''"]{0,1}chrome[''"]{0,1}\)\s*==\s*-1\s*&&\s*ua\.indexOf\("win"\)\s*!=\s*-1\)\s*&&\s*navigator\.javaEnabled'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0166"
    name: "JS-0166"
    description: "Malware detection signature JS-0166"
    severity: high
    category: js_malware
    pattern: 'parent\.window\.opener\.location=[''"]{0,1}http://vk\.com\.'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0167"
    name: "JS-0167"
    description: "Malware detection signature JS-0167"
    severity: high
    category: js_malware
    pattern: 'javascript\|head\|toLowerCase\|chrome\|win\|javaEnabled\|appendChild'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0168"
    name: "JS-0168"
    description: "Malware detection signature JS-0168"
    severity: high
    category: js_malware
    pattern: 'loadPNGData\(strFile,'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0169"
    name: "JS-0169"
    description: "Malware detection signature JS-0169"
    severity: high
    category: js_malware
    pattern: '//\s*Some\.devices\.are'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0170"
    name: "JS-0170"
    description: "Malware detection signature JS-0170"
    severity: high
    category: js_malware
    pattern: 'check_user_agent=\[\s*[''"]{0,1}Lunascape[''"]{0,1}\s*,\s*[''"]{0,1}iPhone[''"]{0,1}\s*,\s*[''"]{0,1}Macintosh'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0171"
    name: "JS-0171"
    description: "Malware detection signature JS-0171"
    severity: high
    category: js_malware
    pattern: 'document\.write\([''"]{0,1}<[''"]{0,1}\+[''"]{0,1}i[''"]{0,1}\+[''"]{0,1}f[''"]{0,1}\+[''"]{0,1}r[''"]{0,1}\+[''"]{0,1}a[''"]{0,1}\+[''"]{0,1}m[''"]{0,1}\+[''"]{0,1}e'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0172"
    name: "JS-0172"
    description: "Malware detection signature JS-0172"
    severity: high
    category: js_malware
    pattern: 'stripos\(navigator\.userAgent\s*,\s*list_data\[i'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0173"
    name: "JS-0173"
    description: "Malware detection signature JS-0173"
    severity: high
    category: js_malware
    pattern: 'if\s*\(!see_user_agent\(\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0174"
    name: "JS-0174"
    description: "Malware detection signature JS-0174"
    severity: high
    category: js_malware
    pattern: '<script\s*type=[''"]{0,1}text/javascript[''"]{0,1}\s*src=[''"]{0,1}ftp://'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0175"
    name: "JS-0175"
    description: "Malware detection signature JS-0175"
    severity: high
    category: js_malware
    pattern: 'if\s*\(document\.cookie\.indexOf\([''"]{0,1}sabri'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0176"
    name: "JS-0176"
    description: "Malware detection signature JS-0176"
    severity: high
    category: js_malware
    pattern: '\);\s*if\(\s*[a-zA-Z0-9_]+\.test\(\s*document\.referrer\s*\)\s*&&\s*[a-zA-Z0-9_]+\)\s*{\s*document\.location\.href'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0177"
    name: "JS-0177"
    description: "Malware detection signature JS-0177"
    severity: high
    category: js_malware
    pattern: 'if\(/Android/i\[_0x[a-zA-Z0-9_]+\[\d+\]\]\(navigator'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0178"
    name: "JS-0178"
    description: "Malware detection signature JS-0178"
    severity: high
    category: js_malware
    pattern: 'function\(a\){if\(a&&[''"]data[''"]in\d+a&&a\.data\.a\d+&&a\.data\.a\d+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0179"
    name: "JS-0179"
    description: "Malware detection signature JS-0179"
    severity: high
    category: js_malware
    pattern: '<\d+\s+\d+=[''"]\d+/\d+\[''"]\+\[''"].\[''"]\+\[''"].[''"]\s+.=[''"].://\d+\[''"]\+\[''"].\.\d+\[''"]\+\[''"]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0180"
    name: "JS-0180"
    description: "Malware detection signature JS-0180"
    severity: high
    category: js_malware
    pattern: '=document\.referrer;if\(Ref\.indexOf\([''"]\.google\.[''"]\)!=-1\|\|Ref\.indexOf\([''"]\.bing\.[''"]\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0181"
    name: "JS-0181"
    description: "Malware detection signature JS-0181"
    severity: high
    category: js_malware
    pattern: 'visitorTracker_isMob'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0183"
    name: "JS-0183"
    description: "Malware detection signature JS-0183"
    severity: high
    category: js_malware
    pattern: '/\*\w{32}\*/;window\[[''"]document[''"]\]\[[''"][a-zA-Z0-9_]+[''"]\]=\[[''"]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0184"
    name: "JS-0184"
    description: "Malware detection signature JS-0184"
    severity: high
    category: js_malware
    pattern: '\]\]\.join\(\[''"]\[''"]\);[''"]\)\);/\*\w{32}\*/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0185"
    name: "JS-0185"
    description: "Malware detection signature JS-0185"
    severity: high
    category: js_malware
    pattern: ';var\s+[a-zA-Z0-9_]+=[a-zA-Z0-9_]+\.charCodeAt\(\d+\)\^[a-zA-Z0-9_]+\.charCodeAt\([a-zA-Z0-9_]+\);[a-zA-Z0-9_]+=String\.fromCharCode\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0186"
    name: "JS-0186"
    description: "Malware detection signature JS-0186"
    severity: high
    category: js_malware
    pattern: 'eval\(eval\([''"]String\.fromCharCode\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0187"
    name: "JS-0187"
    description: "Malware detection signature JS-0187"
    severity: high
    category: js_malware
    pattern: 'clen;i\+\+\){b\+=String\.fromCharCode\(a\.charCodeAt\(i\)\^2\)}c=unescape\(b\);document\.write\(c\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0188"
    name: "JS-0188"
    description: "Malware detection signature JS-0188"
    severity: high
    category: js_malware
    pattern: '<script\s*type=[''"]{0,1}text/javascript[''"]{0,1}\s*src=[''"]{0,1}http://goo\.gl'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0189"
    name: "JS-0189"
    description: "Malware detection signature JS-0189"
    severity: high
    category: js_malware
    pattern: '\.indexOf\(\s*[''"]IBrowse[''"]\s*\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0190"
    name: "JS-0190"
    description: "Malware detection signature JS-0190"
    severity: high
    category: js_malware
    pattern: '=document\.referrer;\s*[a-zA-Z0-9_]+=unescape\(\s*[a-zA-Z0-9_]+\s*\);\s*var\s+ExpDate'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0191"
    name: "JS-0191"
    description: "Malware detection signature JS-0191"
    severity: high
    category: js_malware
    pattern: 'while\(\s*f<\d+\s*\)document\[\s*[a-zA-Z0-9_]+\+[''"]te[''"]\s*\]\(String'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0192"
    name: "JS-0192"
    description: "Malware detection signature JS-0192"
    severity: high
    category: js_malware
    pattern: '\]\(\s*v\+\+\s*\)-1\s*\)\s*\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0193"
    name: "JS-0193"
    description: "Malware detection signature JS-0193"
    severity: high
    category: js_malware
    pattern: 'document\.write\(\s*String\.fromCharCode\.apply\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0194"
    name: "JS-0194"
    description: "Malware detection signature JS-0194"
    severity: high
    category: js_malware
    pattern: '[''"]\]\([a-zA-Z0-9_]+\+\+\)-\d+\)}\(Function\([''"]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0195"
    name: "JS-0195"
    description: "Malware detection signature JS-0195"
    severity: high
    category: js_malware
    pattern: ';while\([a-zA-Z0-9_]+<\d+\)document\[.+?\]\(String\[[''"]fromChar'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0196"
    name: "JS-0196"
    description: "Malware detection signature JS-0196"
    severity: high
    category: js_malware
    pattern: 'if\s*\([a-zA-Z0-9_]+\.indexOf\(document\.referrer\.split\([''"]/[''"]\)\[[''"]2[''"]\]\)\s*!=\s*[''"]-1[''"]\)\s*{'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0197"
    name: "JS-0197"
    description: "Malware detection signature JS-0197"
    severity: high
    category: js_malware
    pattern: 'preg_match\([''"]@\(yandex\|google\|bot'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0198"
    name: "JS-0198"
    description: "Malware detection signature JS-0198"
    severity: high
    category: js_malware
    pattern: 'String\.fromCharCode\(\s*[a-zA-Z0-9_]+\.charCodeAt\(i\)\s*\^\s*2'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0199"
    name: "JS-0199"
    description: "Malware detection signature JS-0199"
    severity: high
    category: js_malware
    pattern: '\[[''"]char[''"]\s*\+\s*[a-zA-Z0-9_]+\s*\+\s*[''"]At[''"]\]\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0200"
    name: "JS-0200"
    description: "Malware detection signature JS-0200"
    severity: high
    category: js_malware
    pattern: 'src=[''"]//[''"]\s*\+\s*String\.fromCharCode\.apply'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0201"
    name: "JS-0201"
    description: "Malware detection signature JS-0201"
    severity: high
    category: js_malware
    pattern: 'String\[\s*[''"]fromChar[''"]\s*\+\s*[a-zA-Z0-9_]+\s*\]\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0202"
    name: "JS-0202"
    description: "Malware detection signature JS-0202"
    severity: high
    category: js_malware
    pattern: '.=[''"].://.\..\..\../.\..\..'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0203"
    name: "JS-0203"
    description: "Malware detection signature JS-0203"
    severity: high
    category: js_malware
    pattern: '</script>[''"]\);\s*/\*/[a-zA-Z0-9_]+\*/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0204"
    name: "JS-0204"
    description: "Malware detection signature JS-0204"
    severity: high
    category: js_malware
    pattern: 'document\[_0x\d+\[\d+\]\]\(_0x\d+\[\d+\]\+_0x\d+\[\d+\]\+_0x\d+\[\d+\]\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0205"
    name: "JS-0205"
    description: "Malware detection signature JS-0205"
    severity: high
    category: js_malware
    pattern: '&adult=1&'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0206"
    name: "JS-0206"
    description: "Malware detection signature JS-0206"
    severity: high
    category: js_malware
    pattern: 'document\.readyState\s+==\s+[''"]complete[''"]\)\s*{\s*clearInterval\([a-zA-Z0-9_]+\);\s*s\.src\s*='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0207"
    name: "JS-0207"
    description: "Malware detection signature JS-0207"
    severity: high
    category: js_malware
    pattern: '.://.\..\../.\..\?/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0208"
    name: "JS-0208"
    description: "Malware detection signature JS-0208"
    severity: high
    category: js_malware
    pattern: 'src="files_site/js\.js'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0209"
    name: "JS-0209"
    description: "Malware detection signature JS-0209"
    severity: high
    category: js_malware
    pattern: 'window\.postMessage\({\s*zorsystem:\s*1,\s*type:\s*[''"]update[''"],\s*params:\s*{\s*[''"]url[''"]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0210"
    name: "JS-0210"
    description: "Malware detection signature JS-0210"
    severity: high
    category: js_malware
    pattern: '\.attachEvent\([''"]onload[''"],a\):[a-zA-Z0-9_]+\.addEventListener\([''"]load[''"],a,!1\);loadMatcher'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0211"
    name: "JS-0211"
    description: "Malware detection signature JS-0211"
    severity: high
    category: js_malware
    pattern: 'if\(\(a=e\.getElementsByTagName\([''"]a[''"]\)\)&&a\[0\]&&a\[0\]\.href\)for\(var'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0212"
    name: "JS-0212"
    description: "Malware detection signature JS-0212"
    severity: high
    category: js_malware
    pattern: ';\s*element\.innerHTML\s*=\s*[''"]<iframe\s+src=[''"]\s*\+\s*xhr\.responseText\s*\+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0213"
    name: "JS-0213"
    description: "Malware detection signature JS-0213"
    severity: high
    category: js_malware
    pattern: 'XHFER1\s*=\s*XHFER1'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0214"
    name: "JS-0214"
    description: "Malware detection signature JS-0214"
    severity: high
    category: js_malware
    pattern: 'document\.write\s*\(\s*[''"]{0,1}<script\s+src=[''"]{0,1}http://<\?=\$domain\?>/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0215"
    name: "JS-0215"
    description: "Malware detection signature JS-0215"
    severity: high
    category: js_malware
    pattern: 'window\.location\s*=\s*[''"]http://\d+\.\d+\.\d+\.\d+/\?'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0216"
    name: "JS-0216"
    description: "Malware detection signature JS-0216"
    severity: high
    category: js_malware
    pattern: 'setTimeout\(function\(\){var\s+pattern\s*=\s*new\s*RegExp\(/google'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0217"
    name: "JS-0217"
    description: "Malware detection signature JS-0217"
    severity: high
    category: js_malware
    pattern: 'wo=[''"]\+!!\([''"]ontouchstart[''"]\s+in\s+window\)\+[''"]&st=1&title'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0218"
    name: "JS-0218"
    description: "Malware detection signature JS-0218"
    severity: high
    category: js_malware
    pattern: 'if\(a&&[''"]data[''"]in\s*a&&a\.data\.a'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0219"
    name: "JS-0219"
    description: "Malware detection signature JS-0219"
    severity: high
    category: js_malware
    pattern: 'document\[[a-zA-Z0-9_]+\([a-zA-Z0-9_]+\[\d+\]\)\]\([a-zA-Z0-9_]+\([a-zA-Z0-9_]+\[\d+\]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0220"
    name: "JS-0220"
    description: "Malware detection signature JS-0220"
    severity: high
    category: js_malware
    pattern: '.\..\(\[''"]<. .=[''"]./.\[''"]\+\[''"].\[''"]\+\[''"].[''"]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0221"
    name: "JS-0221"
    description: "Malware detection signature JS-0221"
    severity: high
    category: js_malware
    pattern: '\(\)}},\d+\);/\*\w{32}\*/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0222"
    name: "JS-0222"
    description: "Malware detection signature JS-0222"
    severity: high
    category: js_malware
    pattern: 'eval[''"]\.split\([''"]\|[''"]\),0,{}\)\);\s*}\(\)\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0223"
    name: "JS-0223"
    description: "Malware detection signature JS-0223"
    severity: high
    category: js_malware
    pattern: 'if\(is\w+\)\s*{\s*window\.location\s*=\s*''http://\d+\.\d+\.\d+\.\d+/\?\w+'';\s*}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0224"
    name: "JS-0224"
    description: "Malware detection signature JS-0224"
    severity: high
    category: js_malware
    pattern: 'eval\(String\.fromCharCode\([\d+,\s]+\)\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0225"
    name: "JS-0225"
    description: "Malware detection signature JS-0225"
    severity: high
    category: js_malware
    pattern: 'window\.tnSetParams\(\d+\s*,\s*{("\w+":\d+,){3,}.+?;window\.tnLoadBlocks\(\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0226"
    name: "JS-0226"
    description: "Malware detection signature JS-0226"
    severity: high
    category: js_malware
    pattern: '.\.getShowedTeasersCount\(.\.siteId,\d+\)\+1},b=function\(\){.\.setShowedTeasersCount'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0227"
    name: "JS-0227"
    description: "Malware detection signature JS-0227"
    severity: high
    category: js_malware
    pattern: '<body>\s*<div id="tblock">\s*<center>\s*</center>\s*</div>\s*<script>setTimeout\("init\(\)",0\);</script>\s*</body>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0228"
    name: "JS-0228"
    description: "Malware detection signature JS-0228"
    severity: high
    category: js_malware
    pattern: '<!\[CDATA\[\s*window\.a\d+\s*=\s*\d+;!function\(\){var\s+\w+=JSON\.parse\(''\["\w+","\w+","\w+","\w+"\]''\),t="\d+"'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0229"
    name: "JS-0229"
    description: "Malware detection signature JS-0229"
    severity: high
    category: js_malware
    pattern: '/i\[\w+\[\d+\]\]\(\w+\[\w+\[\d+\]\]\(\d+,\d+\)\)\?!\d+:!\d+;}\w+\(\)===!\d+&&\(\w+\[\w+\[\d+\]\]=\w+\[\d+\]\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0230"
    name: "JS-0230"
    description: "Malware detection signature JS-0230"
    severity: high
    category: js_malware
    pattern: ':undefined}result=check_os\(\);cook=null;cook=getCookie\(_0x\w+\[\d+\]\);if\(cook==null\|\|cook==_0x\w+\[\d+\]\){if\(result==_0x\w+\[\d+\]\|\|result==_0x\w+\[\d+\]\){if\(result==_0x\w+\[\d+\]\){var\s+div=document'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0231"
    name: "JS-0231"
    description: "Malware detection signature JS-0231"
    severity: high
    category: js_malware
    pattern: '!function\(\){function\s+t\(\){return!!localStorage\.getItem\(a\)}function\s+e\(\){o\(\),\s*parent\.top\.window\.location\.href=c}function\s+o\(\){var\s+t=r\+i;localStorage\.setItem\(a,t\)}\s*function\s+n\(\){if\(t\(\)\){var\s+o=localStorage\.getItem\(a\);r>o&&e\(\)}else\s+e\(\)}var\s+a="\w+",\s*r=Math\.floor\(\(new Date\)\.getTime\(\)/\w+\),c=".+?",i=\d+;n\(\)}\(\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0232"
    name: "JS-0232"
    description: "Malware detection signature JS-0232"
    severity: high
    category: js_malware
    pattern: '<script\s+src=''/\?\d+_\d+_\d+_\d+=1''\s*>\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0234"
    name: "JS-0234"
    description: "Malware detection signature JS-0234"
    severity: high
    category: js_malware
    pattern: 'window\.onload=function\(\)\s*{\s*var\s+\w+\s*=\s*new\s+RegExp\(/[\-\w+\.]+\|.+?/i\);\s*var \w+\s*=\s*\(location\.href\)\.replace'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0235"
    name: "JS-0235"
    description: "Malware detection signature JS-0235"
    severity: high
    category: js_malware
    pattern: 'f\(!window\.a\w+\){var\s+a\w+=function\(\$\){return\s+\$\?document\.getElementById\(\$\):!1},a\w+=function\(\$\){return\s+\$\?document\.getElementsByClassName\(\$\):!1},a\w+=function\(\$\){return\s+\$\?document\.querySelector\(\$\):!1},a\w+=function\(\$\){return'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0236"
    name: "JS-0236"
    description: "Malware detection signature JS-0236"
    severity: high
    category: js_malware
    pattern: '\(function\(a,b\){if\(/.+?/i\.test\(a\.substr\(0,4\)\)\)window\.location=b}\)\(navigator\.userAgent\|\|navigator\.vendor\|\|window\.opera,''[^'']+''\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0237"
    name: "JS-0237"
    description: "Malware detection signature JS-0237"
    severity: high
    category: js_malware
    pattern: 'if\s*\(!VisitWeb\.Clickunder\)\s*VisitWeb\.Clickunder'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0238"
    name: "JS-0238"
    description: "Malware detection signature JS-0238"
    severity: high
    category: js_malware
    pattern: 'if\(/\(google\|yahoo\|bing\|aol\)/i\.test\(document\.referrer\)\){window\.setTimeout\(function\(\){top\.location\.href='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0239"
    name: "JS-0239"
    description: "Malware detection signature JS-0239"
    severity: high
    category: js_malware
    pattern: 't=window,n="teasernet_blockid",e="teasernet_padid"'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0240"
    name: "JS-0240"
    description: "Malware detection signature JS-0240"
    severity: high
    category: js_malware
    pattern: 'var\s+script=document\.createElement\(''script''\);script\.src=''.+?'';bindEvent\(function\(\){if\(\(document\.cookie\.indexOf\(''.+?''\)==-1\)&&\(navigator\.userAgent\.indexOf\(''\w+''\)!=-1\)&&\(document\.location\.pathname\.length>1\)&&\(\(navigator\.userAgent\.indexOf\(''\w+''\)!=-1\)\|\|\(navigator\.userAgent\.indexOf\(''\w+''\)!=-1\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0242"
    name: "JS-0242"
    description: "Malware detection signature JS-0242"
    severity: high
    category: js_malware
    pattern: 'if\(navigator\.userAgent\.match\(/\(([\w+\s\.]+\|?)+\)/i\)!==null\){window\.location\s*=\s*''.+?'';}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0243"
    name: "JS-0243"
    description: "Malware detection signature JS-0243"
    severity: high
    category: js_malware
    pattern: '\(function.+((toString|new|RegExp|String|eval|var|document|script|insertBefore|src|http|js|createElement|getElementsByTagName|parentNode|split)\|){5,}.+split\(''\|''\),0,{}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0244"
    name: "JS-0244"
    description: "Malware detection signature JS-0244"
    severity: high
    category: js_malware
    pattern: '"\];function \w+\(\w+\){return \w+\(\w+\(\w+\),.\w+.\);}\w+\(\w+\(\w+\[\d+]\)\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0245"
    name: "JS-0245"
    description: "Malware detection signature JS-0245"
    severity: high
    category: js_malware
    pattern: 'navigator\[_\w+\[\d+\]\]\|\|navigator\[_\w+\[\d+\]\]\|\|window\[_\w+\[\d+\]\];return/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0246"
    name: "JS-0246"
    description: "Malware detection signature JS-0246"
    severity: high
    category: js_malware
    pattern: 'parent\.top\.window\.location\.href=\w+}function \w+\(\){var \w+=\w+\+\w+;localStorage\.setItem\(\w+,\w+\)}\s*function \w+\(\){if\(\w+\(\)\){'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0247"
    name: "JS-0247"
    description: "Malware detection signature JS-0247"
    severity: high
    category: js_malware
    pattern: 'navigator\[_\w+\[\d+\]\]\|\|navigator\[_\w+\[\d+\]\]\|\|window\[_\w+\[\d+\]\];return/android'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0248"
    name: "JS-0248"
    description: "Malware detection signature JS-0248"
    severity: high
    category: js_malware
    pattern: '/js/jquery\.min\.php\?c_utt=\w+&c_utm='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0249"
    name: "JS-0249"
    description: "Malware detection signature JS-0249"
    severity: high
    category: js_malware
    pattern: '/js/jquery\.min\.php\?key=\w+&utm_campaign=\w+&utm_source='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0250"
    name: "JS-0250"
    description: "Malware detection signature JS-0250"
    severity: high
    category: js_malware
    pattern: '<script\s+language=JavaScript\s+id=scriptData\s*></script>\s*<script\s+language=JavaScript\s+src=/modules/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0251"
    name: "JS-0251"
    description: "Malware detection signature JS-0251"
    severity: high
    category: js_malware
    pattern: '\/\*\w.+?\.js.+?\*\/;\s*\(\s*function\(\)\s*{var\s\w{8}\=.+?for\s*\(\s*var\s*\w{8}\s*=.+?String\.fromCharCode\(''\+\w{8}\+''\)''\)\)\;\}\)\s*\(\)\;\/\*.+?\*\/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0252"
    name: "JS-0252"
    description: "Malware detection signature JS-0252"
    severity: high
    category: js_malware
    pattern: 'el\.src\s*=\s*"/misc/jquery\.animate\.js\?_=.+?try\s*{\s*p\.parentNode\.insertBefore\(el\s*,\s*p\); '
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0253"
    name: "JS-0253"
    description: "Malware detection signature JS-0253"
    severity: high
    category: js_malware
    pattern: 'CreateObject\("Shell\.Application"\).+?ShellExecute'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0256"
    name: "JS-0256"
    description: "Malware detection signature JS-0256"
    severity: high
    category: js_malware
    pattern: 'XMLHttpRequest.+?RegExp\(["'']([a-zA-Z_|\-0-9]+)?(checkout|onestep|onepage)([a-zA-Z_|\-0-9]+)?[''"],''gi''\)\)\.test\(window\.location'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0257"
    name: "JS-0257"
    description: "Malware detection signature JS-0257"
    severity: high
    category: js_malware
    pattern: '<!--\w{32}--><style>#\w+\s*{color:\w+;padding:\d+px;margin:\d+px;}\s*\.\w+,\s*\.\w+\s*a\s*{text-decoration:none.+?</div></div><!--\w{32}-->'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0258"
    name: "JS-0258"
    description: "Malware detection signature JS-0258"
    severity: high
    category: js_malware
    pattern: '((frameborder="no"|scrolling="no"|allowtransparency)\s+){3,}style="(position:fixed;|top:0px;|left:0px;|bottom:0px;|right:0px;|width:100%;|height:100%;|border:none;|margin:0;|padding:0;|filter:alpha\(opacity=0\);|opacity:0;|cursor:pointer;|z-index:\d+){5,}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0259"
    name: "JS-0259"
    description: "Malware detection signature JS-0259"
    severity: high
    category: js_malware
    pattern: '_popwnd\s*=\s*window\.open\(''http://quickdomainfwd\.com/\?dn='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0260"
    name: "JS-0260"
    description: "Malware detection signature JS-0260"
    severity: high
    category: js_malware
    pattern: '/tds/go\.php?sid=\d+&tag'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0261"
    name: "JS-0261"
    description: "Malware detection signature JS-0261"
    severity: high
    category: js_malware
    pattern: '/tds/go\.php?sid=\d+&tag'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0262"
    name: "JS-0262"
    description: "Malware detection signature JS-0262"
    severity: high
    category: js_malware
    pattern: 'var\s*\w{1,40}\s*=\s*new\s*CoinHive\.Anonymous\s*\(\s*''[^'']+''\s*\)\s*;\s*miner\.start\s*\(\s*\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0263"
    name: "JS-0263"
    description: "Malware detection signature JS-0263"
    severity: high
    category: js_malware
    pattern: 'v=0;vx=[''"]Cod'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0264"
    name: "JS-0264"
    description: "Malware detection signature JS-0264"
    severity: high
    category: js_malware
    pattern: 'At[''"]\]\(v\+\+\)-1\)\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0265"
    name: "JS-0265"
    description: "Malware detection signature JS-0265"
    severity: high
    category: js_malware
    pattern: 'ClickUndercookie\s*=\s*GetCookie'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0266"
    name: "JS-0266"
    description: "Malware detection signature JS-0266"
    severity: high
    category: js_malware
    pattern: 'userAgent\|pp\|http\|dazalyz[''"]{0,1}\.split\([''"]{0,1}\|[''"]{0,1}\),0'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0267"
    name: "JS-0267"
    description: "Malware detection signature JS-0267"
    severity: high
    category: js_malware
    pattern: '\.prototype\.a}catch\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0268"
    name: "JS-0268"
    description: "Malware detection signature JS-0268"
    severity: high
    category: js_malware
    pattern: 'try{Boolean\(\)\.prototype\.q}catch\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0269"
    name: "JS-0269"
    description: "Malware detection signature JS-0269"
    severity: high
    category: js_malware
    pattern: 'if\(Ref\.indexOf\(''\.google\.''\)!='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0270"
    name: "JS-0270"
    description: "Malware detection signature JS-0270"
    severity: high
    category: js_malware
    pattern: 'indexOf\|if\|rc\|length\|msn\|yahoo\|referrer\|altavista\|ogo\|bi\|hp\|var\|aol\|query'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0271"
    name: "JS-0271"
    description: "Malware detection signature JS-0271"
    severity: high
    category: js_malware
    pattern: 'Array\.prototype\.slice\.call\(arguments\)\.join\([''"][''"]\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0272"
    name: "JS-0272"
    description: "Malware detection signature JS-0272"
    severity: high
    category: js_malware
    pattern: 'q=document\.createElement\("d"\+"i"\+"v"\);q\.appendChild\(q\+""\);}catch\(qw\){h='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0273"
    name: "JS-0273"
    description: "Malware detection signature JS-0273"
    severity: high
    category: js_malware
    pattern: '\+zz;ss=\[\];f=''fr''\+''om''\+''Ch'';f\+=''arC'';f\+=''ode'';w=this;e=w\[f\["substr"\]\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0274"
    name: "JS-0274"
    description: "Malware detection signature JS-0274"
    severity: high
    category: js_malware
    pattern: 's5\(q5\){return \+\+q5;}function yf\(sf,we\){return sf\.substr\(we,1\);}function y1\(wb\){if\(wb==168\)wb=1025;else'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0275"
    name: "JS-0275"
    description: "Malware detection signature JS-0275"
    severity: high
    category: js_malware
    pattern: 'if\(navigator\.userAgent\.match\(/\(android\|midp\|j2me\|symbian'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0276"
    name: "JS-0276"
    description: "Malware detection signature JS-0276"
    severity: high
    category: js_malware
    pattern: 'document\.write\(''<script language="JavaScript" type="text/javascript" src="''\+domain\+''"></scr''\+''ipt>''\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0277"
    name: "JS-0277"
    description: "Malware detection signature JS-0277"
    severity: high
    category: js_malware
    pattern: 'http://phsp\.ru/_/go\.php\?sid='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0278"
    name: "JS-0278"
    description: "Malware detection signature JS-0278"
    severity: high
    category: js_malware
    pattern: '=navigator\[appVersion_var\]\.indexOf\("MSIE"\)!=-1\?''<iframe name'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0279"
    name: "JS-0279"
    description: "Malware detection signature JS-0279"
    severity: high
    category: js_malware
    pattern: '\\x65At'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0280"
    name: "JS-0280"
    description: "Malware detection signature JS-0280"
    severity: high
    category: js_malware
    pattern: '\\x61rCod'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0281"
    name: "JS-0281"
    description: "Malware detection signature JS-0281"
    severity: high
    category: js_malware
    pattern: '"fr"\+"omC"\+"harCode"'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0282"
    name: "JS-0282"
    description: "Malware detection signature JS-0282"
    severity: high
    category: js_malware
    pattern: '="ev"\+"al"'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0283"
    name: "JS-0283"
    description: "Malware detection signature JS-0283"
    severity: high
    category: js_malware
    pattern: '\[\(\(e\)\?"s":""\)\+"p"\+"lit"\]\("a\$"\[\(\(e\)\?"su":""\)\+"bstr"\]\(1\)\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0284"
    name: "JS-0284"
    description: "Malware detection signature JS-0284"
    severity: high
    category: js_malware
    pattern: 'f=''fr''\+''om''\+''Ch'';f\+=''arC'';f\+=''ode'';'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0285"
    name: "JS-0285"
    description: "Malware detection signature JS-0285"
    severity: high
    category: js_malware
    pattern: 'f\+=\(h\)\?''ode'':"";'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0286"
    name: "JS-0286"
    description: "Malware detection signature JS-0286"
    severity: high
    category: js_malware
    pattern: 'f=''f''\+''r''\+''o''\+''m''\+''Ch''\+''arC''\+''ode'';'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0287"
    name: "JS-0287"
    description: "Malware detection signature JS-0287"
    severity: high
    category: js_malware
    pattern: 'f=''fromCh'';f\+=''arC'';f\+=''qgode''\["substr"\]\(2\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0288"
    name: "JS-0288"
    description: "Malware detection signature JS-0288"
    severity: high
    category: js_malware
    pattern: 'var\s+div_colors'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0289"
    name: "JS-0289"
    description: "Malware detection signature JS-0289"
    severity: high
    category: js_malware
    pattern: 'var\s+_0x'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0290"
    name: "JS-0290"
    description: "Malware detection signature JS-0290"
    severity: high
    category: js_malware
    pattern: 'CoreLibrariesHandler'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0291"
    name: "JS-0291"
    description: "Malware detection signature JS-0291"
    severity: high
    category: js_malware
    pattern: 'km0ae9gr6m'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0292"
    name: "JS-0292"
    description: "Malware detection signature JS-0292"
    severity: high
    category: js_malware
    pattern: 'c3284d'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0293"
    name: "JS-0293"
    description: "Malware detection signature JS-0293"
    severity: high
    category: js_malware
    pattern: '\\x68arC'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0294"
    name: "JS-0294"
    description: "Malware detection signature JS-0294"
    severity: high
    category: js_malware
    pattern: '\\x6dCha'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0295"
    name: "JS-0295"
    description: "Malware detection signature JS-0295"
    severity: high
    category: js_malware
    pattern: '\\x6fde'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0296"
    name: "JS-0296"
    description: "Malware detection signature JS-0296"
    severity: high
    category: js_malware
    pattern: '\\x6fde'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0297"
    name: "JS-0297"
    description: "Malware detection signature JS-0297"
    severity: high
    category: js_malware
    pattern: '\\x43ode'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0298"
    name: "JS-0298"
    description: "Malware detection signature JS-0298"
    severity: high
    category: js_malware
    pattern: '\\x72om'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0299"
    name: "JS-0299"
    description: "Malware detection signature JS-0299"
    severity: high
    category: js_malware
    pattern: '\\x43ha'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0300"
    name: "JS-0300"
    description: "Malware detection signature JS-0300"
    severity: high
    category: js_malware
    pattern: '\\x72Co'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0301"
    name: "JS-0301"
    description: "Malware detection signature JS-0301"
    severity: high
    category: js_malware
    pattern: '\\x43ode'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0302"
    name: "JS-0302"
    description: "Malware detection signature JS-0302"
    severity: high
    category: js_malware
    pattern: '\.dyndns\.'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0303"
    name: "JS-0303"
    description: "Malware detection signature JS-0303"
    severity: high
    category: js_malware
    pattern: '\.dyndns-'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0304"
    name: "JS-0304"
    description: "Malware detection signature JS-0304"
    severity: high
    category: js_malware
    pattern: '}\s*else\s*{\s*document\.write\s*\(\s*[''"]{0,1}\.[''"]{0,1}\)\s*}\s*}\s*R\(\s*\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0305"
    name: "JS-0305"
    description: "Malware detection signature JS-0305"
    severity: high
    category: js_malware
    pattern: 'document\.write\(unescape\(''%3Cdiv%20id%3D%22'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0306"
    name: "JS-0306"
    description: "Malware detection signature JS-0306"
    severity: high
    category: js_malware
    pattern: '\.bitcoinplus\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0307"
    name: "JS-0307"
    description: "Malware detection signature JS-0307"
    severity: high
    category: js_malware
    pattern: '\.split\("&&"\);h=2;s="";if\(m\)for\(i=0;'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0308"
    name: "JS-0308"
    description: "Malware detection signature JS-0308"
    severity: high
    category: js_malware
    pattern: '<iframe\s+src="http://deluxesclicks\.pro/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0309"
    name: "JS-0309"
    description: "Malware detection signature JS-0309"
    severity: high
    category: js_malware
    pattern: '3Bfor\|fromCharCode\|2C27\|3D\|2C88\|unescape'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0310"
    name: "JS-0310"
    description: "Malware detection signature JS-0310"
    severity: high
    category: js_malware
    pattern: ';\s*document\.write\([''"]{0,1}<iframe\s*src="http://ya\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0311"
    name: "JS-0311"
    description: "Malware detection signature JS-0311"
    severity: high
    category: js_malware
    pattern: 'w\.document\.body\.appendChild\(script\);\s*clearInterval\(i\);\s*}\s*}\s*,\s*\d+\s*\)\s*;\s*}\s*\)\(\s*window'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0312"
    name: "JS-0312"
    description: "Malware detection signature JS-0312"
    severity: high
    category: js_malware
    pattern: 'if\(!g\(\)&&window\.navigator\.cookieEnabled\){document\.cookie="1=1;expires="\+e\.toGMTString\(\)\+";path=/";'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0313"
    name: "JS-0313"
    description: "Malware detection signature JS-0313"
    severity: high
    category: js_malware
    pattern: 'nn_param_preloader_container\|5001\|hidden\|innerHTML\|inject\|visible'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0314"
    name: "JS-0314"
    description: "Malware detection signature JS-0314"
    severity: high
    category: js_malware
    pattern: '<!--[a-zA-Z0-9_]+\|\|stat -->'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0315"
    name: "JS-0315"
    description: "Malware detection signature JS-0315"
    severity: high
    category: js_malware
    pattern: '&parameter=\$keyword&se=\$se&ur=1&HTTP_REFERER=''\+encodeURIComponent\(document\.URL\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0316"
    name: "JS-0316"
    description: "Malware detection signature JS-0316"
    severity: high
    category: js_malware
    pattern: 'windows\|series\|60\|symbos\|ce\|mobile\|symbian'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0317"
    name: "JS-0317"
    description: "Malware detection signature JS-0317"
    severity: high
    category: js_malware
    pattern: '\[[''"]eval[''"]\]\(s\);}}}}</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0318"
    name: "JS-0318"
    description: "Malware detection signature JS-0318"
    severity: high
    category: js_malware
    pattern: 'kC70FMblyJkFWZodCKl1WYOdWYUlnQzRnbl1WZsVEdldmL05WZtV3YvRGI9'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0319"
    name: "JS-0319"
    description: "Malware detection signature JS-0319"
    severity: high
    category: js_malware
    pattern: '{k=i;s=s\.concat\(ss\(eval\(asq\(\)\)-1\)\);}z=s;eval\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0320"
    name: "JS-0320"
    description: "Malware detection signature JS-0320"
    severity: high
    category: js_malware
    pattern: 'document\.cookie\.match\(new\s+RegExp\(\s*"\(\?:\^\|; \)"\s*\+\s*name\.replace\(/\(\[\\\.\$\?\*\|{}\\\(\\\)\\\[\\\]\\/\\\+\^\]\)/g'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0321"
    name: "JS-0321"
    description: "Malware detection signature JS-0321"
    severity: high
    category: js_malware
    pattern: 'setCookie\s*\(?\s*"arx_tt"\s*,\s*1\s*,\s*dt\.toGMTString\(\)\s*,\s*[''"]{0,1}/[''"]{0,1}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0322"
    name: "JS-0322"
    description: "Malware detection signature JS-0322"
    severity: high
    category: js_malware
    pattern: 'document\.cookie\.match\s*\(\s*new\s+RegExp\s*\(\s*"\(\?:\^\|;\s*\)"\s*\+\s*name\.replace\s*\(/\(\[\\\.\$\?\*\|{}\\\(\\\)\\\[\\\]\\/\\\+\^\]\)/g'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0323"
    name: "JS-0323"
    description: "Malware detection signature JS-0323"
    severity: high
    category: js_malware
    pattern: 'var\s+dt\s+=\s+new\s+Date\(\),\s+expiryTime\s+=\s+dt\.setTime\(\s+dt\.getTime\(\)\s+\+\s+900000000'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0324"
    name: "JS-0324"
    description: "Malware detection signature JS-0324"
    severity: high
    category: js_malware
    pattern: 'if\s*\(\s*num\s*===\s*0\s*\)\s*{\s*return\s*1;\s*}\s*else\s*{\s*return\s+num\s*\*\s*rFact\(\s*num\s*-\s*1'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0325"
    name: "JS-0325"
    description: "Malware detection signature JS-0325"
    severity: high
    category: js_malware
    pattern: '\+=String\.fromCharCode\(parseInt\(0\+''x'''
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0326"
    name: "JS-0326"
    description: "Malware detection signature JS-0326"
    severity: high
    category: js_malware
    pattern: '<script\s+language="JavaScript">\s*parent\.window\.opener\.location="http://vk\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0327"
    name: "JS-0327"
    description: "Malware detection signature JS-0327"
    severity: high
    category: js_malware
    pattern: 'location\.replace\([''"]{0,1}http://v5k45\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0328"
    name: "JS-0328"
    description: "Malware detection signature JS-0328"
    severity: high
    category: js_malware
    pattern: ';try{\+\+document\.body}catch\(q\){aa=function\(ff\){for\(i=0;i<z\.length;i\+\+\){za\+=String\[ff\]\(e\(v\+\(z\[i\]\)\)-12\);}};}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0329"
    name: "JS-0329"
    description: "Malware detection signature JS-0329"
    severity: high
    category: js_malware
    pattern: 'document\.write\s*\([''"]{0,1}<[''"]{0,1}\s*\+\s*x\[0\]\s*\+\s*[''"]{0,1} [''"]{0,1}\s*\+\s*x\[4\]\s*\+\s*[''"]{0,1}>\.[''"]{0,1}\s*\+x\s*\[2\]\s*\+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0330"
    name: "JS-0330"
    description: "Malware detection signature JS-0330"
    severity: high
    category: js_malware
    pattern: 'if\(t\.length==2\){z\+=String\.fromCharCode\(parseInt\(t\)\+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0331"
    name: "JS-0331"
    description: "Malware detection signature JS-0331"
    severity: high
    category: js_malware
    pattern: 'window\.onload\s*=\s*function\(\)\s*{\s*if\s*\(document\.cookie\.indexOf\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0332"
    name: "JS-0332"
    description: "Malware detection signature JS-0332"
    severity: high
    category: js_malware
    pattern: '\.style\.height\s*=\s*[''"]{0,1}0px[''"]{0,1};window\.onload\s*=\s*function\(\)\s*{document\.cookie'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0333"
    name: "JS-0333"
    description: "Malware detection signature JS-0333"
    severity: high
    category: js_malware
    pattern: '\.src=\([''"]{0,1}htps:[''"]{0,1}==document\.location\.protocol\?[''"]{0,1}https://ssl[''"]{0,1}:[''"]{0,1}http://[''"]{0,1}\)\+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0334"
    name: "JS-0334"
    description: "Malware detection signature JS-0334"
    severity: high
    category: js_malware
    pattern: '404\.php[''"]{0,1}>\s*</script>'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0335"
    name: "JS-0335"
    description: "Malware detection signature JS-0335"
    severity: high
    category: js_malware
    pattern: 'preg_match\([''"]{0,1}/sape/i[''"]{0,1}\s*,\s*\$_SERVER\[[''"]{0,1}HTTP_REFERER'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0336"
    name: "JS-0336"
    description: "Malware detection signature JS-0336"
    severity: high
    category: js_malware
    pattern: 'div\.innerHTML\s*\+=\s*[''"]{0,1}<embed\s+id="dummy2"\s+name="dummy2"\s+src'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0337"
    name: "JS-0337"
    description: "Malware detection signature JS-0337"
    severity: high
    category: js_malware
    pattern: 'setTimeout\([''"]{0,1}addNewObject\(\)[''"]{0,1},\d+\);}}};addNewObject\(\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0338"
    name: "JS-0338"
    description: "Malware detection signature JS-0338"
    severity: high
    category: js_malware
    pattern: '\(b=document\)\.head\.appendChild\(b\.createElement'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0339"
    name: "JS-0339"
    description: "Malware detection signature JS-0339"
    severity: high
    category: js_malware
    pattern: 'Chrome\|iPad\|iPhone\|IEMobile'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0340"
    name: "JS-0340"
    description: "Malware detection signature JS-0340"
    severity: high
    category: js_malware
    pattern: '\$:\({}\+""\)\[\$\]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0341"
    name: "JS-0341"
    description: "Malware detection signature JS-0341"
    severity: high
    category: js_malware
    pattern: '</iframe>[''"]\);\s*var\s+j=new\s+Date\(new\s+Date'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0342"
    name: "JS-0342"
    description: "Malware detection signature JS-0342"
    severity: high
    category: js_malware
    pattern: '{position:absolute;top:-9999px;}</style><div\s+class='
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0343"
    name: "JS-0343"
    description: "Malware detection signature JS-0343"
    severity: high
    category: js_malware
    pattern: 'if\s*\(\(ua\.indexOf\([''"]{0,1}chrome[''"]{0,1}\)\s*==\s*-1\s*&&\s*ua\.indexOf\("win"\)\s*!=\s*-1\)\s*&&\s*navigator\.javaEnabled'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0344"
    name: "JS-0344"
    description: "Malware detection signature JS-0344"
    severity: high
    category: js_malware
    pattern: 'parent\.window\.opener\.location=[''"]{0,1}http://vk\.com\.'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0345"
    name: "JS-0345"
    description: "Malware detection signature JS-0345"
    severity: high
    category: js_malware
    pattern: 'javascript\|head\|toLowerCase\|chrome\|win\|javaEnabled\|appendChild'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0346"
    name: "JS-0346"
    description: "Malware detection signature JS-0346"
    severity: high
    category: js_malware
    pattern: 'loadPNGData\(strFile,'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0347"
    name: "JS-0347"
    description: "Malware detection signature JS-0347"
    severity: high
    category: js_malware
    pattern: '\);if\(!~\([''"]{0,1}'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0348"
    name: "JS-0348"
    description: "Malware detection signature JS-0348"
    severity: high
    category: js_malware
    pattern: '//\s*Some\.devices\.are'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0349"
    name: "JS-0349"
    description: "Malware detection signature JS-0349"
    severity: high
    category: js_malware
    pattern: 'window\.onerror\s*=\s*killerrors'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0350"
    name: "JS-0350"
    description: "Malware detection signature JS-0350"
    severity: high
    category: js_malware
    pattern: 'check_user_agent=\[\s*[''"]{0,1}Lunascape[''"]{0,1}\s*,\s*[''"]{0,1}iPhone[''"]{0,1}\s*,\s*[''"]{0,1}Macintosh'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0351"
    name: "JS-0351"
    description: "Malware detection signature JS-0351"
    severity: high
    category: js_malware
    pattern: 'document\.write\([''"]{0,1}<[''"]{0,1}\+[''"]{0,1}i[''"]{0,1}\+[''"]{0,1}f[''"]{0,1}\+[''"]{0,1}r[''"]{0,1}\+[''"]{0,1}a[''"]{0,1}\+[''"]{0,1}m[''"]{0,1}\+[''"]{0,1}e'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0352"
    name: "JS-0352"
    description: "Malware detection signature JS-0352"
    severity: high
    category: js_malware
    pattern: 'stripos\(navigator\.userAgent\s*,\s*list_data\[i'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0353"
    name: "JS-0353"
    description: "Malware detection signature JS-0353"
    severity: high
    category: js_malware
    pattern: 'if\s*\(!see_user_agent\(\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0354"
    name: "JS-0354"
    description: "Malware detection signature JS-0354"
    severity: high
    category: js_malware
    pattern: 'c\.length\);}return\s*[''"][''"];}if\(!getCookie'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0355"
    name: "JS-0355"
    description: "Malware detection signature JS-0355"
    severity: high
    category: js_malware
    pattern: '<script\s*type=[''"]{0,1}text/javascript[''"]{0,1}\s*src=[''"]{0,1}ftp://'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0356"
    name: "JS-0356"
    description: "Malware detection signature JS-0356"
    severity: high
    category: js_malware
    pattern: 'if\s*\(document\.cookie\.indexOf\([''"]{0,1}sabri'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0357"
    name: "JS-0357"
    description: "Malware detection signature JS-0357"
    severity: high
    category: js_malware
    pattern: 'window\.location=b}\s*\)\(\s*navigator\.userAgent\s*\|\|\s*navigator\.vendor\s*\|\|\s*window\.opera\s*,\s*[''"]{0,1}http://'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0358"
    name: "JS-0358"
    description: "Malware detection signature JS-0358"
    severity: high
    category: js_malware
    pattern: '\);\s*if\(\s*[a-zA-Z0-9_]+\.test\(\s*document\.referrer\s*\)\s*&&\s*[a-zA-Z0-9_]+\)\s*{\s*document\.location\.href'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0359"
    name: "JS-0359"
    description: "Malware detection signature JS-0359"
    severity: high
    category: js_malware
    pattern: 'if\(/Android/i\[_0x[a-zA-Z0-9_]+\[\d+\]\]\(navigator'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0360"
    name: "JS-0360"
    description: "Malware detection signature JS-0360"
    severity: high
    category: js_malware
    pattern: 'function\(a\){if\(a&&[''"]data[''"]in\d+a&&a\.data\.a\d+&&a\.data\.a\d+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0361"
    name: "JS-0361"
    description: "Malware detection signature JS-0361"
    severity: high
    category: js_malware
    pattern: 's\(o\)}\)},f=function\(\){var t,i=JSON\.stringify\(e\);o\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0362"
    name: "JS-0362"
    description: "Malware detection signature JS-0362"
    severity: high
    category: js_malware
    pattern: '<\d+\s+\d+=[''"]\d+/\d+\\[''"]\+\\[''"].\\[''"]\+\\[''"].[''"]\s+.=[''"].://\d+\\[''"]\+\\[''"].\.\d+\\[''"]\+\\[''"]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0363"
    name: "JS-0363"
    description: "Malware detection signature JS-0363"
    severity: high
    category: js_malware
    pattern: 'setTimeout\(\d+\);\s*var\s+default_keyword\s*=\s*encodeURIComponent\(document\.title\);\s*var\s+se_referrer'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0364"
    name: "JS-0364"
    description: "Malware detection signature JS-0364"
    severity: high
    category: js_malware
    pattern: '=document\.referrer;if\(Ref\.indexOf\([''"]\.google\.[''"]\)!=-1\|\|Ref\.indexOf\([''"]\.bing\.[''"]\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0365"
    name: "JS-0365"
    description: "Malware detection signature JS-0365"
    severity: high
    category: js_malware
    pattern: 'visitorTracker_isMob'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0366"
    name: "JS-0366"
    description: "Malware detection signature JS-0366"
    severity: high
    category: js_malware
    pattern: '/\*\w{32}\*/var\s+_0x[a-zA-Z0-9_]+=\["\\x'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0367"
    name: "JS-0367"
    description: "Malware detection signature JS-0367"
    severity: high
    category: js_malware
    pattern: '/\*\w{32}\*/;window\[[''"]document[''"]\]\[[''"][a-zA-Z0-9_]+[''"]\]=\[[''"]'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0368"
    name: "JS-0368"
    description: "Malware detection signature JS-0368"
    severity: high
    category: js_malware
    pattern: '\]\]\.join\(\\[''"]\\[''"]\);[''"]\)\);/\*\w{32}\*/'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0369"
    name: "JS-0369"
    description: "Malware detection signature JS-0369"
    severity: high
    category: js_malware
    pattern: ';var\s+[a-zA-Z0-9_]+=[a-zA-Z0-9_]+\.charCodeAt\(\d+\)\^[a-zA-Z0-9_]+\.charCodeAt\([a-zA-Z0-9_]+\);[a-zA-Z0-9_]+=String\.fromCharCode\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0370"
    name: "JS-0370"
    description: "Malware detection signature JS-0370"
    severity: high
    category: js_malware
    pattern: 'eval\(eval\([''"]String\.fromCharCode\('
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0371"
    name: "JS-0371"
    description: "Malware detection signature JS-0371"
    severity: high
    category: js_malware
    pattern: 'clen;i\+\+\){b\+=String\.fromCharCode\(a\.charCodeAt\(i\)\^2\)}c=unescape\(b\);document\.write\(c\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0372"
    name: "JS-0372"
    description: "Malware detection signature JS-0372"
    severity: high
    category: js_malware
    pattern: 'window\.location\s*=\s*[''"]http://\d+\.\d+\.\d+\.\d+/\?[a-zA-Z0-9_]+'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0373"
    name: "JS-0373"
    description: "Malware detection signature JS-0373"
    severity: high
    category: js_malware
    pattern: '." .=".://.\..\../.-./././.\..\..'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0374"
    name: "JS-0374"
    description: "Malware detection signature JS-0374"
    severity: high
    category: js_malware
    pattern: ';eval\(String\.fromCharCode\(\d+\s*,'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0375"
    name: "JS-0375"
    description: "Malware detection signature JS-0375"
    severity: high
    category: js_malware
    pattern: 'setTimeout\(\d+\);if\(document\.referrer\.indexOf\(location\.protocol\+"//"\+location\.host\)!==0'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0376"
    name: "JS-0376"
    description: "Malware detection signature JS-0376"
    severity: high
    category: js_malware
    pattern: '/i\[\w{1,45}\[\d+\]\]\(i\[\w{1,45}\[\d+\]\]\(0,\d+\)\)\?!0:!1;}\w{1,45}\(\)===!0&&\(window\[\w{1,45}\[\d+\]\]=\w{1,45}\[\d+\]\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0377"
    name: "JS-0377"
    description: "Malware detection signature JS-0377"
    severity: high
    category: js_malware
    pattern: ':undefined}result=check_os\(\);cook=null;cook=getCookie\(_0x[a-zA-Z0-9_]+\[\d+\]\);if\(cook==null\|\|cook==_0x[a-zA-Z0-9_]+\[\d+\]\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0378"
    name: "JS-0378"
    description: "Malware detection signature JS-0378"
    severity: high
    category: js_malware
    pattern: 'document\.write\([''"]<script\s+type=[''"]text/javascript[''"]\s+src=[''"]http://goo\.gl/\w{1,45}[''"]></script>[''"]\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0379"
    name: "JS-0379"
    description: "Malware detection signature JS-0379"
    severity: high
    category: js_malware
    pattern: '\(location\.href\)\.replace\([''"]http://[''"]\+location\.host\+[''"]/[''"],[''"][''"]\);if\(pattern\.test\(document\.referrer\)\)'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0380"
    name: "JS-0380"
    description: "Malware detection signature JS-0380"
    severity: high
    category: js_malware
    pattern: '<script\s*language=JavaScript\s*src=/media/system/js/\w{1,45}\.php'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0381"
    name: "JS-0381"
    description: "Malware detection signature JS-0381"
    severity: high
    category: js_malware
    pattern: 'uijquery\.org'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0382"
    name: "JS-0382"
    description: "Malware detection signature JS-0382"
    severity: high
    category: js_malware
    pattern: 'portal-b\.pw'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0383"
    name: "JS-0383"
    description: "Malware detection signature JS-0383"
    severity: high
    category: js_malware
    pattern: 'sexfromindia\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0384"
    name: "JS-0384"
    description: "Malware detection signature JS-0384"
    severity: high
    category: js_malware
    pattern: 'filekx\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0385"
    name: "JS-0385"
    description: "Malware detection signature JS-0385"
    severity: high
    category: js_malware
    pattern: 'stummann\.net'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0386"
    name: "JS-0386"
    description: "Malware detection signature JS-0386"
    severity: high
    category: js_malware
    pattern: 'toplaygame\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0387"
    name: "JS-0387"
    description: "Malware detection signature JS-0387"
    severity: high
    category: js_malware
    pattern: 'http://xzx\.pm'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0388"
    name: "JS-0388"
    description: "Malware detection signature JS-0388"
    severity: high
    category: js_malware
    pattern: '\.hopto\.me/jquery'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0389"
    name: "JS-0389"
    description: "Malware detection signature JS-0389"
    severity: high
    category: js_malware
    pattern: 'mobi-go\.in'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0390"
    name: "JS-0390"
    description: "Malware detection signature JS-0390"
    severity: high
    category: js_malware
    pattern: 'myfilestore\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0391"
    name: "JS-0391"
    description: "Malware detection signature JS-0391"
    severity: high
    category: js_malware
    pattern: 'filestore72\.info'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0392"
    name: "JS-0392"
    description: "Malware detection signature JS-0392"
    severity: high
    category: js_malware
    pattern: 'file2store\.info'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0393"
    name: "JS-0393"
    description: "Malware detection signature JS-0393"
    severity: high
    category: js_malware
    pattern: 'url2short\.info'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0394"
    name: "JS-0394"
    description: "Malware detection signature JS-0394"
    severity: high
    category: js_malware
    pattern: 'filestore123\.info'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0395"
    name: "JS-0395"
    description: "Malware detection signature JS-0395"
    severity: high
    category: js_malware
    pattern: 'url123\.info'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0396"
    name: "JS-0396"
    description: "Malware detection signature JS-0396"
    severity: high
    category: js_malware
    pattern: 'dollarade\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0397"
    name: "JS-0397"
    description: "Malware detection signature JS-0397"
    severity: high
    category: js_malware
    pattern: 'secclik\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0398"
    name: "JS-0398"
    description: "Malware detection signature JS-0398"
    severity: high
    category: js_malware
    pattern: 'moby-aa\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0399"
    name: "JS-0399"
    description: "Malware detection signature JS-0399"
    severity: high
    category: js_malware
    pattern: 'servload\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0400"
    name: "JS-0400"
    description: "Malware detection signature JS-0400"
    severity: high
    category: js_malware
    pattern: 'nnn\.pm'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0401"
    name: "JS-0401"
    description: "Malware detection signature JS-0401"
    severity: high
    category: js_malware
    pattern: 'nnm\.pm'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0402"
    name: "JS-0402"
    description: "Malware detection signature JS-0402"
    severity: high
    category: js_malware
    pattern: 'mob-redirect\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0403"
    name: "JS-0403"
    description: "Malware detection signature JS-0403"
    severity: high
    category: js_malware
    pattern: 'web-redirect\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0404"
    name: "JS-0404"
    description: "Malware detection signature JS-0404"
    severity: high
    category: js_malware
    pattern: 'top-webpill\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0405"
    name: "JS-0405"
    description: "Malware detection signature JS-0405"
    severity: high
    category: js_malware
    pattern: 'goodpillservice\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0406"
    name: "JS-0406"
    description: "Malware detection signature JS-0406"
    severity: high
    category: js_malware
    pattern: 'youtuibes\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0407"
    name: "JS-0407"
    description: "Malware detection signature JS-0407"
    severity: high
    category: js_malware
    pattern: 'unscrewing\.ru'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0408"
    name: "JS-0408"
    description: "Malware detection signature JS-0408"
    severity: high
    category: js_malware
    pattern: 'loadme\.chickenkiller\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0409"
    name: "JS-0409"
    description: "Malware detection signature JS-0409"
    severity: high
    category: js_malware
    pattern: '//vk\.cc'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0410"
    name: "JS-0410"
    description: "Malware detection signature JS-0410"
    severity: high
    category: js_malware
    pattern: 'webshop-tool-manager\.info'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0411"
    name: "JS-0411"
    description: "Malware detection signature JS-0411"
    severity: high
    category: js_malware
    pattern: 'privatelands\.biz'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0412"
    name: "JS-0412"
    description: "Malware detection signature JS-0412"
    severity: high
    category: js_malware
    pattern: '[''"]ui[''"]\.[''"]jquery\.org/jquery'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0413"
    name: "JS-0413"
    description: "Malware detection signature JS-0413"
    severity: high
    category: js_malware
    pattern: 'google-analyzing\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0414"
    name: "JS-0414"
    description: "Malware detection signature JS-0414"
    severity: high
    category: js_malware
    pattern: 'portal-\w{1,45}\.pw'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0415"
    name: "JS-0415"
    description: "Malware detection signature JS-0415"
    severity: high
    category: js_malware
    pattern: 'SBERBANK\.RU'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0416"
    name: "JS-0416"
    description: "Malware detection signature JS-0416"
    severity: high
    category: js_malware
    pattern: 'SBERBANK-ONLINE\.RU'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0417"
    name: "JS-0417"
    description: "Malware detection signature JS-0417"
    severity: high
    category: js_malware
    pattern: 'bokotraffic\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0418"
    name: "JS-0418"
    description: "Malware detection signature JS-0418"
    severity: high
    category: js_malware
    pattern: 'onclkds\.com'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0419"
    name: "JS-0419"
    description: "Malware detection signature JS-0419"
    severity: high
    category: js_malware
    pattern: 'mwtraf\.mobi'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0420"
    name: "JS-0420"
    description: "Malware detection signature JS-0420"
    severity: high
    category: js_malware
    pattern: 'recaptcha-in\.pw'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0421"
    name: "JS-0421"
    description: "Malware detection signature JS-0421"
    severity: high
    category: js_malware
    pattern: '\[0\]\.appendChild\(script\);};include\("http'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
  - id: "JS-0422"
    name: "JS-0422"
    description: "Malware detection signature JS-0422"
    severity: high
    category: js_malware
    pattern: 'miner\.start\(\w{1,45}\.\w{1,45}\);'
    is_regex: true
    extensions: [js, html, htm, php]
    level: 0
